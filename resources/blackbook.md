
## Contents Use Alt+Left arrow to return from hyperlinks target (Previous View)

- Contents Use Alt+Left arrow to return from hyperlinks target (Previous View)
- 1. Screen Forms / UI Controls
    - Overview
    - A. Form Design
        - A.1 Basic Features
        - A.2 Fields
        - A.3 Form Parameters / Settings
        - A.4 User Defined Tables
        - A.5 String lists
        - A.6 Script
        - A.7 Layout
        - A.8 Access Rights
    - B. Layout Controls
        - B.1 Tabs / Pages
        - B.2 Panels
        - B.3 Nested Panels
        - B.4 Sub Forms................................................................................................................................................................................................
    - C. Data Controls
        - C.1 String Textbox
        - C.2 Numeric Textbox
        - C.3 Memo Textbox
        - C.4 Password Textbox (Hash SHA-2)
        - C.5 Webpage / Email Textbox
        - C.6 Grid
        - C.7 Selector List
        - C.8 DropDown List (Memory Tables)
        - C.9 Text Picker
        - C.10 Checkbox...............................................................................................................................................................................................
        - C.11 Multiple Checkbox
        - C.12 Image
        - C.13 HTML Editor
        - C.14 SoftOne Spreadsheet
        - C.15 Datetime
        - C.16 Embedded QuickView
    - D. Dialog Controls
        - D.1 File Picker
        - D.2 Color Picker
        - D.3 Printers Picker
        - D.4 Time Scheduler
    - E. Command Controls
        - E.1 Buttons
        - E.2 Hyperlinks
    - F. Attached / Related Files....................................................................................................................................
    - G. Editor Commands
    - H. Editor Attributes
- 2. Browsers
    - Overview
    - A. Modules
    - B. Columns
    - C. Filters
    - D. Grouping
    - E. Sorting
    - F. Parent / Child Browsers
    - G. User-defined modules
- 3. Printout Forms
    - Overview
    - A. General Printing Features
        - A.1 Printer Settings
        - A.2 Available Printing Methods
        - A.3 Printout Form Types.........................................................................................................................................................................
        - A.4 Import / Export Printout Forms
    - B. Internal Printout Forms
        - B.1 Sections
        - B.2 Toolbar...................................................................................................................................................................................................
        - B.3 General Form Operations
        - B.4 Page Size
        - B.5 Draft Printout Fonts
        - B.6 Image Printout Fonts
        - B.7 Recurrent Zone
        - B.8 Band Image
        - B.9 QR Code
    - C. Ms-Word Printout Forms
        - C.1 General
        - C.2 Form Design
        - C.3 Filters – Sorting – Grouping
        - C.4 Field decimals
        - C.5 Report Footer
        - C.6 Item Image
        - C.7 Text wrap
    - D. Ms-Excel Printout Forms
        - D.1 General
        - D.2 Form Design
    - E. Label Printout Forms
    - F. Crystal Reports Printout Forms
        - F.1 Basics
        - F.2 Crystal Report Design
        - F.3 Reports using tables
        - F.4 Reports using SQL statements
        - F.5 Import Crystal Report into SoftOne
    - G. Automated Jobs
        - G.1 Auto Email............................................................................................................................................................................................
        - G.2 Auto Save to file
- 4. Alerts – EDA Event Driven Actions
    - Overview
    - A. Events & Conditions
        - A.1 Field Rule (On Change)
        - A.2 Table Rule
        - A.3 Module Rule
        - A.4 Browser – Search Condition
    - B. Actions
        - B.1 Send Message
        - B.2 Message Display (Notification)
        - B.3 Error Display (Exception)
        - B.4 Run
        - B.5 Update
        - B.6 Reminder
    - C. Case Studies
        - C.1 Field Rule – Message display
        - C.2 Table Rule – Error Message Display
        - C.3 Object Rule – Send Message
        - C.4 Browser – Search Condition
- 5. User-Defined Fields
    - A. General Features
    - B. Operation Commands
        - B.1 Line Calculation
        - B.2 Calculation of line+totals
        - B.3 SQL command
        - B.4 Question
        - B.5 SQL Filter
        - B.6 Single filter / Multiple filter
        - B.7 Function
        - B.8 Multi Results SQL
    - C. Built-in Functions............................................................................................................................................
        - Abs (Param1: double): double
        - GetConvertSeries (SOSOURCE: number, SERIES: number): string
        - FormatDateTime (Param1:string, Param2: Date): String............................................................................................................
        - SetValue (Param1: string, Param2:variant):integer
        - RunSQL (Param1:string):string
        - Copy (Param1: string, Param2, Param3: integer): string
- 6. Database Designer
    - A. General Features
        - A1. Synchronization
        - A2. Publication – Custom Administration
    - B. Fields
        - B.1 Field Data Types
        - B.2 Field Properties
        - B.3 Selector Fields
    - C. Tables
        - C.1 Table properties
        - C.2 Memory Tables...................................................................................................................................................................................
        - C.3 Child Tables
    - D. String Lists
    - E. Database Views
        - E.1 Design
        - E.2 Advanced Browser Redirection
        - E.3 Examples
    - F. Objects
        - F.1 Design
        - F2. Object Properties
        - F.3 Table Properties
        - F.4 Field Properties
        - F.5 Calculated Fields
        - F.6 Linked Tables
        - F.7 Browsers Design
        - F.8 Forms Design
        - F.9 Display Object in Menu
        - F.10 Printout Forms
        - F.11 Object Examples
    - G. Virtual Tables
        - G.1 Design Virtual Table
        - G.2 Virtual Table Example
    - H. Report Objects
        - H.1 Design Report Object
        - H.2 Report Object Example
- 7. Extra Tools
    - A. Auto Login from Windows Shortcut
        - A.1 Create a Windows Shortcut
        - A.2 Configuration of XCO connection file
        - A.3 XCO file Commands
    - B. Maximum Entries per Module (Select Top)
        - B.1 Overview
        - B.2 Object Usage
        - B.3 Browser Usage
    - C. Menu Jobs
        - C.1 Create Job
        - C.2 Job Types
        - C.3 Menu Job Parameters – Menu Commands
        - C.4 Examples of Menu Jobs
- 8. Scheduler & Messages
    - A. Remote Server
        - A.1 Activation
        - A.2 Remote Server Commands
        - A.3 Send SMS - Email
    - B. Windows Scheduler
        - B.1. Overview
        - B.2 Job File
        - B.3 XCO Connection File
        - B.3 Windows Scheduler Task
    - C. SoftOne Scheduler
        - C.1 CreateTask
        - C.2 Scheduler Commands
    - D. Messages
- 9. Form Scripts
    - A. General Features
        - A.1 Script Editor
        - A.2 Debug Javascript
        - A.3 Global Variables
        - A.3 S1P & X.SYS
    - B. Object Methods
        - BATCHEXECUTE
        - BEEP
        - CALLPUBLISHED (Library.Function:string, params)
        - CANCELEDITS
        - CLOSEAPPLICATION
        - CLOSEFORM
        - CLOSESUBFORM (SubFormName: string)
        - COPY – PASTE
        - CREATEAPPLPOPUP(ModuleHandle, 0)
        - DBDELETE
        - DBLOCATE (KeyData: variant)
        - DBINSERT
        - DBPOST
        - EXCEPTION (Message: string)
        - FIELDCOLOR (FieldName: string; UserColor: integer)
        - FOCUSFIELD (FieldName: string)
        - FREE
        - INVALIDATEFIELD (FieldName: string)..............................................................................................................................................
        - INCLUDE (filename: string)
        - OPENSUBFORM (SubFormName: string)
        - QUICKVIEW (ObjectName: string, ListName: string, Keydata: string)
        - PRINTDOCURL (ObjectName, FormName, RecordID, TemplateCode)
        - PRINTFORM (TemplateCode: integer, PrinterName: string, FileName: string)
        - REFRESH
        - RUNSQL (ASQL: string; AParams: Variant)
        - SETDECIMALS (FieldName: string, Decimals: integer)
        - SETDOCPRINT (PrintNum, Mode, TemplD: integer, PrinterName, Caption: string)
        - SETFIELDEDITOR (FieldName: string; Editor: String)
        - SETFIELDVALUE (FieldName: string, Value: Variant)
        - SETPARAM(PrmName, PrmValue);
        - SETPROPERTY ('EDITOPTIONS', 'READONLY=True/False')
        - SETPROPERTY ('MERCHANGELOG', 'True or False')
    - SETPROPERTY ('FIELD', 'FieldName', 'CAPTION', 'NewCaption')
    - SETPROPERTY ('FIELD', 'FieldName', 'VISIBLE', 'True/False or 1/0')
    - SETPROPERTY ('FIELD', 'FieldName', READONLY, 'True/False or 1/0' )
    - SETPROPERTY ('PANEL', 'PanelName', 'CAPTION', 'NewCaption')
    - SETPROPERTY ('PANEL', 'PanelName', 'VISIBLE', 'True/False or 1/0')
    - TOFILE (FileName, AMessage: string)
    - WARNING (Message: string)
- C. Object Functions
    - ASK (ACaption, AMessage: string): integer.....................................................................................................................................
    - ASKYESNO (ACaption, AMessage: string): boolean
    - CASE (IfCase, ThenCase, ElseCase: variant): Variant;
    - CHECKACCESS(JobName): Boolean
    - CONNECTIONSTATUS: string;
    - CREATEOBJ (ObjectName: string): OBJECT (IDispatch)
    - CREATEOBJFORM (ObjectName: string): OBJECT (IDispatch)
    - DOUBLE (StrNum: string): real
    - DIR (Name: string): string
    - EVAL (Formula: string): Variant
    - EXEC (Command: string): variant
    - FINDTABLE (TableName: string): variant
    - FILTERSUM (FieldName: string, Filter: string): real
    - FORM: string
    - FORMATFLOAT (number: float, decimalsformat: string): string
    - FORMATDATE (Dateformat: string, Date: TDateTime): string
    - FORMATTEXT (Text: string, parameters: string): string
    - FROMFILE (FileName: string): string
    - GETYEARPERIOD (ADate: TDateTime): Variant
    - GETLASTERROR: string
    - GETPARAM(PrmName)
    - GETPROPERTY('CUSTOMFIELDS, TABLENAME '): string
    - GETPROPERTY('MASTERTABLENAME'): string
    - GETPROPERTY('HASCHANGES'): boolean
    - GETPROPERTY('GRIDSELECTED: GRIDNAME | FIELDNAME '): string
    - GETSQLDATASET (ASQL: string; AParams: Variant): TDataset
    - HTTPCALL (URL: string, PostData: string, Headers: string, Method: string): Variant
    - ID (TableName: string, CodeValue: string): integer
    - INPUTBOX (Prompt: string, DefaultValue: string): string
    - INPUTQUERY (Title: string, Prompt: string, DefaultVal:Variant, vPassword:integer) : Variant
    - ISVALIDCONTRACT: boolean
    - LIST: string
    - LOCALE: integer
    - LOCALESTRING (value: string): string
    - LOGINDATE: TDateTime
    - MULTISQL: variant
    - NEWID: integer
    - PASSWORDVALIDATE(stringtoValidate: string, Password: string): boolean
    - PLAY (SoundFileName: string): boolean
    - SHOWOBJFORM: integer
    - SPELL (Num: Real): string
    - SQL (ASQL: string; AParams: Variant): string
    - STRINGS (StringList: string, Key: string): string
    - SUM (FieldName: string): real
    - TEMPDIR: string
    - TIME: string..................................................................................................................................................................................................
    - USERVALIDATE(UserName: string, Password: string): boolean
    - WEBREQUEST (JSONRequest: string): string
    - WSCALL (scope: variant, uri: string, postData: string, callbackFunc: variant): string
- D. Dataset Methods
    - APPEND
    - DELETE
    - DISABLECONTROLS
    - ENABLECONTROLS
    - EDIT
    - FIRST
    - INSERT
    - LAST................................................................................................................................................................................................................
    - NAME
    - NEXT
    - POST
    - PRIOR
    - SETREADONLY (FieldName: string, Value: True/False)...............................................................................................................
    - SETDATASETLINKS(ModuleHandle, DatasetHandle, Value)
    - SETFIELDPROPERTY(FieldHandle, PropertyIndex, PropertyValue);........................................................................................
    - GETFIELDPROPERTY(FieldHandle, PropertyIndex);
- E. Dataset Functions
    - ACTIVE: boolean
    - BOF: boolean
    - EOF: boolean...............................................................................................................................................................................................
    - FIELDBYNAME (FieldName: string): variant
    - FIELDCOUNT: integer
    - FIELDNAME (index: integer): string
    - FIELDTYPE (FieldName: string): integer
    - FIELDS (index: integer): variant
    - FILTER: string
    - FILTERED: boolean
    - GETGRAPH (LabelFieldName: string; ValueFieldName: string): string
    - GETHTML (FieldNames: string): string
    - GETXML (WriteMetadata: Boolean, DisplayTagsOnNullValues: Boolean): string
    - ISNULL (FieldName: string): boolean
    - JSON: string
    - LOCATE (KeyFields: string; KeyValues: variant): boolean
    - LOOKUP (KeyFields: string; KeyValues: Variant; ResultFields: string): Variant;
    - RECNO: integer
    - RECORDCOUNT: integer
    - STATE: integer
    - SUM (FieldName: string, Filter: string): real
- F. Field Events
    - ON_ObjectName_FieldName_VALIDATE
    - ON_ObjectName_FieldName
- G. Datagrid Events
    - ON_DatagridName_NEW
    - ON_DatagridName_POST
    - ON_DatagridName_AFTERPOST
    - ON_DatagridName_BEFOREDELETE
    - ON_DatagridName_AFTERDELETE
- H. Object Events
    - ON_CREATE
    - ON_FORMLOAD
    - ON_DESTROY
    - ON_CANCEL
    - ON_LOCATE
    - ON_POST
    - ON_AFTERPOST
    - ON_DELETE
    - ON_AFTERDELETE
    - ON_INSERT
    - ON_DOCPRINT
    - ON_OPENREPORT
    - EXECCOMMAND (cmd)
    - EXECCOMMAND(cmd) (cmd=-1)
    - EXECCOMMAND(cmd) (cmd=-2)
    - ON_RESTOREEVENTS
    - ON_EDIT
    - ON_AFTEREXECUTE
- I. Sub Form Events
    - ON_SubFormName_SHOW
    - ON_SubFormName_ACTIVATE
    - ON_SubFormName_ACCEPT
    - ON_SubFormName_CANCEL
- J. Report Objects Events
    - ON_BANDSTART(BandName)
    - ON_BANDEND(BandName)
    - ON_BANDLINE(BandName)
    - ON_BANDTRANSFER(BandName)......................................................................................................................................................
- K. Advanced JavaScript
    - K.1 JSMain
    - K.2 Library
    - K.3 Debug Functions
- Case Studies
    - 1. Print Form using dialog that asks for number of copies
    - 2. Delete related converted documents
    - 3. Get Compressed Data
    - 4. Run Batch Job
    - 5. Custom Screen Filters
    - 6. Virtual Table – Item Purchases
    - 7. HTTP Request – Google Maps Distance
    - 8. Run External Application
    - 9. Add Related Jobs in SoftOne Objects
    - 10. Run SBSL script without UI (filters screen)
    - 11. Auto a pply ABC model.
    - 12. SubMenu in Button
    - 13. ASCII Export / Import encoded file
    - 14. Get Browser field data
    - 15. Add / Retrieve HTML data
    - 16. Check / Add / Delete ABC (Activity Based Costing) data
- 10. Data Flows
    - A. Overview
    - B. Data Flow Rules
        - B.1 Source entity
        - B.2 Target entity
        - B.3 Runtime Settings
    - C. Data Flow Scenarios
    - D. Execute Data Flows from Screen Scripts
    - E. Case Studies
        - 1. Sales to Purchases Conversion
        - 2. Sales to Sales (Company)
        - 3. Items to Purchases...............................................................................................................................................................................
        - 4. Production to Purchases
        - 5. Marketing Campaigns to Tasks
- 11. SoftOne Batch Script Language (SBSL)...............................................................................
    - A. Overview
    - B. Syntax Basics
        - B.1 Case Insensitive
        - B.2 Semicolons
        - B.3 Comments
        - B.4 Variables
        - B.5 Libraries References..........................................................................................................................................................................
        - B.6 Functions...............................................................................................................................................................................................
        - B.7 Error Messages
        - B.8 Comparison symbols........................................................................................................................................................................
        - B.9 Logical operators
    - C. Dialog screen design (Interface)
        - C.1 Section TABLES
        - C.2 Section CACHETABLES
        - C.3 Section PANELS
        - C.4 Section STRINGS
        - C.5 Section FIELDEXEC
        - C.6 Section SCRIPT
    - D. Main Code
        - D.1 Converters
        - D.2 Functions
        - D.3 Connection Types
        - D.4 Variables
        - D.5 Use Libraries
        - D.6 Execute Javascript from SBSL
    - E. SBSL Script Execution
        - E.1 Menu Execution
        - E.2 Browser Execution
        - E.3 Form Execution
        - E.4 Run using Parameters
    - F. Built-in Functions
        - Abs(Number: numeric): numeric;
        - AddMessage(Text: string);
        - CallPublished(FunctionName: string, Params: VarArray);
        - CharToOem (var:string);
        - Commit(Connectionstring: string);
        - Copy(Source: string, Start: integer, Count: integer);
    - DateOfDateTime(DateTime: TDateTime);
    - DayOfDate(DateTime: TDateTime): integer;
    - DayOfWeek(): integer;
    - DaysinMonth(DateTime: TDateTime): integer;
    - Delay(Time: Integer);
    - DeQuotedStr (text:string);
    - EncodeTime(Hours: integer, Minutes: integer, sec: integer, ms: integer): TDateTime;
    - ExecPrg(File: string, Params: string);
    - ExecSQL(Connection: string, Query: string, Params: VarArray);
    - Fetch SQLCursorName
    - FormatSQLText(Connection: string, text: string, Params: VarArray);
    - GetIndexVar (Array: VarArray, index: integer);
    - GetTimeHour(DateTime: TDateTime): integer;
    - GetTimeMin(DateTime: TDateTime): integer;
    - GetTimeSec(DateTime: TDateTime): integer;
    - GetTimems(DateTime: TDateTime): integer;
    - GetQueryDataset(Datasetname: string, Connection: string, Query:string, Params:VarArray);
    - GetQueryResults(Connection: string, Query: string, Params: VarArray);
    - GetWhere(XModule, ParamWhere: string, Param3(0=and,1=where));
    - GrConvert(text: string): string;..............................................................................................................................................................
    - ImportModule(Module: string);
    - Len(text: string): integer;
    - ModuleCommand (Module, Soft1Command, Params: string);
    - MonthOfDate(DateTime: TDateTime): integer;
    - Now(): TDateTime;
    - OEMToChar (oem: var);
    - QuotedStr (text: string);
    - Pos(Text: string,Source: string): integer;
    - RaiseException(Message: string);
    - RefreshMemoryTable(MemoryTable: string);
    - Resultnum;
    - ReplaceStr (text: string, String1: string, String2: string);
    - RollBack(Connectionstring: string);
    - SafeCallPublished(FunctionName: string, Params: VarArray);
    - SafeExecSQL(Connection: string, Query: string, Params: VarArray);
    - SendResponse(Values, Fields: string);
    - Space (num: integer);
    - StartTrans(Connectionstring: string);
    - StrToDate(text: string, format: string): TDateTime;
    - StrToFloat (var: string);
    - StrToInt (var: string);
    - TableExists(Connection: string,TableName: string);
    - Trim(text: string): string;
    - Time():TDateTime;
    - VarArray(Var1, Var2, ..., Varn, n);
    - VarArrayDimCount (Array: VarArray);
    - VarArrayHighBound(Array: VarArray, Dim: integer);
    - VarToStr(Param: Variant);
    - XModule();
    - XSupport();
    - YearOfDate(DateTime: TDateTime): integer;
- G. SoftOne Libraries
    - G.1 ModuleIntf
    - G.2 PiLib
    - G.3 SysRequest
    - H. Case Studies
        - 1. ReUpdate Sales Documents
        - 2. Import Customers from Excel..........................................................................................................................................................
        - 3. Add Customer Collections (UI)
        - 4. Get String List Data
        - 5. Read ASCII file using specific Codepage
- 12. Web Services
    - A. Overview
    - B. Open Enterprise Engine
        - B.1 Prerequisites & Setup
        - B.2 Custom Web & Mobile Apps........................................................................................................................................................
        - B.3 Web Accounts
    - C. Methods / API Calls
        - Ping (Get Method)
        - Refresh(Get Method)
        - Login(Post Method)
        - Authenticate(Post Method)
        - ChangePassword (Post Method)
        - GetObjects (Post Method)
        - GetObjectTables (Post Method)
        - GetTableFields (Post Method)
        - GetDialog (Post Method)
        - GetFormDesign (Post Method)
        - GetBrowserInfo(Post Method)
        - GetBrowserData(Post Method)
        - GetReportInfo(Post Method)
        - GetReportData(Post Method)
        - GetData(Post Method)
        - FileName(Get Method)
        - SetData(Post Method)
        - Calculate(Post Method)
        - DelData(Post Method)
        - GetSelectorData(Post Method)
        - SelectorFields(Post Method)
    - D. Case Studies
        - 1. Get Items
        - 2. Add Customer
        - 3. Update Items
        - 4. Add Customer Branch
        - 5. Get Sales Documents..........................................................................................................................................................................
        - 6. Add Sales Document
        - 7. Add HTML data
        - 8. Get HTML data
        - 9. Add Related Files
- 13. Business Automation Machine
    - A. Overview
    - B. Prerequisites & Setup
    - C. Design & Mode
        - C1. Available Tools
        - C2. Mode
        - C3. Process Testing
    - D. Variables
        - D.1 Calculation
        - D.2 SQL Command
        - D.3 Soft1
    - E. Process Steps
        - E.1 Start
        - E.2 Decision
        - E.3 Standby
        - E.4 User Action
        - E.5 Job
        - E.6 Sub Process
    - F. Runtime............................................................................................................................................................
    - G. Audit & Reports
        - G.1 Business Process Management
        - G.2 Business Process Analysis
- Appendix System Parameters & Commands
    - A. SODTYPE – Entity Values................................................................................................................................
    - B. SOSOURCE – Module Values
    - C. ORIGIN – Transaction Source Values
    - D. CSTTYPE (CSTINFO Table)
    - E. X.SYS – System Parameters
    - F. ACMD Commands – System Tools
    - G. Editor Commands
    - H. Editor Attributes
    - I. Built-in Editors
    - J. Related Job Commands
    - K. Browser Job Commands
    - L. Command Line Switches
    - M. XCO: On-Premise Connection Settings
    - N. PARAMS.cfg: Cloud Connection Settings
    - O. Internal Object Parameters


## 1. Screen Forms / UI Controls

#### A. Form Design

#### B. Layout Controls

#### C. Data Controls

#### D. Dialog Controls

#### E. Command Controls

#### F. Attached Files

**G. Editor Commands**

#### H. Editor Attributes


Chapter 1 – Screen Forms

### Overview

Forms are visual surfaces of SoftOne objects (modules) that contain controls, such as Textboxes, Datagrids, EditLists,
Checkboxes, etc. and offer a graphical environment to display and process data from database objects.

Form interface can be designed in any way that it meets your needs and can be exported to file (.cst) so as to use it
in any other Softone installation. The tool for importing and exporting forms is ”Custom Administration”.

Note that every SoftOne object has at least one form (internal) that can not be updated. Instead, you can create as
many custom forms as you like and save them with different names inside the object.

Form structure is saved inside the blob field SODATA of the database table CSTINFO (CSTTYPE= 1 ), which makes it
easy to transfer through different installations as .cst or .auv files using the “Custom Administration” tool.

Most of the actions users do inside form controls generate events. Forms respond to these events using custom
script code (Javascript) and process them when they occur. For more information, see Chapter Form Scripts.

SoftOne application provides many form controls with a rich feature set. Additionally, SoftOne provides a fully
functional API which allows you to create DLL applications in .NET or Delphi, that can be displayed or interact with
SoftOne object forms.

The controls that can be used inside SoftOne Forms are discussed in the following sections.


Chapter 1 – Screen Forms

### A. Form Design

Forms are designed either through the “Design” icon or through right click (Figure A1). The option “Export to (.cst)”
exports the form as file, that can be later imported through “Custom Administration” tool.

```
Figure A 1
```
The window that is displayed is a WYSIWYG tool that allows you to alter the form layout.
Use buttons “Save” and “Save as” to save the changes you have made (Figure A2).

```
Figure A 2
```
Notice that the design screen form is similar to runtime. The only difference is a toolbar that stays on top of the
form and contains the tools to design it (Figure A3).

```
Figure A
```

Chapter 1 – Screen Forms

Form design is internally saved in a text format that can be displayed and copied to other forms through the
shortcut keys: **CTRL + ALT + SHIFT + F12** (Figure A4).

```
Figure A
```
You can also view the object Info using the shortcut keys: **CTRL + ALT + SHIFT + F1 1** (Figure A5).

```
Figure A
```

Chapter 1 – Screen Forms

#### A.1 Basic Features

The design tools are displayed through the right click pop up menu, which displays the available options that can be
used to create controls (panels, datagrids, tabs, memo textboxes and images) (Figure A1.1). The controls that can be
added to a form are discussed in detail below.

```
Figure A1.
```
```
Form Design Options
```
```
Tab / Page Panel / Area Datagrid
```
```
New panel
```
```
Inserts a new panel in the
selected tab.
```
```
Inserts a new panel under the
selected panel. Not applicable^
```
```
New datagrid
```
```
Inserts a new datagrid in the
selected tab.
```
```
Inserts a new datagrid under the
selected panel. Not applicable^
```
```
New tab
```
```
Inserts a new tab on the left of
the selected tab.
```
```
Inserts a new tab under the selected
panel.
```
```
Inserts a new tab under the
selected datagrid.
```
```
New memo
textbox
```
```
Inserts a new memo textbox in
the selected tab.
```
```
Inserts a new memo textbox under
the selected panel.
```
```
Inserts a new memo textbox
under the selected datagrid.
```
```
New Photo Inserts selected tab.a new image in the Inserts the selected panel.a new image textbox under Inserts under the selected datagrid.a new image textbox
```
```
New button Not applicable Inserts a new selected panel.button under the Not applicable
```
```
New link Not applicable Inserts a new panel. link^ under the selected Not applicable
```
```
Delete Deletes the selected tab.^ Deletes the selected panel.^ Deletes the selected datagrid.^
```
```
Properties Not applicable Opens the panel properties window. Opens the datagrid properties window
```

Chapter 1 – Screen Forms

#### A.2 Fields

The toolbar on the top of the form window provides the tools for designing a form.

Button “ **Fields** ” displays a window that contains all the available tables and fields defined inside the object. Fields
are inserted in panels or datagrids of the form through drag and drop.

The search icon lets you search for fields names or captions that contain the search word.
Another way to search for a field is by typing inside the window. This searches for the field captions and displays the
buttons “ _Previous_ ” and “ _Next_ ” at the bottom of the window.

Table names and field types are visible when you select the option “Field Details” from the right click menu.


Chapter 1 – Screen Forms

#### A.3 Form Parameters / Settings

“ **Configuration** ” button displays a window where you can change the database objects (tables, views, virtual tables)
that will be displayed in the form. The same tool allows you also to change field captions, default values, decimal
places, and also the way the form will interact with users, by entering your own code in JavaScript.

The first tab “ **General settings** ” allows you to add module parameter commands. These commands are the same as
the object properties and are explained fully in the section Object Properties.

Figure A 3. 1 shows an example of the parameter command _BUFEXCLUDE_ , which is used to exclude data from copy.
In the example the field “NAME” from the table “ITEM” is excluded when users click on the toolbar button “Copy”.

The command _CUSTOMBUFEXCLUDE_ is the same as _BUFEXCLUDE_ , but works for user defined fields. This command
is automatically inserted when you enable the property “Exclude from Copy Buffer” in a user defined field. The third
command _EDITOPTIONS=NOINSERT,NODELETE_ hides the toolbar buttons “New” and “Delete” from the current
form.

```
Figure A3.1 – Form Parameters
```

Chapter 1 – Screen Forms

#### A.4 User Defined Tables

The second tab “User Defined Tables” contains the tables and fields of the current object. Use this tab to add or edit
tables and also alter their field properties.

```
Figure A4.1 – Field Properties
```
**_A4.1 Field Properties_**

Field properties are summarized in the table below.

```
PROPERTY DESCRIPTION
```
```
Field name Name of the field (Database Name) – ReadOnly
Caption Title of the field, as it appears inside a form.
```
```
Display size Width of the field. Applicable only in Datagrids.
```
```
Forced Value Indicates the value that will be applied to the field when the record is submitted.
```
```
Default Value Indicates the default^ value of the field, that applies to new entries.^
Users can change it at runtime.
```
```
Decimals
```
- Indicates the number of the **decimal places**. Specific commands (P,V,Q,%,C) can be used in
  order to define the use of the company defaults for decimal places.
- When used in fields that are added to **memo textboxes** , then use the numbers 1, 2 or 3 to
  display the horizontal, vertical or both scrollbars.
- When used in fields that have **memory tables** as editor, then use number 0, 1, 2 to display
  the code, description or both values in datagrids.
  **Visible** Indicates whether the field is visible or not, when inserted to panel or datagrid in form.

```
ReadOnly Specifies whether the contents of the field can change at runtime by users.
```
```
Required Specifies whether a value for the field is required in order to submit a record^ (e.g. sales lines
with null items are not permitted).
```
```
No Copy Buffer
```
```
Visible only in custom fields. If selected then the value of this field is not copied, when a
record is copied (toolbar button “Copy”).
```

Chapter 1 – Screen Forms

**_A4.2 Add / Delete Tables_**

The combo box “Tables” lists all the custom tables, virtual tables and views that can be added in the form.

In order to add a SoftOne table in this list, click on the button “Add table” (Figure A 4 .2) and double click on the
desired table.

```
Figure A4.2
```
Any custom or internal table that is added can be deleted using the button “Delete table”.

Tables that are linked to fields (through editor property) can be deleted using the right click option “Delete link...”
(Figure A 4. 3 ).
Notice that linked tables will not be deleted if they have fields inside the form layout.

```
Figure A4.3
```

Chapter 1 – Screen Forms

**_A4.3 Table Properties_**

The available properties of the selected table (left pane) are displayed in the right pane of the window (Figure A 4. 4 ).

```
Figure A4.4
```
**Database table name**

Displays the name of the selected table or view as it exists in the database. It also displays the name of custom
virtual tables or view tables as defined in SoftOne database designer.

**Primary key**

Displays the primary key of the selected table (Figure A4.5).

```
Figure A4.5
```

Chapter 1 – Screen Forms

**Alias table name**

Defines the alias name of the table. Alias names are used to refer to tables in form scripts. It is possible to use the
same table more than once inside a form as long as you have different alias names. Figure A4. 6 shows that the
database table PRJLINES is inserted many times inside form PRJC, given different alias table names (PRSNLINES,
STGLINES, etc).

```
Figure A4.6
```

Chapter 1 – Screen Forms

**Locate statement**

Defines the fields that will be used to locate the data of the selected table according to the parent table.

If the the primary key of the detail table has the same name with the parent one (e.g. FINDOC), then you only need
to enter its name inside the locate statement (e.g. FINDOC). The application will auto create the relation
**ChildTable.ID = :HeaderTable.ID** (e.g. MTRLINES.FINDOC=:FINDOC.FINDOC) (Figure A4.7).

```
Figure A4.7
```
More that one keys are defined using a key-value pair expression divided by semicolons as follows:

MyTableField1 **;** MyTableField2 **;** MyTableField3 **=** 1000;2000;3000

References to parent table field values are made using colons followed by fields (without table names) (Figure A4.8):

MyTableField1 **;** MyTableField2 **;** MyTableField3 **=:ParentField1;:** ParentField2 **;** 1000

SoftOne X.SYS parameters can also be used as values inside locate statements (Figure A4. 9 )

MyTableField1 **;** MyTableField2 **;** MyTableField3 **=:** ParentField1 **;:X.SYS.COMPANY;** 1000


Chapter 1 – Screen Forms

```
Figure A4.8
```
```
Figure A4.9
```

Chapter 1 – Screen Forms

**Index Fields**
Used in second child tables (child tables linked to child tables) in order to indicate the fields that define the child to
child relationship. Figure A4.10 shows the table SNLINES which is child table to MTRLINES, which is also child table
of the parent table FINDOC. Index field of the SNLINES table is the field MTRLINES.

**Master Table**
Used in second child tables to indicate the name of the master child table that will be used for locating the records
of the second child table.
**Master Fields**
Used in second child tables to indicate the fields of the master child table that define the child to child relationship.

```
Figure A4.10
```

Chapter 1 – Screen Forms

**Sort Fields**
Defines the default sort fields of the selected table (when used in grid).
Fields are added in the “ **Sort Fields** ” list using drag and drop from the “ **Fields** ” list (Figure A4.1 1 ).

```
Figure A4.11
```
Uncheck a field if you need to sort it in descending order (Figure A4.12)

```
Figure A4.12
```

Chapter 1 – Screen Forms

#### A.5 String lists

This tab gives you the option of creating string lists that can be used inside the form. String Lists display a collection
of keys and values, that can be used as editors to numeric fields and display data in combo box controls with fast
lookups (Figure A5.1).

```
Figure A5.1
```
A string list is created using the right click option “New” on the left panel and its values are inserted through the
grid in the right panel (Figure A5.2).

```
Figure 5.2
```

Chapter 1 – Screen Forms

A string list can be used as lookup list of numeric fields by adding its name in the editor property of the field (Figure
A5. 3 ).

Note that string lists created through SoftOne Designer are referenced with a **$** prefix
(e.g. **$DesignerStringListName** ).

Analysis of String Lists design can be found in section String Lists (Chapter Form Scripts).

```
Figure A5. 3
```

Chapter 1 – Screen Forms

#### A.6 Script

Tab “Script” is used for adding extra code in JavaScript or VBscript that implements functionality in the form.
The default script Language is Javascript. Button “Check” (bottom-left) can be used to check Javascript code for
syntax errors.

The available commands, functions and events that can be used inside a form script are covered in Chapter Form
Scripts.

**Note:** When you press **CTRL+Spacebar** after entering “ **X.** ”, “ **function** “, “ **DatasetName.** ” (e.g. ITELINES.) then a list
of the available commands is displayed as in Figure A 6. 1.

```
Figure A 6. 1
```

Chapter 1 – Screen Forms

#### A.7 Layout

The toolbar button “Layout” displays all the form controls structure in a tree view. This tool has all the controls that
are used inside the form as well as the sub forms. It also provides the same tools as the designer window, which
means that you can design the whole form through this tool. Use the right click context menu to display all the
available commands for designing the form through this tool (Figure A 7 .1). The hierarchical arrangement of the
controls in the form is done through this tool. Simply drag a control (tab, panel, e.t.c) from a lower node and drop it
to the preferred higher node. This way your control is moved to a new position inside the form (Figure A7.2).

```
Figure A7.1 Figure A 7 .2
```
Nested / horizontal panels (Figure A 7 .3) are also created through this tool, by creating a parent panel and

then creating the child (horizontal) panels inside it (See Nested Panels).

```
Figure A7.3
```

Chapter 1 – Screen Forms

#### A.8 Access Rights

Users or groups of users that can access the form are defined through this window (Figure A 8 .1)

**Figure A8.1**
Record access rights are defined through object button “Define User Access Rights”. The available options are (A8.2):

- **Execute / View:** Access (Open) current object
- **New** : Insert new records
- **Edit** : Edit records
- **Delete** : Delete records

```
Figure A8.2
```

Chapter 1 – Screen Forms

### B. Layout Controls

#### B.1 Tabs / Pages

Tab control provides a way to present related information on separate labeled tabs (pages) within the form. By using
the Tab control, you can define multiple tabs in a SoftOne object form. Each page consists of a group of controls
that an object view displays when the user selects the corresponding tab. The following image displays an example
of tabs inside the Items object form (Figure B1.1).

```
Figure B1.1
```
Tabs can be created in forms design mode using the option “New page” of the right click pop up menu or from the
layout window (Figure B1.2). The order of tabs in a form can be altered using the “Layout” button. Alter the position
of the tabs by performing a drag and drop action.

```
Figure B1.2
```
##### PROPERTY DESCRIPTION

```
Name Sets the name of the tab control (used in Form Scripts).
```
```
Caption Sets the text that appears as title of the tab.
```
```
Lines
```
```
Sets the height of the tab counted in number of lines. Zero value auto increases the
height of the tab in order to display all the panel controls.
```
```
Height Sets the percentage height of the panel, according to its main layout control.
```
```
Floating Auto fits the tab^ to fill the available space^ of the form. Works for tabs^ inserted at the
bottom of forms or tabs.
```

Chapter 1 – Screen Forms

#### B.2 Panels

Forms and tabs consist of panels that contain controls, which are either designed for data entry such as textboxes,
combo boxes and checkboxes or for invoking commands within the application, such as buttons and links.
Figure B2.1 displays the Items form in design mode.

```
Figure B 2. 1
```
**_Design_**

Panels are created by right clicking on a form or tab and selecting “New Panel”. Fields can be added into panels
through drag and drop action either from the “Fields” window (Figure B2.2) or through “Configuration” window.
Panels can display up to four fields (columns) in a row, but you can you use more than one panels (nested panels) in
order to display more than four fields in a row.

```
Figure B 2. 2
```
**_Properties_**

The properties of a panel enable you to alter its appearance in the form. They are almost the same as other form
controls, since most of them share similar properties.
The table below lists panel properties which are the same for nested panels.


Chapter 1 – Screen Forms

##### PROPERTY DESCRIPTION

```
Name Sets the name of the panel control.
```
```
Caption Sets the text that appears as title of the panel.
```
```
Lines Sets the height of the panel^ counted in^ number of lines. Zero^ value auto increases the
height in order to display all the panel controls.
```
```
Height Sets the percentage height of the panel, according to its main layout control.
```
```
Columns
```
```
Sets the number of displayed columns (Max=4). Splits data controls into horizontal
columns. It is also used in nested panels and defines the number of horizontal panels
contained in a master panel.
```
```
Columns percentage Percentage of displayed columns, which is relevant to the width of the panel
```
```
Floating Auto fits the panel to fill the available space of a form or tab. Works for panels inserted
at the bottom of forms or tabs.
```
```
No bottom line Hides bottom border line of panel.
```
```
Vertical order
```
```
Vertical order of the panel controls. It also sets the control tab order to vertical instead
of horizontal
```
```
Group
```
```
Indicates a number that defines the selected panel. All panelsthat have the same
number align their controls in the same way.
```
```
Fields Fields, buttons and links that will be displayed in the selected panel.
```
#### B.3 Nested Panels

Object forms and tabs can display panels horizontally, which means that you can more than one panels, containing
up to four fields each, in a horizontal layout. A typical example of nested panels is the items form (Figure B3.1).

```
Figure B3. 1
```

Chapter 1 – Screen Forms

**_Design_**

Nested panels are created as sub panels of a main panel. First, you have to create a main panel that will contain the
sub panels. In order to achieve that, you have to click the button “Layout” in form design mode and then create the
main panel inside the window that appears.

Right click inside the Layout window and create a new panel, which will be used as “header” panel. Enter the number
of the nested panels inside the Columns box and then define their width as percentage per column. Then, select the
“header” panel and create new panels inside it, by right clicking and choosing “New Panel”. Now, you will have one
“header” panel with sub panels, that will be displayed horizontally inside the form.

**_Properties_**

The properties of nested panels are the same as Panel properties, except for the “master” panel, whose columns
define the width of the sub panels (Figure B3.2).

```
Figure B3.2
```
#### B.4 Sub Forms................................................................................................................................................................................................

Sub forms are pop up forms that can be displayed inside the main object form, through user’s interaction. They have
many uses, for example you can use a pop up form to display a more detailed view of a datagrid record that
contains many fields (Figure B4.1). Another example would be to use a sub form to display additional data
associated with a record, such as calculated values, datagrids with financial data, etc. when user clicks on a button of
a form or when a form event occurs (using form script).

```
Figure B4. 1 – Sub Form in sales documents datagrid
```

Chapter 1 – Screen Forms

**_Design_**

In design mode of an object form, select the “Layout” button and then right-click to create a new “Sub form”. In the
properties window of the newly created form enter its name, which can be later used to access the form in datagrids
or in form script (Figure B4. 2 ).

```
Figure B4. 2 – Sub Form SFITELINES in sales documents
```
Any control can be used inside a sub form as long as it is created under the sub form’s node in the layout window.
This means that when you right click a sub form (using the layout tree window) you can add panels, tabs, images,
datagrids, etc.

One way to display a sub form (e.g. “MySubForm”) in runtime is through button, that can be created using the
command **RUNB_SubFormName=Open Sub Form** (Figure B4.3). Alternative ways of creating buttons are discussed

in section Buttons.

```
Figure B4.3
```

Chapter 1 – Screen Forms

Sub forms can also be displayed when users double click on datagrid rows. This can be done by entering the name
of the sub form in the “ **Popup form** ” property of the datagrid (see Datagrid Properties). Figure B4.4 displays the
properties of item lines datagrid in sales documents form.

```
Figure B4. 4 – Sales documents – Item lines datagrid properties
```
**_Properties_**

Sub form properties are listed in the table below.

```
PROPERTY DESCRIPTION
```
```
Name Sets the name of the pop up form. This name can be used to access^ the sub form from
datagrid records or in form script.
```
```
Caption Sets the text that appears as title of the sub form.
```
```
Width Sets the width of the sub form.
```
```
Height Sets the of the sub form.
```
```
OK button Indicates that the OK button will be displayed on the bottom side of the sub form
```
```
Cancel button Indicates that the Cancel button will be displayed on the bottom side of the sub form
```
**_PopUp Form Examples_**

**Example 1**

#### Display a pop-up form from Datagrid records

This example demonstrates the design of a sub form that is displayed when users double click on a row of the Items
datagrid, which is inside the object “Sales documents”.

- In design mode of a “Sales documents” form, click on the button “Layout”, right click and select “New Form”
  (Figure B4.5).

```
Figure B4.5
```

Chapter 1 – Screen Forms

- Enter a name for your new sub form (e.g. MyPopUpform) in the Form Properties (Figure B4.6).

```
Figure B4.6
```
- Create panels, datagrids, tabs and any other control by right-clicking and selecting the appropriate control
  (Figure B4. 6 ). Fields can be added through the properties of controls.

```
Figure B4.6
```
- Finally, add the name of your sub form inside the “pop up form” property of the Items datagrid. This way your
  sub form will be displayed when users double click on a record line of the Items datagrid (Figure B4.7).

```
Figure B4.7
```

Chapter 1 – Screen Forms

**Example 2**
**_Display a pop-up form from Button click_**

Create a new button inside the “Fields” property of a panel, by entering a new field (right click) with the command
RUNB_ButtonID=ButtonCaption (e.g. RUNB_20140101=Open Pop up).

```
Figure B4. 8
```
In the tab “Script” of the configuration window add the following JavaScript code (Figure B4. 9 ):

function EXECCOMMAND(cmd) {
if(cmd == 20140101)
X.OPENSUBFORM('MYPOPUPFORM');
}

```
Figure B4. 9
```

Chapter 1 – Screen Forms

Alternatively, you can simply use the name of the sub form as the id of the button. In this case you don’t need to
write any code at all (Figure 4. 10 ).

```
Figure B4.10
```
Another way to open a sub form without writing script code would be to use a (virtual) numeric field for creating a
button. Then, inside the property “Editor” of the field you would have to enter the following command:
**XCMD:MYPOPUPFORM** (Figure B4.11).

```
Figure B4.11
```

Chapter 1 – Screen Forms

### C. Data Controls

Data entry controls display fields from database tables, virtual tables, view tables and database views that are added
in the form through Configuration button (tab User defined tables). The controls created depend on the data types
of the fields, which means that different types of fields create different controls (textboxes, memos, edit lists, etc).

Fields can be added in a layout control of a form through drag and drop, either from the tab “User defined tables”
under the window “Configuration” or from the window “Fields”.

#### C.1 String Textbox

String Textboxes display data from string (varchar or nvarchar) fields and allow users to edit them as unformatted
text. For example, the field “Name” of Items (table MTRL) is displayed in a textbox control and allows text input.

**_Design_**

A String Textbox is automatically created when you drag and drop a string field inside a panel. Another way is by
dragging and dropping fields inside the box “Fields” of panel properties. Moving fields between panels is permitted
and can be performed from panels’ properties window (Figure C1.1).

```
Figure C1.1 – Add field in panel
```

Chapter 1 – Screen Forms

**_Properties_**

Click on the button “Configuration”, move to the tab “User defined tables” and click on a field in order to display
and modify its the properties, which affect the way it is processed (Figure C1.2).

```
Figure C1.2 – Field Properties
```
Field properties are summarized below.

```
PROPERTY DESCRIPTION
```
```
Field name Name of the field (Read only)
Caption Title of the textbox
```
```
Display size Column width size. Affects only fields that are added to grids.
```
```
Forced Value Indicates a value that will be applied to the field when the record is submitted.
```
```
Default Value Sets a default value to the field, that applies to new entries. Users can change it at runtime.
```
```
Visible Indicates whether the field is displayed or not.
```
```
ReadOnly Specifies whether the contents of the textbox can change^ by users at runtime.^
Changing the value of the textbox by script code is allowed.
Required Specifies whether the textbox must be filled in order to submit a record.
Exclude from
Copy Buffer
```
```
Visible only in custom fields. If selected then the value of this field is not copied, when a record
is copied using the toolbar button “Copy”
```

Chapter 1 – Screen Forms

#### C.2 Numeric Textbox

Numeric Textbox control is textbox that accepts only numeric input.

**_Design_**

This type of textbox is created the same way as string textboxes and its properties differ only when it comes to
floats. This type of fields displays the number of decimals entered in the “Decimals” property inside the
“Configuration” window of a screen form.

**_Default decimal places_**

SoftOne application gives you the option to display float fields with the same number of decimals places as the ones
you have selected inside each company’s properties (Figure C2.1). This means that if you enter the letter **P** (Figure
C2.2) in the property “Decimals” of a float field, then the field will display with the same number of decimal places as
configured for company prices(field PDECIMALS inside table COMPANY).
The available formats are summarized in the following table.

```
COMMAND DESCRIPTION CORRESPONDING COMPANY FIELD
```
```
P Prices COMPANY.PDECIMALS
```
```
V Values COMPANY.VDECIMALS
```
```
Q Quantities COMPANY.QDECIMALS
```
```
% Percentages COMPANY.DDECIMALS
```
```
C Cost Prices COMPANY.CDECIMALS
```
```
Figure C2.1
```

Chapter 1 – Screen Forms

```
Figure C2.2
```
**_Calculation formulas_**

At runtime, there is an option of entering numbers inside numeric textboxes using formulas. Formulas must always
begin with the equal sign “=” (Figure C2.3).

```
Figure C 2 .3 – Calculation formulas in numeric fields
```

Chapter 1 – Screen Forms

#### C.3 Memo Textbox

Memo control is a multiline textbox that displays data from string fields. Examples of memo control fields are fields
REMARKS which can be found in almost every object and table (TRDR, MTRL, FINDOC, etc.).

**_Design_**

In order to display a string field as memo you have to right click a view or page (in design mode) and choose to
create a “New text”. Then simply drag and drop a string field inside the “Fields” box of the properties window.

**_Properties_**

The table below summarizes all the memo textbox properties

```
PROPERTY DESCRIPTION
```
```
Caption Adds a title in the top line (header) of the control
```
```
Height Changes the height (lines or percentage). If not entered then it auto fits the size of the
panel.
```
```
Scrollbars
```
```
Visibility of horizontal and vertical scrollbars can be achieved by entering the numbers 1, 2
or 3 inside the Decimals property of the selected field.
1: Horizontal scrollbar visible
2: Vertical scrollbar visible (Figures C3.1 & C3.2)
3: Both scrollbars visible (Figure C3.4)
```
```
Figure C3.1
```

Chapter 1 – Screen Forms

```
Figure C3.2
```
```
Figure C3.4
```

Chapter 1 – Screen Forms

#### C.4 Password Textbox (Hash SHA-2)

This control is a masked textbox that hides data and displays characters with asterisks. It generates a SHA- 256
encrypted hash and applies to string fields.

**_Design_**

In form design mode, open the configuration window, select a string field and enter the command **$PASSWORDH**
inside the Editor property on the right hand side of the window (Figure C.4.1).
In runtime mode the field is displayed as in figure C.4.2.

```
Figure C4.1
```
```
Figure C4.2
```

Chapter 1 – Screen Forms

#### C.5 Webpage / Email Textbox

These controls are textboxes, that add a link to their captions, which auto opens the corresponding programs (the
default Browser for Webpage and the default email client for Email).

**_Design_**

In form design mode, open the configuration window and select the field you want to display as webpage or email.
Then in Editor Property, on the right hand side of the window, add the command **$WEBPAGE** (Fig. C5.1) for
webpage or the command **$EMAIL** for email field (Fig. C5.2). In runtime mode, fields are displayed as in figure C.5.3

```
Figure C5.1
```
```
Figure C5.2
```
```
Figure C5.3
```

Chapter 1 – Screen Forms

#### C.6 Grid

Grid control is used for displaying child database tables, database views and virtual tables that have been created
through SoftOne database designer. Figure C6.1 shows the grid “ _Item lines_ ” of Sales Documents entity and the grid
“ _Alternative codes_ ” of Items entity, which are used as child tables to the parent tables of their objects.

```
Figure C6.1
```

Chapter 1 – Screen Forms

**_Design_**

While in object form design, right click on a panel and select “ _New Datagrid_ ” (Figure C6.2). Drag fields from the
“ _Fields_ ” or “ _Configuration_ ” windows inside the datagrid as in Figure C6. 3.

```
Figure C6.2
```
```
Figure C6. 3
```

Chapter 1 – Screen Forms

**_Properties_**

The table below summarizes all the grid properties (Figure C6.4).

```
PROPERTY DESCRIPTION
```
```
Name Sets the name of the datagrid
```
```
Caption Sets the title of the datagrid
```
```
Lines Sets the number of lines that will be displayed.
```
```
Height Sets the percentage height of the datagrid.
```
```
Popup form Defines the name of the pop-up^ form that will be displayed when user double clicks a
datagrid row.
```
```
LN Digits
```
```
Sets the width (in digits) of datagrid’s header column.
For example if you enter the number 2, then the header column’s width will be adjusted to
be able to display up to number 99. Entries above 99 (e.g. 100) will display on the first two
digits (Figure C6.4)
```
```
Floating
```
```
Auto fits the grid to fill the available space of a panel or tab.
Works for grids inserted at the bottom of forms or tabs.
```
```
Fields Fields that will be displayed in the selected grid.
```
```
Popup menu String list that defines the right click context menu of the grid (Figure C6.4).
```
```
Fields With Totals Numeric Columns (Field Names) that display totals in the footer of the grid (Figure C6.6).
```
```
Figure C6.4
```

Chapter 1 – Screen Forms

```
Figure C6.5
```
```
Figure C6.6
```

Chapter 1 – Screen Forms

#### C.7 Selector List

This control is a multi-column drop-down list (with magnifier) that displays data from database tables, inherited
tables, database views and view tables, and stores their primary key (as defined in SoftOne database designer).

The selected record is displayed in two textboxes that are defined in the property “Selector fields” through SoftOne
database designer. The first textbox usually indicates the code of the selected record and the second one the
description.

The columns of the drop-down list are the ones defined in the “Selector fields” property of database designer or the
user defined columns created in the linked object (Figure C7.1).

```
Figure C7.1
```
It is usually used in integer fields that are foreign keys to other tables, for example Customer (field TRDR) inside
Sales Documents (table FINDOC) (Figure C7.2).
The link is made through the editor property of the field by adding the name of the linked database table, database
view, view table or inherited table.

Extra features such as auto update of other fields can also be applied using any of the available editor attributes
(See Editor attributes).

```
Figure C7. 2
```

Chapter 1 – Screen Forms

#### C.8 DropDown List (Memory Tables)

This control is a drop-down list that displays two text boxes horizontally (with arrow selector). Designing a combo
box is the same as for selector list, which means that you enter the name of the table inside the editor property of a
field (Figure C8.1).

The main difference from the selector list control is that it refers to memory tables and that it displays only the
columns defined in the “Selector fields” property of the table through SoftOne database designer.

This control is usually used in small integer fields to store the id of a record and link to a foreign memory table. The
drop-down list box portion of the control is displayed when the user clicks the drop-down arrow.

Example of memory table drop down list is the field Country inside the table TRDR, which stores the id of Country in
Customers entity (Figure C8. 2 ).

```
Figure C8.1
```
```
Figure C8.2
```

Chapter 1 – Screen Forms

#### C.9 Text Picker

Text Picker Control is a drop-down list (with magnifier) that displays the selected data in one text box. When clicked
it displays a one column drop down list of alphanumeric data and returns the selected record string.

The main difference from the other drop-down list controls is that it allows editing of the data inside the textbox,
which does not affect the data of the drop-down list. It is usually used when you want to have a text list selector also
allowing the users to enter free text.

This control is created through the editor property of a string field by entering the name of a table and using also
the editor attributes **M,R[StringFieldColumn]**. This will return the defined column of the table (Figure C9.1).

Example of text picker control is the field COMMENTS inside the table FINDOC (Figure C9.2).

```
Figure C9.1
```
```
Figure C9.2
```

Chapter 1 – Screen Forms

#### C.10 Checkbox...............................................................................................................................................................................................

Checkbox is a three state (Yes / No / Null) control, usually associated with a small integer field. The selected state of
the control returns value 1, while the unselected state returns 0 (Figure C10.1).

```
Figure C10.1
```
To create a checkbox control, you have to insert the command $Y inside the Editor property of the preferred field.
This can be done in form design mode by selecting the button “Configuration” and choosing the field from the table
tree of the tab “User defined tables” (Figure C10.2).

```
Figure C10.2
```
Another way of displaying “Yes/No” data is through a combo box, using the editor $YN.
Figure C10.3 displays the design of field MTRSUBSTITUTE.ISACTIVE that is added in a datagrid of Items form.

```
Figure C10.3
```

Chapter 1 – Screen Forms

#### C.11 Multiple Checkbox

Multiple Check Box control displays one text box with a drop-down arrow selector. It is used in string fields and
presents the data of a **memory table or string list** in a drop-down list control. It stores the selected record ids in
comma delimited string (Figure C11.1).

```
Figure C11.1
```
This control is designed by entering the symbol # and the name of a memory table inside the editor property of a
field. For string lists, use the symbols #$ and the name of the string list (Figure C11.2).

Example of a multiple check box control is the field VISITEVERY inside the table TRDR, which presents a drop down
list of the week days.

```
Figure C11.2
```

Chapter 1 – Screen Forms

#### C.12 Image

Image control displays an image inside a form with the use of image data fields only. Field SODATA inside the table
XTRDOCDATA is an example of image field. Figure C12.1 displays the use of the field XTRDOCDATA in an image
control inside the Items object form.

```
Figure C1 2. 1
```
Image control can be created in design mode of a form, through the option “New picture” of the right click pop up
menu. Inside the properties window of the image, simply drag and drop the preferred binary field (Figure C12.2).

```
Figure C11.2
```

Chapter 1 – Screen Forms

#### C.13 HTML Editor

This control displays an editor for html code that is stored in an image field. Example of this control can be found in
field SOMAIL of the object Email (Figure C13.1).

```
Figure C13.1
```
HTML editor is designed in form by creating a new special panel through the right click pop up menu. Then, inside
the properties of the special panel you have to enter the command **HTMLEDITOR** inside the “Popup form” property
and also the expression **USERPARAMS=TableName.BinaryFieldName** in the “Editor Params” property (Figure
C13.2). “BinaryFieldName” is the name of the image field, that you have created in the table “TableName” from
SoftOne database designer (Figure C13.3).

```
Figure C13.2
```
```
Figure C13.3
```

Chapter 1 – Screen Forms

#### C.14 SoftOne Spreadsheet

SoftOne Spreadsheet is a spreadsheet displayed by combination of keys Alt + S on fields of the application. The
specific control allows you to use simple calculations within a spreadsheet environment and insert the result
(selected cell) within the field through which the tool was called (Figure C14.1).

By default, the spreadsheets in all fields are empty. However, it is possible to create default spreadsheets which will
be matched to specific fields of application modules. All you need to do is save the desired spreadsheet file in the
application folder with htm extension and provide as file name the name of the field (Object_Field.htm).

For example, if you want to match a file in the Barcode field of the item, you must save the file in the application
folder under the name ITEM_CODE1.htm. Figure C14.2 depicts the spreadsheet displayed with Alt + S in the
BARCODE field of the items.

```
Figure C14.1
```
```
Figure C14.2
```

Chapter 1 – Screen Forms

#### C.15 Datetime

This control is used for displaying datetime fields. Fields can be displayed in four different ways.

**_Date only_**

This control, which is the default one, displays a datetime field using a drop down calendar (Figure C15. 1 ). Nothing
is entered inside the editor property of the field (Figure C15.2).

```
Figure C15.1
```
```
Figure C15.2
```

Chapter 1 – Screen Forms

**_Date and time_**

This control displays a datetime field using a drop down calendar and its time using an updown control (Figure
C15. 3 ). The command **$DT** must be entered inside the editor property of the field (Figure C15. 4 ).

```
Figure C15.3
```
```
Figure C15.4
```
**_Time only_**

This is an UpDown control that displays only the time of a datetime field (Figure C15.5). The command **$Time** must
be entered inside the editor property of the field (Figure C15.6).

```
Figure C15. 5
```

Chapter 1 – Screen Forms

```
Figure C15.6
```
**_Time Range_**

This is a textbox control that displays the difference between two datetime fields in hh:mm:ss format (Figure C15.7).
The command **$TimeRange** must be entered inside the editor property of the field (Figure C15.8).

```
Figure C15. 7
```
```
Figure C15.8
```

Chapter 1 – Screen Forms

#### C.16 Embedded QuickView

It is a read only control that displays multiple data (columns) of a browser that exists in a different entity of the
current form’s entity.

Figures C16.1 and C16.2 display data and image of the selected row items. These data exist in the browser
‘ItemData’ that is created in ‘Items’ entity as in Figure C16.3.

You can also use this control to display data from form fields (not only datagrid rows) such as Customer financial
data (columns inside a browser of ‘Customers’ module).

```
Figure C16.1
```
```
Figure C16.2
```

Chapter 1 – Screen Forms

```
Figure C16.3
```
**_Design_**

Use a special area, enter the command **XQuickView** in Editor property and then the following commands as in
Figure C16.4:

**[PARAMS]
MODULE=ITEM
QUICKVIEW=ItemData
FIELD=ITELINES.X_CODE**

The table below summarizes the parameters needed to create an embedded quickview.

```
PARAMETER DESCRIPTION
```
```
MODULE Name of the entity (module) that the data exist.
```
```
QUICKVIEW Name of the browser. For images use the command IMAGE.
```
##### FIELD

```
Name of the field (inside current form) that will be used to retrieve the data.
(e.g. For Customers inside Sales Documents use: SALDOC.TRDR)
```

Chapter 1 – Screen Forms

```
Figure C16.4
```
Images are displayed using the parameter **QUICKVIEW=IMAGE** (Figure C16.5):

**[PARAMS]
MODULE=ITEM
QUICKVIEW=IMAGE
FIELD=ITELINES.X_CODE**

```
Figure C16.5
```

Chapter 1 – Screen Forms

### D. Dialog Controls

#### D.1 File Picker

This control displays a file picker dialog window. It returns the full path of the selected file (Figure D1.1). Varchar
fields are used to display this control in a form of an object, by adding the command **$FILENAME** in their editor
property (Figure D1.2).

```
Figure D1.1
```
```
Figure D1.2
```

Chapter 1 – Screen Forms

#### D.2 Color Picker

This control displays a color window and returns the selected values (Figure D2.1). Varchar fields are used to display
this control in a form of an object, by adding the command **$COLOR** in their editor property (Figure D2.2).

```
Figure D2.1
```
```
Figure D2.2
```

Chapter 1 – Screen Forms

#### D.3 Printers Picker

This control displays a printer dialog window and returns the selected printer string (Figure D3.1). Varchar fields are
used to display this control in a form of an object, by adding the command **$PRINTERS** in their editor property
(Figure D3.2).

```
Figure D3.1
```
```
Figure D3.2
```

Chapter 1 – Screen Forms

#### D.4 Time Scheduler

This control displays the SoftOne scheduler window and returns the selected values in semi-colon text (Figure D 4 .1).
String fields are used to display this control in a form of an object, by adding the command **$RECURRENCE** in their
editor property (Figure D 4. 3 ).

```
Figure D4.1
```
```
Figure D4.2
```

Chapter 1 – Screen Forms

### E. Command Controls

#### E.1 Buttons

Command Buttons can be created in any panel of a form and run when users click on them. The event handler that
controls the actions performed when the command button is clicked is **EXECCOMMAND(cmd),** where cmd refers
to the id of the button. Handling the “On Click” event is done through form script code (JavaScript / VBscript).

Buttons can be used to execute any of the following jobs:

- **Display / Open a sub form in an object**
  Use the sub form's name (e.g. Mypopupform) and the command **XCMD:Mypopupform** to open a sub form
  inside an object form.
- **Display / Open an object**
  Use the name of the object and the command **XCMD:ObjectName** to open an object.
  Enter the command in the editor property of a numeric field.
  Alternatively you can use form script code that handles the button click through the function
  EXECCOMMAND(cmd) and then use the EXEC function to open the object.
  The following command opens the customer object and locates a the record defined from the field
  SALDOC.TRDR. **X.EXEC('XCMD:CUSTOMER[AUTOLOCATE='+SALDOC.TRDR+',FORM=Myform]')**
- **Display a relative job of an object**
  Relative job commands can be found in Annex Relative Job Commands.
- **Execute custom form script code**
  Use buttons to execute code written in VBscript or JavaScript inside object forms.
- **Execute SBSL script**
  Use buttons to execute custom functions and code written in SBSL script.

Buttons are inserted in forms using one of the following ways (command RUNB or database fields):

**_Command RUNB_buttonID=buttonCaption (Recommended)_**

Right click the “Fields” property of a panel, select the option “Add field” from the pop up menu and enter the
command RUNB_ButtonID=MyButton (Figure E2.3). Buttons are displayed as in Figure E2.4.
Hyperlink buttons are added using the command **RUN_ButtonID=ButtonCaption**

```
Figure E2.3
```

Chapter 1 – Screen Forms

```
Figure E2.4
```
**_Database numeric fields_**

- Add a numeric field inside a panel
- Add the command **XCMD:xxx** (xxx=id of the button defined by the user) in the Editor property of the field
  (Figure E1.1). Note that the id of the button should be a number larger than 100.000, in order not to conflict
  with SoftOne internal buttons.
- Enter the number **1** inside the Decimals property of the field (Displays the **button** control). The field is
  displayed as **hyperlink** if you leave the Decimals property blank.

```
Figure E1.1
```
**_Virtual table numeric fields_**

- Create a virtual table in database designer
- Insert the virtual table in the “User defined tables” tab of the configuration window of an object
- Select the numeric field and follow the previous steps.


Chapter 1 – Screen Forms

#### E.2 Hyperlinks

Fields that are linked to tables through the editor property, display a link to their caption. This link redirects to the
corresponding table or object depending on the editor command.

Examples of fields with hyperlink captions are all the selector list and combo box controls, that link through their
editors to specific objects and tables (Figure E2.1).

More specifically links can be created by:

- Fields with lookup to memory-tables that create drop-down lists, which redirect to full data process of the
  memory-tables (e.g. Geographic Zones, Currencies etc.).
- Fields with lookup to tables that create selector list controls, which redirect to the objects defined in the editor
  property (e.g. Items in document lines, Customer in document, etc.).
- Webpage and e-mail fields that lead to the corresponding application.
- Command fields that respond as buttons.

The use of hyperlinks renders secondary the importance of the job menus because the operator does not have to
"remember" where each job is located. In reality, each job constitutes a job menu of its related jobs and all can be
accessed in an easy way, regardless of "where you are at the time" and "where the target-job is located in the
menu".

```
Figure E2.1
```

Chapter 1 – Screen Forms

### F. Attached / Related Files....................................................................................................................................

“Attached Files” is a control for adding attachments (files, shortcuts, URL) to any object, including custom ones.
The following Figures (F1 and F2) show that “Attached files” may be included in some objects (e.g. ITEM object), but
not included in some others (e.g. Resources - RSRC object).

```
Figure F 1
```
```
Figure F2
```

Chapter 1 – Screen Forms

```
The process of adding Attachments in any object is explained below, using as an example the internal object
Sets / Kits (Object ID: 70 , Object Name: SPCGPS ). The same process can be used for any custom object.
```
- Create a new string list inside a record of Soft1 Designer and name it **CUSTOMDOCINFO** – this keeps the
  references of all the custom objects that use “Attachments” (the similar SoftOne internal string list is
  SOFTDOCINFO). Use the script of the SBSL example “Get String List Data” to retrieve all the data of either
  SOFTDOCINFO or CUSTOMDOCINFO (Figure F3).

```
Figure F3
```
- Enter a new record as in Figure F 4.
  o **Key:** Object id (in this case its 70).
  o **Value** : Main TableName;Primary Key;Varchar Field1(CODE);Varchar Field2(NAME);COMPANY field. The
  last three fields are used in Documents File code, description fields.
- Save the record and close Soft1 Designer. There is no need for DB sync, since the DB schema has not changed.

```
Figure F4
```

Chapter 1 – Screen Forms

- Open the object form (Sets / Kits) in design mode and add the table XTRDOCDATA (Document Pointers) as in
  Figure F5.
  1. Click on “Configuration” button and move to “User Defined Tables” tab of “Entity Configuration” window.
  2. Click on “Add new table”
  3. Select “Document pointers” from the “Available Tables” window.
  4. Select XTRDOCDATA from the drop-down list “Tables”
  5. Check that “Document pointers” is added.

```
Figure F 5
```
- Alter the “Alias table name” to any unique name (e.g. CCCMYDOCDATA).
- Enter the following “Locate statement”: **REFOBJID;SOSOURCE;XDOCTYPE=:SPCS;70;1** (Figure F6)
  **_REFOBJID;SOSOURCE;_** **XDOCTYPE** **_=:PrimaryKey;ObjectID;1_**

```
Figure F6
```

Chapter 1 – Screen Forms

- Select the field Entity (REFOBJID) of Document pointers table and enter the forced value **: SPCS.SPCS** (Figure F7)
  **_:MainTableName.PrimaryKey_**

```
Figure F 7
```
- Select the field Module (SOSOURCE) of Document pointers table and enter the forced value **70** (Figure F8)
  **_ObjectID_**

```
Figure F8
```

Chapter 1 – Screen Forms

- Select the field Type (XDOCTYPE) of Document pointers table and enter the forced value **1** (Figure F9)

```
Figure F9
```
- In General Setting tab of the form add the command (Figure F 10 ):
  **XDOCTABLENAME=CCCMYDOCDATA** (XTRDOCDATA Alias Table Name)

```
Figure F 10
```

Chapter 1 – Screen Forms

- Finally, click on “Layout” and add a new tab. Add a special area and enter the editor: **DocFrm** (Figure F 11 ).

```
Figure F 11
```
- Save the form, insert or locate a record and check the functionality of the new control (Figure F1 2 ).

```
Figure F12
```

Chapter 1 – Screen Forms

### G. Editor Commands

The table below summarizes all the available editor commands and their use.

```
EDITOR COMMANDS
```
```
Command Operation – Usage Data Type
```
```
$DT Date & Time in different fields Datetime
```
```
$TIME Only Time (Returns the current Date) Datetime
```
```
$PASSWORD Password Mask (Displays text with asterisks) Varchar
```
```
$PASSWORDH Hash Password (Displays text with asterisks) Varchar
```
```
$Y Boolean field (Displays checkbox control) Small Integer
```
```
$YN Boolean field in datagrids (Displays “Yes/No/Null” drop-down list) Small Integer
```
```
$WEBPAGE Web page fields - Link to internet browser Varchar
```
```
$EMAIL Email fields - Link to e-mail application Varchar
```
```
$PRINTERS Displays printers window dialog Varchar
```
```
$IMAGE Displays image control (usage in Image fields) Image
```
```
$DATERANGE Date from to Datetime
```
```
$TIMERANGE Time from to Datetime
```
```
$COLOR Displays SoftOne color selection window Varchar
```
##### $ONECOLOR

```
Displays Windows color selection window: (65536*R)+(256*G)+B
= ( 256 ^ 2 * Red) + ( 256 ^ 1 * Green) + ( 256 ^ 0 * Blue)
```
```
Varchar
```
```
$FILENAME Displays file selection window and returns its path Varchar
```
```
$FOLDERNAME Displays folder selection window and returns its path Varchar
```
```
$MASKEDIT Code mask creation window Varchar
```
```
$RECURRENCE Displays SoftOne scheduler window Varchar
```
```
$MEMOEDIT Word wrap in datagrid lines for memo textbox fields Varchar
```
##### $LIST:OBJECT

```
Lookup from preselection lists created from browsers.
Tables used are SOLIST and SOLISTLNS. Varchar^
```
##### $XRUN

```
Runs external program.
$XRUN(D[0,C:\Xplorer.exe,"/"+CUSEXTRA.VARCHAR01])
The above example runs SoftOne application using the switch
parameters added in field CUSEXTRA.VARCHAR01.
```
```
Varchar
```

```
Chapter 1 – Screen Forms
```
### H. Editor Attributes

```
Inside Editors, that retrieve data from other Tables, Views or Strings (e.g. ITEM), it is possible to enter extra
commands that have various functions, such as entries filtering, fields updating, change links etc.
The following table summarizes all the available commands as well as examples of their syntax.
Note: Line breaks and Quotes are not permitted in editors, instead you can use the sql function char().
```
```
EDITOR ATTRIBUTES
```
**Command Operation – Use Syntax Example**

##### W

```
(Master
Table
Selectors)
```
```
Filters table data using extra where
clause in SQL statement.
Usage in selector fields linked to
master tables.
```
```
SALDOC(W[A.COMPANY=:X.SYS.COMPANY])
Lookup data from sales documents table using as filter the Company Login.
Login system parameters (as Login Company) can be used by entering a colon
: and then the name of the param(:X.SYS.COMPANY).
CUSTOMER(W[A.CODE LIKE CHAR(97)+CHAR(37)])
Customers that code starts with letter 'a' (... AND A.CODE LIKE 'a%')
```
```
W
(Memory
Table
Selectors)
```
```
Filters memory table data using the
operators AND, OR, <>, >, <.
Usage in selector fields linked to
memory tables.
```
```
SERIES(F[COMPANY;SOSOURCE=:X.SYS.COMPANY;1351],W[FPRMS=7000
OR FPRMS=7001])
Display sales series from login company that FPRMS=7000 or FPRMS=7001
```
##### W

```
(String
Lists)
```
```
Filters String List data.
Usage in fields linked to string lists.
```
```
$CCCMYSTR (W[1,2,3])
Lookup data from the string list CCCMYSTR displaying only the values that the
key is 1 or 2 or 3.
```
##### F

```
Filters memory table data.
Usage in fields linked to memory
tables.
```
```
MTRMARK(F[CCCMYFIELD;SODTYPE=1;51])
Lookup from the table MTRMARK filtering data using CCCMYFIELD = 1 and
SODTYPE = 51 fields and values.
```
##### M, R

```
Defines the field that will be
returned.
Usually used in string fields.
```
```
CUSTOMER(W[A.CCCMYFIELD=1],M,R[CODE])
Lookup data from customers (inherited table) using specific filter from CCC
field and return the customer's code.
(Use the Editor of the above example in a varchar field)
```
##### U

```
Updates fields after selection.
Usage in selector fields linked to
tables.
```
```
SERIES(U[FPRMS;BUSUNITS;=FPRMS;BUSUNITS@]
Lookup data from series table and update the FPRMS and BUSUNITS fields
with the values of the fields FPRMS and BUSUNITS of the selected series. The
@ symbol at the end indicates that the fields on the left, will always be
updated, no matter if they already have a value or not. If you do not enter the
@ symbol, then the fields will be updated only if they do not already have a
value.
```
```
H Redirection to Object, using the hyperlink of the field label. CC Lookup data from table CCCTABLE. Redirection to Object CCCOBJECT. CTABLE(H[CCCOBJECT]) or CCCTABLE(H[#ObjectID;RecordID])
```
```
E,W[] Exlcusion Filter in String Lists.Usage in fields linked to string lists.^
```
```
$CCCMYSTR (E,W[5])
Lookup data from the string list CCCMYSTR displaying only the values that the
key is not 5.
```
```
J Link to specific field. Usage in Custom Design Printouts. SALDOC(J[A.FINDOC])
```
##### I

```
Defines the field that will be
updated when user clicks the
button “Input” in fields of datagrids
with editors.
```
```
ITEM(I[QTY1])
In sales documents, when user selects from the available items and clicks on
the button “Input” then the data entered will update the QTY1 field.
```
##### L

```
Local Editor that lookups data from
a table, db view or virtual table that
is inside an object.
```
**1. CCCMYVTTABLE(L,F[CCCMYVTTABLEFIELD=:OTHERTABLE.FIELD])
2. #WHOUSE(L) (example in object Company** → **BRANCH.WHOUSES)**


Chapter 1 – Screen Forms

##### C

```
Removes the sql expression “ AND
A.COMPANY=<LoginCompany> ”
from the where clause.
Usage in selector fields linked to
master tables.
```
```
SALDOC(W[A.CCCField in (1,2,3)],C)
Lookup data from sales documents of all the companies, using also an extra
where clause: “AND A.CCCField in (1,2,3)”.
```
##### A

```
Removes the sql expression
“ AND A.ISACTIVE=1 ”
from the where clause.
Usage in selector fields linked to
master tables.
```
```
CUSTOMER(A)
Lookup data from Customer inherited table (Active and Inactive records)
```
##### Z

```
Applies to Soft1 Designer String
Lists only. Displays both Key and
Value of the string list.
```
```
$SODTYPE(Z)
Displays data in format “Key – Value“
```

Chapter 1 – Screen Forms

## 2. Browsers

#### A. Modules

#### B. Columns

#### C. Filters

#### D. Grouping

#### E. Sorting

#### F. Parent / Child Browsers

#### G. User-defined Tables


Chapter 2 - Browsers

### Overview

Browsers are used for displaying data from database tables and views. They serve a lot of features which can be
found either on runtime or in design mode. Browsers are displayed when users open any object from the menu.

Browsers are saved as blob data inside the table CSTINFO (CSTTYPE=0) and can be easily transferred through
different installations as .cst or .auv files using the “Custom Administration” tool.

The first screen displayed when you double click an object is the “Filters screen”, where users can define filters and
then view the records by clicking on the button “ **List** ”. The screen that appears next is the “List screen” (runtime
mode), which displays records in one or more datagrids depending on the design of the selected browser.

In runtime mode, users can filter, group, sort, copy and paste data and use any other option that is available in the
right click pop up menu. Browsers also allow users to alter the data of the records as long as the option “Editable” is
enabled through the design mode of the browser.

Another great feature of browsers is the ability to print the records displayed in any available system printer or in
MS-Word, Document file, MS-Excel, Spreadsheet file, ASCII file, PDF file, HTML file and even attach the file and send
it through e-mail.

Horizontal or vertical grouping of data is also available through the button “Grouping” of the toolbar.

Pivot analysis is yet another great tool embedded in browsers that displays data containing summarized numeric
columns in pivot table. Pivot tool provides all the functions needed to perform full analysis of your data.

The following image (Figure A 1 ) displays the design mode of the “Sales documents” browser. The available fields
are displayed in the left-hand side of the window, while the right part shows the selected fields (Columns) that will
be displayed in runtime of this particular browser.

Designing a browser is very easy. Just select a browser from the menu on the right pane and click the “Design” icon.
The available design options are summarized in the following sections.

```
Figure A 1 – Sales Documents Browser design
```

Chapter 2 - Browsers

The toolbar buttons in design mode of a browser are the following (Figure A2).

```
Figure A2–Browser toolbar buttons
```
**_Save_**

Saves the changes of the browser using its current name.
SoftOne default browsers cannot be overwritten. This means that when you use “Save” button in those browsers the
“Save as” window will appear.

**_Save as_**

Displays the “Save as” window in order to save the browser with a different name.

**_Delete_**

Deletes the selected browser from the database.

**_Apply_**

Applies the changes of the browser and makes it possible to run it and see if it fits your needs.

Notice that this button **does not save the browser** in the database. You need to use the “Save” or “Save as” buttons
in order to permanently save a browser in the database for later use.


Chapter 2 - Browsers

### A. Modules

The properties of the tab “Define Modules” (Figure A3) affect all the columns of the browser and are explained in
the table below.

```
Figure A3
```
```
PROPERTY DESCRIPTION
```
```
Expand by Defines the table of the module that will be used to display the data.
```
```
Fixed columns Number of columns that are kept visible while scrolling the browser results.
```
```
Totals file
```
```
Enter a name of a file that will be created in SoftOne Temp path, containing the total values
of the numeric fields of the browser. The path where the file is saved is: <Drive
letter>:\Documents and Settings\ <Windows user >\Application Data\SoftOne\Temp
```
```
Ascending
Numbering (Line
Digits)
```
```
Number of digits that will be displayed in the header column of browser results. For
example, if you enter the number 2, then the header column width will be adjusted in order
to be able to display up until entry 99. This does not mean that the browser will be limited
to this number of rows, but simply that the header column of records below 99 will not be
displayed, because the header column width does not auto fit. The default value is 2.
```
```
Display zeros It specifies whether the numeric columns of zero values will be blank or displayed with zero.
```
```
Auto preselection Auto selects all the records displayed in the browser.
```
```
Auto fit columns
size Automatically adjusts the size of the columns of the browser based on the column contents.^
```
```
Quick View
```
```
Enables the right click option “Quick view” in fields that are linked to this table through their
editor property. For example, in item lines of Sales documents object the right click option
“Quick view” is enabled if you have created a “Quick View” browser in Items object.
```
```
Force Pivot Execution of the browser opens the Pivot Analysis tool automatically.
```
```
Fast entry
```
```
It allows inserting new entries directly from the browser. All the record required fields must
be filled.
```

Chapter 2 - Browsers

### B. Columns

The “Modules” tab (Figure B1) is split in two panels. The left panel contains the fields that are available to display as
columns and filters or for grouping and sorting. Fields are inserted on the right hand-side of the window either
using double click or using drag-and-drop. “ **Columns** ” tab consists of the fields that will be displayed as columns of
the browser in runtime. Change the position of the columns using drag and drop or the arrows on the right side.

```
Figure B1
```
Unchecked columns are not visible in runtime, but they are executed in the SQL select statement and they can be
used to compute other columns. Figure B2 shows a browser in runtime mode.

```
Figure B2
```

Chapter 2 - Browsers

**_Field Properties_**

Once finished adding columns, proceed with the configuration of each column at the bottom part of “Columns” as
shown in Figure B3.

```
Figure B3
```
The available field options are:

```
PROPERTY DESCRIPTION
```
```
Table – field Name of table and field (Read only).
Title Title of the field.
```
```
Alignment Cell alignment of the field.
```
```
Width Column width.
```
```
Totals Applies^ only to numeric fields. Displays the totals of the field at the bottom line of the
browser. Available functions are the following: Min, Max, Average and Sum.
Decimals Number of decimal places.
```
```
Color matrix Color zone that will be applied to a field, depending on the range of values.
```
```
Horizontal analysis Horizontal Analysis of a numeric field based on another field of the browser (e.g. Period)
```
```
Grouping Scenarios Extra grouping of the horizontal analysis. For example, if you have selected a date field in
horizontal analysis then you can perform grouping by month.
Hint Displays the title of the field on mouse over the column.
```
```
Editable Sets the column in edit mode and allows user to alter field data through browser.
```

Chapter 2 - Browsers

Figure B4 displays a sales browser grouped (horizontally) by customer name, using also **horizontal analysis** of the
total value in months.

```
Figure B4
```
### C. Filters

This tab contains the fields that will be displayed in the first dialog (filters) of the browser and will be used to filter
the data of the browser. Add the fields using drag and drop or double click (Figure C1).

```
PROPERTY DESCRIPTION
```
```
Table – field Name of table and field (Read only).
```
```
Title (From – To) Title of the field as it will be displayed in filter dialog.
Value (From – To) Default value of the field. You can also use any of the available system parameters.
```
```
Locked Set the mode of the field to Read only.
```
```
Required Defines that users have to fill this field in order to list the data of the browser.
```
```
Figure C1
```

Chapter 2 - Browsers

### D. Grouping

This tab contains the fields that will be used for grouping the data of the browser in runtime. Add the fields using
drag and drop or double click and select grouping layout (vertical or horizontal).

Additionally, you can set the following parameters (Figure D1):

```
PROPERTY DESCRIPTION
```
```
Activate Activates grouping for the selected field.
Layout Defines the grouping layout, horizontal or vertical.
```
```
Grouping intervals Defines the grouping intervals depending on the type of field.
Auto Run Auto group after running the browser.
```
```
Detailed View
```
```
Selecting the cost accounting view displays all the selected columns of operating results
(see above), otherwise only the grouping and value fields columns shown as totals, will be
displayed.
Auto Filter Filters the group entries and displays only the ones included in the results of the browser.
```
```
Paging Exports the group index in different worksheets of Excel file.
```
**Note** : While running the browser with grouping, then the grouping columns are also used as sorting columns.

```
Figure D1
```

Chapter 2 - Browsers

### E. Sorting

Inside this tab you define the fields that will be used to sort the results of a browser.
Ascending or descending sort can be performed by selecting the appropriate option (Figure E1).

```
Figure E1
```

Chapter 2 - Browsers

### F. Parent / Child Browsers

Browsers can display more than one band of different tables. Figures F1 & F2 show an example of Sales Documents
browser that display analysis of both Item lines and Service lines.
The flag “ **_Master-Detail tree view_** ” of “ **_System Settings_** ” allows you to display secondary bands in two ways:

- In tree view as in Figure F1
- In grids at the bottom of the browser as in Figure F2.

```
Figure F 1
```
```
Figure F2
```

Chapter 2 - Browsers

Design of the above is achieved through the " **Define Modules** " tab, where you set the tables that will be used
inside the browser. Click on button “ **_Add_** ” to insert a <New module> and then select the detail table (e.g. Item
Lines) after clicking on the button (Figure F3).

```
Figure F2
```
Now, from “ **_Modules_** ” tab you can select the new module (e.g. “ **_Item lines_** ”) and add any columns to your browser
(Figure F3). Repeating the above steps you can add more than one bands (e.g. “ **_Service lines_** ”).

```
Figure F3
```

Chapter 2 - Browsers

### G. User-defined modules

The browsers provide the ability to design child bands (detail) using user-defined tables. That is, you can create SQL
statements that will populate a datatable, that can be later used as child table of the browser.

This is done from the module “ **_Define Modules_** ” following the instructions below:

- Click the button (next to button ).
- Inside the window that opens, click on “ **_Add_** ” to create a new table (e.g. MyLines).
- Enter your sql statement in the right panel box “ **_SQL_** ” as in Figure G1. The SQL statement uses the expression
  **:ParentTable.ID** to link to the parent table of the browser, where ID is the primary key of the parent table.
- Click on “Create fields from SQL” inside “Fields” tab to create the fields and add captions (Figure G2).

```
Figure G1
```
```
Figure G2
```

Chapter 2 - Browsers

Add a <New module>, select the custom table from “ **_User-defined view tables_** ” (Figure G3) and follow the steps of
the previous section to add new columns in the browser (Figure G4).

```
Figure G3
```
```
Figure G4
```

Chapter 2 - Browsers

**Example**
**_Create a browser in customers object that will display in a 2nd band the financial data of customers per year
and month._**

Create a new table and enter the SQL statement as in Figure G5.

Then create the fields through the " **_Fields_** " Tab, enter the captions and the editors FISCPRD and PERIOD of the
corresponding fields (Figure G6).

Insert a <New module> and select the new table through the “ **_User defined tables_** ”.

In the " **_Modules_** " tab of the browser, select the second module from the combo box and add the fields in the right
panel “ **_Columns_** ”. Save the browser under a name of your choice.

Run the browser and the results will be displayed as in Figure G7.

```
Figure G5 Figure G6
```
```
Figure G7
```

## 3. Printout Forms

#### A. General Printing Features

#### B. Internal Printout Forms

#### C. Ms-Word Printout Forms

#### D. Ms-Excel Printout Forms

#### E. Label Printout Forms

#### F. Crystal Reports Printout Forms

#### G. Automated Jobs


Chapter 3 – Printout Forms

### Overview

Printout form is a report tool that is used for printing data through SoftOne objects. This means that this tool auto
inherits the data structure (tables, database views, etc.) of an object and makes the associated fields available for use
in report by simple drag and drop. Printout forms run from the button “Print” while in object view of a record or
through right click on a record from browser.

### A. General Printing Features

#### A.1 Printer Settings

The printer mode (Image or Draft) is set through the "Printers" tab of system settings (Figure A1). Double click on a
printer in order to change its printing mode from Image to Draft.

```
Figure A1
```
If you select the Draft mode, then the option button " **Details** " (in lower left corner) is activated. Inside the window
that appears by clicking on the "Details" button, you can set the Dot Matrix printer settings. Default printing values
are inserted through click on the button “ **Default values** ” (Figure A2). These settings are applied perworking station
and are saved in the Xplorer.cfg file. This file is saved in the " **User Profile Directory** " folder. Link for this folder can
be found under the " **About** " button.

```
Figure A2
```

Chapter 3 – Printout Forms

#### A.2 Available Printing Methods

Data viewed in screens can also be sent to the following media:

**MS-Excel** : Opens and prints data in new Microsoft Excel file. Microsoft Excel must be installed on the client
computer.

**MS-Word** : Opens and prints data in new Microsoft Word file. Microsoft Word must be installed on the client
computer.

**E-mail** : Sends email using the selected data. Through a settings screen that is displayed you can set the file format
as well as whether the data will be sent in the email body or in an attachment file.

**Spreadsheet File** : Exports the data in xls format. It does not necessarily require the installation of Microsoft Excel,
but any spreadsheet application.

**Document File** : Exports data in doc format. It does not necessarily require the installation of Microsoft Word, but
any text processing application.

**Ascii file Windows** : Saves data in ASCII file using Windows 1253 encoding.

**Ascii file DOS** : Saves data in ASCII fileusing437 character set.

**Html format** : Saves data html file.

**SoftOne MetaFile** : Saves data in xpr SoftOne format file. These files run through SoftOne application, directly from
Windows Explorer through <double click>. If SoftOne is running, then the executed report is displayed on the
application screen, else the operator is subjected to login process and immediately afterwards the report is
displayed on the screen. In the last case, SoftOne runs in "viewer mode" and does not contain any other job.

#### A.3 Printout Form Types.........................................................................................................................................................................

The available printout form types (Figure A3) are the following:

**Internal use** : Design printout forms using the internal report tool.

**External (Word)** : Design printout forms using MS Word.

**External (Excel)** : Design printout forms using MS Excel.

**Fiscal printer** : Retail receipts printout forms that are printed through POS Fiscal Printers.

**Label** : Design printout forms for labels print using the internal report tool.

**Crystal Report** : Design printout forms using Crystal Reports. Crystal reports runtime must be installed.

**Internal (Fast Report)** : Design forms using the embedded tool Fast Reports. No need to install extra application.

**Label (Fast Report)** : Design label forms using the embedded tool Fast Reports. No need to install extra application.

```
Figure A3
```

Chapter 3 – Printout Forms

#### A.4 Import / Export Printout Forms

Printout forms can be exported and imported in other installations using XXF files.
For internal forms you can also use PTF file extension.

**_XXF File_**

This option saves the structure of the printout form along with the object that uses it, the code and the name.

A form is exported through the option “ **Export to .xxf file** ” of the browser list right click menu (Figure A4.1).

Forms are imported through the User or System option “ **Import from .xxf file** ” (Figure A4.2).

```
Figure A4.1
```
```
Figure A4.2
```

Chapter 3 – Printout Forms

**_PTF File_**

This option is available in internal forms and saves only the structure of the printout form.
Use this option when you need to copy a form from one object to another, that has similar fields (SALDOC to
PURDOC). Edit the ptf file using a text editor, alter any table or field names and then import it in any other object.
Notice though that background images are not saved.

Internal printout forms can be exported to ptf files through the right click option “ **Save to file...** ” that is found when
you locate a printout form record (Figure A4.3).

Ptf files are imported into printout forms using the right click option “ **Load from file...** ” (Figure A4.3).

```
Figure A4.3
```

Chapter 3 – Printout Forms

### B. Internal Printout Forms

Printout forms can be designed using the following modes:

**Draft:** Reports printed on dot matrix printers. In this case the printer must necessarily be defined as draft and the

"Printer commands" settings must be filled as in Printer Settings.

**Image:** Reports printed on laser, inkjet printers.

The design environment is the same for both modes. What differ are the settings and printer commands that can be
used.

#### B.1 Sections

Internal forms are divided in three sections (Figure B1):

**Beginning of page - Header** (light blue): It contains the header data of a report (e.g. customer data, date and
number of a document, etc.).

**Recurrent section** (yellow): It contains the recurrent part of a report (e.g. item lines of a document).

**End of page - Footer** (light green): It contains the footer data of a report (e.g. prices-quantities totals, comments of
a document).

```
Figure B1
```

Chapter 3 – Printout Forms

#### B.2 Toolbar...................................................................................................................................................................................................

The toolbar (Figure B 2 .1) which appears in the design of internal forms has the following commands:

```
Figure B2.1
```
**Fields** : Displays the fields that can be inserted in the form through double click or drag and drop (Figure B2.2).

```
Figure B2.2
```
**Entities** : Displays the available sections of the form (Figure B2.3)

```
Figure B2.3
```

Chapter 3 – Printout Forms

**Properties** : Displays the Properties window for the selected point on the form (the option is also available by right-
clicking on the form). Figure B2.4 shows the properties of the field "MTRDOC.TRUCKS" of sales documents.

```
Figure B2.4
```
**Printer command** : Window for adding printer commands on the forms. (Figure B2.5)

```
Figure B2.5
```
**Page Properties** : Printout form Properties window. The options "Blank lines above", "Blank characters on the left"
and "Useful page lines" are used in label printout forms (Figure B2.6).

```
Figure B2.6
```

Chapter 3 – Printout Forms

#### B.3 General Form Operations

Right clicking in any place of the form to display the list of available options (Figure B3.1):

**Zoom In / Out** : Zooms the form

**Lines** : Shows / Hides grid lines.

**Delete** : Deletes the selected field, zone, image etc.

**Properties** : Displays the properties of the selected field, zone, image etc. Same as the toolbar button "Properties".

**Delete line data** : Deletes all fields and texts of the selected line.

**Insert line** : Inserts a line at the selected point.

**Delete line** : Deletes the selected line.

**Add background Photo** : Inserts a background picture (jpg or bmp format).

**Background Photo properties** : Picture properties configuration

**Export background photo to file** : Exports image as file

**Band Photo** : Inserts an image at the selected point

**Digital signature type B** : Inserts a digital signature at the selected point. It works only in the footer and only in
internal forms. (Greek Legislation)

**User defined label "from ...to..."** : Inserts page numbers. Available only in footer.

**User defined Tables** : Inserts a User defined table to the available tables of the forms.

**Save to file...** : Saves form to a file in ptf extension, which can be edited using any text editor.

**Load from file ...** : Imports a form from ptf file.

```
Figure B 3. 1
```

Chapter 3 – Printout Forms

#### B.4 Page Size

The size of the form is set through the right click option "Properties" which is available at any point between the
zone of the recurrent part (white color) and the footer of the form (Figure B4.1).

```
Figure B4.1
```
In case of using a document without distinctive paging (e.g. roll paper of a cash device), set the parameter
" **Dynamic page length** " to "Yes" so that the footer is printed only once, at the end of the report.

Once page dimensions setting is completed, the ruler that surrounds the design screen of the form will be adjusted
accordingly (Figure B4.2).

```
Figure B4.2
```
**_Basic Dimensions Parameters_**

**Laser Printouts** : Lines height: 85, Characters width: 137

**Draft Printouts** : Lines height: 66, Characters width: 137

**Note** : The actual dimensions of the printout in centimeters depends additionally on **geometry font** for image
printouts (Figure B2.6), while for draft printouts it depends on the used **printer commands** (Figure B2.5).


Chapter 3 – Printout Forms

#### B.5 Draft Printout Fonts

The font size in draft printouts is set by printer commands. A printout form can have one or more printer
commands, which apply different font sizes per line or module. Printer commands (red squares) are added in forms
by clicking on the button “Printer command” of the toolbar. Inside the properties window you can apply the
appropriate setting (Figure B5.1). Printer command settings are applied in form until you use a new one. For
example, if there is a printer command of 12CPI, then all elements of the form that follow will have this size. The size
is applied in combination with the special settings that have been set in the draft printer.

The width of the line you have set at form settings determines the maximum number of characters per line. Suppose
you set 12CPI size and the maximum width according to the settings, is 96 characters. If your data exceed this width,
line folding will be applied, even if the overall width of the printout form is larger.

```
Figure B5.1
```
#### B.6 Image Printout Fonts

The font size in image printouts is initially set by "Page properties" button on the toolbar. Specifically, through page
properties you can set the fonts to be used in the designed form.

The option " **Default Page Font** " determines the default font for each field or text you enter.

Special settings regarding the printing method (font type and characters size) for the different sections of the form
or even for specific fields can be set through their "Properties".

The option " **Geometry font** " sets the font type and size that will determine the size of the grid cells of the form.
Note that the actual size of the printout is enlarged proportionally to the size of the selected geometry font.
Essentially, the geometry font is the key parameter that determines the space available for printing each character
on the page. It is obvious that the default page font cannot be larger than the geometry font because this would
lead to characters overlapping during printing.
**Note:** If these parameters are not entered, then the default fonts are used (Lucida Console 8pt).


Chapter 3 – Printout Forms

#### B.7 Recurrent Zone

The first thing you have to define before inserting fields in the recurrent part of the form is the table that will be
used in this section. Right click the recurrent part (yellow line), click on "Properties" button to display the menu of
Figure B7.1. The recurrent section contains prints the data entered in the yellow line.
Section properties are the following:

**Lines:** Indicates the section number of lines

**Table:** Name of the table that will be used for displaying data / fields in this section

**Filter:** If used, it filters the data of the table according to the expression. Expression must be entered using only the
name of the field (not the table). For example, if you want to filter item lines that have quantity larger than zero, you
have to enter **QTY1> 0**.

**Sorting:** If used, it sorts the data of the table according to the selected field. The field must be added in the same
way as it is displayed when you add it inside a section of the form.

**Pack fields:** If used, it groups the data according to the selected fields. Fields are separated with semicolons.

```
Figure B7.1
```

Chapter 3 – Printout Forms

#### B.8 Band Image

Images are added into form sections through the right click option "Band Photo". Inside the properties of the image
(Figure B8.1) you can define the path and the filename of the image in the Value textbox.

Item Images are referenced using the command **$MTRLINES.MTRL;0** while images from item related files are
displayed using the command **$MTRLINES.MTRL;**.

```
Figure B 8 .1
```
#### B.9 QR Code

QR Codes are added into form sections through the right click option "Band Photo". Inside the properties of the
image (Figure B 9 .1) enter the name of the field that contains the QR code using the prefix character **~.**

The example of Figure B9.1 will display the data of the field MTRDOC.SOSIGNQR as QR Code.

```
Figure B 9 .1
```

Chapter 3 – Printout Forms

### C. Ms-Word Printout Forms

#### C.1 General

MS Word printout forms are designed through Microsoft Word application using the option "External (Word)" in the
form type. (Figure C1.1).

```
Figure C2.1
```
A different toolbar is displayed (Figure C1. 2 ) that lets you create a new word document, modify or delete the
existing one and insert Fields from the current object to your MS-Word form.

```
Figure C2.2
```

Chapter 3 – Printout Forms

#### C.2 Form Design

Fields are inserted inside the form by double-clicking on them from the Fields window.

Word Forms, are divided in the following sections:

- **Page Header**
  The fields of this section must be inserted inside the document header (Figure C2.1).
- **Recurrent**
  The fields of this section must be inserted in a MS-Word table (Figure C2. 2 ).
  The first column of the table must contain the symbols **{@** and the last column the symbols **@}**.
  The SoftOne table that will be used for recurrency is entered inside the hyperlink Address box of the first
  two symbols. The command is: **Table:”TableName”** (Figure C2.3).
  The last columns symbols @} of the table do not need a hyperlink.
- **Page Footer**
  Page Footer is defined in MS Word form by inserting a new textbox at the bottom (not document footer) of
  the document page and grouping the items inside it.
- **Report Footer**
  Definition of this section is done by adding a hyperlink to a Page Footer (not document footer) using the
  command " **XTR: LP_FOOTER** " in the Address field.

```
Figure C2.1
```
```
Figure C2.2
```
```
Figure C2. 3
```

Chapter 3 – Printout Forms

#### C.3 Filters – Sorting – Grouping

Data of the recurrent part of a Word can be filtered, sorted, and grouped, by adding extra commands to the
hyperlink of the first column ({@). The syntax is the following (Figure C3.1):

**TABLE:<Table>,<FilterField 1> AND<FilterField 2> OR<FilterField 3>,<SortField>, <GroupField>**

The fields used in the above command must also be inserted in the form, in order to work properly. If you do not
add the fields in the form, then in runtime, an exception message will be displayed informing you that a field is not
found.

```
Figure C 3. 1
```
#### C.4 Field decimals

Decimal places can be added to numeric fields, through editing the field hyperlink and adding the following
command in the address textbox (Figure C4.1):
**FIELD:<Field>;n** where n is the number of decimal places.

```
Figure C4. 1
```

Chapter 3 – Printout Forms

#### C.5 Report Footer

In order to add data in the report footer you need to use the following steps:

- Insert text boxes at the bottom of the page and enter the text you want to be displayed.
- Add a text box outside the above text boxes. (Figure C5.1)
- Group all text boxes.
- Select the grouped box and add a hyperlink, entering the command " **XTR:LP_FOOTER** " in Address textbox.
  (Figure C5.2)

```
Figure C5.1
```
```
Figure C5.2
```

Chapter 3 – Printout Forms

#### C.6 Item Image

Image fields are added inside the lines of the MS-Word document, using the following steps:

- Insert a Rectangle Shape (Insert - Shape - Rectangle) (Figure C 6 .1).

```
Figure C6.1
```
- Right click the shape and insert a hyperlink. Add the following command inside the Address box:
  **IMAGE:$MTRLINES.MTRL;0** (Figure C 6 .2)

```
Figure C6.2
```
- Notice that the shape must be inside a column of the detail table. In order to achieve that, you can use the
  formatting marks to resize and move it (Figure C 6 .3).

```
Figure C 6 .3
```

Chapter 3 – Printout Forms

#### C.7 Text wrap

MS-Word forms that use multi-line memo fields (i.e. customer remarks) are displayed incorrectly (with line-break
character symbols). Moreover, they perform a line break if the field is inserted directly into the main text, while they
do not insert a line break if the field is inserted into a table cell (Figure C7.1)

```
Figure C7.1
```
This can be easily fixed by using a defined field which will replace the line break characters #13 & #10 with the
character #11. The following example uses the field vRemarks instead of the field Remarks of Sales documents.
**REPLACE(REPLACE(A.REMARKS,char(13),''),char(10),char(11))** (Figure C7.2)

The result of using the user-defined field on the form is shown in Figure C7.3.

```
Figure C 7. 2
```
```
Figure C7.3
```

Chapter 3 – Printout Forms

### D. Ms-Excel Printout Forms

#### D.1 General

MS Excel printout forms are designed through Microsoft Excel, using the option "External (Excel)" (Figure D 1 .1).

```
Figure D1.1
```
Through the toolbar that is displayed (Figure D1. 2 ) you can create a new excel document, modify or delete the
existing one and insert Fields from the current object to your MS-Excel form.

```
Figure D1.2
```

Chapter 3 – Printout Forms

#### D.2 Form Design

Excel forms have a recurring section but do not support pagination. Fields are inserted through **double click**. Select
a cell inside Excel and then double click on a field from SoftOne “Fields” window.

Recurrent section must have as first column the **{>** symbol signs and as last column the symbols **<}**. To set the
SoftOne table from which to retrieve data of the recurrent section, select the **{>** symbol in the first column and
create a hyperlink entering in the address box the command " **Table: table name** " (Figure D2.1). You do not need
to insert a hyperlink in the **<}** symbol of the last column cell.

**Note** : Fields in recurrent section must be entered after you insert the {> symbol of the first column in order for the
form to run properly.

The syntax for filtering, sorting or grouping data is the same as in MS-Word printout forms:

**TABLE:<Table>,<FilterField 1> AND<FilterField 2> OR<FilterField 3>, <SortField>, <GroupField>**

```
Figure D2.1
```

Chapter 3 – Printout Forms

### E. Label Printout Forms

Labels are designed through the option “ **Label** ”. The tool for designing labels is the same as the one used for
internal printout forms (Figure E1).

```
Figure E1
```
The page properties button allows you to change the page data properties as shown in Figure E2.

```
Figure E2
```

Chapter 3 – Printout Forms

Through form properties you can define the label size, as well as the table that will be used for retrieving data. From
the same window you can set the number of copies that a label will be printed (Figure E 3 ).

```
Figure E3
```
Fields are added in the label in the same way as in internal forms (drag and drop or double click). Barcodes can be
displayed by choosing the appropriate font.

In runtime, labels are printed through the right click option “ **Print labels** ”. Before printing labels, the window of
figure E4 is displayed, allowing you to change the printing settings. Enable the option “ **Automatically from form** ”
for activating the commands you have entered in the “ **Printing – repetition condition** ” property of the label.

```
Figure E4
```

Chapter 3 – Printout Forms

### F. Crystal Reports Printout Forms

#### F.1 Basics

The forms in Crystal Reports are designed exclusively from within the Crystal Reports application.
Printout forms designed using crystal reports can only be printed on a physical printer or in pdf file.

Crystal Reports forms can run from computers where Crystal Reports is not installed, as long as you have installed
the Crystal Reports Runtime application, which is located in the SoftOne common area.

Create a new form, using the option " **Crystal Report** " in the form type. (Figure F1.1)
Next, create a new Crystal Reports printout form through the right click option or by clicking on the "New model
report" button (Figure F1.2)

```
Figure F1.1 Figure F1.2
```
Upon creating report forms in Crystal Reports, you need to know the following:

- The database tables that contain the data you want to display.
- The field names of the above tables.
- The primary keys of the tables that will be used to link them.
- If the SoftOne installation is on-premises or on Azure.
  To create a crystal report in a Windows Azure environment it is mandatory to use a specific command.
- The key fields of the object tables through which SoftOne will connect to the Crystal report.
  These fields will be matched through SoftOne local fields.
  Designing a form in Crystal Reports application can be done in two ways; either using tables or using commands.
  Commands use SQL queries to define the data and the structure (tables and fields) that will be used in the report.


Chapter 3 – Printout Forms

#### F.2 Crystal Report Design

Create a new report from the File - New - Standard report menu and then from the window that appears choose
OLE DB(ADO).In the window displayed choose "Microsoft OLE DB Provider for SQL Server", if the database is on an
SQL Server (Figure F2.1). The next window (Figure F2.2) asks for the Server credentials and the database name that
will be used in the report.

```
Figure F2.1
```
```
Figure F2.2
```

Chapter 3 – Printout Forms

#### F.3 Reports using tables

For creating reports using tables, you need to add the tables that will be later used in the report from the tab “Data”
(Figure F3.1). The next step is to link the tables (tab “Links”) based on their primary keys (Figure F3.2).

The example below uses tables for creating a crystal report that will be inserted in Sales documents printout forms.

```
Figure F3.1
```
```
Figure F3.2
```

Chapter 3 – Printout Forms

From the main report Design screen, design the report by selecting the fields you want display (Figure F3.3).

```
Figure F3.3
```
To link the report to a SoftOne entry (e.g. the FINDOC field) you must set a Parameter field which will be linked to
the primary field of the SoftOne entry.
The example uses the parameter iFINDOC which links to the FINDOC field of documents (Figure F3.4).

When creating the Parameter field, you should always pay attention to the field type. In our example the link field
FINDOC is an integer, so the parameter type must be Number.

```
Figure F3.4
```

Chapter 3 – Printout Forms

The next step is to create a filter for the report entries based on the Parameter field.

From the menu choose Report - Selection Formulas - Record and in the window that appears "link" the iFindoc
parameter filter to the field FINDOC.FINDOC as shown in Figure F3.5.

```
Figure F3.5
```
Instructions for importint Crystal Reports to SoftOne can be found in Section F. 5.


Chapter 3 – Printout Forms

#### F.4 Reports using SQL statements

Reports can be created using SQL statements. Notice that this way of creating Crystal reports **is mandatory for
Azure installations**.

The first thing you need to do is to enter the SQL statement inside the “Add command” windows. The parameter
fields are also defined here (Command Parameters) which will link your crystal report to a SoftOne record.

The example in Figure F4.1 displays the design of a crystal report through a SQL query command. This report can be
used in Sales documents printout forms, since the parameter (iFINDOC) can be linked with a document record
(FINDOC) through a defined field inside the printout form.

Design your report as in the previous section omitting the part of matching the Parameter Field with a table field,
because it is already defined in the SQL command (Figure F4.2).

To import the report into SoftOne as a printout form, follow the steps of the next section.

```
Figure F4.1
```
```
Figure F4.2
```

Chapter 3 – Printout Forms

#### F.5 Import Crystal Report into SoftOne

In order to import a crystal report inside SoftOne as a printout form, just follow the steps below.

Create a new report form, select "Crystal Reports" as form type and then right click to select "Insert document from
file".

Select the rpt file you have created and the window shown in Figure F5.1 will be displayed. If you choose "Yes" then
the Parameter fields will be automatically imported into the "User defined fields" section of the report form defined
fields (Figure F5.2).

```
Figure F5.1
```
Notice that, “ **Auto Insert Filters** ” from Crystal parameters recreates the filters inside SoftOne user-defined fields.
This means that if you insert a modified Crystal report, and do not want to lose the field matching (Crystal – SoftOne
parameters) you should choose **NO** and not let SoftOne automatically insert filters, since otherwise the matches you
have created will be deleted and then you will need to recreate them.

```
Figure F5.2
```

Chapter 3 – Printout Forms

The following example demonstrates how to import a crystal report into sales documents:

- Click on “Fields” button of the printout form, select the «User defined fields" section.
- Insert a new user-defined field named Ifindoc, which is the name as the parameter name field of crystal reports.
- In the calculation formula enter the SoftOne matching field, which in our example is SALDOC.FINDOC (Figure
  F5.3).

```
Figure F5.3
```

Chapter 3 – Printout Forms

### G. Automated Jobs

Printout forms can be used to automatically send reports via email in pdf format. There is also the option of auto
saving the report in a file and path.

**Note** : If you have tax mechanism of B type, then the email files sent include the two txt files produced, that have the
Special Secure Tax Layout of Data Marking.

#### G.1 Auto Email............................................................................................................................................................................................

Automatic routing (email sending) is performed by activating the corresponding option in the "Parameters" Tab
(Figure G1.1). Using this option, the document will be sent directly in the chosen format, upon usage of the specific
form.

```
Figure G1.1
```
The email parameters are the following:

**Formula To:** Email Recipient. In this box, enter the recipient's email in single quotes, or the email field from the
corresponding table of the form.

**Formula CC:** Notification. Completed similarly to "Formula To"

**Formula BCC:** Bcc. Completed similarly to "Formula To"

**Formula Subject:** Email subject. Enter in single quotations the text of the subject.

**Formula Body:** Email text. Enter in single quotations the main text of the email. You can also use html code, which

must be entered in a defined field (Figure G1.2).

**Note** : You can add any form fields to all the above-mentioned boxes.


Chapter 3 – Printout Forms

```
Figure G1.2
```
Figure G1.3 provides a simple example that uses text and fields inside the email properties. At runtime, after printing
the specific sales document form, the (vBody) text will be sent to the email address of the customer (in Sales)
( **SALDOC.TRDR_CUSTOMER_EMAIL** ).

The subject of the email is a combination of text and fields **SALDOC.vSubject** , **SALDOC.FINCODE**.

The main text of the email is the one entered inside the user-defined field **SALDOC.vBody**.

```
Figure G1.3
```

Chapter 3 – Printout Forms

#### G.2 Auto Save to file

Automatic filing (file saving) is performed by activating the corresponding option in the "Parameters" Tab. This
option can be used either individually or in combination with automatic routing.

In the "Files" panel fill in the “Formula for path” and “Formula for file” textboxes.

**Formula for path** : File path. Use single quotes to specify the path where the file will be saved. The path can be
parametric, i.e. can include form fields (Figure G2.1).

**Formula for file name** : Filename. Use single quotes to specify the file name. You must necessarily indicate the
extension of the file.

**Note:** If you encounter problems when printing multiple printout forms, remove the last backslash from the
“Formula for path” textbox and place it at the beginning of “Formula for file name” ('\'+filename).

```
Figure G2.1
```

## 4. Alerts – EDA Event Driven Actions

#### A. Events & Conditions

#### B. Actions

#### C. Case Studies


Chapter 4 – EDA

### Overview

Event Driven Actions (Alerts) is a very powerful tool that that allows you to add new functionality to any built-in or
custom object in a way that it meets your needs. All the events, built in commands and internal functions are
available through a very friendly interface that even amateur developers can use.

Jobs, like custom messages, field and record validation, SMS and email sending, field value calculations and many
others can be easily developed with simple clicks or drag and drop actions.

More experienced developers can also find this tool very useful, because apart from the above, it fully supports SQL
statements and coding in JavaScript or VBscript.

One thing that you must always keep in mind is that EDA affects by default all the forms of an object.

Examples of EDA are the following: display a message when text is changed in a field, calculate and set the data of a
table field when a new row is inserted in a datagrid or even send email and SMS when a record is posted and certain
conditions are met.

Alerts are saved as blob data inside the table CSTINFO (CSTTYPE=6) and can be easily transferred through different
installations as .cst or .auv files using the “Custom Administration” tool.

### A. Events & Conditions

EDA tool allows you to set the events and the conditions where actions will take place. When such conditions are
met, a series of actions can be executed. In order to use events, you need to know the basic structural components
(tables, virtual tables, etc.) that compose the objects of the application, e.g. object Customers. More specifically,
different events occur in fields, datagrids and objects and can be used to create new rules and jobs. Multiple rules
can be defined in a single EDA.

#### A.1 Field Rule (On Change)

This rule is used if you need to perform an action (display message, change field value etc.), when users change the
data of a field. The following table shows the available rule properties:

```
PROPERTY DESCRIPTION
```
```
Type Type of Event (Field / Table / Module / Browser)
```
```
Description Name of the Rule
```
```
Formula Condition Formula that defines if the rule will fire and the actions will execute.
```
```
Field Field that triggers the rule
```
```
Formula Action
```
```
Type of action that will be executed
Send Message – Message display – Error display – Run – Reminder
```
```
Formula Type Formula Type that depends on the formula action.
```
```
Formula Recipient Recipient (used in message and email actions)
```
```
Formula Calculations that will be performed
```
The following example (Figure A1) displays an alert created in ‘Items’ entity, that changes the value of the field
ITEM.PRICEW (Wholesale price) when user changes the data of the field ITEM.PRICER (Retail price).

The operation is performed only when ‘Retail price’ (ITEM.PRICER) is greater than zero and ‘Accounting category’
(ITEM.MTRACN) is equal to 100.

**Note: Formula conditions** with more than one argument, that are separated with operators AND & OR should
always be placed in **parentheses** (ITEM.PRICER>0) AND (ITEM.MTRACN=100).

The function that changes the data of the field is ‘SETVALUE’ and its syntax can be found inside the window Fields –
<Event fields> – Local Fields – Available functions (Figure A2).


Chapter 4 – EDA

```
Figure A1
```
```
Figure A2
```

Chapter 4 – EDA

#### A.2 Table Rule

Table rules are triggered when table events occur. These events are summarized in the table below.

Be careful when enabling more than one events because they may fire twice. For example, if you enable both
“Before Post” and “After Post” and choose to display a message, then this message will be displayed twice when you
change the data of a datagrid and move to the next record.

```
EVENT DESCRIPTION
```
```
On Insert Fires when a new record is added in the dataset. Usually used for setting default values.
```
```
Before Post
```
```
Fires before changes to a dataset record are posted.
Use it to perform actions that you want to occur before a dataset record is posted. It is
commonly used for updating values, performing validation or raising custom error
messages.
```
```
After Post
```
```
Fires after changes to a dataset record have been posted.
Usually used to display / send a message or for calculating purposes in order to update
values.
```
```
Before Delete
```
```
Fires before a dataset record is deleted.
Use it to perform validation or to raise custom error messages.
```
```
After Delete
```
```
Fires after a dataset record is deleted.
Use it to raise custom messages or perform any other updating actions.
```
**Example**
**_The EDA rule of the example in Figure A 3 operates in the customers' object as follows:
When users add a new branch in table CUSBRANCH then the function SETVALUE('CUSBRANCH.SALESMAN',
CUSTOMER.SALESMAN) is executed and sets as the default salesman of the branches the customer's
salesman._**

```
Figure A 3
```

Chapter 4 – EDA

#### A.3 Module Rule

This rule is used if you need to perform actions when object events occur. Notice that same actions can be executed
in more than one events (multi check), but always be careful of accidentally running the same job twice.
The available events are the following:

```
EVENT DESCRIPTION
```
```
On Insert
```
```
Occurs when a new record is created (click on toolbar button “New”).
Usually used for setting default values.
```
```
On Locate
```
```
Occurs after locating a record in an object; display the record in screen form.
Usually used for displaying messages or changing the layout of the form (hide elements).
```
```
Before DB Insert
```
```
Occurs before inserting a new record in an object
For example, it fires when users click on “Save” button for a newly created record of an
object, before the record is saved in the database.
```
```
After DB Insert
```
```
Occurs after inserting a new record in an object
For example, it fires when users click on “Save” button for a newly created record of an
object, after the record is saved in the database.
```
```
Before DB Update
```
```
Occurs before updating a record in an object
For example, it fires when users edit / change the contents of a record and then click on
“Save” button. The event rises before the record is saved in the database.
```
```
After DB Update
```
```
Occurs after updating a record in an object
For example, it fires when users edit / change the contents of a record and then click on
“Save” button. The event rises after the record is saved in the database.
```
```
Before DB Post
```
```
Occurs before saving record data of an object
It merges the events “Before DB Insert” and “Before DB Update”, so be careful not to
combine it with these events because it will fire twice.
```
```
After DB Post
```
```
Occurs after saving record data of an object.
It merges the events “After DB Insert” and “After DB Update”, so be careful not to combine it
with these events because it will fire twice.
```
```
Before DB Delete
```
```
Occurs before deleting a record of an object.
Usually used when you need to prevent users from deleting a record, because it fires before
the changes take effect.
```
```
After DB Delete
```
```
Occurs after deleting a record of an object.
Usually used when you need to perform an action (send message / add log) when users
delete a record, because it is triggered after the changes take effect.
```
**Example**
**_The EDA rule of the following example (Figure A4) is applied in sales documents when a record is saved.
It prevents the record from being saved in the database if the transaction’s currency is different from the
customer’s currency and the document is not an order (SALDOC.TFPRMS<>201).
If the above conditions are met, then it displays an exception message (Figure A5)._**

- Design a new Alert and add a “Module Rule” with any description (e.g. Currency check)
- Add the condition inside the formula text, using drag and drop from “Fields”:
  (SALDOC.SOCURRENCY<>SALDOC.TRDR_CUSTOMER_SOCURRENCY) AND (SALDOC.TFPRMS<>201).
- Select the event “Before DB Post”
- Add the message that will be displayed when the conditions are met, using “Error display” action.


Chapter 4 – EDA

```
Figure A4
```
```
Figure A5
```

Chapter 4 – EDA

#### A.4 Browser – Search Condition

The browser – search conditions operate as filters in the running browsers of the objects.

To create a browser condition, set the run condition (Formula) and the caption (Indication) that will appear in the
browser as title.
In the “ _Formula facts_ ” panel, select " _Run_ " as Fact, " _SQL filter_ " as Type and in the Text field enter the SQL filter, which
will be inserted in the “where clause” of the SQL query of the browser when the condition is met.

**Example**

The following example (Figure A6) applies to object Meetings.
The application user with code 262 will be able to see only the meeting entries, where he is defined as the operator.
Moreover, the meeting lists' title will display the caption "Locked for 262 " (Figure A7).

```
Figure A6
```
```
Figure A7
```

Chapter 4 – EDA

### B. Actions

The datagrid “Actions” contains all the jobs that can be executed whenever the selected events fire and certain
conditions are met. The available actions are the following (Figure B1.1):

```
Figure B1.1
```
#### B.1 Send Message

Sends a message specified in the “Formula” column to the recipient of the column “Recipient”.
Available types are (Figure B1.2):

```
Figure B1.2
```
**_On the screen of the user_**

Sends the message to a user of the application. Select the user from the column “Recipient”. The message is saved
and as soon as the selected user is available (logs in the application), the message will be displayed on the screen.

**_To email address of the user_**

Sends the message to the email address specified in the “Recipient” column. The recipient may be entered through
a formula or a table field (e.g. TRDR.EMAIL). In order to use this type, you need to setup the outgoing email from the
Settings window or from the SoftOne Remote Server.

**_To user’s cell phone_**

Sends the message to the cell phone specified in the “Recipient” column. The recipient may be entered through a
formula or a table field (e.g. TRDR.PHONE01). In order to use this type, you need to setup the cell phone from the
SoftOne Remote Server or use a Web SMS provider from the Settings window.


Chapter 4 – EDA

#### B.2 Message Display (Notification)

Displays a message box on the screen of the login user. The message is entered inside the “Formula” column.
Module and user-defined fields are also allowed to use.

```
Figure B2
```
#### B.3 Error Display (Exception)

Raises an exception message on the screen of the login user and stops the current process.
The message is entered inside the “Formula” column. Module and user-defined fields are also allowed to use.

```
Figure B3
```

Chapter 4 – EDA

#### B.4 Run

Apart from the display or sending messages, EDA allows you to run various commands.

The available types / run commands are (Figure B4):

```
Figure B4
```
**_SQL Command_**

Runs the SQL statement entered in the “Formula” column.

**_VB Script_**

Runs the VB script entered inside the “Formula” column.

**_Java Script_**

Runs the Java script entered inside in the “Formula” column.

**_Function_**

Runs an internal function of the program, which is entered inside the “Formula” column.

**_Job_**

Runs the SQL statement entered in the “Formula” column. It can only be used for object rules and only for the
events related to the database. On "before Event" actions, an event confirmation question is displayed. On "after
Event " actions, an event completed message is displayed. In this case, you don't need to set anything but the
formula as all the rest elements is calculated automatically.

#### B.5 Update

This type of action can be used only in object rules and it displays a validation message box before committing the
changes to the database.

#### B.6 Reminder

This type of action is the same as sending a message to a user of the application and it only differs to the fact that
the message is saved and displayed as a reminder.


Chapter 4 – EDA

### C. Case Studies

#### C.1 Field Rule – Message display

Each time the log in user changes the address of a customer and the turnover of the customer is greater than zero,
then the operator's screen will display the message " **Changed the address of the customer [customer's name]** “
(Figure C1.2).

- Create an EDA inside Customers’ module
- Add a Field Rule
- Drag and drop **Turnover** inside Formula and enter: **CUSTOMER.TRDR_CUSFINDATA_TTURNOVR>0**
- Drag and drop **Address** (Figure C1.1) in **Field** textbox.

```
Figure C1.1
```
```
Figure C1.2
```

Chapter 4 – EDA

#### C.2 Table Rule – Error Message Display

Prohibition on deletion of a customer's branch when the customer's turnover is positive, displaying the message
"Deletion is aborted" (Figure C2.2).

```
Figure C2.1
```
```
Figure C2.2
```

Chapter 4 – EDA

#### C.3 Object Rule – Send Message

Once the operator chooses to delete a customer with a positive turnover, the application will stop the process
showing a message to his screen. The message will also be sent and displayed to the “Administrator’s” screen
(Figure C3).

```
Figure C3
```
#### C.4 Browser – Search Condition

The operator in the workstation named “user1” can only view the item browser records that the field “Code” starts
with “000-000”. The title of browser will also display the phrase ‘Only for computer user1’.

```
Figure C4
```

## 5. User-Defined Fields

#### A. General Features

#### B. Operations Commands

#### C. Built-In Functions


Chapter 5 – User-Defined Fields

### A. General Features

User-defined fields (Local and General Fields) are used for displaying data using simple or advanced calculations
between database fields. They can be used inside browsers, EDA (alerts), imports, reports, printout forms and in any
other tool that they are available as an option. Figure A1 shows an example of user-defined fields inside “Sales
Documents” browser.
“ **_General Fields_** ” are designed in the same way as “ **_Local Fields_** ” and the only difference is that they are available
from every tool (e.g. Browsers) of the entity that they are saved. For example, if you create a “Local field” inside a
browser of Customers object, then this field will be available for use only in this specific browser. But, if instead you
create this field inside “General Fields”, then it will be available from every browser of Customers object.

```
Figure A1
```

Chapter 5 – User-Defined Fields

“ **_Local Fields_** ” or “ **_General Fields_** ” buttons display a window that lets you create the user-defined fields inside the
grid “Fields” (Figure A2), which has the following columns.

```
Figure A2
```
**_Name_**

Field name that can be used as reference between the user-defined fields of the current browser, alert, etc. The
default name for every new field begins with the letter V and is followed by an auto increment number.
It is recommended to change this name using a name that meets your needs.

**_Caption_**

Defines the title of the field, as it will be displayed in dialog filters, columns, etc.

**_Operation_**

Defines the way that data will be accessed and are discussed in the following sections. All the available operation
options are summarized in the table below.

**_Field type_**

Field type options differ depending on the selected operation. For example, if the operation is “SQL filter” then the
only available option is “Boolean”.

**_Calculation formula_**

This field is used for entering the formula commands that will be used to calculate the value of the defined field.

**_Displayed_**

Select whether the field is available in the design columns of the tool through the **Displayed** option.

**Note** : Defined fields that use “Function” operation cannot be displayed, since they can only be used from other
defined fields.


Chapter 5 – User-Defined Fields

### B. Operation Commands

The following table contains the available operation options and the SoftOne controls they can be used (Figure A3).

```
Operation Commands / SoftOne Tools
```
(^) **Browsers Design
Reports
Open
Reports
Imports Printout
forms**

##### EDA

```
(Alerts)
```
```
Remote
Commands
```
```
Line Calculation ^ ^ ^ ^ ^ ^ ^
```
```
Calculation of line
+Totals
```
  (^)
**SQL command** ^ ^ ^ ^ ^
**Question** ^ ^ ^
**SQL filter** ^ ^
**Single filter** ^ ^
**Multiple filter (OR)** ^ ^
**Multiple filter (AND)** ^ ^
**Function** ^ ^ ^ ^ ^ ^ ^
**Multi Result SQL** ^ ^ ^ ^
**Figure A3**


Chapter 5 – User-Defined Fields

#### B.1 Line Calculation

This operation is used for displaying data in columns, using math calculations or built-in functions. Calculations are
executed for every record of the dataset. This means that if for example, you create a “Line Calculation” field inside a
browser that at runtime it displays 1000 records, then the calculation will be executed 1000 times (each for every
record) (Figure B1.1).

```
Figure B1.1 – Line calculation field using RUNSQL function
```
Suppose that you use the built-in function **RUNSQL** for retrieving results in a field, then one SQL query will be
executed per record displayed.
This will cause **slow performance** , because every record will produce one SQL query that will be executed from the
database server to return the results (Figure B1.2). This means that user-defined fields using RUNSQL function may
cause reports or browsers delay, so it is much better to use the operation option “ **SQL command** ” (if available from
the specific control) when you need to use SQL statements.

```
Figure B1.2 – SQL Monitor
```

Chapter 5 – User-Defined Fields

Calculations between fields is achieved using a defined field with “ _Line Balance / Calculation_ ” operation. Select the
field type (e.g. Number) and then enter or drag and drop the fields, applying the preferred math formulas.

**Note:** All built-in functions and system parameters, e.g. UserCode (Login User), CompanyCode (Login Company),
etc. are available through this operation command.

**Example 1 (Browser)**
**_User-Defined field inside the Sales Statistics browser that calculates the gross profit, using the expression:
Sales value - Sales cost._**

Create a defined field and select “Line calculation” as operation and “Number” as field type (Figure B1.3).

Enter the calculation formula (or drag and drop the fields): VSALSTAT.SalVal-VSALSTAT.SCpurmtk

```
Figure B1.3 – Calculations between Fields
```

Chapter 5 – User-Defined Fields

**Example 2 (Report)**
**_User-Defined field inside the report “Sales per customer” that displays the concatenation of the name and
surname of Salesmen._**

Create a new user-defined field, use the operation option “Line Balance” and select “Alphanumeric” in Field Type.
Drag and drop the fields **NAME** and **NAME2** from **Salesperson** node or enter the following formula:
CUSTOMER.SALESMAN_PRSNIN_NAME+' '+CUSTOMER.SALESMAN_PRSNIN_NAME 2 (Figure B1.4).

Notice that when you drag and drop the field “PRSN.NAME”, SoftOne uses the shorter (alias) name X_SNAME.

```
Figure B1.4
```

Chapter 5 – User-Defined Fields

#### B.2 Calculation of line+totals

This operation is the same as “Line Balance / Calculation”. It differs to the fact that it can only be used in numeric
field types for displaying the totals if there is grouping in the browser or report.

This means that in case you want to display the totals of a defined field in browsers or reports that have grouped
data then you have to use this operation.
It uses exactly the same commands and functions as “Line Calculation”.

```
Figure B2. 1
```

Chapter 5 – User-Defined Fields

#### B.3 SQL command

This operation is used in SQL statements for retrieving data from the database. It substitutes the RUNSQL function
in browsers, reports and printout forms. It is executed within the select statement of the report, so it runs faster.

**Example 1 (Browser)**
**_User-defined field in Items browser that displays the Name field of the Item commercial category._**

Create a defined field in Item browser and select SQL Command as operation, Alphanumeric as field type and enter
the formula:

SELECT NAME FROM MTRCATEGORY WHERE SODTYPE=51 AND COMPANY=:X.SYS.COMPANY AND
MTRCATEGORY=A.MTRCATEGORY (Figure B 3. 1 )

Note that the alias A is used for linking the primary key field MTRCATEGORY of the table MTRCATEGORY with the
MTRCATEGORY field of item. Aliases can be easily spotted in the SQL statement that runs if you execute the
browser. Sql statements are displayed inside the SQL Monitor tool (Figure B 3. 2 ).

```
Figure B 3. 1
```
```
Figure B 3. 2 – SQL Monitor
```

Chapter 5 – User-Defined Fields

#### B.4 Question

This operation is used for defined fields that will be displayed as dialog filters in browsers or reports. It is usually
used combined with the operation SQL filter for applying the filters inside the where clause of SQL statements.

**Example (Browser)**
**_In Customers browser create a user-defined field that will display the records that don’t have transactions
within a date range defined in dialog filters. Set also the current year as the default value of the date._**

Create two user-defined fields **vDateFilter** and **vRunFilter** as in Figure B 4. 1.

```
Figure B 4. 1
```
Field **vDateFilter** uses the command **$DATERANGE** which allows the user to select dates from a range control (Date
from – Date to) (Figure B4.2).

```
Figure B4.2 – Dialog filters using Question Operation
```

Chapter 5 – User-Defined Fields

The second defined field **vRunFilter** uses a SQL statement for filtering the records, according to the selected date
range. The formula is: NOT EXISTS (SELECT 1 FROM TRDTRN WHERE SODTYPE=13 AND TRDR=A.TRDR AND
TRNDATE BETWEEN [SQLDATE(USR.TRDRV1L)] AND [SQLDATE(USR.TRDRV1H)] )

**Square brackets []** are escape characters and they can be used inside **SQL commands** in order to add SoftOne
functions or any other non-SQL commands. Notice that for **SQL Filters** you also need to add a colon **[: xxx]**.

In our example we have used the internal function **SQLDATE** , which returns the date in SQL format (‘yyyymmdd’)
and the parameters **USR.TRDRV1L** and **USR.TRDRV1H**.

Figure B4. 3 displays the SQL statement that is executed at runtime through the SQL Monitor tool.

```
Figure B 4. 3 – SQL Monitor
```
The **USR.TRDRV1L** and **USR.TRDRV1H** return the values the user will enter inside the dialog filter field **vDateFilter**
at runtime. Names **TRDRV1L** and **TRDRV1H** are found with the use of the shortcut keys **CTRL+SHIFT+F12** that is
performed in the dialog filter field **vDateFilter** at runtime (Figure B 4. 4 ).

```
Figure B 4. 4 – CTRL+SHIFT+F 12
```

Chapter 5 – User-Defined Fields

The default value is set through the filters tab of the browser in design mode. Select the field **vDateFilter** and enter
the value **131** , which is the value for **Current Year** , as it is defined through the Date Ranges object (Figure B 4. 5 ).
The filtering is performed at runtime when users select a date range and enable (Yes) the dialog filter **vRunFilter**.

```
Figure B 4. 5
```
#### B.5 SQL Filter

This operation is used for filtering the records of reports or browsers. It creates a checkbox (Yes/No) in the filters of
the browser/report and if enabled it adds a where clause in the main SQL statement.
Example of this operation can be found in the previous section.


Chapter 5 – User-Defined Fields

#### B.6 Single filter / Multiple filter

The operation types “ **Single filter** ” and “ **Multiple filter** ” are used for creating dialog filters with specific values that
are selectable through combo box control.
At runtime, when users select a value, then the data are filtered according to the formula of the second column.
Use the button (Figure B6.1) next to the textbox of the calculation formula to enter the values that will populate the
combo box (Figure B6.2). The field will be displayed in dialog filters as in Figure B6.3.

```
Figure B6.1
```
```
Figure B6.2
```

Chapter 5 – User-Defined Fields

```
Figure B6. 3
```
#### B.7 Function

This operation is used for creating custom functions that can be later used from other user defined fields. Note that
fields created using this operation cannot be displayed as columns.

#### B.8 Multi Results SQL

This operation creates an OUTER APPLY SQL statement to the main query of the browser. This is very useful when
you need to retrieve multiple column data from the same tables, because you don’t have to write (and execute) the
same SQL statement many times.

Suppose you need to display three columns (debit, credit and turnover) in a browser of Customers. One way to do it
would be to add the fields from the **Customer details** node as in Figure B8.1.

```
Figure B 8. 1
```

Chapter 5 – User-Defined Fields

This creates three nested queries that select different columns (LDEBIT, LCREDIT, LTURNOVR) from the same table
(TRDBALSHEET) using also the same where clause, as you can see in the SQL Monitor of Figure B8.2. The results
would be as in Figure B8.3.

```
Figure B 8. 2
```
```
Figure B 8. 3
```
So, it would be better if we could create an OUTER APPLY join with TRDBALSHEET and return all three columns with
a single query. The outer apply operator always returns the data of the left join (TRDR) irrespectively of its match
with our table, so there would be no problem with the data returned.

- Create a user-defined field that uses **Multi Results SQL** as operation, and write the following SQL statement:
  **SELECT
  1 AS VMULTIQUERY ,
  SUM(TB.LDEBIT) AS DEBIT ,
  SUM(TB.LCREDIT) AS CREDIT ,
  SUM(TB.LTURNOVR) AS TURNOVER
  FROM
  TRDBALSHEET TB
  WHERE
  TB.TRDR = A.TRDR
  AND COMPANY = :X.SYS.COMPANY
  AND TB.PERIOD > 0 AND TB.PERIOD < 1000**


Chapter 5 – User-Defined Fields

- Create three user-defined fields that will be added as columns inside the browser. The names of the columns
  must be the same as the ones inside the Multi Results SQL statement (Debit, Credit, TurnOver).
  Use SQL command as Operation and Number as Field Type (Figure B8.4). Leave Calculation Type blank.

```
Figure B 8. 4
```
- Add all four fields inside the browser (Columns Tab).
- Uncheck the field that uses “Multi results SQL operation” (Figure B8.5).
  This column is needed, because it applies the OUTER APPLY join and is also added in SQL SELECT statement,
  so we need it just for reference ( **1 AS VMULTIQUERY** ), but it does not need to be visible.

```
Figure B 8. 5
```

Chapter 5 – User-Defined Fields

In Figure B8.6 (SQL Monitor) you can see the select statement with the OUTER APPLY join when browser is executed
(Figure B8.7). The results are the same as in Figure B8.3.

```
Figure B 8. 6
```
```
Figure B 8. 7
```

Chapter 5 – User-Defined Fields

### C. Built-in Functions............................................................................................................................................

Predefined functions are available in user defined fields and are very useful for advanced calculations. Select them
through the window that is displayed by clicking on the button “ **Available functions** ” (Figure C1).
Syntax, parameters, info and examples of the functions are displayed on the right-hand side of the window.
Basic functions and examples of them are discussed below.

```
Figure C1 – Built-in Functions
```

Chapter 5 – User-Defined Fields

#### Abs (Param1: double): double

Returns the absolute number defined in Param1.

**Example (Browser)**
**_Defined field in a Sales statistics browser that displays the absolute number of the expression:
(Sales value + Vat Value) / Abs (Sales value). The expression will be executed only if the sales quantity is
larger than zero._**

Create a new defined field using the operation “Line calculation” and “Number” as Field type.

Enter the following formula expression (Figure C2):
**IF(VSALSTAT.SalQty1<>0
,(ABS(VSALSTAT.SalVal+VSALSTAT.SalVatAmnt))/VSALSTAT.SalQty1
,0)**

This expression uses also the built-in function if for the validation check.

```
Figure C2 – Function Abs
```
#### GetConvertSeries (SOSOURCE: number, SERIES: number): string

Returns the conversion series split by semicolon (of the given sosource and series).

**Example**
GetConvertSeries **(** 1351 **,** 7001 **)** //returns 7021;7721;7041


Chapter 5 – User-Defined Fields

#### FormatDateTime (Param1:string, Param2: Date): String............................................................................................................

Returns the date of the Param2 in Param1 format.

**Example (Browser)**
**_Defined field in Sales statistics browser that displays the insert time of sales documents, in a specific format
(hours, minutes, seconds)._**

Create a new defined field, set the Operation to “Line calculation”, Field type to “Number” and enter the following
formula (Figure C3):
**FormatDateTime('hh:mm:ss',VSALSTAT.SoTime)**

This formula returns the date of the field in “hh:mm:ss’ format.

```
Figure C3 – Function FormatDateTime
```

Chapter 5 – User-Defined Fields

#### SetValue (Param1: string, Param2:variant):integer

This function is usually used in EDA (Alerts) for setting a value (Param2) to a field (Param1). Note that the first
parameter (Param1) is string, which means that fields have to be inserted in single quotes.

**Example (EDA)**
**_EDA in Customers that that sets to the value of field Code 1 the value of field Code, adding zeroes as a prefix
in such a way that the whole length of the field is no longer than 15 characters._**

Click on the EDA tool of the customers object to create a new EDA.

- Add a **Module rule** and enable the event « **Before DB Insert** ».
- Click on the toolbar button “ **Fields** ” and then on **Local fields** (available through the node <Event fields>).
- Create a new user-defined field, set the operation to “Calculate”, the field type to “Alphanumeric” and enter
  the formula (Figure C4) : **LPad(CUSTOMER.CODE1,15,'0')**

Return to the main screen of the EDA and create a new Formula fact using “Run” as Action, “Function” as Type and
enter the formula (Figure C5): **SETVALUE('CUSTOMER.CODE',EVTCUSTOMER.vAddZeros)**

```
You may drag and drop the field EVTCUSTOMER.vAddZeros instead of typing it.
```
```
Figure C4 – Function Lpad
```
```
Figure C5 – Function SetValue
```

Chapter 5 – User-Defined Fields

#### RunSQL (Param1:string):string

Executes the SQL statement defined in Param1 and returns the results. This function is used for retrieving data from
database objects. Use this function wisely, because for every record returned it executes the custom query (defined
in Param1) and this can cause slow performance.

**Example 1 (Browser)**
**_Defined field in a Sales statistics browser that displays the field FINCODE of the “converted from”document
that is linked to the Sales document displayed in each record of the browser._**
Create a defined field, select “Line calculation” as operation, “Alphanumeric” as field type and enter the formula:
**RunSql('select f.fincode from findoc f,mtrlines m where m.findocs=f.findoc and
m.findoc = '+STRING(VSALSTAT.Findoc))** (Figure C6)

Note that the formula uses the function **String** for converting the FINDOC id of each record (VSALSTAT.FINDOC) to
string format.

**Note** : If you needed to add a reference to a varchar field then you would have to use the **QUOTESTR** function.
Suppose that you need to filter data using field FINCODE (type varchar), then the sql statement should be:
**RunSql('select f.fincode
from findoc f,mtrlines m
where m.findocs=f.findoc
and m.fincode='+QUOTESTR(VSALSTAT.FINCODE)+'
and m.findoc='+STRING(VSALSTAT.Findoc))**

Figure C7 displays the sql statement in SQL Monitor.

```
Figure C6 – Defined field using RUNSQL function
```
```
Figure C7 – SQL Monitor
```

Chapter 5 – User-Defined Fields

**Example 2 (EDA-Alert)**
**_User-defined field in Sales documents EDA that returns Company T.R. No._**

This can be implemented either using the RUNSQL function or using the TABLE function (Figure C8). The SQL
statement produced is the same, the only thing that is different is the way you can use the system parameter Login
Company.

The first defined field uses the value of the field SALDOC.COMPANY. The formula is:

**RUNSQL('SELECT AFM FROM COMPANY WHERE COMPANY='+STRING(SALDOC.COMPANY))**

The second defined field uses the X.SYS.COMPANY system parameter, prefixed with a colon, that retrieves the login
company. The formula is:

**RUNSQL('SELECT AFM FROM COMPANY WHERE COMPANY=:X.SYS.COMPANY')**

The third defined field retrieves the login company using the internal parameter CompanyCode, that is available
through “Available functions” button. The formula is:

**RUNSQL('SELECT AFM FROM COMPANY WHERE COMPANY='+STRING(CompanyCode))**

Figure C9 displays the SQL queries that will be executed at runtime.

```
Figure C8
```
```
Figure C9 – SQL Monitor
```

Chapter 5 – User-Defined Fields

#### Copy (Param1: string, Param2, Param3: integer): string

Returns the number of characters defined in Param3 for the string Param1, starting from Param2 position.

**Example (Printout Form)**
**_Defined fields in sales documents printout form that display the field Comments of Items in the recurrent
section of the form. The text will wrap every 20 characters._**
Create the two defined fields inside the “Material Lines” (table MTRLINES) as in Figure C 10. The defined field **vLine1**
will display the first 20 characters of the field MTRL.COMMENTS using the formula:
**COPY(MTRLINES.MTRL_MTRL_REMARKS,1,20)**
The defined field V2 will be used to display all the rest text of the field MTRL.COMMENTS using the formula:
**COPY(MTRLINES.MTRL_MTRL_REMARKS, 2 1, 1000 )**

Field wrap is achieved through the $ sign. Insert the field **vLine1** in the recurrent section of the form and then enter
the **vLine2** field, in the properties, using the $ sign (Figure C11). Set the width to 20 characters.

At runtime the form will be printed as in Figure C12, the comments of the first line are wrapped in four lines.

```
Figure C10 – Function Copy
```
```
Figure C11
```
```
Figure C12
```

## 6. Database Designer

#### A. General Features

#### B. Fields

#### C. Tables

#### D. String Lists

#### E. Database Views

#### F. Objects

#### G. Virtual Tables

#### H. Report Objects


Chapter 6 – Database Designer

### A. General Features

SoftOne provides a Database Management tool that allows you to customize the structure of the database and also
create new Business Objects. This means that you are allowed to create new fields in SoftOne tables, create your
own custom tables, database views and new custom Business Objects, virtual tables, string lists and scripts.

Customizations are maintained during future upgrades of SoftOne.

Database is managed through the **S1 Designer** tool, which is inside the “ **S.D.K. – Customization tools** ” folder
under “ **Tools** ” section menu. Each record of S1 Designer has its own name, description, versioning and of course
custom fields, tables, objects etc. Figure A1 shows an example of different designer records.

```
Figure A1 –SoftOne Designer
```
Designer entries can be merged in one designer record (project) by inheriting others (Used Projects).
The option of creating many design projects can be very helpful when deploying customer projects that involve
different implementors. At the same time, they can be also used to generate a single custom solution for
exploitation (Figure A2).

```
Figure A2 - Designer with Used Projects
```

Chapter 6 – Database Designer

#### A1. Synchronization

SoftOne designer uses an internal sync tool that synchronizes the database whenever you make changes that affect
the database structure (new fields, tables, views, constraints). Synchronization takes place upon **manual change of
the version** of any designer record (Figure A3).

```
Figure A3 – Designer version change
```
Any time you change the version of a SoftOne designer record you will be requested to synchronize upon your next
login to the application. The different versions of the design projects will be displayed in a dialog message asking
you to accept the synchronization. In the example of Figure A4 the sync occurred because the version of the custom
designer “ _WS_CustomRedirection_ ” has changed from 2 to 3.

```
Figure A4 - Sync database message box
```

Chapter 6 – Database Designer

The versions of all the database designer records are saved as delimited string inside the field **CSTGEN** of the table
**CSTINFO** for **CSTTYPE=98** (Figure A 5 ).

**SELECT** CSTGEN **FROM** CSTINFO **WHERE** CSTTYPE **=** 98

MENU=518;Start=518;xBase=518;Trdr=518;Mtrl=518;Asst=518;Prdn=518;Acnt=518;Cheque=518;
FinDoc=518;Srvc=518;ABC=518;Budgets=518;SX=518;Pay=518;HR=518;CRM=518;BG=518;
Version=518;
Custom Sales Order Flow=2;DEMO=3;LoadCardItems=1;mydemodes=101;
NEWCustomOrderFlow=5;PalletsCustom=12;S1_CurrencyRates=100;S360Customs=1;
WS_CustomRedirection=2;WS_Dashboard=1;WS_GenCustom=4;WS_LoginParams=2

```
Figure A 5 – Custom designer records
```
Each custom designer structure is saved in the field **SODATA** of the table **CSTINFO** for **CSTTYPE=97** (Figure A6).

**SELECT * FROM** CSTINFO **WHERE** CSTTYPE **=** 97

```
Figure A 5 – Custom designer records
```

Chapter 6 – Database Designer

**Note:** Version numbers of new database designers must be greater than the older ones or else the synchronization
will fail and you will not be able to login SoftOne. In this case you need to manually update (through SSMS) the
value of the field CSTGEN (CSTTYPE=98) with a version number less than the number of the new designer.

The synchronization file is saved inside the « **Log** » folder of the " **Program Profile Directory** ". Its path can be found
inside the window " **_About_** " (User – About) (Figure A 7 ). The filename of the log file uses the same name as the
connection file XCO, stating also the execution time of the synchronization (e.g. " S1DemoENG_20180505-
160924.log"). This file contains all the sync jobs that took place and the possible errors that prevented the creation
of tables, database views, or constraints in the database (Figure A8).

```
Figure A 7 – About Window
```
```
Figure A 8 – Log File
```

Chapter 6 – Database Designer

#### A2. Publication – Custom Administration

SoftOne designer records can be exported throughout the **Custom Administration** tool as .cst files. Multiple export
of designer records and other cst files (browsers, forms, etc.) is also supported. This is useful for creating
comprehensive **Solutions** , which can be also enriched with additional publication information, such as the
manufacturer’s name, date restriction – shareware (Figure A 10 ) or restriction to certain SoftOne Serial Number.

All the above can be password protected and suggest that any custom solution can be copyrighted (Figure A 10 ).

```
Figure A9 - Custom solution publication for All Customers
```
```
Figure A10 - Custom solution publication for a single Serial Number (password protected)
```

Chapter 6 – Database Designer

Custom Administration records (Designers, Forms, Browsers, etc.) can also be grouped using **Bundles** (Figure A1 1 ).

```
Figure A1 1 – Bundles
```
Note that **search** is also available using **CTRL+F** , or the corresponding button below the grid (Figure A1 2 ).

```
Figure A1 2 – Search
```

Chapter 6 – Database Designer

### B. Fields

Inside SoftOne designer entries you can create new fields in any table of the database, even SoftOne internal tables.
In order to create a new field, you have to select the desired table (e.g. PRSN), move to the last field and then use
the down arrow of the keyboard, which will bring you up a new empty field record.

Field names should always begin with the prefix **CCC**. This ensures that these fields will not be altered in any way
when upgrading to newer SoftOne versions. Fields are stored in database, so sync is required in order for them to be
available for further design in forms, browsers, etc.

**Note:** It is recommended that fields’ length should be no longer than 14 characters.

Figure B1 shows an example of adding fields inside table MTRL using different data types.

Float Fields can be set to display the same number of decimal places as the ones you have selected inside each

company’s properties (Figure B2 - Numeric TextBox Control).

```
Figure B1
```
```
Figure B2
```

Chapter 6 – Database Designer

#### B.1 Field Data Types

Database table fields require a name and a data type and can be displayed with different controls depending on the
given editors. Analysis of all the available Editors is provided in the section Editors in Chapter "Screen Forms". The
following table lists the available data types and their specifications. Always keep in mind that a table can contain a
maximum of 8,060 bytes per row (SQL Server).

```
Data Type Min Max Storage Size
```
```
Small Integer - 32,768 32,767 2 bytes
```
```
Integer - 2,147,483,648 2,147,483,647 4 bytes
```
```
Float - 1.79E + 308 1.79E + 308 4 bytes (24 digits)
```
```
CInteger (Identity) 1 2,147,483,647 4 bytes
```
```
DateTime 1753 / 01 / 01 9999 / 12 / 31 8 bytes
```
```
Varchar 0 chars 8000 chars number of chars + 2 bytes
```
```
Text 0 chars 2,147,483,647 chars number of chars + 4 bytes
```
```
Image 0 bytes 2,147,483,647 bytes
```
```
Unicode (nVarchar) 0 chars 4000 chars 2 * number of chars + 2 bytes
```
#### B.2 Field Properties

Field properties (Figure B4) are summarized in the table below:

```
Figure B4
PROPERTY DESCRIPTION
```
```
Size Sets the size of the field (Varchar data type).
Title Sets the title of the field
```
```
Required Specifies whether a value for the field is required for the record to be saved (e.g. null
values are not permitted).
Default Value Sets a default value to the field that applies to new entries. Users can change it at runtime.
```
```
Forced Value Indicates the forced value applied to a field. Users cannot change it at runtime.
Always included in
select statement Indicates that the field will always appear in SQL SELECT statement.^
```
```
Size (in characters) Sets the default width size display of the field inside SoftOne^ (when displayed in datagrids
or browsers).
Hidden field Indicates whether the field is displayed or not.
Editor Sets the field editor. See editors.
```

Chapter 6 – Database Designer

#### B.3 Selector Fields

Fields can be set to retrieve and store data from other tables, database views, view tables or string lists. These links
(selectors) to other objects are done using **editors** and the data stored depend on the editor attributes used.

The available data types for creating selectors are "Integer", "Small Integer" and "Varchar" and they are usually used
according to the primary key of the linked object (table, view, string list).

A selector is built upon entering the name of the object (table, view, string list) in the **Editor** property of the field
(tab **Search by** ). It is recommended to use the same field names as the corresponding linked objects.

In Figure B3 you can see an example of linking the field TRDBRANCH of the table FINDOC with the table
TRDBRANCH. Apart from the linked table name, there is also an extra command F[TRDR=:FINDOC.TRDR] that limits
the corresponding data (of TRDBRANCH table) to the ones that the value of field TRDR is the same as FINDOC.TRDR
value. These commands are explained in the section Editors Attributes.

```
Figure B3
```
Another use of editors is for altering the control that displays the fields’ data inside forms. The available editor
commands are explained in the section Editor Commands. In Figure B4 there is an example of the field ISACTIVE
(Table TRDR) that is displayed as a checkbox (Yes / No), because it uses the command $Y.

```
Figure B4
```

Chapter 6 – Database Designer

### C. Tables

New tables are created in database using the right click option “New – Table”. Table names must always begin with
the prefix **CCC** , while the fields inside them can be created using any name.

The name of the primary key field is recommended to be the same as the table name. This maintains the same logic
as in SoftOne tables, which shortens the process of using internal commands in controls (editors, locate statement
expressions etc.).

**Note** : Field names **COMPANY** and **ISACTIVE** are predefined and they always appear in the “where clause” of the
“selector list” SQL statements. This means that if you create a custom table that contains the above fields and you
use it as selector table (editor) in a field, then the SQL statement for retrieving data will be like the following:
**SELECT** FLD1 **,** FLD2 **,... FROM** CCCMYTABLE **WHERE** COMPANY **=[LoginCompany] AND** ISACTIVE **= 1 AND...**

Tables are stored in database, so sync is required for them to be available in SoftOne object forms, browsers etc.

#### C.1 Table properties

Table properties are defined through the different options of the tabs “Table basic data”, “DB/Logical Limitations”,
“Additional relations” and “Selector fields” that are discussed in the following sections.

```
Figure C1
```
**_C. 1 .1 Table Basic Data_**

The available properties of this tab (Figure C1) are summarized below:

**_Name_**

Name of the table (Database Name). Always use prefix CCC.

**_Title_**

Title / caption of the table. This is the name that will be displayed when adding the table in SoftOne objects.

**_Primary key_**

Table primary key fields divided by semicolons that will be used to create the database table primary keys
(e.g. CCCFIELD1;CCCFIELD2;CCCFIELD3).


Chapter 6 – Database Designer

**_Table in memory (Checkbox)_**

This option defines that the data of the custom table will be loaded in memory on login. Use it in tables that don’t
have a lot of data. Analysis of this type of tables can be found in the section C2. Tables in memory.

**_Process with_**

This property is the same as the **H[ObjectName]** editor attribute which is defined in field editors and has different
uses depending on the type of the table you want to create (Memory, Master, Child Table). It also provides a
different use when creating database views.

**_A. Object Redirection_**

Custom tables with corresponding custom objects like SoftOne tables (Customers, Items, etc.), can be used as
selectors to other fields. Example of this is the field TRDR (Customer) of table FINDOC (Sales Documents) that is
linked to the inherited table Customer (under the database table TRDR).

If these tables are used as selectors from other fields, then the caption of the selector fields is turned into hyperlink
and redirects to the corresponding object that is defined inside the property “ **Process with** ”. Keep in mind that
fields are linked to tables through the editor property. These **selector fields** , that retrieve data from tables, are
displayed via “ **Selector List** ” control as in figure C2.

Figure C2 shows an example of a custom field named “Model” (CCCAIRMODEL) that retrieves data from the table
“CCCAIRMODEL” and links (“Process with” property) to the object “CCCAIRMODEL”. This means that clicking on the
caption (hyperlink) of the field “Model” redirects you to the custom object “Aircraft Models” (Figure C3).

**Note:** It is advised to use the name for tables and objects linked to them, as in the above example.

```
Figure C2
```
```
Figure C3
```

Chapter 6 – Database Designer

**_B. Memory Tables Processing (Command $)_**

Process with $ (Figure C 4 ) is used for tables in memory and defines that the data of these tables will be processed
through a simple edit list control (Figure C5) and not using an object. The menu job that displays the table for
editing is created using the job type “Table processing” as in Figure C 6.

```
Figure C 4
```
```
Figure C5
```
```
Figure C 6
```

Chapter 6 – Database Designer

**_C. Browser Redirection_**

The property “ **_Process with_** ” can be used for object redirection from browser records. This is usually used in
database views that are displayed in objects and have only a browser view and not a form view.

An example of the above is the object-database view “Sales Statistics” (Figure C6). When users double click on one
record/line of the browser they are redirected to the corresponding object and record (SALDOC or RETAILDOC) that
is defined in the property “Process with” of the database view.

```
Figure C6
```
The expression formula for browser custom redirection is the following:

**#ObjectID;RecordID**

This means that if for example you have created a custom object that uses the id 100001 and you want to make a
redirection from a database view to this object, using as locate record the value of the field “Myfield”, then you
should enter the expression: **# 100001 ;Myfield**

**ObjectID** is the unique number that defines objects. For example, the objectID of Customers is 13, of Items 51, of
Sales Documents 1351, of Purchase Documents 1251, of Retail Documents 11351. This means that by entering the
number of the object, the records of the browser will redirect the user to the specified object. There is also the
option of variant object redirection, that depends on the value of a field of the table.

For example, the Sales Statistics object redirects either to Sales Documents or to Retail Documents depending on
the value of the fields SOSOURCE and SOREDIR. Sales and Retail Documents share the same SOSOURCE value,
which is 1351, but the value of the field SOREDIR is 0 for Sales Documents and 10000 for Retail Documents.
So, the “ **Process with** ” property of the database view VSALSTAT is: **#SOSOURCE+SOREDIR;FINDOC;MTRTRN**
SOSOURCE and SOREDIR values define the redirection object id (e.g. 1351+10000 = 11351 which is the id of
RETAILDOC[Retail documents], 1351+0=1351 which is the id of SALDOC [Sales documents]).

**RecordID** defines the record of the redirection. The above example uses two fields, FINDOC value is used for
locating the header record and MTRTRN for locating the child table record (MTRLINES).

**Note:** All the fields that are used inside the property “Process with” need to be in the select statement of the object
browser. This means that you can either add them as columns inside the browser or enable the field property
“Always included in select statement” of the database view.


Chapter 6 – Database Designer

In Figures C7 and C8 you can see an example of a custom database view CCCVMTRSTAT that selects data from the
table MTRTRN, just as VMTRSTAT. The “ **Process with** ” property is: **#SOSOURCE+SOREDIR;FINDOC;MTRTRN**. Also
notice that in order to use the object CCCVMTRSTAT in browser-only mode, you need to use the parameter
**BROWSERONLY=1** (Figure C 9 ).

```
Figure C7
```
```
Figure C8
```

Chapter 6 – Database Designer

```
Figure C9
```

```
Chapter 6 – Database Designer
C. 1. 2 DB/Logical Limitations
This tab contains the constraint definitions of tables. The available commands are described in the following table.
```
```
Database Limitations/ Logical Limitations
```
**Command Process Analysis Syntax / Example**

##### XP

(^)
**Defines the name of primary key of the
table** .The fields of the primary key are the
ones entered in the textbox “Primary key” of
the tab “Basic Data”.
XP_KEYNAME (KEYNAME is the name of the primary key)

##### XU

```
Creates a unique, non-clustered index.
Used when you want to prevent duplicate
values.
```
##### XU_KEYNAME = FIELD1, FIELD2,...

```
Example: Unique customer branch codes.
XU_TRDBRANCH_CODE=TRDR,CODE
```
```
XI Creates non-unique, non-clustered index.^
Used for creating indexes.
```
##### XI_KEYNAME = FIELDNAME1, FIELDNAME2,...

```
XF Creates a foreign key to a table.
```
##### XF_TABLE_FOREIGNKEY = REFERENCETABLE

```
or when fields of both tables and foreign table have the
same name
XF_TABLE_FOREIGNKEY
Example 1: Table TRDR
Command: XF_TRDR_SALESMAN = PRSN
ConstraintName: XF_TRDR_SALESMAN
Foreign Key: SALESMAN
Reference Table: PRSN
Example 2: Define that the field COUNTRY of the table
Bank has a foreign key to the primary key field COUNTRY
of the table
XF_BANK_COUNTRY
```
##### XC

```
Check constraint
Sets restrictions on data added to the table.
```
```
XC_KEYNAME = (FIELDNAME>=value)
Example: Restrict values entered to FIELD1 (Values
permitted are between 100 to 500).
XC_KEYNAME =(FIELD1>100) AND (FIELD1<500)
```
##### XD

```
Foreign key with Cascade Delete.
Used in child tables. If a record of the parent
table is deleted then the corresponding
records of the child table are also deleted.
```
##### XD_CHILDTABLE_HEADERTABLE

```
Example: Cascade delete customer branches.
XD_TRDBRANCH_TRDR
```
##### XT

```
Additional relations / Additional
constraints (SoftOne or CCC tables )
```
**1.** Defines table links to fields (apart from
editor links) e.g. In Customers browser, Field
TRDR is linked to Financial Data).
**2.** Defines the “ **Expand by** ” property of
browsers (e.g Item Lines in Sales Documents).
It can be used either in SoftOne tables (tab
Additional constraints) or in CCC tables.
**1.** XT_TABLEFIELD_OBJECT=J[Extra Joins(Values First)]
**Example:**
XT_TRDR_CUSFINDATA=[J(B.COMPANY=:X.SYS.COMPA
NY AND B.TRDR=A.TRDR)]
**2.** XT_MASTERTABLE_DETAILTABLE[L(ID1;ID2;+LINENUM]
**Example:**
XT_FINDOC_ITELINES=[L(FINDOC.FINDOC;+LINENUM)]

```
XR Logical/Internal Limitation :^
Creates foreign key in objects
```
##### XR_TABLE_FIELDNAME = OBJECT

```
Example: Relative item
XR_MTRL_RELITEM = ITEM
```
##### XR

```
Logical/Internal Limitation :
Cascade Delete in objects
```
##### XR_CHILDTABLE_PARENTTABLE

```
Example: Item lines in documents
XR_MTRLINES_FINDOC
```

Chapter 6 – Database Designer

**_C. 1. 3 Selector Fields_**

The datagrid of this tab lists the columns that will be displayed in the selector list of fields that are linked to this
table (through editor property). Figure C9 is an example of creating a custom table (CCCAIRMODEL) that is used as
selector from the field CCCAIRMODEL (Figure C10) and is displayed in form as in Figure C11.

**Note** : The selector list works properly only when you have **valid display sizes** in all the fields that you define as
selector fields. This means that except for the sizes you have to define inside this datagrid, you also need to enter
proper values in the **display size property** of the fields.

```
Figure C9
```
```
Figure C10
```
```
Figure C11
```

Chapter 6 – Database Designer

#### C.2 Memory Tables...................................................................................................................................................................................

Memory tables are database tables that are loaded into memory during application log in. This means that their
data are available from every SoftOne control or script without the need of SQL statements. It is recommended that
you add tables in memory only when you are certain that they will have small size.

When these tables are used as from selector fields then they are displayed as combo boxes. Their data are
processed through a simple edit list control and not using an object (Figure C2.1). The menu job that displays the
table data for editing is created using the job type “Table processing” as in Figure C2.2.

```
Figure C2.1 Figure C2.2
```
The steps of creating a table in memory are the following:

- Right click the left pane of SoftOne designer and select “New table” from the pop-up menu.
- Enter the name of the table as it will be created in the database.
- Enter the title of the table as it will be displayed in SoftOne objects.
- Enter the primary keys separated by semicolons (;).
- Enter the command **$** in the property “ **Process with** ”.
- Add the fields and select the property " **Required** " for the **primary key fields** (Figure C2.3).

```
Figure C2.3
```

Chapter 6 – Database Designer

- Optionally, you may enter default or mandatory values inside the properties “Default value” and “Forced value”.
  Default values are auto inserted when inserting a new record, while Forced values are auto inserted when
  posting one (Figure C2.4).

```
Figure C2.4
```
- Enter the display size of the fields in order to be displayed properly in the edit list control. This affects only the
  display size of the column of the field as it will be displayed inside SoftOne and not the database table.
- Enter the name of the primary key in the textbox of the tab “ **DB/Logical Limitation** ” (Figure C2.5). This is the
  name of the PRIMARY KEY constraint of the table.

```
Figure C2.5
```
- In the datagrid of the tab “ **Selector fields** ” enter the columns and their display size that will be used when this
  table is used as selector list from a selector field (Figure C2.6). Make sure that the display size of the fields is
  greater than zero or else the fields will no be visible in the selector list.

**Figure C2.6**
The table will be available from SoftOne forms and menu, only when you sync the database, which is done by
increasing the version number of SoftOne database designer.


Chapter 6 – Database Designer

**_Link fields to memory table_**

Inside the configuration window of an object form, select a field, that uses the same type as the primary key of the
memory table (usually small integer), and enter the name of the table in the editor property (Figure C2.7).

```
Figure C2.7
```
In running mode, the field will be displayed in the object form as in Figure C2.8.

```
Figure C2.8
```

Chapter 6 – Database Designer

#### C.3 Child Tables

Child tables are ordinary database tables that are displayed through datagrid control inside object forms. They are
detail tables to parent tables of SoftOne objects. That means that the relationship between them is “One to many”.

**_C. 3 .1 Design_**

The design of a child table uses the same principles as the design of any table, such as a table in memory. The only
difference is that you need to add a field that links the child table to the primary key of the parent table (and stores
it). It is recommended to name the link field of the child table as the primary key name of the parent table, so as to
keep up with SoftOne logic and shorten object expressions, when you use it in editors or locate statements.

It is also advised to add a field named **LINENUM** (type integer) to all your child tables, that keeps the line
numbering of the child table records per parent record. The column name LINENUM is predefined and it can
generate auto-increment numbers as long as you enter the number **9999999** in the default value property of the
field. After posting a record, SoftOne automatically fills fields named LINENUM with auto increment values (starting
from 1). For every new parent record inserted, the line numbering of the child tables is restarted.
Note that this field is also used in **Web Service calls** (SetData post method).

Example of parent – child tables are the tables FINDOC(Documents) and MTRLINES (Document lines) where the field
that links the two tables is FINDOC (primary key in table FINDOC) (Figure C3.1)

```
Figure C3.1
```

Chapter 6 – Database Designer

The design of a child table is the same as any other table. The only thing that you should keep in mind is to add a
field that will store the data of the primary key field of the parent table.
The steps for creating the child table are the following:

- Right click the left pane of SoftOne designer and select “New table” from the pop-up menu.
- Enter the name of the table as it will be created in the database.
- Enter the title of the table as it will be displayed in SoftOne objects.
- Enter the primary keys separated by semicolons (;).
- Add the fields and select the property " **Required** " for the **primary key fields**
  In the example of Figure C 3 .2 we have created a child table (CCCWSDETAIL) of the master table CCCWSMASTER
  (Figure C3.3). You are allowed of course to create child tables for any SoftOne table, not only for custom ones.

```
Figure C3.2
```
```
Figure C3.3
```

Chapter 6 – Database Designer

**_C. 3 .2 Process data in object form_**

Display a detail table in an object form using the following steps:

- Open the design mode of the object (e.g. CCCMYOBJECT) where you wish to display the table.
- Click on the “ **_Configuration_** ” button and move to the tab “ **_User Defined Tables_** ”
- Click on “Tables” drop down list and select the child table (Figure C3.4).
- Select the child table from the left panel and then in the “ **_Locate statement_** ” property enter the field
  expression that will be used to locate the data of the table. The locate statement expression may contain parent
  field values ( **:Field** ), user values (e.g. 51) or login parameters (e.g. **:X.SYS.COMPANY** ). Syntax is the following:
  **ChildField1;ChildField2;ChildField3=:ParentField1;:ParentField2;Value1**

```
Example: REFOBJID;SOSOURCE;XDOCTYPE=:PRJC;40;1
```
```
Note: If the link field of the parent-child relationship uses the same name in both parent and child tables, then you
simply enter the name of the field inside the “Locate statement” property (Figure C3.4).
```
```
Figure C3.4
```
- The next step is to store the value of the parent table primary key in the corresponding child table field.
  Select also the fields mentioned in the " **_Locate statement_** " property and enter the appropriate values in the
  “ **_Forced value_** ” property so that they meet the expression of the locate statement.


Chapter 6 – Database Designer

```
Figure C3.5 stores the primary key value CCCWSMASTER of the parent table CCCWSMASTER in the field
CCCWSMASTER of the child table CCCWSDETAIL.
```
```
Figure C3.5
```
- Last step is to display the table inside the form using a grid control.
  Right-click, create a new grid and then drag and drop the fields you want to be displayed (Figure C3.6)

```
Figure C3.6
```

Chapter 6 – Database Designer

**_C.3.3 Performance Tips_**

It’s better not to use identity fields in child tables, because they are not processed very fast from database servers.
Instead, you can use integer fields as primary keys that are auto filled with incremental numbers, following the steps
below:

- Insert a new field in your parent table:
  o **Name** : LOCKID
  o **Data type** : Integer
  o **Preselected Value** : 0
- Create a primary key field in the child table using any name and add the following command:
  **:ParentTableName.LOCKID** in its Forced Value property.

Parent table fields named **LOCKID** are responsible for filling automatically child table fields with incremental
numbers, using an internal SoftOne process.
Figures C3.7 and C3.8 show the primary key field MTRLINES of the child table MTRLINES that uses the above
command in the object Sales documents.

```
Figure C3.7
```
```
Figure C3.8
```

Chapter 6 – Database Designer

### D. String Lists

String Lists represent a collection of keys and values. A key-value pair is an entry of a string list, where keys are
unique. String lists are used as editors to numeric fields (integers, small integer) and provide fast lookups. An
example of a field that uses a string list as selector, is the field “ _Tax Category”_ in the Customers entity, which displays
the values "Normal, Is Exempted, Reduced" (Figure D1).

The main difference of tables and string lists is that string list data cannot be modified during runtime. They also
display only two fields, and their data are always loaded in memory.

String lists can be created either from SoftOne designer or through the configuration window of an object form. The
ones that are created through SoftOne designer can be used from any object of the application, while those created
inside an object can only be used from fields within the current object (Chapter 1 - A5. String Lists).

```
Figure D1
```
A string list is created in SoftOne Designer using the following steps:

- Right click the left panel of SoftOne Designer and select “ **New string list** ” from the pop-up menu.
- Enter the name of the string list in the textbox “ **Name** ”.
- Inside the “ **Key** ” column enter the key codes
- Add values for each key in column “ **Value** ”. Those values will be displayed in fields that use this string list in
  their editor property (Figure D 2 ).

```
Figure D 2
```

Chapter 6 – Database Designer

String lists can be used as selector lists from numeric fields of any object, using the following steps (Figure D3):

- Design a form of an object (e.g. Sales Documents)
- Click on “ **_Entity Configuration_** ”
- Select a numeric field and enter the name of the string list prefixed by $ (e.g. $DocumentLevel)

In runtime the field will be displayed as in Figure D4.

Analysis of creating a string list inside a form can be found in Chapter 1 - A5. String Lists.

String lists created inside forms are used in Field Editors without using the symbol $, but only the name of the stringlist.

**Note:** All **SoftOne internal string lists** (e.g. SODTYPE, SOSOURCE) can be overridden through Soft1 Designer, if you
create an identical string list – with the same name (e.g. SODTYPE) and add new values (e.g. 5001:MyType). These values
will then be available at runtime (in fields that use the above string list as editor). Use this option carefully!

```
Figure D 3
```
```
Figure D3
```

Chapter 6 – Database Designer

### E. Database Views

Database Views are stored in database and can be used in the following cases:

- As editors in lookup fields (selectors), displaying data from SoftOne tables or tables from another database.
- As child “tables” of object forms in order to display entries from various tables.
- In custom object browsers for displaying data in report style with redirections to other objects (e.g. Sales
  Statistics).

#### E.1 Design

A database view is created using the following steps:

- Right click the left panel of SoftOne Designer and select “ **New database view** ” from the pop-up menu.
- Inside the textbox of the tab “ **_SQL_** ” enter the SQL statement and then click on the button " **_Create Fields_** ", to
  create the fields (Figure E1). Configure fields by entering titles, editors, etc.

```
Figure E1
```
- The property " **_Primary Key_** " of tab “ **_Basic Data_** ” may be used in two different ways, either to locate a record
  when used as a child table of an object or to return a value when used as an editor from a selector field. In both
  ways you need to enter here the name of the fields separated by semicolons (Figure E2).
- Finally, in Tab " **_Selector fields_** " insert the fields that you wish to display if the specific database view will be
  used as lookup table in field editor (Figure E3).
  After completing the creation of the database view the database must be synchronized.

(^)
**Figure E2 Figure E3**


Chapter 6 – Database Designer

#### E.2 Advanced Browser Redirection

Database views can be used in objects in order to display data in browsers and pivot tables. This means that when
users double click on a record/line of the browser they can be redirected to a specific record of an object.
The expression formula for browser redirection to different objects is **#ObjectID;RecordID** and is fully explained in
section Browser Redirection.

In this section we will display the way of defining the redirection objects along with different forms and lists using
script code.

In the example of the section Browser Redirection we created a database view that redirects the user to different
objects (Sales, Purchases, etc.) according to the values of the fields SOSOURCE and SOREDIR. Suppose that we
needed to redirect the user to specific forms of the above objects depending on the value of the field SERIES. In this
case we could write a JavaScript code that checks the series (or anything else we prefer to check) and then return a
command that opens the object in a specific form (and list). There are two way to express the command, either
using the object name: **#ObjectName,FORM=xxx,LIST=xxx** or the object id: **#ObjectID,FORM=xxx,LIST=xxx**

The JavaScript function that returns the object command can be written inside the “ **S1 Import** ” tool (Tools – SDK –
Customization tools – S1 Import). Create a new a record, type a code (e.g ReturnFindocForm) and description and
then enter the JavaScript of Figure E4. The function RUN (can be any name) returns the object command that will be
used for the redirection and it will be later called from the property “ **_Process with_** ” of the database view.

The script initializes a variable “vEditor” that will hold the object command (returned in line 32). Then it checks for
the value of the field SOSOURCE (line 5) and also the SERIES value (lines 7,10) so as to create the command that
redirects to different object forms per SERIES. In line 13 it uses the expression SOSOURCE+SOREDIR (as in Browser
Redirection example) that redirects to the object using the default form of the user.

```
Figure E4
```

Chapter 6 – Database Designer

In SoftOne Designer, select the view and enter the following expression in the “ **_Process with_** ” property (Figure E5).

**#SysRequest.ExecScript(1,"ReturnFindocForm", "RUN");FINDOC;MTRTRN**

The part **#SysRequest.ExecScript(1,"ReturnFindocForm", "RUN")** is the one that executes the JavaScript function
“ **_RUN_** ” of the “ **_S1 Import_** ” record with code “ **_ReturnFindocForm_** ”. The other part is the record id of the redirection.

Figure E6 shows the database view at runtime and how it redirects to specific form per SERIES value.

```
Figure E5
```
```
Figure E6
```

Chapter 6 – Database Designer

#### E.3 Examples

**_E. 3 .1 Editor in lookup fields (Selectors)_**

**_Create a database view that will be used as lookup list in field MTREXTRA.NUM01 of Items. The lookup list
will display the code and the names of customers, as well as some financial data from table TRDFINADATA
and return the id (TRDR) of the selected customer._**

- Create a database view named **CCCViewCustomer** with primary key **TRDR**
- Enter the following SQL statement inside the tab “ **_SQL_** ” and click on the button “Create Fields” (Figure E3.1):
  **SELECT
  A1.TRDR ,
  A1.CODE ,
  A1.NAME ,
  A1.COMPANY ,
  $NVL(A2.LBAL, 0 ) AS LBAL ,
  $NVL(A2.LTURNOVR, 0 ) AS LTURNOVR,
  FROM
  TRDR A1,
  TRDFINDATA A2
  WHERE
  A1.TRDR =A2.TRDR
  AND A1.COMPANY=A2.COMPANY
  AND A1.SODTYPE=13**

```
Figure E3. 1
```
- Add the selector fields as in Figure E3.2, change the S1 Designer version, save and synchronize the database.

```
Figure E3.2
```

Chapter 6 – Database Designer

In “ _Items_ ” Configuration window, select NUM01 of “ _Item extra fields_ ” and enter the name of the database view
“ **_CCCViewCustomer_** ” in the Editor property. (Figure E 3 .3)

```
Figure E3.3
```
The field will be displayed at runtime as in Figure E3.4.

```
Figure E3. 4
```

Chapter 6 – Database Designer

**_E. 3 .2 Child Database View in Object_**

**_In Customers’ form, display CRM actions inside a datagrid._**

- Create a database view named CCCTRDRACTION with primary key TRDR and enter the following sql query:
- Click on “Create Fields” (Figure E3.5)

**SELECT
A.SOACTION,
B.TRDR
FROM
SOACTION A
LEFT OUTER JOIN
TRDR B
ON
A.TRDR=B.TRDR**

```
Figure E3. 5
```
- Enter titles, display sizes in fields, change S1 Designer version, save the changes and synchronize the database.
- Inside Customer form Configuration window, select and add the view as in Figure E3.6.

```
Figure E3. 6
```

Chapter 6 – Database Designer

- Select the view (left panel) and set the locate statement, use either TRDR or TRDR=:TRDR.TRDR (Figure E3.7).

```
Figure E3. 7
```
- SOACTION fields are displayed (linked) when you enter the editor SOACTION inside the field
  “ **_CCCTRDRACTION.SOACTION_** ” of the view (Figure E3.8). Notice that the table is linked to the field after you
  Accept the changes and reopen “ **_Configuration_** ”.

```
Figure E3. 8
```

Chapter 6 – Database Designer

- Create a new tab and a new datagrid and drag and drop fields from the action table of the database view
  (Figure E3.9).

```
Figure E3.9
```
The datagrid will be displayed at runtime as in Figure E3.10.

```
Figure E3.10
```

Chapter 6 – Database Designer

### F. Objects

Business Objects are used for creating a user interface where data from tables, virtual tables, database views etc. can
be processed. They function exactly as SoftOne objects (Customers, Sales documents, etc.), which means that they
include all the tools that can be found in an object (EDA, Imports, Browsers, Forms, Printout Forms, etc.).

Database objects (tables, database views, etc.) can be used inside form objects, as long as they are designed
through SoftOne designer.

#### F.1 Design

Objects are created through the right click option “ **_New – Object_** ” of SoftOne Designer (Figure F1.1). Object names
must use the prefix CCC.

Database objects (tables, database views, etc.) can be inserted through drag and drop (Figure F1.2).
If you need to lock the focus of the object then use the button “ **Lock Tree** ”.

```
Figure F1.1
```
```
Figure F1.2
```

Chapter 6 – Database Designer

#### F2. Object Properties

Object properties are the following (Figure F2.1):

```
Figure F2.1
```
**_Object Name_**

Object name using CCC prefix.

**_Job Type_**

- **Master Form**
  Creates a form object that uses all the available tools (Browsers, Forms, EDA, etc.)
- **Edit List**
  Creates an edit list object that uses simple toolbar controls (Save, New, Delete). Data are displayed either in a
  datagrid (e.g. Customer Professional categories) or in a single record form using the command
  EDITOPTIONS=ONEROW (e.g. Customer Parameters).

**_Object ID_**

Declares the ID of the object that can be used from as a reference from other tools. For example printout forms that
refer to this object are created through the menu command Templates.ObjectID. This ID can also be used in
hyperlink redirection, as long as you have used it inside the table’s “Process with” property.

**_Caption_**

Name that will be displayed in the default object form.

**_Ref.Obj.Id_**

Defines the reference object that displays your custom object in its “ _Relative jobs_ ”. For example, if you enter the
number 51, then your object will be listed in the relative jobs of items. Object ids (SOSOURCE & SODTYPE) can be

found in Annex SODTYPE and SOSOURCE tables.


Chapter 6 – Database Designer

**_Domain Info_**

Declares the field whose value is used to distinguish between different object records. Helpful when you want to
create only one interface (object) and use it for different record types.
For example, there is only one object created for table AREAS, but there are different menu jobs for customers
(SODTYPE=13), suppliers (SODTYPE=12), etc. The Domain Info property of the AREAS object is
SODTYPE=SODTYPE(12,13,15,16,20,21) and the different objects created in the menu have the command AREAS.xxx
, where xxx is the SODTYPE value. That is, for customer areas the menu job command is AREAS.13. Moreover, every
new record adds the value of the menu job command (13) in the field SODTYPE, that is defined in Domain Info
property of the main object.

**_Parameters_**

The following table displays the various commands that can be used as Object Parameters (Figure 2.2).
**Note** : These commands can also be used in custom forms (“General parameters” tab of “Configuration” window).

**Object Parameters**

```
Command Operation
```
```
AUTOLOCATE=id Locates the record using the given id
```
```
BRMENU=StringList Adds the StringList records in the Browser context menu
```
```
BROWSERONLY= 1 Displays object only as a browser (e.g. SalesStatistics)
```
```
BUFEXCLUDE=S1FIELD1;S1FIELD2; The SoftOne fields defined are excluded from Record Copy
```
```
CUSTOMBUFEXCLUDE=CCCFIELD1;CCCFIELD2; The custom fields defined are excluded from “Record Copy”
```
```
CUSTOMBUFEXCLUDE=TABLENAME All the fields of the defined table are excluded from “Copy”
```
```
NOGRIDTOOLBAR=1 Hides the toolbar of all the grids inside a form.
```
```
NOTOOLBAR=1 Hides the main toolbar of the given object.
```
```
NOSIDEBAR=1 Hides the sidebar (browsers, forms, tools) of the given object.
```
```
EDITOPTIONS=NOINSERT Prohibits adding^ a new entry^ and hides the toolbar button
“New”
```
##### EDITOPTIONS=NODELETE

```
Prohibits entry delete and hides the toolbar button “Delete”
Example: EDITOPTIONS=NOINSERT,NODELETE
```
```
EDITOPTIONS=READONLY Disables editing the data of an entry
```
##### EDITOPTIONS=NOBROWSER

```
Hides the browser of an object and the toolbar button
"Browser"
Example: EDITOPTIONS=NOBROWSER,NOINSERT,NODELETE
```
```
EDITOPTIONS=ONEROW Displays an EditList object in “one record” mode
```
```
EDITOPTIONS=NOPRINTFORM Disables Form printing and hides the toolbar button “Print
Form”
```
```
EDITOPTIONS=NOPRINTBROWSER Disables Browser printing
```
```
EDITOPTIONS=NOPRINTLABEL Disables label printing (from browser right click menu)
```
```
PARENT=ObjectName (e.g.PARENT=SALDOC) Inherits the properties of an Object (Tables, Script, etc.)
```
```
RELJOBS=StringList Adds the StringList records in the Related Jobs of the Object
```

Chapter 6 – Database Designer

```
Figure F2.2
```
```
Figure F2.3
```

Chapter 6 – Database Designer

#### F.3 Table Properties

Database objects (Tables, DB Views, etc.) used in SoftOne objects have the following properties (Figure F3.1):

```
Figure F3.1
```
**_Caption_**

Auto filled with the title of the table

**_Original Name_**

Auto filled with name of the table

**_Filled with Data from_**

Indicates the way table records are populated

- **SQL:** Use in Form objects (e.g. Customers, Sales documents, etc.).
- **Report:** Use in Report objects (e.g. Customer Balance report).
- **Dialog:** Use in Dialog objects (e.g. Customers reupdate) or filter tables in Report objects (e.g., Customer
  Balance report).

**_Locate_**

Defines the fields that will be used to locate the data of this table according to the parent table primary key. Parent
table field data are defined using a colon following the name of the field (:FIELD).
You have the option to use only the name of the linked field, if its name is the same in both tables (parent – child).
Multiple fields and values are separated with semicolons (Figure F3. 2 ).

The main syntax for the locate statement is:
**CHFIELD1;CHFIELD2;CHFIELD3;CHFIELD4=:PRFIELD1;:PRFIELD2;Value1;Value2**

For example, if the name of the parent table field is TRDR and the linked child field name is REFOBJID, then you have
to enter REFOBJID=:TRDR


Chapter 6 – Database Designer

```
Figure F3.2
```
**_Index Fields_**

It is used in second child tables (child tables linked to child tables) to indicate the fields that define the child-to-child
relationship. The example of Figure 3.3 shows the table SNLINES which is child table to MTRLINES, which is also a
child table of the parent table FINDOC. Index field of the SNLINES table is the field MTRLINES.

```
Figure F3. 3
```
**_Primary Key_**

Read-only property that displays the primary keys of the selected table

**_Master Table_**

Use it in second child tables to indicate the name of the master child table that will be used for locating the records
of the second child table.


Chapter 6 – Database Designer

**_Master Fields_**

Use it in second child tables to indicate the fields of the master child table that define the child-to-child relationship.

**_Display Level_**

Internal use only

**_Master / Detail Relationship_**

Indicates the master – detail relationship. For example, in Sales documents the table MTRDOC has “one to one”
relationship with table FINDOC, while the table “MTRLINES” has a “one to many” relationship.

**_Auto increment Assignments_**

Internal use

**_Sort (Check=Asc/Uncheck=Desc)_**

Indicates the fields that will be used by default for sorting the records of the selected table/view.


Chapter 6 – Database Designer

#### F.4 Field Properties

Table fields inside objects have the following properties (Figure F4.1):

```
Figure F4.1
```
**_Caption_**

Sets the title of the field.

**_Forced Value_**

Indicates the forced value applied to the field. Table Field values are defined through the syntax
**:TABLENAME.FIELD**. System parameter values are defined through the syntax **:X.SYS.PARAMNAME**

**_Default Value_**

Indicates the default value applied to the field. Syntax used is the same as Forced Value.

**_Editor_**

Changes the form control that displays the data of the field using Editor Commands.

**_Decimals_**

Indicates the number of the decimal places. Specific commands (P,V,Q,%,C) can be used in order to define the use of

the company defaults for decimal places. (see Default decimal places)

**_Display size_**

Sets the default width size display of the field inside SoftOne, for use in datagrids or edit list objects.

**_Hidden field_**

If enabled then the field will not appear in the field list of the object in Browsers and Forms.

**_Display Level_**

Internal use only


Chapter 6 – Database Designer

**_Read Only_**

Specifies whether the contents of the field can change at runtime by users.

**_Required_**

Specifies whether a value for the field is required for the record to be saved (Mandatory field).

#### F.5 Calculated Fields

Apart from database fields, there is an option of creating calculated (virtual) fields that can be populated through
form script code (JavaScript or VBscript) or used as command buttons. Calculated fields are created through right
click on tables of the object and the selection of the option “Add calculated Field” (Figure F5.1).

```
Figure F5.1
```
Calculated fields created in Report Objects can be used for assigning values to other fields, through the Formula
property. Calculated field properties are the following:

**Field Type:** Indicates the type of the field (Varchar, SmallInt, Double, Date, Integer)

**Size:** Sets the size of the field

**Caption** : Sets the title of the field

**Formula** : Refers to Report Objects only. Enable the checkbox Formula. Then enter the preferred calculation in the
Formula property. If the first character of the command is **^** then the calculation will take place after totals are
calculated.


Chapter 6 – Database Designer

#### F.6 Linked Tables

Tables are linked to fields through the editor property. This gives you the ability to use any field of the linked tables
inside custom designed forms or browsers, but these fields are not available when designing the **default** browsers
or forms inside a custom object. For this reason, you need to use linked tables that make linked table fields available
for designing default browsers and forms inside custom objects.

**_Design_**

Fields are linked to tables through the right click option “ **Add Link** ” (Figure F6.1). Click on “Lock Tree” button, drag a
table from the left panel of SoftOne designer and drop it into the property “Link To Table”. Enable any of the
available fields of the table as in Figure F6.2.

Another advantage of linked tables is that if you rename the selected fields by adding the prefix **X_** then you can
refer to them as if they were database fields, so their names must be unique inside a table. This means that you can
call a linked field through form script code, by only entering the name of the table and then the name of the linked
field **TableName.X_Fieldname**.

**_Example_**

The example of Figure F6.2 links the field MTRL to the table LINEITEM. Reference to the field CODE of the linked
table LINEITEM is achieved through the use of CCCDVXREOP.X_MCODE.

Note also, that the linked tables LINEITEM and TRDR use fields with same names (CODE, NAME). Uniqueness is done
by using different field names in linked tables: X_MCODE, X_MNAME for table LINEITEM and X_TCODE, X_TNAME for
table TRDR.

```
Figure F6.1 Figure F6.2
```

Chapter 6 – Database Designer

#### F.7 Browsers Design

Objects give you the option of designing default browsers, which cannot be deleted or updated at runtime. Use the
button “Lock Tree” when needed and follow the steps below to create a default browser:

- Right click the “ **REPORT** ” node in the left pane of your custom object and select “ **Add Band** ”
- Name the band, for example MyMasterBand (Figure F7.1)
- Select a table of your object and drag & drop it into the property “ **Primary Band Table** ”.
  Note that default browsers must **always** have a Primary Band Table, for the object to work properly.
- “ **Secondary Band Tables** ” is used for browsers displaying master detail tables.
- Drag and drop the fields (columns) that the browser will display at runtime in the tab “ **Band Fields** ”
- Drag and drop the fields that will be used for sorting in the tab “ **Sort Order** ”
- Drag and drop the fields that will be used for grouping in the tab “ **Grouping** ”
- Finally, drag and drop the dialog filter fields in the tab “ **Questions** ”.
  For each field in questions tab you may also use the following properties:
  o **Field Name** : Name of the field. Fields can be added through drag and drop.
  o **From Caption** : Title that will be displayed in the dialog textbox “From”
  o **Default From Value** : Default value that will be displayed in the dialog textbox “From”
  o **To Caption** : Title that will be displayed in the dialog textbox “To”
  o **Default To Value** : Default value that will be displayed in the dialog textbox “To”
  o **Forced Value** : Defines the forced value of the field

```
Figure F7.1
```

Chapter 6 – Database Designer

#### F.8 Forms Design

Default forms can be designed using the toolbar buttons or the right click menu options. Commands are the same
as in internal objects form design (Figure F8.1).

```
Figure F8.1
```
**Add Datagrid** : Adds a new datagrid. Fields are added through drag and drop.
There is also the option of adding a Totals line at the end of the datagrid. This is only available in datagrids created
in custom objects. To enable this option, you only need to enter the field names that will be used in the Totals line,
in the textbox “ **Fields with Totals** ” (Figure F8.2).

```
Figure F8.2
```
**Add Tab** : Adds a new tab. Properties are the same as in section Screen Forms - Tabs.


Chapter 6 – Database Designer

**Add Panel** : Adds a new panel. Properties are the same as in section Screen Forms – Panels.

**Add Memo TextBox** : Adds a new memo text box. Properties are the same as in section Screen Forms – Memo
TextBox.

**Add SubForm** : Adds a new subform. Properties are the same as in section Screen Forms – SubForms.

**Add Image** : Adds a new image. Properties are the same as in section Screen Forms – Image.

**Check duplicates** : Checks for controls that use the same name.

**Add StringList** : Adds a new string list. Properties are the same as in section Screen Forms –String Lists.

**Delete** : Deletes the selected control.

There is also a toolbar button “ **Test Form** ” that lets you preview the form you have designed. After the preview, you
can return to object design through the close button in the upper right corner (Figure F8.2).

```
Figure F8.3
```
Fields can be added in a form control as long as you have enabled the toolbar button “Lock Tree”.

Inside the default form you can add a form script (JavaScript or VBscript) in the same way you add it through
“Configuration” button in designed forms. Form script is added using the node “SCRIPT” (Figure F8.4).

```
Figure F8.4
```

Chapter 6 – Database Designer

#### F.9 Display Object in Menu

Objects can be displayed in menus as jobs through the following steps:

- Save changes in SoftOne Designer.
- Synchronize the database if needed. Objects design do not need synchronization.
- Create a new job in the menu from the right click option “New job”.
- Click on the button next to the textbox “Action/File” (Figure F9.1).
- Select your object from the list.

Alternatively, you can manually select “Object process” as Job type, enter the name of the object in “Action/File” and
then the name of the job.

The object, at runtime, will be displayed as in Figure F9.2. Notice that all the tools are available.

```
Figure F9.1
```
```
Figure F9.2
```

Chapter 6 – Database Designer

#### F.10 Printout Forms

Printout forms that use tables and data from custom objects you have created through SoftOne designer can be
created using the following steps:

- Create a new job in the menu and select “Object process” as Job type.
- In “Action/File” enter the command “ **TEMPLATES.ObjectID** ”, where ObjectID is the unique ID of your object
  (Figure F10.1).
- Enter a job title and execute the job.

The printout form will be displayed as in Figure F10.2, allowing you to select from any of the available table fields
that have been defined in your object.

```
Figure F10.1
```
```
Figure F10.2
```

Chapter 6 – Database Designer

#### F.11 Object Examples

**_F. 11 .1 Object using custom table_**

The following example creates an object (CCCCUSTSHIP) that uses the custom table “Vessels” (CCCCUSTSHIP).

Create the Object through the right click option in Database Designer. Then, drag the custom table CCCCUSTSHIP
from the left panel and drop it under the Object Properties.

Enter CCCCUSTSHIP in the Object Name.

Enter the caption of the object, Vessels (Figure F 11 .1).

```
Figure F11.1
```
Create a new Band under the Report node and drag and drop the table CCCCUSTSHIP in the “Primary Band Table”
property. Drag and drop fields from the table in the “Band Fields” tab to be displayed as columns in the default
browser (Figure F11. 2 ).

```
Figure F11.2
```

Chapter 6 – Database Designer

Create Panels under the Form node and add fields in the “Available Fields” property.

Add any other tables, virtual tables etc. and add memo textboxes, grids and context menus as in Figure F11.3.

Finally, create a new job to display the object in the menu (Figure F11.4)

```
Figure F11. 3
```
```
Figure F11.4
```

Chapter 6 – Database Designer

**_F.11.2 Object using database view_**

The following example creates an object (CCCVMTRSTAT) that uses the custom database view “ _CCCVMTRSTAT_ ”.
created in the section Browser Redirection.

- Create the Object and enter the name CCCVMTRSTAT.
- Drag and drop the database view CCCVMTRSTAT under the Object Properties.
- In Parameters textbox, enter the command BROWSERONLY = 1 (Figure F11.5), that displays the object in
  browser mode only (Form design is not available).

```
Figure F11.5
```
Add a new Band in “ _Browser/Report_ ” and drag n’
drop the DB View CCCVMTRSTAT in “ _Primary
Band Table_ ”.

**If “** **_Primary Band Table_** **” is left blank, then the
object will not open and an error will raise.**

Drag n’ drop any fields inside “ _Columns_ ”, “ _Sort
order_ ”, “ _Grouping_ ” and “ _Filters_ ” of the band
(Figures F11.6 and F11.7).

If you need to add fields that are linked to a table
(e.g. X_TCODE, X_TNAME) then you have to right
click the field, add the linked table and then
select the fields (Figure F11.6). It’s better to
rename the linked fields and add the prefix X_
because this makes them available for reference
from Form script code as if they were fields of the
table (e.g. CCCVMTRSTAT.X_TCODE).


Chapter 6 – Database Designer

```
Figure F11.6
```
```
Figure F11.7
```

Chapter 6 – Database Designer

### G. Virtual Tables

Virtual Tables are cached memory tables (datasets), whose fields are created only in SoftOne designer and not in the
database. They are populated through script code and can be displayed in datagrids, in Report Objects and in
Dialog Objects. The main difference with database views is that Virtual Tables can be populated at runtime and are
also editable, while database views are populated through the data retrieved from the views of the database.

#### G.1 Design Virtual Table

Virtual tables are created through the right click option “New – Virtual Table” of SoftOne Designer. Fields are created
the same way as in tables. That is, you can use all the properties (Editors, Default values, etc.). Virtual Tables are
inserted in object forms, as tables (through Configuration window). They are populated through script code and
their columns can be displayed in form controls (e.g. datagrids) through drag and drop.

#### G.2 Virtual Table Example

The following example uses a virtual table in sales documents that displays the lines of Item sets and provides the
user the ability to edit, delete or add new records. Changes are saved in Item sets.

- Create a Virtual Table through right click pop up menu in SoftOne Designer.
- Insert the fields ITELINESMTRL, MTRL, QTY, PRICE as in Figure G 1.
- Enter ITEM in the editor property of the field MTRL, to link the field with Items.
  Field QTY will be used to display the item sets quantities.

```
Figure G1
```

Chapter 6 – Database Designer

- After synchronizing the database, open the sales documents object in design mode.
- Use the configuration window to add the virtual table, through the “User defined tables” tab (Figure G2).

```
Figure G2
```
In the tab “Script” of the configuration window enter the code below, which populates the virtual table with the lines
of the item set. It also uses the command X.SETPROPERTY('MERGECHANGELOG', 'True'), to save the changes and
deactivate the “Save” button.

**function** ON_LOCATE **() {**
ITELINES**.** DISABLECONTROLS **;
try {**
ITELINES**.** FIRST **;
while (!** ITELINES**.** EOF **()) {**
str **=** "SELECT MTRL,QTY1,PRICE FROM SPCLINES WHERE SPCS=(SELECT SPCS FROM MTRL
WHERE MTRL=:1)" **;**
ds **=** X**.** GETSQLDATASET **(** str **,** ITELINES**.** MTRL **);**
ds**.** FIRST **;
while (!** ds**.** EOF **()) {**
CCCSPCLINES**.** APPEND **;**
CCCSPCLINES**.** ITELINESMTRL **=** ITELINES**.** MTRL **;**
CCCSPCLINES**.** MTRL **=** ds**.** MTRL **;**
CCCSPCLINES**.** QTY **=** ds**.** QTY1 **;**
CCCSPCLINES**.** PRICE **=** ds**.** PRICE **;**
CCCSPCLINES**.** POST **;**
ds**.** NEXT **;
}**
ITELINES**.** NEXT **;
}
} catch (** e **) {**
X**.** WARNING **(** e**.** message **);
}
finally {**
ITELINES**.** ENABLECONTROLS **;**
X**.** SETPROPERTY **(** 'MERGECHANGELOG' **,** 'True' **);
}
}**


Chapter 6 – Database Designer

In order to update the Item sets object with user changes, enter the code below, that runs in AFTERPOST of Sales
Documents and locates the Object of Item Sets, deletes and re-enters all lines of the Set based on the lines of the
Virtual Table of the sales documents.

Notice that DISABLECONTROLS is not used in ITELINES, because we need to iterate the virtual table CCCSPCLINES,
which is child table of ITELINES (Locate Statement ITELINESMTRL=:MTRLINES.MTRL – Figure G2). If we use ITELINES.
DISABLECONTROLS then CCCSPCLINES records will not be located while we loop ITELINES records.

**function** ON_AFTERPOST **() {**
ChangeSetLines **();
}**

**function** ChangeSetLines **() {**
//ITELINES.DISABLECONTROLS; //Disable controls should not be used when iterating child of child table
ITELINES**.** FIRST **;
while (!** ITELINES**.** EOF **()) {**
strqry **=** 'SELECT TOP 1 SPCS FROM SPCS WHERE SPCS=(SELECT SPCS FROM MTRL WHERE MTRL=:1)' **;**
ds **=** X**.** GETSQLDATASET **(** strqry **,** ITELINES**.** MTRL **);**
ds**.** FIRST **;
if (!** ds**.** EOF **()) {
try {**
ObjSPCS **=** X**.** CreateObj **(** 'SPCGPS' **);**
ObjSPCS**.** DBLocate **(** ds**.** SPCS **);**
TblSPCS **=** ObjSPCS**.** Findtable **(** 'SPCGPS' **);**
TblSPCLines **=** ObjSPCS**.** Findtable **(** 'SPCLines' **);
if (** TblSPCS**.** SPCS **==** ds**.** SPCS **) {**
TblSPCS**.** Edit **;**
TblSPCLines**.** FIRST **;
while (!** TblSPCLines**.** EOF **()) {**
TblSPCLines**.** DELETE **;
}**
CCCSPCLINES**.** FIRST **;
while (!** CCCSPCLINES**.** EOF **()) {**
TblSPCLines**.** APPEND **;**
TblSPCLines**.** MTRL **=** CCCSPCLINES**.** MTRL **;**
TblSPCLines**.** QTY1 **=** CCCSPCLINES**.** QTY **;**
TblSPCLines**.** PRICE **=** CCCSPCLINES**.** PRICE **;**
TblSPCLines**.** POST **;**
CCCSPCLINES**.** NEXT **;
}**
ObjSPCS**.** DBPost **;
}
}
finally {
}
}**
ITELINES**.** NEXT **;
}
}**

Finally, create a new datagrid in the form and add the columns of the Virtual Table as in Figure G3.

```
Figure G3
```

Chapter 6 – Database Designer

### H. Report Objects

Report Objects are used to create dynamic reports. Their difference with the designed reports is that they give you
the option of changing at runtime the column widths, captions, etc. depending on the filters.

#### H.1 Design Report Object

Reports using Report Objects are designed using database tables, virtual tables or view tables. In Report objects,
Form is used for dialog filters, while Report displays the columns.

If you use virtual tables then they must be populated through form script. Additionally, you have to add the
following commands in the object parameters:

**CODE=SoScriptCodeClt**

**SCRIPTNAME=MyScript** , where MyScript stands for the script that will be used for displaying the columns of the
report.

Create a new Report Object through the right click option of SoftOne Designer. Select “ **Report”** in the “Job Type”
property of the object. (Figure H1.1)

```
Figure H1
```
Use a virtual table for the dialog filters and select “ **Dialog** ” in its “Filled with Data from” property (Figure H2).

```
FigureH 2
```
For tables that will be used as report columns you have to use the “SQL”, “Report” or “Function” property.
You don’t have to fill in the Locate property in the tables that are used for report columns (Figure H3).


Chapter 6 – Database Designer

```
Figure H3
```
Cumulative fields can also be defined inside the report using the prefix **SUM_** followed by the name of the field. The
initial value of the field can also be defined, through the “Forced Value” property. In the example of Figure H4 the
field SUM_DEBIT will display the cumulative sum of the field DEBIT and will also have as initial value the value of the
field FBALDATA.TOBO.

```
Figure H4
```
Under the Report node of the object properties add a new band and insert the table, whose fields will be used as
report columns, in the “Primary Band Table” textbox (Figure H5).

The Band Attributes are the following:

**Numbering** : Auto increment number for each line of the report

**Page Break** : Change page on record

**Offset** : Number of empty characters

**Column Headers** : Displays the column headers (captions)

**Bottom Line** : Graphical line that separates records

```
Figure H5
```
Fields entered in the tab “ **Band Fields** ” of the form node have the following properties (Figure H6):


Chapter 6 – Database Designer

**Title** : Column header caption.
Master headers are declared using the following steps in the “Title” property of the first column:
**ColumnName@MasterName:NumberofColumns**

- **ColumnName** : Name of the table field
- **MasterName** : Sets the name for the master (merged) column
- **NumberofCcolumns** : Number of merged columns for the master column

**Size** : Sets the width size of the column

**Debit / Credit** : Calculates the debit / credit according to the value sign

**Totals** : Displays the totals for a field. Mandatory for fields used in cumulative fields.

**Transfer Value** : Totals will be printed in each page.

```
Figure H6
```
The following function SetBandXProperty is used for changing the attributes of the field and has the following
parameters:

**function SetBandXProperty(Params1,Params2,Params3,Params4)**

**Params1** : Band

**Params2** : Band Caption

**Params3** : Property Type (1=Caption, 2=Width.Decimals, 4=Visible, 7=HasSums, 8=DebCred, 9=Transfer)

**Params4** : Property Value


Chapter 6 – Database Designer

#### H.2 Report Object Example

The following example creates a Report, that displays data from different SQL queries, depending on the filter
selection. That is, using the filter Sodtype (Module) and selecting either Customers or Items, the respective data are
displayed, with concurrent change of the captions and the number of columns.

Create a virtual table named CCCVTFILTERS, which will be used for the filters of the report.
This report uses one filter only, so the filter table will have only one field, SODTYPE (Title: Module) displaying only
the customers and items, thus, you must enter in Editor property the command $SODTYPE(W[13,51]) (Figure H3).

```
Figure H3
```
Createa virtual table named CCCVTDISPLAY, which has the columns that will be displayed in the report (FigureH4).

```
Figure H4
```
Create a Report Object and enter the parameter commands (Figure H5):
CODE=SoScriptCodeClt
SCRIPTSOURCE=SOIMPORT
SOIMPORT=SOIMPORT,CODE,SOIMPORT
SCRIPTNAME=CCCMTRLTRDR (the script that will be executed and create the report)

Insert the SBSL script as in Figure H 6 , which in this example executes different SQL queries to display columns
according to the "Module" filter.

The commands used in CallPublished to change the attributes of the report grid are shown in Figure H7.


Chapter 6 – Database Designer

```
Figure H 5
```
```
Figure H 6
```
```
Figure H 7
```

## 7. Extra Tools

#### A. Auto Login from Windows Shortcut

#### B. Maximum Entries per Module (Select Top)

#### C. Menu Jobs


Chapter 7 – Extra Tools

### A. Auto Login from Windows Shortcut

The application allows you to automatically login to a specific database, with a specific user, company and branch,
using only a Windows shortcut.

#### A.1 Create a Windows Shortcut

Autologin works by adding the switch /XCO:xcopath to SoftOne application shortcut. First you need to create a
shortcut for SoftOne file Xplorer.exe and then alter its “target” textbox by entering the path of a XCO file that
includes the database login information.

You can copy the XCO file in the SoftOne folder and then add the target command as in Figure A1.
C:\Soft1\Xplorer.exe /xco:"C:\Soft1\MyCompany.XCO"

```
Figure A1
```
#### A.2 Configuration of XCO connection file

**_A.2.1 On-Premise Installations_**

Auto login is activated only if you manually add a section [LOGIN] inside the connection file XCO using the following
commands.

**XCO File**

**[LOGIN]**
USERNAME **=** xxx
PASSWORD **=** xxx
COMPANY **=** xxx
BRANCH **=** xxx


Chapter 7 – Extra Tools

**_A.2.2 Cloud Installations_**

Auto login in cloud installations is done by adding a section [LOGIN] inside the Params.cfg file, as in on-premise
installations and also adding the command **GO=1** in order to work properly.

**Params.cfg File**

**[SAAS]**
SaasInstallation **=** SaasInstName (use any name)

**[SaasInstallation]**
USERNAME **=** xxx (serial number of the installation)
PASSWORD **=** xxx
DONTSHOWAGAIN **=** 1

**[LOGIN]**
USERNAME **=** xxx
PASSWORD **=** xxx
COMPANY **=** xxx
BRANCH **=** xxx
GO **=** 1

Auto login in cloud installations can also be done using a .xco file as in on-premise installations, by adding a [SAAS]
section as in the following example (A.2.3 – MyLocalXco.xco) and using also the switch /xco:C:\...\MyLocalXco.xco in
the application shortcut.

**_A.2.3 Schedule Jobs – Cloud Installations_**

Job scheduling is done using a txt file that describes the SoftOne job, as in the following example (MyJob.txt). The
path of this file is used inside the application shortcut after the switch **/execute**.
**Example:** C:\...\xplorer.exe /execute:C:\...\MyJob.txt
The Params.cfg file is not needed, because its sections are described inside the xco file.

Note that when you use autologin for scheduling SoftOne jobs it is preferred to use the switch **/noversion** in the
application shortcut, so as to avoid job interruptions when new versions are released. In this case, the SoftOne folder
that is used for scheduling jobs can be manually synced.

**Attention** : Inside the xco file, always use the **plain text** password of cloud installation and not the encrypted one.

**MyLocalXco.xco**

**[SAAS]**
SERVER **=** SAAS.AZURE.ONCLOUD.GR
USERNAME **=** xxx (serial number of the installation)
PASSWORD **=** xxx **(plain text – not encrypted)**
DONTSHOWAGAIN **=** 1

**[LOGIN]**
USERNAME **=** xxx
PASSWORD **=** xxx
COMPANY **=** xxx
BRANCH **=** xxx
GO **=** 1

**MyJob.txt**

TYPE **=** BATCH
OBJECT **=** CLIENTIMPORT,SCRIPTNAME:MYJOB
XCOFILENAME **=** MyLocalXco.xco


Chapter 7 – Extra Tools

#### A.3 XCO file Commands

In XCO file you can also add other commands, which affect the way SoftOne is displayed.

**_HIDEBAR = 1_**

Hides the main toolbar (Back – Forward - History - Menu selection...)

**_HIDEMENU =1_**

Hides the user menu. It is usually combined with the command that displays an object after autologin (e.g.
EXEC=RETAILDOC)

**_HIDEXPLORER = 1_**

Minimizes the application to Windows tray. It is usually used with the object you wish to display after login, hiding
the form of the application (e.g. EXEC=SALDOC)

**_EXEC = Objectname_**

Opens the “Objectname” object after autologin (e.g. Sales, Customers, Items, e.t.c.).
You can also use any of the EXEC commands when opening an object (Menu Job Parameters).

The following example opens the Retail Documents object in a new entry, in Fullscreen and hides the Related jobs.
EXEC=RETAILDOC[FORM=RETAIL, AUTOEXEC=2, MAXIMIZE=1, RELJOBS=0]


Chapter 7 – Extra Tools

### B. Maximum Entries per Module (Select Top)

#### B.1 Overview

The utility "Select Top" can be used to specify the number of entries that can be displayed per object.
This means that by adding the command “ObjectName = x" to this tool, all the fields that link to this object (editors)
including the browser of the object, display only the first x rows that meet the condition filters.

The above operation is done by executing the “SELECT TOP x” clause in the SQL statements of the object primary
table. This can improve the performance of the application as long as it is used in a proper way.

#### B.2 Object Usage

" _Select Top_ " tool is opened by inserting a new job in the menu, using as job type "System Tools" and command
" **ACMD:ACSELECTTOP** " (Figure B 2 .1).

When running the above job, a blank window will be displayed, where you can define the objects that the "Select
Top" will be applied, as well as the number of the entries that will be displayed (Figure B 2 .2).

After completing the above process, you can check that is working properly by opening one of the objects defined
inside the “Select top” tool and running its browser. Note that it displays only the number of records that you have
set in the "Select Top" window. You can also view the SQL statement through the SQL Monitor tool.

```
Figure B 2 .1
```
```
Figure B 2. 2
```

Chapter 7 – Extra Tools

Notice that when you run a browser or a selector that uses any of the above objects then the SQL statement will use
the SELECT TOP entries defined in the previous step (e.g. ITEM – Figure B2.3).

```
Figure B 2 .3
```
#### B.3 Browser Usage

Objects inserted in the tool " **_Select Top_** " affect all the controls that the object is displayed (browsers, reports,
editors). However, there are a lot of times where you need to deactivate it or change the number of select records in
a browser or report. To achieve this, you need to create a filter that lets the user select the number of records that
will be displayed (null = All records). Follow the steps below:

- Create a user-defined field and type the command **SELECTTOP** in column “Name”.
- Select “ **_Question_** ” in the column “ **_Operation_** " and " **_Number_** " in column “ **_Field type_** ” (Figure B3.1).

```
Figure B 3. 1
```

Chapter 7 – Extra Tools

- Insert the defined field in the filters of the browser.
- Open the object and notice that the browser filters are displayed as in Figure B 3. 2.

```
Figure B 3. 2
```
- Enter a value in Filter “Max Entries” and run the browser (Figure B3.3).

```
Figure B 3. 3
```
All the records of the object are displayed if you leave the “Max entries” filter field **blank**.

**Note** : The " **_SELECTTOP_** " user-defined field can be used in any browser or report even if there is no reference for its
object inside the "Select Top" tool (Section B. 2 ).


Chapter 7 – Extra Tools

### C. Menu Jobs

The application allows you to configure the menu by creating jobs that open objects (Sales documents, Customers,
Items) using specific browsers, forms, templates etc. and not the default ones. They also give you the option of
adding some extra commands such as locking the Toolbar, opening in insert mode, use specific template etc.

These jobs might be used in custom group or user menus in a way that each group or user can be set to view
different browsers and forms for the same object.

User Menus are saved in the blob field SODATA of the table CSTINFO (CSTTYPE=7).

**Select * from** cstinfo where sotype **=** 802 and sodefault **=** 0 and csttype **=** 7 and cstname **=** name
and cstinfo **=** 0 and name **=** 'UserName'

#### C.1 Create Job

The easiest way to create a job with a specific browser and form is to open an object, select the desired browser and
form and then drag the tab and drop it in the menu (left pane).

Alternatively, you can do the following:

- Right-click the menu panel and select "New Job" (Figure C1.1).
- In " **Job type** " select "File Processing" for application objects or "Table processing" for memory tables.
  Job parameters are discussed in the next section.
- In " **Order/File** " type or select an object (i.e. ITEM). For memory tables add the symbol $ before the name of the
  table (e.g. $DISTRICT).

The tab “Properties” allows you to set if the job will open automatically on login and if users are permitted to close
the job (Figure C1.2).

```
Figure C1.1
```
```
Figure C1. 2
```

Chapter 7 – Extra Tools

#### C.2 Job Types

The available job types are the following:

**_Object (Edit Master)_**

It is used to open an application object (e.g. SALDOC)

**_Table processing_**

It is used to call a memory table (e.g. $DISTRICT). Memory tables do not have browsers and forms.

**_Report_**

It is used to call an application report
**Example**

**_Job that opens the designed report named “MYREPORT”_**

REPORTGEN [LIST=MYREPORT]

**_Batch Job_**

It is used to open batch jobs: Dialog objects or SBSL scripts.
**Example**

**_Job that opens the SoftOne script named “myscript”_**

FORMIMPORT,SCRIPTNAME:MYSCRIPT

**_Web Page_**

It is used for opening a Webpage

**_Other files_**

It is used for opening files of the computer

**_File list_**

It is used for opening a folder of the computer

**_System Tools_**

It is used for opening Softone internal tools
**Example**

**_Job that opens the SoftOne tool “SELECTTOP”_**

ACMD:ACSELECTTOP

**_Qlik View_**

It is used for opening Qlik View files

**_Dll Form_**

It is used for calling forms from dll files
**Example**

**_Job that opens the form “MyMainForm” from the file “Mydll.dll” (file is in the application folder)_**

.Mydll.dll;MyMainForm


```
Chapter 7 – Extra Tools
```
#### C.3 Menu Job Parameters – Menu Commands

```
The following table shows the available menu commands:
```
```
Menu Commands
```
**Command Operation**

**AUTOEXEC= 1** Runs the browser using the default filters.

**AUTOEXEC=2** Opens an object in insert mode (new entry).

**AUTOLOCATE=HeaderID** Locates an object using the given id.^
**Example:** SALDOC[AUTOLOCATE=620]

**BROWSERONLY=1** Opens an object displaying only its browser.

**CUSTOM=0** Locks the toolbar of the object. Use this command when you want to
prevent the user from selecting from the available browsers and forms.

**EXTRALOCATE=LineID**

```
Locates a datagrid record using the given id. Combined with AUTOLOCATE.
Example: SALDOC[AUTOLOCATE=620,EXTRALOCATE=5]
(FINDOC=620, MTRLINES=5)
```
##### FORCEFILTERS =

**filedname1:fieldvalue1?
filedname2:fieldvalue2**

```
Runs the browser with the filters specified.
Example:
CUSTOMER[LIST=MyList,AUTOEXEC=1,FORCEFILTERS=CODE=000-00*?
DISTRICT=Athens]
```
##### FORCEVALUES =

**filedname1:fieldvalue1?
filedname2:fieldvalue2**

```
Opens the form of the object in a new entry with the values specified
Example:
CUSTOMER[AUTOEXEC=2,FORCEVALUES=TRDCATEGORY=3000?TRDBUSIN
ESS=1]
```
**FORM=FormName** Opens the form named “FormName”.

**LIST=ListName** Opens the browser named “ListName”.

**MAXIMIZE=1** Opens the window in Full Screen mode.

**NOGRIDTOOLBAR =1** Hides the toolbar of all the grids inside a form.

**NOTOOLBAR=1** Hides the main toolbar of the given object.

**NOSIDEBAR=1** Hides the sidebar (browsers, forms, tools) of the given object.

**PHOTO=MyPhoto** Opens an object in insert mode using a specific template (MyPhoto).

**RELJOBS= 0** Hides the Related jobs of the given object.

**SELECTION=Name**

```
Opens the object in Browse mode using the given pre-selected list (of
records)
```
**STYLE=MODAL** Opens an object in Modal mode

**STYLE=MODELESS** Opens an object in Modeless mode (new Tab)

##### STYLE=NEW

```
Opens an object in insert mode using Modal window (Save/Cancel buttons)
Example:
SALDOC[STYLE=NEW,FORCEVALUES=SERIES=7062?COMMENTS=TEST]
```
**SELECTION=Name** Runs the browser using the selected predefined list


```
Chapter 7 – Extra Tools
```
```
Menu Commands
```
**Command Operation**

##### EDITOPTIONS=NOINSERT

```
Prohibits adding a new entry and hides the toolbar button “New”
Example: SALDOC[EDITOPTIONS=NOINSERT]
```
##### EDITOPTIONS=NOINSERT

```
Prohibits adding a new entry and hides the toolbar button “New”
Example: SALDOC[EDITOPTIONS=NOINSERT]
```
##### EDITOPTIONS=NODELETE

```
Prohibits entry delete and hides the toolbar button “Delete”
Example: SALDOC[EDITOPTIONS=NOINSERT?NODELETE]
```
##### EDITOPTIONS=READONLY

```
Disables editing the data of an entry
Example: CUSTOMER[EDITOPTIONS=READONLY,AUTOLOCATE=55]
```
**EDITOPTIONS=NOBROWSER** Hides^ the^ browser of an object and the toolbar button "Browser"^
**Example:** SALDOC[EDITOPTIONS=NOBROWSER?NOINSERT?NODELETE]

**EDITOPTIONS=ONEROW** Displays an EditList object in “one record” mode

##### EDITOPTIONS=NOPRINTFORM

```
Disables Form printing and hides the toolbar button “Print Form”
Example: SALDOC[EDITOPTIONS=NOPRINTFORM]
```
##### EDITOPTIONS=NOPRINTBROWSER

```
Disables Browser printing
Example: SALDOC[EDITOPTIONS=NOPRINTBROWSER]
```
##### EDITOPTIONS=NOPRINTLABEL

```
Disables label printing (from browser right click menu)
Example: SALDOC[EDITOPTIONS=NOPRINTFORM?NOPRINTLABEL]
```

Chapter 7 – Extra Tools

#### C.4 Examples of Menu Jobs

Examples of the use of extra commands when running menu jobs are provided below.

```
Figure C 4. 1 – Specific Browser and Form
```
```
Figure C 4. 2 – Lock Vertical Toolbar Browsers and Forms
```
```
Figure C 4. 3 – Run the Browser using default filters
```
```
Figure C 4. 4 – Open the form in new record using a specific template (photo)
```

Chapter 7 – Extra Tools

## 8. Scheduler & Messages

#### A. Remote Server

#### B. Windows Scheduler

#### C. SoftOne Scheduler

#### D. Messages – Reminder


Chapter 8 – Schedule Tasks

### A. Remote Server

Remote Server is a SoftOne server that can execute application jobs, such as scheduled emails, SMS, batch and
reports. Examples of jobs you can run through remote server are the following:

- Send emails through EDA (Alerts)
- Send SMS through EDA (Alerts)
- Run a report and export the result in any supported format
- Run a report in any available printer and send a confirmation message.
- Run a report, route the result to a cell phone or an e-mail and sent to the originator a confirmation message.
- Run a batch job.

**Note:** Remote Server uses one SoftOne license for running and executing the above jobs.

```
Figure A1
```

Chapter 8 – Schedule Tasks

#### A.1 Activation

Open Remote Server using the settings menu: Tools → System → Remote Server → Run and follow the steps below
to activate it.

- Use button “ **Add device** ” and select " **Database** " to activate the use of Remote Server for the current Database.
- Enable the option “ **Auto activation** ” and then press the button “ **Activation** ” (Figure A1.2).
- Select any other device (GSM Phone, E-mail) you need to activate, fill in the parameter fields and then select
  the button “ **Save config** ” to save the configuration settings as in Figure A1. 3.

```
Figure A1. 2
```
```
Figure A1. 3
```

Chapter 8 – Schedule Tasks

#### A.2 Remote Server Commands

All commands that can be used for running specific commands through the Remote Server menu are displayed in
the table below.

```
Remote Server Commands
```
**Command Parameters Operation**

##### TYPE

##### REPORT, BATCH, DIALOG, DESIGN, ANSWER,

##### REPORTLIST, BATCHLIST, PRINTERLIST,

##### COMPANYLIST, BRANCHLIST

```
Job type
```
**OBJECT** Object selection (i.e. CUSTOMER)

**JOBNAME** Name of Browser or designed Report

**PHOTO** Template name

**AUTOEXECUTE** 0,1 (e.g. AUTOEXECUTE=1) Auto run

##### OUTPUT

```
928, 437, EXCEL, WORD, METAFILE, PDF File,
PrinterName Sends^ Job Results to a specific File or printer^
```
**FILENAME** Name of the File for saving the results

**SENDTO** MAIL, GSM Send Results to Email or Cell phone

**MAILADDR** Email Address

**GSMNUM** Cell phone Number


Chapter 8 – Schedule Tasks

#### A.3 Send SMS - Email

First thing you have to do in order to send messages using a cell phone from within the application is to setup and
recognize the cell phone in Windows (using drivers).

Then select GSM Phone in the left pane and inside the property " **GSM port** " enter the Windows Com port where the
cell phone is connected.

Inside the textbox “ **Number** ” enter the number of the connected phone, which will be used to send SMS. Finally,
enable the parameter " **Auto activation** " and press “ **Activation** ” (Figure A3.1).

```
Figure A3.1
```
You can display the “in-progress” messages and jobs or the ones that are processed, using the menu "Remote
Server → Scheduled commands" (Figure A3.2).

```
Figure A3.2
```

Chapter 8 – Schedule Tasks

You also have the option to schedule messages or batch jobs (Figure A3.3).

```
Figure A3.3
```
Remote Server can also be used to run any of the jobs you have created inside EDA (Alerts) and have as their type to
send messages to email or user cell phones. The process is very simple, requiring only the activation of the devices
(email or SMS) through the Remote Server, and the creation of EDA (Alerts) using email or cell phone types.


Chapter 8 – Schedule Tasks

**Example**

**_Send multiple SMS messages to customers using fields from TRDR table._**
Select one or more customers from the customers’ browser. Then, from the right-click pop up menu click on the
option " **Send SMS** " (Figure A3.4).

```
Figure A3.4
```
From the window that is displayed, select the button " **Fields** " and drag n drop the field Phone01 from customers in
the field Recipient. Of course, you can enter the number directly if you wish to send a message to a specific phone
number. In the textbox "Message" enter the message to send. However, you can use and drag in it any of the
available fields. Finally, click the button "Send" to send the message.

```
Figure A3.5
```

Chapter 8 – Schedule Tasks

### B. Windows Scheduler

#### B.1. Overview

Jobs running from Remote Server or SoftOne Scheduler can also run through Windows Scheduler, following the
steps below, that are analyzed in the next sections:

- Create a text file which includes the SoftOne job
- Add AutoLogin section inside the XCO connection file with
- Create a Windows Scheduler task that runs SoftOne application using the SoftOne job.

All actions executed using the above mechanism, as well as the execution errors, are kept in a log file named
**XECUTOR.LOG** which is created in the log folder of the program profile directory: C:\ProgramData\SoftOne\Log

Windows Scheduler execution requires that the option "Enable Scheduler/Messages" in SoftOne System Settings is
not activated (Figure B1).

```
Figure B1
```

Chapter 8 – Schedule Tasks

#### B.2 Job File

The SoftOne job that will be used to run through Windows scheduler must be added inside a text file. Create a .txt
file and then enter the SoftOne job commands or copy them from a SoftOne Scheduler job. Add also the parameter
XCOFILENAME=xxx.xco which describes the name of the XCO file as in Figure B2 and save it using any name (e.g.
Soft1JobAutoRun.txt). The path of this file will be used in Windows scheduler, inside the application shortcut after
the switch **/execute**. **Example:** C:\...\xplorer.exe /execute:C:\...\Soft1JobAutoRun.txt
**JOBNAME** : Name of the job (can be any name)

**TYPE=BATCH** : Job type

**OBJECT** : Object or script to execute

**XCOFILENAME** : Name of the xco connection file

```
Figure B2
```
For **Cloud Installations** you need to create a .xco file inside the application directory as in the following example.
**Attention** : Inside the xco file, always use the **plain text** password of cloud installation and not the encrypted one.

**S1AUTOLOGIN.XCO**

**[SAAS]**
SERVER **=** SAAS.AZURE.ONCLOUD.GR
USERNAME **=** xxx (serial number of the installation)
PASSWORD **=** xxx **(plain text – not encrypted)**
DONTSHOWAGAIN **=** 1

**[LOGIN]**
USERNAME **=** xxx
PASSWORD **=** xxx
COMPANY **=** xxx
BRANCH **=** xxx
GO **=** 1

The Params.cfg file is not needed, because its sections are described inside the xco file.

Note that when you use autologin for scheduling SoftOne jobs it is preferred to use the switch **/noversion** in the
application shortcut, so as to avoid job interruptions when new versions are released. In this case, the SoftOne folder
that is used for scheduling jobs can be manually synced.


Chapter 8 – Schedule Tasks

#### B.3 XCO Connection File

The connection file XCO must necessarily be located within the application folder.

Inside this file you need to add the section [LOGIN] (Figure B16), in order for the Windows Scheduler Task to auto
Login to a specific database using a specific user, company and branch and then execute the selected job. You can
use any text editor to open the XCO files.

```
Figure B16
```

Chapter 8 – Schedule Tasks

#### B.3 Windows Scheduler Task

Create a task in Windows Schedule using the following steps:

**_B.3.1 Windows XP_**

Open Windows Scheduler: Control panel → Scheduled task

Insert a new Task in Windows Scheduler (Add Scheduled Task) (Figure B3)

```
Figure B3
```
Use the button “Browse” to locate the application folder and then the file “Xplorer.exe” (Figure B4)

```
Figure B4
```
Select a name for the task and the execution intervals (Figure B5).

In the next window, enter the user credentials (Figure B6).

```
Figure B5 Figure B6
```

Chapter 8 – Schedule Tasks

In the last window select the option “Open advanced properties” (Figure B7)

Click "Finish" to display the window shown in Figure B8.

Inside the textbox “Run”, after the path of Xplorer.exe file, enter the switch parameter
/EXECUTE:C:\TEST\Commands.TXT

```
Figure B7 Figure B8
```
**_B. 3 .2 Windows 7_**

Open Windows Scheduler: Control panel → Administrative Tools → Task Scheduler (Figure B9)

Create a new task, either through right-click, or through panel Actions → Create Basic Task. (Figure B10)

```
Figure B9 Figure B10
```

Chapter 8 – Schedule Tasks

Enter a name and description for the task (Figure B11).

```
Figure B11
```
In the next window select the execution intervals (Figure B12).

In the next window, select “Start a program” (Figure B13)

```
Figure B12 Figure B13
```
Use the button “Browse” to locate the application folder and then the file “Xplorer.exe” (Figure B14)

In the same window inside the textbox “Add arguments (optional)" enter the switch parameter
/EXECUTE:C:\TEST\ENTOLES.TXT that will be executed after launching SoftOne.

The last window displays a summary of the actions that will run when executing this Task (Figure B15).

```
Figure B14 Figure B15
```

Chapter 8 – Schedule Tasks

### C. SoftOne Scheduler

SoftOne Scheduler is a tool for scheduling SoftOne jobs (Browsers, Reports, etc.) which can run at a specific time
and day from a specific user and repeat within specific time interval. It is located Tools-System-Scheduled Jobs
menu (Figure C1). When you open the Scheduler tool then a browser is displayed with all the scheduled tasks.
Scheduler messages are activated from the “System Settings” option “Enable Scheduler / Messages” (Figure C2).

```
Figure C1
```
```
Figure C2
```

Chapter 8 – Schedule Tasks

#### C.1 CreateTask

While in Scheduler browser, click on the button “New” to create a new scheduler task (Figure C1.1).

Available options are the following:

**Insert date** : Inserted automatically using the insert date of the task (Login Date).

**Inserted by** : Inserted automatically using the insert user of the task (Login User).

**Executed by** : Sets the user that will run the task.

**Recurrency** : Recurrency of the task (Figure C1.2).

**Restart(Minutes)** : Time for restarting the job.

**Auto run:** "Yes" → Displays the task to the user and runs it automatically, "No" → Displays the task and waits for
user reaction.

**Date of Last Run** : Displays the last execution date.

**Next Run** : Displays the next execution date.

**Processed** : "Yes" → If the task has been executed, "No" → If the task is not yet executed, or if the task is scheduled
to run at regular intervals.

**Select report/printout** : Select from the available browsers, design reports and open reports (Figure C1.3).

**Select Job** : Select from the available jobs of the application (Figure C1.4).

Figure C1.1 shows an example of scheduling the batch job "Batch modification of sales prices".

**Note** : When inserting a new task some properties are auto filled from SoftOne. You may delete any property you do
not need. For example, if you wish to run an object but you don’t want to use a certain template (photo) then delete
the line PHOTO=.

```
Figure C1.1
```

Chapter 8 – Schedule Tasks

```
Figure C1.2
```
```
Figure C1.3 Figure C1.4
```

Chapter 8 – Schedule Tasks

#### C.2 Scheduler Commands

You can use extra commands when creating a task in Scheduler. All the available commands are displayed in the
table below, which are similar to the Remote Server commands.

```
Scheduler Commands
```
**Command Parameters Operation**

**TYPE**
REPORT, BATCH, DIALOG, DESIGN, ANSWER,
REPORTLIST, BATCHLIST, PRINTERLIST,
COMPANYLIST, BRANCHLIST, BAM

```
Job type (Figure C2.1)
```
**OBJECT** Object selection (i.e. CUSTOMER)

**JOBNAME** Name of Browser or designed Report

**PHOTO** Template name

**AUTOEXECUTE** 0,1 (e.g. AUTOEXECUTE=1) Auto run

**OUTPUT** 928, 437, EXCEL, WORD, METAFILE, PDF File,
PrinterName

```
Sends Job Results to a specific File or printer
```
**FILENAME** Name of the File for saving the results

**SENDTO** MAIL, GSM Send Results to Email or Cell phone

**MAILADDR** Email Address

**GSMNUM** Cell phone Number

```
Figure C2.1
```

Chapter 8 – Schedule Tasks

### D. Messages

SoftOne messages are used for text communication between application users and they are activated (for every pc)
through the “System settings” option “Enable Scheduler/Messages” (Figure D1).

```
Figure D1
```
New messages are added from the “Messages” icon that sits in the application toolbar (Figure D2). This opens a
window that shows all pending messages. Use the button ”New” to add a new message. Then select the “Users” or
“User Groups” that will receive the message and enter the text message in the memo box.

```
Figure D2
```

Chapter 8 – Schedule Tasks

There is also an option of adding links to entity records that will display the records when clicked from recipients.
This is very useful when you need to refer to a record, because it will be easily accessed from users that receive the
message. The only thing you need to do before sending the message is right click on the preferred record (from the
object browser) and select “Attach to message” (Figure D3). This option is available in all the objects of the
application. Then, when you create a new message, the record will be auto inserted as attachment (Figure D2).

```
Figure D3
```
There is also another option of adding a message, and that is through the menu job “Company processes – Business
processes – Messages”. This opens the window of Figure D4 where you have also the option of recurrency (Time
scheduling).

```
Figure D4
```

Chapter 8 – Schedule Tasks

Pending messages are displayed through the application “Messages” icon (Figure D5). On double click of a
record, the message is displayed on a different window, along with its attachments, that allow to be redirected to
linked records (if any) (Figure D6).

```
Figure D 5
```
```
Figure D 6
```

## 9. Form Scripts

#### A. General Features

#### B. Object Methods

#### C. Object Functions

#### D. Dataset Methods

#### E. Dataset Functions

#### F. Field Events

#### G. Dataset Events

#### H. Object Events

#### I. Sub Form Events

#### J. Report Objects Events

#### K. Advanced JavaScript

#### Case Studies


### A. General Features

Form Script Engine is a very powerful tool that allows you to override SoftOne Objects functionality, execute custom
jobs through commands or events, post data to different objects, run external applications, calculate data through
different database objects, run SoftOne SBSL Scripts, make web service calls and many others that are discussed in
the following sections.

Form Scripts affect only the form that they are written, where Advanced JavaScript affects all the forms of an object.
The code of a script inside an object form is entered in Design mode, inside the “Script” tab (Figure A1).

```
Figure A 1 – Script Editor – Functions
```
#### A.1 Script Editor

All the script functions are displayed and can be easily accessed from the right-hand side of the script window.
Use **F12** to display the definition of the selected function in code. The button “ **Check** ” performs a **syntax** check of
the JavaScript code and displays the results in a message (Figure A1.1).

```
Figure A1.1 – Script Editor – Check Syntax
```

A list of SoftOne / JavaScript functions & methods is displayed when **CTRL+Spacebar** is pressed, depending on the
symbol that the cursor points inside the script code:

- After **X.** → Displays all the available object methods & functions (Figure A1.2).
- After **TableName**. → Displays all the fields of the table and all the SoftOne functions & methods that can be
  used (Figure A1.3). It also displays fields from FindTable variables (after CreateObj is used).
- On empty space → Displays all the available SoftOne Events and JavaScript functions (Figure A1.4).
- After JavaScript function → Displays JavaScript methods & properties (Figure A1.5).

```
Figure A1.2 – Script Editor – CTRL+Spacebar on X.
```
```
Figure A1.3 – Script Editor – CTRL+Spacebar on TableName.
```

```
Figure A1.4 – Script Editor – CTRL+Spacebar on empty space.
```
**Figure A1.5 – Script Editor – CTRL+Spacebar on Javascript function.**


#### A.2 Debug Javascript

SoftOne JavaScript code can be debugged using **Just-In-Time Debugger** through Microsoft Script Editor or Visual
Studio. Enable /Disable Just-In-Time debugger using the following instructions:

- Open Registry Editor (regedit).
- Add a new REG_DWORD value inside the registry path (Figure A2.1):
  " **HKEY_CURRENT_USER\Software\Microsoft\Windows Script\Settings\** "
- Name the DWORD as " **JITDebug** ". Value data **1** enables the feature, while **0** disables it (Figure A2.2).
- Once the above are completed you can add the word “ **debugger;** ” at any point of a form script (or Advanced
  JavaScript). This word functions as **breakpoint** and prompts to launch an installed editor for debugging.

**Note** : When this feature is enabled all the SoftOne Exception messages will be prompted for debug.

```
Figure A2.1 – Registry Editor – Debug Javascript
```
```
Figure A2.2 – Debug Javascript using debugger;
```

#### A.3 Global Variables

SoftOne script engine allows the usage of global variables, that can be accessed from any object or custom script.
Global variables hold their value and are accessible during application execution.

The syntax of global variables is:

**XGlobal.VariableName**

**Example 1**
**_Declare a global variable named vCustomer that stores the id of the located customer record (on Locate event
of Customers object)._**

**function** ON_LOCATE **() {**
XGlobal**.** vCustomer **=** CUSTOMER**.** TRDR **;
}**

This variable can be used in any other object (e.g. after the selection of a customer in Sales Documents).
It is prefered to check if the variable is null.
**function** ON_SALDOC_TRDR **() {
if ( (** XGlobal**.** vCustomer **!= null) && (** SALDOC**.** TRDR **>** 0 **)
&& (** SALDOC**.** TRDR **==** XGlobal**.** vCustomer **) ) {**
//Add Code Here
**}
}**

Global variables can be redefined in any script using the same way.

**Example 2**
**_Create a button inside Installations module, that copies the data of the located record (source) in a new
record (target) that is displayed on the screen. Add also, the data of the source field INST.INST inside a
custom field (INST.CCCRELINST) of the target record._**
When users locate a record of Installations, a global variable (vCurrentInst) stores the data of the located INST id.
Then, when the button (20200401) is clicked we perform a copy of the selected record and finally, we assign the
field INST.CCCRELINST with the value of the global variable vCurrentInst that was previously stored.

**function** ON_LOCATE **() {**
XGlobal**.** vCurrentInst **=** INST**.** INST **;
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20200401 **) {**
X**.** EXEC **(** 'BUTTON:NEW' **);**
X**.** EXEC **(** 'BUTTON:COPY' **);**
INST**.** CCCRELINST **=** XGlobal**.** vCurrentInst **;
}
}**


#### A.3 S1P & X.SYS

The built-in functions of the internal SoftOne library can be easily used at any point of a script through the
command **S1P.functionName**.

**var** vEasterDate **=** S1P**.** GetPasxaDate **(** S1P**.** LoginDate **));
var** vConvSeries = S1P**.** GetConvertSeries **(** 1351 **,** 7001 **)** //returns 7021;7721;7041

X.SYS parameters are populated on login and are available inside scripts using **X.SYS.ParamName**.

**var** vLoginUser **=** X**.** SYS**.** USER **;**

String variables that use quotes can also access X.SYS params with a preceding colon, as in the following example.

**var** msg **=** "Login Year is :X.SYS.FISCPRD"

**Example**
**_Form script inside Customers form that calculates data using S1P and displays a message, when users click
on button “Financial Data”. There is also another button that checks for valid Tr.No and displays the results._**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 202021 **) {
var** vTurnover **=** S1P**.** CusNetTurnover **(** CUSTOMER**.** TRDR **,**
S1P**.** FirstPeriodDate **(** S1P**.** LoginYear **,** 1 **),** S1P**.** EndOfYear **(** S1P**.** LoginDate **));
var** vBalance **=** S1P**.** CusBalance **(** CUSTOMER**.** TRDR **,** S1P**.** EndOfYear **(** S1P**.** LoginDate **));
var** vAvgBalDays **=** S1P**.** Trunc **(** S1P**.** CusAvgBalDays **(** CUSTOMER**.** TRDR **,**
S1P**.** EndOfYear **(** S1P**.** LoginDate **)));
var** vPendCheques **=** S1P**.** CusChequeBalance **(** CUSTOMER**.** TRDR **,** 1 **);
var** vOpenOrders **=** S1P**.** CusOpenOrder **(** CUSTOMER**.** TRDR **);
var** strMessage **=** "" **;**
strMessage **=** "Customer Financial Data\n"
**+** "\nTurnOver: " **+** S1P**.** ARound **(** vTurnover **,** 0.01 **)
+** "\nBalance: " **+** S1P**.** Round **(** vBalance **,** 2 **) +** " (" **+**
S1P**.** Spell **(** S1P**.** Round **(** vBalance **,** 2 **),** 1 **) +** ")"
**+** "\nAverage Balance Days: " **+** vAvgBalDays
**+** "\nPending Cheques: " **+** vPendCheques
**+** "\nOpen Orders: " **+** vOpenOrders
X**.** WARNING **(** strMessage **);
}
else if (** cmd **==** 202022 **) {
var** vValidTrNo **=** S1P**.** CusCheckAFM **(** CUSTOMER**.** AFM **);**
X**.** WARNING **(** "Tr.No is " **+ (** vValidTrNo **==** 1**?** "" **:** "not" **)+** " valid" **;
}
}**

```
Figure A3.1 – S1P Calculations
```

### B. Object Methods

This module demonstrates all the object methods you can use in form scripts through X.FunctionName.

#### BATCHEXECUTE

Runs the Batch Object

**Examples**

See Case Study 4 - Case Study 10

#### BEEP

Plays a simple beep sound

**Example**
X.BEEP;

#### CALLPUBLISHED (Library.Function:string, params)

Runs the SoftOne SBSL CallPublished function. Functions can be found in section Libraries of Chapter "SoftOne

Batch Script Language" (SBSL). Params are comma separated.

**Example 1**
**_Send SMS using the WEB SMS Account defined in Settings and the function XSendWebSMS._**
**function** SendSMS **() {**
X**.** CALLPUBLISHED **(** 'SysRequest.XSendWebSMS' **,** '0123456789' **,** 'SMS Message' **);
}**

**Example 2**
**_Case Study 12 – Auto apply ABC model on post of a record (Supplier Other Transactions)._**
//sCommand = S1Tablename+';'+dim1+';'+dim2+';'+dim3+';'+dim4+';'+dim5+
';'+dim6+';'+dim7+';'+dim8+';'+dim9+';'+dim10;
X**.** CALLPUBLISHED **(** 'ProgLibIntf.ModuleCommand' **,** X**.** MODULE **,** 10120 **,** sCommand **)**

#### CANCELEDITS

Cancels all changes made to data of an Object (Cancel entry).

**Example**
**_Prohibition - cancelation of changes for a specific user when saving an entry._**
**function** ON_POST **() {
if (** X**.** SYS**.** USER **==** 901 **)** //Checks if Login UserCode = 901
X**.** CANCELEDITS **;
}**

#### CLOSEAPPLICATION

Closes the application.

**Example**
X.CLOSEAPPLICATION();

#### CLOSEFORM

Closes the active object form.

**Example**
X.CLOSEFORM();


#### CLOSESUBFORM (SubFormName: string)

Closes sub form name “SubformName”.

**Example**
X.CLOSESUBFORM('MYSUBFORM');

#### COPY – PASTE

Copies all the data of a record (same as the toolbar button “Copy from last”).

**Example
function** CopyCustomer **(** vTRDR **) {**
XGlobal**.** vFromTrdr **=** vTRDR **;**

**var** obj **=** X**.** CREATEOBJFORM **(** 'CUSTOMER' **);
var** tbl **=** obj**.** FINDTABLE **(** 'TRDR' **);**

obj**.** DBLOCATE **(** XGlobal**.** vFromTrdr **);**
obj**.** COPY **;**
obj**.** DBINSERT **;**

// Data are altered before PASTE
tbl**.** NAME **=** "New Customer from Copy" **;**
tbl**.** RELTRDR **=** XGlobal**.** vFromTrdr **;**

obj**.** PASTE **;**
obj**.** SHOWOBJFORM **;** //Display new record on screen
**}**


#### CREATEAPPLPOPUP(ModuleHandle, 0)

SBSL (SysRequest) function that can be used in form scripts to create button sub menus (string lists) and display
them using the function **SHOWAPPLPOPUP**.

**Syntax** : X.EXEC('CODE:SysRequest. **CreateApplPopup'** , X, 0 );

**Example
var** mysubmenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'MyButtonMenu' **);
var** mypopup **=** X**.** EXEC **(** 'CODE:SysRequest.CreateApplPopup' **,** X **,** 0 **);**
X**.** EXEC **(** 'CODE:SysRequest.ShowApplPopup' **,** mypopup **,** mysubmenu **);**

See → Case Study 12

#### DBDELETE

Deletes the located record of an Object, executing all SoftOne object methods and jobs (similar to Toolbar button
“Delete”). If the object does not allow record deletion, an error is raised.

**Example 1**
**_Locate and delete a record of Purchase documents._**
**function** DeleteRecord **(** vID **) {
var** myObj **=** X**.** CreateObj **(** 'PURDOC' **);**
myObj**.** DBLocate **(** vID **);**
myObj**.** DBDelete **;
}**

**Example 2**

See → Case Study 2

#### DBLOCATE (KeyData: variant)

Locates the record containing “KeyData” value in the primary key.

**Example 1**
**_Locate a record in Sales documents and display a message._**
**function** LocateRecord **(** vID **) {
var** myObj **=** X**.** CreateObj **(** 'SALDOC' **);**
myObj**.** DBLocate **(** vID **);**
X**.** WARNING **(** 'Located record: ' + vID **);
}**

**Example 2**

See → Case Study 2


#### DBINSERT

Modifies the Object status to insert mode in order to accept new data (similar to Toolbar button “New”).

**Example 1**
**_Function that adds a new customer from any SoftOne object and displays the new id in a warning message._**
**function** AddNewCustomer **() {
var** myObj **=** X**.** CREATEOBJ **(** 'CUSTOMER' **);
var** CustTbl **;
try {**
CustTbl **=** myObj**.** FINDTABLE **(** 'TRDR' **);**
myObj**.** DBINSERT **;**
CustTbl**.** CODE **=** "000*" **;**
CustTbl**.** NAME **=** "TEST_CUSTOMER" **;
var** newid **=** myObj**.** DBPOST **;**
X**.** WARNING **(** "New Customer's ID is: "+newid);
**}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
}**

**Example 2**

See → Case Study 4

#### DBPOST

Posts the data of an Object in the database, applying all SoftOne methods (similar to Toolbar button “Save”).

**Example**
**_Function that locates a PRJC (Projects object) record, updates specific fields and posts the data._**
**function** UpdatePRJC **(** vPRJCID **,** vnewTRDR **,** vnewBOOL01 **) {**

**var** myObj **=** X**.** CREATEOBJ **(** 'PRJC;MYCUSTOMFORM' **);
var** tblPRJC myObj**.** FINDTABLE **(** 'PRJC' **);
var** tblPRJEXTRA **=** myObj**.** FINDTABLE **(** 'PRJEXTRA' **);**

**try {**
myObj**.** DBLOCATE **(** vPRJCID **);**

tblPRJC**.** TRDR **=** vnewTRDR **;**
tblPRJEXTRA**.** BOOL01 **=** vnewBOOL01 **;**

myObj**.** DBPOST **();
}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error" **+** e**.** message **);
}
}**


#### EXCEPTION (Message: string)

Displays an exception message. Cancels all jobs and stops running code.

**Example**
**_Prevent User Groups 101, 102 from saving a record._**
**function** ON_POST **() {
if ( (** X**.** SYS**.** GROUPS **==** 101 **) || (** X**.** SYS**.** GROUPS **==** 102 **) )**
X**.** EXCEPTION **(** 'No changes allowed. Save is cancelled!!!' **);
}**

#### FIELDCOLOR (FieldName: string; UserColor: integer)

Sets the back color of a control. **UserColor = (1 * Red) + (256 * Green) + (65536 * Blue)**

**Example**
**_Set color in field Item.Mtrcategory according to field value._**
**var** Colors **= {** WHITE **: [** 16777215 **],** BLUE **: [** 16711680 **],** RED **: [** 255 **],** GREEN **: [** 32768 **],**
LIGHTYELLOW **: [** 14745599 **],** YELLOW **: [** 52428 **],** BROWN **: [** 19609 **],** GRAY **: [** 12632256 **]
,** DARKBLUE **: [** 6697728 **] ,** LIGHTBLUE **: [** 16769490 **] ,** DARKRED **: [** 534458 **],** LIGHTRED **:
[** 6711008 **],** LIGHTAZURE **: [** 16776118 **],** LIGHTAZURE2 **: [** 16449439 **]
,** LIGHTBLUE2 **: [** 16769459 **],** LIGHTGREEN **: [** 14680009 **],** LIGHTYELLOW2 **: [** 10876927 **] };**

**function** ON_LOCATE **() {**
SetColors **();
}**

**function** ON_ITEM_MTRCATEGORY **() {**
SetColors **();
}**

**function** SetColors **() {
var** vColor **;
if (** ITEM**.** MTRCATEGORY **==** 101 **)** vColor **=** Colors**.** RED **;
else if (** ITEM**.** MTRCATEGORY **==** 102 **)** vColor **=** Colors**.** YELLOW **;
else if (** ITEM**.** MTRCATEGORY **==** 103 **)** vColor **=** Colors**.** GREEN **;
else if (** ITEM**.** MTRCATEGORY **==** 104 **)** vColor **=** Colors**.** BLUE **;
else** vColor **=** Colors**.** WHITE **;**

X**.** FIELDCOLOR **(** 'ITEM.MTRCATEGORY' **,** vColor **);
}**

#### FOCUSFIELD (FieldName: string)

Sets focus in “FieldName” field.

**Example**
**_In sales documents, when user adds a new item line change the focus depending on the selected series._**
**function** ON_ITELINES_NEW **() {
if ((** SALDOC**.** SERIES **==** 7003 **) || (** SALDOC**.** SERIES **==** 7023 **))**
X**.** FOCUSFIELD **(** 'ITELINES.SRCHCODE' **);
else**
X**.** FOCUSFIELD **(** 'ITELINES.X_CODE' **);
}**

#### FREE

Destroys the Object and deallocates its memory


#### INVALIDATEFIELD (FieldName: string)..............................................................................................................................................

Repaints the data in a combo box. Usually used after the method “Refresh” when data are altered using SQL update
statement.

**Example**
**_In Items object, when user selects a specific value (100) in field MTRMARK then set inactive a value of the
table MTRMANFCTR and refresh the items shown in the appropriate combo box of the form._**
**function** ON_ITEM_MTRMARK **() {**
If **(** ITEM**.** MTRMARK **==** 100 **) {**
X**.** RUNSQL **(** 'UPDATE MTRMANFCTR SET ISACTIVE=0 where COMPANY=1 AND
MTRMANFCTR=10' **, null);**
X**.** MTRMANFCTR**.** REFRESH **;**
X**.** INVALIDATEFIELD **(** 'ITEM.MTRMANFCTR' **);
}
}**

#### INCLUDE (filename: string)

Adds reference to code file (functions etc.). Use full path, when the file is saved in a specific folder or the name of
the file, when it is saved in SoftOne Custom SDK Code files.

**Example 1**
**_Include code from file saved in a specific directory._**
X**.** INCLUDE **(** 'C:\\temp\\myfunctions.txt' **);**

**Example 2**
**_Include code from file saved in SoftOne Custom SDK files._**
X**.** INCLUDE **(** 'myfunctions.txt' **);**

#### OPENSUBFORM (SubFormName: string)

Opens the Sub form named “SubFormName”

**Example**
**_Open sub form Vat Analysis by clicking on a specific button (cmd = 201805011) in sales documents_**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201805011 **)**
X**.** OPENSUBFORM **(** 'SFVAT' **);
}**

#### QUICKVIEW (ObjectName: string, ListName: string, Keydata: string)

Opens the Quick View window and displays data for the record “Keydata” of the object “ObjectName”, using the
browser “ListName”.

**Example**
**_Open the Quick View named “BROWSER1” of the module Customers, by clicking on a specific button
(cmd = 201805021 ) in sales documents_**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201805021 **)**
X**.** QUICKVIEW **(** 'CUSTOMER' **,** 'BROWSER1' **,** 'SALDOC.TRDR' **);
}**


#### PRINTDOCURL (ObjectName, FormName, RecordID, TemplateCode)

Returns a URL (valid for 10 minutes) that prints the template (TemplateCode) of the object (ObjectName) for the
record (RecordID) in PDF format and makes it available for download.
This function is usually used in Web Services, through custom web service requests in Advanced JavaScript.

Note that the above URL works only if the module “Soft1 Open Enterprise Engine” exists on the current installation.

**Example**
**_Custom web service that prints a template form in PDF and returns the URL._**
**function** PrintS1Template **(** obj **) {
return** X**.** PRINTDOCURL **(** obj**.** ObjectName **,** obj**.** FormName **,** obj**.** RecordID **,**
obj**.** TemplateCode **);
}**


#### PRINTFORM (TemplateCode: integer, PrinterName: string, FileName: string)

Prints the template that uses the code number "TemplateCode" of the current object and sends it to the printer
named "PrinterName". If the print media is “file type” you also need to define the "FileName".

**FormCode** : Code Number of the printout form
**PrinterName** : Printer name / File type

**Available File Types:** Ascii928 / Ascii437 / Word (use 928) / Excel / PDF file / XPS file / Image / HTML / E-mail

**FileName** : File path when "PrinterName" is file.

**Example 1**
**_Locate and print a record in Sales document using a specific printout form and printer._**
**function** PrintSalesRecord **() {**
ObjSaldoc **=** X**.** CreateObj **(** 'SALDOC' **);**
ObjSaldoc**.** DBLocate **(** 12345 **);**
ObjSaldoc**.** PRINTFORM **(** 100 **,** 'MyPrinterName' **,** '' **);** //FormCode=100,Printer=MyPrinterName
**}**

**Example 2**

See →Case Study 1

#### REFRESH

Refreshes the data of a combo box control

**Example**
X**.** MTRMANFCTR**.** REFRESH **;**

#### RUNSQL (ASQL: string; AParams: Variant)

Runs an action query by using the "ASQL" statement.

**ASQL** : The SQL statement to execute.

**AParams** : Array list containing ASQL Parameters

**Example**
**_Update custom table field with a specific value_**
X**.** RUNSQL **(** 'UPDATE CCCMYTABLE SET CCCMYFIELD=1 WHERE COMPANY=:1' **,** X**.** SYS**.** COMPANY **);**

#### SETDECIMALS (FieldName: string, Decimals: integer)

Sets the number of decimal digits in the field "FieldName"

#### SETDOCPRINT (PrintNum, Mode, TemplD: integer, PrinterName, Caption: string)

Prints a specific number of copies of the TempID form. Must be used under the event ON_DOCPRINT.

**PrintNum** : Number of copies

**Mode** : Method (1 = Automatically, 2 = With question)

**TemplD** : Form Code

**Printer Name** : Name of the printer

**Caption** : Window title


#### SETFIELDEDITOR (FieldName: string; Editor: String)

Changes the editor of any field that **already has a predefined editor** inside its “Editor” property.

**Example 1**
**_Change the editor of the field ITELINES.MTRL (selector list) in item lines of sales documents_**
X**.** SETFIELDEDITOR **(** 'ITELINES.MTRL' **,** 'ITEM(W[A.MYCCCFIELD=1 AND EXISTS (...)])' **);**

**Example 2**
**_Change the editor of the field MTRDOC.WHOUSE (combo box) in sales documents based on the selected series_**
**function** ON_SALDOC_SERIES **() {
if ((** SALDOC**.** SERIES **==** 7001 **) || (** SALDOC**.** SERIES **==** 7002 **))**
X**.** SETFIELDEDITOR **(** 'MTRDOC.WHOUSE' **,** 'WHOUSE(F[WHOUSE=1001])' **);
else**
X**.** SETFIELDEDITOR **(** 'MTRDOC.WHOUSE' **,** 'CCCVIEWWHOUSE' **);
}**

#### SETFIELDVALUE (FieldName: string, Value: Variant)

Assigns the new value to “FieldName” field.

**Example**
X**.** SetFieldValue **(** 'SALDOC.COMMENTS1' **,** 'MyComments' **);**

#### SETPARAM(PrmName, PrmValue);

Sets a new value in the parameter "PrmName" of the object.

**Example 1**
X**.** SETPARAM **(** 'MyParameterName' **,** X.SYS.FISCPRD **);**

**Example 2**
X**.** SETPARAM **(** 'WARNINGS' **,** 'OFF' **);**
X**.** SETPARAM **(** 'NOMESSAGES' **,** 1 **);**

**Example 3**
**_Follow-up an e-mail. Create a new object of SOEMAIL and set its parameters in such a way that it uses
“Reply” “Reply to all” or “Forward”._**
var obj = X.CREATEOBJ('SOEMAIL');
obj**.** SETPARAM **(** 'EMAIL' **,** vID **);** //vID = ID of previous email record
obj**.** SETPARAM **(** 'FOLLOW' **,** 1 **);** //1=Reply, 2=Reply to all, 3=Forward

**Example 4**
var obj = X.CREATEOBJ('PRDORDDOC');
obj**.** SETPARAM **(** 'IMPORT' **,** 1 **);**

#### SETPROPERTY ('EDITOPTIONS', 'READONLY=True/False')

Enables / Disables record editing (read-only fields) of the current object.

**Example 1**
X**.** SETPROPERTY **(** 'EDITOPTIONS' **,** 'READONLY=True' **);**

**Example 2**

See → ObjectEvents - ON_LOCATE (Example 2)


#### SETPROPERTY ('MERCHANGELOG', 'True or False')

Merges and saves any data changes, overwriting existing values. Usually used after populating a virtual table in a
view, in order to "disable" the Save button.

**Example 1**
X**.** SETPROPERTY **(** 'MERGECHANGELOG' **,** 1 **);**

**Example 2**
X**.** SETPROPERTY **(** 'MERGECHANGELOG' **,** 'False' **);**

### SETPROPERTY ('FIELD', 'FieldName', 'CAPTION', 'NewCaption')

Changes the caption of the field _FieldName_.

**Example**
X**.** SETPROPERTY **(** 'FIELD' **,** 'SALDOC.TRDR' **,** 'CAPTION' **,** 'MYNEWCAPTION' **);**

### SETPROPERTY ('FIELD', 'FieldName', 'VISIBLE', 'True/False or 1/0')

Changes the visible property of Fields in grids.

**Example**
X**.** SETPROPERTY **(** 'FIELD' **,** 'ITELINES.QTY1' **,** 'VISIBLE' **,** 'False' **);**

### SETPROPERTY ('FIELD', 'FieldName', READONLY, 'True/False or 1/0' )

Changes the read-only property of Fields.

**Example 1**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.NAME' **,** 'READONLY' **,** 1 **);**

**Example 2
function** ON_INSERT **() {**
CheckLockFields **();
}
function** ON_CANCEL **() {**
CheckLockFields **();
}
function** ON_LOCATE **() {**
CheckLockFields **();
}
function** CheckLockFields **() {
if ((** X**.** SYS**.** USER **==** 1 **) || (** X**.** SYS**.** USER **==** 2 **) )
&& (** X**.** SYS**.** ISADMIN **!=** 1 **)) {**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.CODE' **,** 'READONLY' **,** 0 **);**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.NAME' **,** 'READONLY' **,** 0 **);
}
else {**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.CODE' **,** 'READONLY' **,** 1 **);**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.NAME' **,** 'READONLY' **,** 1 **);
}
}**


### SETPROPERTY ('PANEL', 'PanelName', 'CAPTION', 'NewCaption')

Changes the caption of the panel _PanelName_.

**Example**
X**.** SETPROPERTY **(** 'PANEL' **,** 'MyPanel' **,** 'CAPTION' **,** 'NewPanelName' **);**

### SETPROPERTY ('PANEL', 'PanelName', 'VISIBLE', 'True/False or 1/0')

Changes the visible property of Panels, Tabs and Datagrids. Parameter "PANEL" is also used for Datagrids and Tabs.

**Example 1**
X**.** SETPROPERTY **(** 'PANEL' **,** 'PANEL14' **,** 'VISIBLE' **,** 'TRUE' **);**

**Example 2**
X**.** SETPROPERTY **(** 'PANEL' **,** 'MYPAGE' **,** 'VISIBLE' **,** 'TRUE' **);**

**Example 3**
X**.** SETPROPERTY **(** 'PANEL' **,** 'MYGRID' **,** 'VISIBLE' **,** 1 **);**

### TOFILE (FileName, AMessage: string)

Saves the "AMessage" text in the "FileName" file. If the file exists, then it is replaced.

### WARNING (Message: string)

Displays a warning message on the user's screen.

**Example**
**_After posting a Sales Documents (new or edit), display a warning message with the ID of the record.
The id of newly created records is returned through the function X.NEWID. So we create a custom function
GETID() that returns the ID for both new or already posted records._**
**function** GetID **() {
return** SALDOC**.** FINDOC **>** 0**?** SALDOC**.** FINDOC **:** X**.** NEWID **;
}**

**function** ON_AFTERPOST **() {**
X**.** WARNING **(** 'Posting completed, ID = ' **+** GetID **());
}**


## C. Object Functions

This module demonstrates all the object functions you can use in form scripts.

### ASK (ACaption, AMessage: string): integer.....................................................................................................................................

Displays a dialog message that displays three button (Yes, No, Cancel) and returns the index of the button: **6=Yes,
7=No, 2=Cancel**

**ACaption** : Title of the window, **AMessage** : Message displayed inside the window

**Example**
**_Confirm saving an entry._**
**function** ON_POST **() {
var** ans **;**
ans **=** X**.** ASK **(** "Confirm save" **,** "Continue ?" **);** // 6=Yes, 7=No, 2=Cancel
**if ((** ans **==** 7 **) || (** ans **==** 2 **))**
X**.** EXCEPTION **(** "Save cancelled by user" **);
else**
X**.** WARNING **(** "Yes pressed" **);
}**

### ASKYESNO (ACaption, AMessage: string): boolean

Displays a dialog message that displays the button Yes and No and returns 1 for Yes and 0 for No.
**ACaption** : Title of the window, **AMessage** : Message displayed inside the window

**Example
function** ValidateEntries() **{
if (** X**.** ASKYESNO **(** "My Title" **,** "My Question" **) ==** 1 **)**
X**.** WARNING **(** "User clicked Yes" **);
else**
X**.** WARNING **(** "User clicked No" **);
}**

### CASE (IfCase, ThenCase, ElseCase: variant): Variant;

Returns formula "ThenCase" when formula "IfCase" is true. Otherwise, it returns formula "ElseCase"

### CHECKACCESS(JobName): Boolean

Checks if Login User has access rights to JobName

**Example
function** CheckUserAccess **() {
if (** X**.** CHECKACCESS **(** "CUSTOMER" **)) {**
//Add Code here
**}
if (** X**.** CHECKACCESS **(** "FifoFinPayTerms" **)) {**
//Add Code here
**}
}**

### CONNECTIONSTATUS: string;

Returns the SoftOne connection status.
**0** =Standalone, **1** =Client, **2** =Server, **3** =SleepClient, **4** =OffLine, **5** =SaaS, **6** =ESupport


### CREATEOBJ (ObjectName: string): OBJECT (IDispatch)

Creates the "ObjectName" object and returns its IDispatch interface. In order to create an object using a specific
form use the syntax: CreateObj('ObjectName; **Myform** ').

**Example 1**
**_Create and save a sales document, while in object Customers, using current located customer record id._**
**function** CreateSales **() {
var** myObj **=** X**.** CreateObj **(** 'SALDOC;MYSALESVIEW' **);
try {**
myObj**.** DBINSERT **;
var** tblFINDOC **=** myObj**.** FindTable **(** 'FINDOC' **);
var** tblITELINES **=** myObj**.** FindTable **(** 'ITELINES' **);**

tblFINDOC**.** Edit **;**
tblFINDOC**.** SERIES **=** 7062 **;**
tblFINDOC**.** TRDR **=** CUSTOMER**.** TRDR **;**

tblITELINES**.** Append **;**
tblITELINES**.** MTRL **=** 123456 **;**
tblITELINES**.** QTY1 **=** 100 **;**
tblITELINES**.** PRICE **=** 50 **;**
tblITELINES**.** Post **;**

**var** id **=** myObj**.** DBPOST **;
if (** id **>** 0 **)**
X**.** WARNING **(** 'New id is:' **+** id **);
}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}
}**

**Example 2
function** PrintSelectedDocuments **() {
var** vSelRecs **=** X**.** GETPARAM **(** 'SELRECS' **);
var** fso **= new** ActiveXObject **(** 'Scripting.FileSystemObject' **);
var** vFolder **=** "C:\\Temp" **;
var** ObjSaldoc **=** X**.** CreateObj **(** 'SALDOC' **);**
vQueryBrowser **=** "SELECT DISTINCT FINDOC, TRDR, (SELECT CODE FROM TRDR WHERE
TRDR=FINDOC.TRDR) as TRDRCODE FROM FINDOC WHERE " **+** vSelRecs **+** " ORDER BY TRDR" **;**
ds **=** X**.** GETSQLDATASET **(** vQueryBrowser **, null);**
ds**.** FIRST **;
while (!** ds**.** EOF **) {**
vCurTrdr **=** ds**.** TRDR **;**
vCurTrdrCode **=** ds**.** TRDRCODE **);
if (!** fso**.** FolderExists **(** vFolder **+** "\\" **+** vCurTrdrCode **)) {**
fso**.** CreateFolder **(** vFolder **+** "\\" **+** vCurTrdrCode **);
}**
ObjSaldoc**.** DBLocate **(** ds**.** FINDOC **);**
ObjSaldoc**.** PRINTFORM **(** 1001 **,** 'PDF file' **,** vFolder **+** '\\' **+** vCurTrdrCode **+** '\\' **+**
ds**.** FINDOC **+** '.PDF' **);**
ds**.** NEXT **;
}
}**

**Example 3**

See →Case Study 1


### CREATEOBJFORM (ObjectName: string): OBJECT (IDispatch)

Creates an instance of the SoftOne object defined in "ObjectName" and returns its IDispatch interface.
Object’s form or list can be specified in the same way as in EXEC commands, for example:

X.CREATEOBJFORM **(** 'SALDOC[FORM=MyFormName, LIST=MyListName]' **).**

The target object’s record can be displayed on user’s screen (before posting the data) using the function
ShowObjForm instead of DBPost.

**Example**
**_Locate a record of Items entity. Add a new purchase document using the located item record id(MTRL).
Display the purchase document on screen, wait for the user to save it and then display the new id in a
message box._**
**function** CreatePurchase **() {
var** myObj **=** X**.** CreateObjForm **(** 'PURDOC[FORM=MyFormName]' **);
try {**
myObj**.** DBINSERT **;
var** tblFINDOC **=** myObj**.** FindTable **(** 'FINDOC' **);
var** tblITELINES **=** myObj**.** FindTable **(** 'ITELINES' **);**

tblFINDOC**.** Edit **;**
tblFINDOC**.** SERIES **=** 2001 **;**
tblFINDOC**.** TRDR **=** 123456 **;**

tblITELINES**.** Append **;**
tblITELINES**.** MTRL **=** ITEM**.** MTRL **;**
tblITELINES**.** QTY1 **=** 100 **;**
tblITELINES**.** PRICE **=** 50 **;**
tblITELINES**.** Post **;**

**var** id **=** myObj**.** SHOWOBJFORM **();
if (** id **>** 0 **)**
X**.** WARNING **(** 'New id is:' **+** id **);
}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}
}**


### DOUBLE (StrNum: string): real

Converts StrNum to a real number and returns the result.

### DIR (Name: string): string

Returns the "Name" directory. Returned names are:

**Soft1Data** : Soft1 Profile Directory

**UserData** : User Profile Directory

**EXE** : SoftOne Dir

**HTML** : Soft1 Web Server Dir

**SDK** : Soft1 SDK files Dir

### EVAL (Formula: string): Variant

Calculates the "Formula" and returns the result. Used primarily for executing internal SoftOne functions.

**Example 1**
DateforSQLQuery **=** X**.** EVAL **(** 'SQLDATE(SALDOC.TRNDATE)' **)**

**Example 2**
EasterDate **=** X**.** EVAL **(** 'DateToStr(GetPasxaDate(' **+** X**.** SYS**.** FISCPRD **+** '))' **);**

**Example 3
function** FillFinalDate **() {
if ((** GUARANTY**.** ISNULL **(** 'MTRL' **) ==** 0 **) && (** GUARANTY**.** ISNULL **(** 'FROMDATE' **) ==** 0 **)) {
var** vGUARTIME **=** X**.** SQL **(** "SELECT ISNULL(GUARTIME,0) FROM MTRL WHERE MTRL=:1" **,**
GUARANTY**.** MTRL **);**
GUARANTY**.** FINALDATE **=** X**.** EVAL **(** "FormatDateTime('dd/mm/yyyy'
,INCMONTH(GUARANTY.FROMDATE," **+** vGUARTIME **+** "))" **);
}
}**

**Example 4**

See → Case Study 3

### EXEC (Command: string): variant

Executes the SoftOne "Command" based on the following parameters:

**_A. Button: xxx_**

The corresponding button of the toolbar is executed. Syntax is: **X.EXEC(“button:XXX”);**
Toolbar Buttons are: Browse, View, New, Copy, Save, Cancel, Delete, Prior, Next, Print.

**Example 1**
**_Save entry_**
**function** SaveEntry **() {**
X**.** EXEC **(** 'Button:Save' **);
}**

**Example 2**
**_Cancel entry_**
**function** CancelEntry **() {**
X**.** EXEC **(** 'Button:Cancel' **);
}**

**_B. XCMD: xxx_**

- If it is followed by an integer then it runs an internal command of the application or any other custom
  command (e.g. custom form button). Syntax is: **X.EXEC('xcmd:XXX');**
  All the available internal commands can be found in ANNEX Tables


- If it is followed by a menu command (e.g. ObjectName, TableName or SoftOneScript) then it executes the
  corresponding job.
  Notice that if you need to open an object that closes automatically when user clicks on Save, then you have to
  use the parameter **,N** as in example 3.

**Example 1**
**_Display open item window inside a sales document form_**
X**.** EXEC **(** 'XCMD:1031' **)**

**Example 2**
**_Open customer_**
X**.** EXEC **(** 'XCMD:CUSTOMER' **)**

**Example 3**
**_Open new sales document from object Customers assigning the current value to field “SALDOC.TRDR”_**
X**.** EXEC **(** 'XCMD:SALDOC,N["SET FINDOC.TRDR=' **+** CUSTOMER**.** TRDR **+** '"]' **)**

**Example 4**
**_Run SoftOne SBSL script “myscript” using the parameter myparam=1._**
X**.** EXEC **(** 'XCMD:FormImport,ScriptName:myscript,myparam: 1 ' **)**

**_C. ACMD: xxx_**

Runs the xxx internal tool. All the available system tools can be found in ANNEX table “ACMD System Tools”

**Example 1**
X**.** EXEC **(** 'ACMD:acZReportSignB **)**

**_D. Script: xxx_**

Runs the script function that follows it.

**Example 1**
X**.** EXEC **(** 'Script:Myfunction' **)**

**_E. Code: xxx_**

Runs the SoftOne callpublished function that follows it. Functions can be found in the section Libraries of Chapter
"SoftOne Batch Script Language" (SBSL).

**Example 1**
X**.** EXEC **(** 'CODE:ModuleIntf.GetDataset' **,** X**.** MODULE **,** 'CCCMYTABLE' **);**

**Example 2**
**_Send SMS using the Web SMS Account defined in Settings._**
X**.** EXEC **(** 'CODE:SysRequest.XSendWebSMS' **,** '0123456789' **,** 'SMS Message' **);**


**Example 3**
**_Send email using doSendMail3._**
X**.** EXEC **(** 'CODE:SysRequest.doSendMail3' **,** strTO **,** strCC **,** strBCC **,** strSubject **,** strBodyPlain **,**
strBodyHTML **,** strAttachment **,** strFromName **,** vEmailAccount **);**

**Example 4**
**_Add menu items dynamically to the Browser Context Menu of any object._**
**function** ON_CREATE **() {
var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 910011 =Customer Financial');
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 910012 =1;Custom ReUpdate' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 910021 =1;SubJob1?MySubMenu' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 910022 =1;SubJob2?MySubMenu' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201910023=3;Displayed on Lines
Analysis Browser' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);**
// See section **G. Object Events (Example 2)
}**

**Example 5**
**_Run (include) function from SoftOne Designer. The function named ‘myFunction’ is inside the script
‘myDesignerScript’ of SoftOne Designer._**
var myDesignerScript = X.EXEC('CODE:ModuleIntf.GetTextValue','myScriptName');
X.EXEC('CODE:SysRequest.ExecuteXScript', X.Module, 1, myDesignerScript,
'myFunction'); // function inside SoftOne Designer script

**_F. Reljobs: xxx_**

Executes the related job.


### FINDTABLE (TableName: string): variant

Returns the Dataset (IDispatch interface) of the table " **TableName** ".

**Example 1**
ObjSaldoc **=** X**.** CreateObj **(** 'SALDOC' **);**
tblFindoc **=** ObjSaldoc**.** FindTable **(** 'FINDOC' **);**

**Example 2**

See → Case Study 4

### FILTERSUM (FieldName: string, Filter: string): real

Summarizes the data of the " **FieldName** " field of the given datagrid for entries that meet the " **Filter** " expression.
Use filter "1=1" when there is no need to apply any filters.

**Example 1**
**_Summarize the data of the field ITELINES.QTY1 (only for lines that MTRUNIT=1) each time users post a line._**
**function** ON_ITELINES_AFTERPOST **() {
var** TotQty1 **=** X**.** FILTERSUM **(** 'ITELINES.QTY1' **,** 'MTRUNIT=1' **);**
X**.** WARNING **(** TotQty1 **);
}**

**Example 2**
**_Check if an item already exists (double entry) in ITELINES datagrid, display a message and delete the line._**
Summarize all the MTRLs inside the datagrid, that have the same value as the one inserted, and check if this number
is greater than MTRL (id).
**function** ON_ITELINES_AFTERPOST **() {
var** vMTRLTimes **=** X**.** FILTERSUM **(** 'ITELINES.MTRL' **,** 'MTRL='+ITELINES.MTRL **);**
if (vMTRLTimes > ITELINES.MTRL) **{**
X**.** WARNING **(** ITELINES.X_NAME + ' exists more than one time!' **);**
ITELINES.DELETE;
**}
}**

### FORM: string

Returns the form name of the current object

**Example
function** ON_FORMLOAD **() {**
CheckUserAccess **();
}**

**function** ON_LOCATE **() {**
CheckUserAccess **();
}**

**function** CheckUserAccess **() {
if ((** X**.** FORM **==** 'SOACTIONDBView' **) && ((** X**.** SYS**.** USER **==** 10 **) || (** X**.** SYS**.** USER **==** 20 **))) {**
X**.** EXCEPTION **(** "\nYou do not have permissions to access the form:\n" **+** X**.** FORM **);
}
}**


### FORMATFLOAT (number: float, decimalsformat: string): string

**decimalsformat** : Number of decimals or character that retrieves company decimals (% C Q V P)

Returns the float “Value” in alphanumeric format

**Example
var** fnum **=** X**.** FORMATFLOAT **(** 1234 **,** 'V' **);**

### FORMATDATE (Dateformat: string, Date: TDateTime): string

Returns the “Date” in alphanumeric format

**Example 1**
**_Return field TRNDATE of sales documents in sqldate format._**
strDate **=** X**.** FORMATDATE **(** 'yyyymmdd' **,** SALDOC**.** TRNDATE **)** //e.g. 15 June 2018 returns 20180615

For use in sql queries:
strDate **=** String**.** fromCharCode **(** 39 **) +** strDate **+** String**.** fromCharCode **(** 39 **);**

**Example 2**
**_Return UPDDATE field of customers in specific datetime formats_**
strDate1 **=** X**.** FORMATDATE **(** 'yyyy-mm-dd HH:MM:SS' **,** CUSTOMER**.** UPDDATE **)**
strDate2 **=** X**.** FORMATDATE **(** 'yyyy-mm-dd 00:00:00' **,** CUSTOMER**.** UPDDATE **)**

### FORMATTEXT (Text: string, parameters: string): string

Returns a formatted text using the parameters defined

**Example
function** ON_POST **() {
var** vCompany **=** X**.** SYS**.** COMPANY **;
var** vUser **=** X**.** SYS**.** USER **;
var** vFiscprd **=** X**.** SYS**.** FISCPRD **;
var** str **=** X**.** FormatText **(** 'Company: {0}\nUser: {1}\nFiscal Year: {2}' **,** vCompany **,**
vUser **,** vFiscprd **);**
X**.** WARNING **(** str **);
}**

### FROMFILE (FileName: string): string

Returns the data of the file “FileName”

**Example**
X**.** WARNING **(** X**.** FROMFILE **(** X**.** DIR **(** "EXE" **)+** "\\MyText.txt" **));**

**ExecuteNetFunction(Dll FileName, Class (with Namespace), FunctionName, Params);**

SBSL Function that runs a .NET DLL Function using the defined Params.

See → SBSL - ExecuteNetFunction


### GETYEARPERIOD (ADate: TDateTime): Variant

Returns the year and the period of date "Adate"

### GETLASTERROR: string

Returns the last error message

**Example**

**function** InsertNewCustomer **() {
var** myObj **=** X**.** CREATEOBJ **(** "CUSTOMER" **);
try {
var** tblCustomer **=** myObj**.** FINDTABLE **(** "TRDR" **);**
myObj**.** DBINSERT **;**
tblCustomer**.** CODE **=** "*" **;**
tblCustomer**.** NAME **=** "TEST_CUSTOMER" **;**
newid **=** myObj**.** DBPOST **;**
X**.** WARNING **(** "New Customer ID is:" **+** newid **);
}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}
}**

### GETPARAM(PrmName)

Returns the value of PrmName of the object

**Example 1**
X**.** GETPARAM **(** 'MyParameterName' **);**

**Example 2
function** ON_CREATE **() {**
X**.** GETPARAM **(** 'SOSOURCE' **);
}**


### GETPROPERTY('CUSTOMFIELDS, TABLENAME '): string

Returns the custom fields of the defined table**.** Returned data are separated by semicolons.

**Example 1**
**_Button inside Sales Documents that displays the custom fields of tables FINDOC and MTRLINES_**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 202007133 **) {** //Get Findoc-Mtrlines Custom Fields
**var** vCustomFieldsFindoc **=** X**.** GETPROPERTY **(** 'CUSTOMFIELDS,FINDOC' **);
var** vCustomFieldsMtrlines **=** X**.** GETPROPERTY **(** 'CUSTOMFIELDS,MTRLINES' **);**
X**.** WARNING **(** "Custom Fields\n\nFINDOC: " **+** vCustomFieldsFindoc **+** "\nMTRLINES: " **+**
vCustomFieldsMtrlines **);
}
}**


### GETPROPERTY('MASTERTABLENAME'): string

Returns the name of the master table for the current object.

**Example 1**
**_Button inside Sales Documents that displays the Master Table Name._**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 202007134 **) {** //Get Master Table Name
**var** vMasterTableName **=** X**.** GETPROPERTY **(** 'MASTERTABLENAME' **);**
X**.** WARNING **(** vMasterTableName **);
}
}**


### GETPROPERTY('HASCHANGES'): boolean

Returns true when record is on edit mode (record has pending changes and Save button is activated).

**Example 1**
**_Button that checks whether the record has pending changes._**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 202007135 **) {** //Check if on edit mode
**var** vPendingChanges **=** X**.** GETPROPERTY **(** 'HASCHANGES' **);**
X**.** WARNING **(** vPendingChanges **);
}
}**


### GETPROPERTY('GRIDSELECTED: GRIDNAME | FIELDNAME '): string

Returns the **FIELDNAME** values of the **selected rows** for the **GRIDNAME** grid. Returned data are separated by \r\n.

**Example 1**
**_Add a new option inside the pop-up menu of Sales Documents item lines grid (MAINGRID), that returns the
selected MTRL in a warning message. Display also the data of the first selected record in message box._**
**function** ON_CREATE **() {**
ChangeContextMenus **();** //Change context menu items
**}**

**function** ChangeContextMenus **() {**
//===== Items Grid Menu ======//
**var** vGridMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'GRIDMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenu **,** '-=-' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenu **,** '201707195=Relative campaigns' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenu **,** '201707196=Lots availability' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenu **,** '201907131=Grid Selected Items' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'GRIDMENU' **,** 0 **);
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201907131 **) {** //Grid Selected Records
**var** selectedMTRL **=** X**.** GETPROPERTY **(** 'GRIDSELECTED:MAINGRID|MTRL' **);**
X**.** WARNING **(** selectedMTRL **);
var** ArraySelMtrl **=** selectedMTRL**.** split **(** "\r\n" **);
if (** ArraySelMtrl**.** length **>** 0 **)** X**.** WARNING **(** ArraySelMtrl **[** 0 **]);
}
}**


**Example 2**
**_Add a new option inside the pop-up menu of Sales Documents service lines grid (MAINGRID 121 ), that
displays a warning message with the selected service descriptions (X_NAME)._**
**function** ON_CREATE **() {**
ChangeContextMenus **();
}**

**function** ChangeContextMenus **() {**
//===== Services Grid Menu ======//
**var** vGridMenuSrv **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'SRVGRIDMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenuSrv **,** '-=-' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vGridMenuSrv **,** '201907132=Grid (Services) Selected
Records **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'SRVGRIDMENU' **,** 0 **);
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201907132 **) {** //Grid Services Selected Records
**var** selSrvName **=** X**.** GETPROPERTY **(** 'GRIDSELECTED:MAINGRID121|X_NAME' **);**
X**.** WARNING **(** selSrvName **);
var** ArraySelSrvName **=** selSrvName**.** split **(** "\r\n" **);
if (** ArraySelSrvName**.** length **>** 0 **)**
X**.** WARNING **(** ArraySelSrvName **[** 0 **]);
}**


### GETSQLDATASET (ASQL: string; AParams: Variant): TDataset

Executes the "ASQL" statement and populates a Dataset with the results set.

**ASQL** : SQL statement

**AParams** : Comma separated list containing query parameters

**Example 1**
**_Populate a dataset with data from Customers (Code, Name). Filter query results so that only customers with
specific business unit ( 100 ) and company (Login) are displayed._**
**var** qry **=** "SELECT CODE, NAME FROM TRDR WHERE COMPANY=:1 AND SODTYPE=:2 AND
BUSUNITS=:3" **;
var** ds **=** X**.** GETSQLDATASET **(** qry **,** X**.** SYS**.** COMPANY **,** 13 **,** 100 **);**

**Example 2**
**_Inside the object ITEM, create a script that populates a dataset with all the Items that contain the value of
field Code2 in any position of field Code1._**
**var** qry **=** "SELECT CODE, NAME FROM MTRL WHERE COMPANY=:1 AND SODTYPE=:2 AND
CODE1 LIKE :3" **;
var** ds **=** X**.** GETSQLDATASET **(** qry **,** X**.** SYS**.** COMPANY **,** 51 **,** '%' **+** ITEM**.** CODE2 **+** '%' **);**

**Example 3**
**_Populate a dataset with the balance per year of the located item._**
X**.** GETSQLDATASET **(** "SELECT FISCPRD, ISNULL(QTY1,0) AS BAL FROM MTRDATA WHERE MTRL=:1" **,**
ITEM**.** MTRL **);**


### HTTPCALL (URL: string, PostData: string, Headers: string, Method: string): Variant

Makes HTTP request. Used for interaction with web services, API and web sites in general.

**URL** : URL of the web request
**PostData** : post data of the web request
**Headers** : Request headers split by \r\n
**Method** : GET, POST, PUT, PATCH, DELETE method of the web call

**Example 1**
**_Web request using GET method._**
**function** myGetWebRequest **() {
try {
var** vAns **=** X**.** HTTPCALL **(** "https://www.mysite.com/webcall 1 " **);
if (** vAns **!=** "" **) {**
//...
**return true;
} else {**
X**.** WARNING **(** vAns **);
}
} catch (** err **) {**
X**.** WARNING **(** err**.** message **);
}
return false;
}**

**Example 2**
**_Web request using POST method._**
**function** myPostWebRequest **(** vKey **) {
var** ans **= {};**

**var** vMethod **=** "POST" **;
var** vHeaders **=** "Content-Type:application/json \r\nAuthorization: Bearer " **+** vKey **;
var** vWebRequest **=** "https://www.mysite.com/webcall2" **;**

**var** vBody **= {};**
vBody**.** username **=** "user1" **;**
vBody.password **=** "pass" **;
var** postdata **=** JSON**.** stringify **(** vBody **);**

**try {
var** resp **=** JSON**.** parse **(** X**.** HTTPCALL **(** vWebRequest **,** postdata **,** vHeaders **,** vMethod **));**
ans**.** success **=** resp**.** success **;**
ans**.** data **=** resp**.** data **;**
ans**.** message **=** resp**.** message **;
} catch (** ex **) {**
ans**.** success **= false;**
ans**.** message **=** ex**.** message **;
}
return** JSON**.** stringify **(** ans **);
}**

### ID (TableName: string, CodeValue: string): integer

Searches the “CodeValue” inside the field Code of the main table of the object " **ObjectName** " and returns its
primary key value.

**Example**
**_Display a message on screen with the ID of customer with code '001'._**
X**.** WARNING **(** X**.** ID **(** "CUSTOMER" **,** "001" **));**
//The sql query executed uses login company (e.g. 1000 )
//SELECT TRDR FROM TRDR A WHERE A.COMPANY=1000 AND A.SODTYPE=13 AND A.CODE='001'


### INPUTBOX (Prompt: string, DefaultValue: string): string

Displays a dialog message that allows the user to enter text and returns the text.

**Example**
**_Display a dialog message that asks the user to enter the e-mail._**
**var** inputMail **=** X**.** INPUTBOX **(** 'Please enter recipient e-mail:' **,** '' **);**

### INPUTQUERY (Title: string, Prompt: string, DefaultVal:Variant, vPassword:integer) : Variant

Displays a dialog message that allows the user to enter text. Returns the text entered by the user when the user
selects OK. Returns blank when Cancel or Esc is pressed.

**ACaption** : Title of the window,
**APrompt** : Internal window text (input field title),
**Value** : Preselected value of the input field,
**vPassword** : Displays the input text with asterisks (1 = Asterisk Text, 0 = Normal Text)

**Examples**

See →Case Study 1

See → Case Study 4

### ISVALIDCONTRACT: boolean

Checks if serial number - contract is valid

### LIST: string

Returns the name of the current browser

**Example
var** vListName **=** X**.** LIST **;**

### LOCALE: integer

Returns the Current Locale ID in language code (LCID)

**Example**
X**.** WARNING **(** X**.** LOCALE **);** // For Greek it returns 1032

### LOCALESTRING (value: string): string

Returns the login language of variable "value". Requires the existence of specific language files.

### LOGINDATE: TDateTime

Returns the current date(same as X.SYS.LOGINDATE)

**Example**
X**.** WARNING **(** "LoginDate is: " **+** X**.** LOGINDATE **);**
//Returns: Login Date is: Sat Oct 5 00:00:00 UTC+0300 2013

### MULTISQL: variant

Creates an IDispatch interface that can be used **to execute multiple SQL queries in a single transaction**.
SQL statements are added using the function “ **AddSQL** ” and are executed using function “ **Execute** ”.
The returned datasets are accessed through the function “ **DataSets** ”.
**Note:** Queries that use **X.SYS** commands are resolved using the function “ **Resolve** “ inside AddSQL.

**Example**
**_Execute queries that retrieve data from Customers, Items and Sales Statistics.
Use different dataset functions JSON, SUM, RECORDCOUNT, etc. on the returned datasets.
Check that all queries are executed in a single transaction (SQL Monitor)._**


**function** Example_MULTISQL **(){
var** mSQL **=** X **.MULTISQL();**

**var** qryCustomers **=** "SELECT TOP 20 A.TRDR, A.NAME, ISNULL(B.LBAL,0) AS BALANCE "
**+** " FROM TRDR A"
**+** " LEFT OUTER JOIN TRDFINDATA B ON B.COMPANY=:X.SYS.COMPANY AND B.TRDR=A.TRDR"
**+** " WHERE A.COMPANY=:X.SYS.COMPANY AND A.SODTYPE=13"
**+** " AND A.ISACTIVE=1 AND B.LBAL>100" **;**
mSQL **.AddSQL(** "dtCustomers" **,** X **.RESOLVE(** qryCustomers **));**

**var** qryItems **=** "SELECT TOP 20 A.MTRL, A.CODE,A.NAME,ISNULL(B.QTY1,0) AS QTY1"
**+** " FROM MTRL A "
**+** " LEFT OUTER JOIN MTRDATA B ON B.COMPANY=A.COMPANY"
**+** " AND A.MTRL=B.MTRL AND B.FISCPRD=:X.SYS.FISCPRD"
**+** " WHERE A.COMPANY=:X.SYS.COMPANY AND A.SODTYPE=51" **;**
mSQL **.AddSQL(** "dtItems" **,** X **.RESOLVE(** qryItems **));**

**var** qrySalesStats **=** "SELECT A.TrnDate,A.Findoc,A.Trdr,"
**+** " B.CODE AS X_TCODE ,B.NAME AS X_TNAME,"
**+** " C.CODE AS X_MCODE ,C.NAME AS X_MNAME,"
**+** " A.MtrTrn ,ISNULL(A.SalQty1,0) AS SalQty1 ,ISNULL(A.SalVal,0) AS SalVal"
**+** " FROM VMTRSTAT A "
**+** " LEFT OUTER JOIN TRDR B ON A.Trdr=B.TRDR"
**+** " LEFT OUTER JOIN MTRL C ON A.Mtrl=C.MTRL"
**+** " WHERE A.COMPANY=:X.SYS.COMPANY"
**+** " AND A.FISCPRD=:X.SYS.FISCPRD"
**+** " AND A.PERIOD=:X.SYS.PERIOD"
**+** " AND A.SoSource=1351 AND A.TSodType=13 "
**+** " ORDER BY A.TrnDate,A.Findoc,A.MtrTrn"
mSQL **.AddSQL(** "dtSalesStats" **,** X **.RESOLVE(** qrySalesStats **));**

mSQL **.Execute;** //Executes all queries

**var** dtCustomers **=** mSQL **.DataSets(** 'dtCustomers' **);
var** dtItems **=** mSQL **.DataSets(** 'dtItems' **);
var** dtSalesStats **=** mSQL **.DataSets(** 'dtSalesStats' **);**

**var** vTotCusLbal **=** dtCustomers **.Sum(** "BALANCE" **,** "NAME LIKE 'Β*'" **);
var** vItemsJson **=** dtItems **.JSON;**

**if (** dtSalesStats **.RECORDCOUNT >** 0 **) {**
dtSalesStats **.FIRST;
while (!** dtSalesStats **.EOF) {**
//Enter your Code Here
dtSalesStats **.NEXT;
}
}
}**


```
MULTISQL queries – SQL Monitor
```
**MULTISQL – Example in Advanced JavaScript**


### NEWID: integer

Returns the ID of the entry saved. Used in after post event.

**Example**
**_Return the ID of a sales document entry (Insert or Update)_**
**function** ON_AFTERPOST **() {**
var vFindocID;
vFindocID **=** GetID **();
}**

**function** GetID **() {
return** SALDOC**.** FINDOC **>** 0**?** SALDOC**.** FINDOC **:** X**.** NEWID **;
}**

### PASSWORDVALIDATE(stringtoValidate: string, Password: string): boolean

Compares the not encrypted string "StringtoValidate" with an encrypted password field (e.g. USERS.SOPASSWORD)
and returns TRUE if they match.

### PLAY (SoundFileName: string): boolean

Plays the sound file "SoundFileName" and returns True.

**Example**
X**.** PLAY **(** "C:\\SOUND\\alarm.mp3" **);**

### SHOWOBJFORM: integer

Opens an object, waits for the user to save it and then returns the id of the new record. It must always be combined
with function CreateObjForm.

**Example**
**_Create purchase document from items_**
**function** CreatePurchaseDoc **() {
var** myObj **=** X**.** CreateObjForm **(** 'PURDOC' **);
try {**
myObj**.** DBINSERT **;
var** tblFINDOC **=** myObj**.** FindTable **(** 'FINDOC' **);
var** tblITELINES **=** myObj**.** FindTable **(** 'ITELINES' **);**
tblFINDOC**.** Edit **;**
tblFINDOC**.** SERIES **=** 2001 **;**
tblFINDOC**.** TRDR **=** 123456 **;**
tblITELINES**.** Append **;**
tblITELINES**.** MTRL **=** ITEM**.** MTRL **;**
tblITELINES**.** QTY1 **=** 100 **;**
tblITELINES**.** PRICE **=** 50 **;**
tblITELINES**.** Post **;
var** id **=** myObj**.** SHOWOBJFORM **();
if (** id **>** 0 **)**
X**.** WARNING **(** "New id is:" **+** id **);
}
catch (** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}
}**


### SPELL (Num: Real): string

Returns the spelling of number Num

**Example**
X**.** WARNING **(** X**.** SPELL **(** 1101.10 **));**
//Returns: ONE THOUSAND ONE HUNDRED ONE AND TEN

### SQL (ASQL: string; AParams: Variant): string

Executes the ASQL statement and returns **one row result** (comma separated).

**ASQL** : SQL statement

**AParams** : Comma separated list containing query parameters

**Example 1
var** NewCode **=** X**.** SQL **(** "SELECT ISNULL((SELECT MAX(ISNULL(TRY_PARSE(ISNULL(SNCODE,0) AS
INT),0)) FROM GUARANTY),0) + 1" **, null);**
//Returns the max number + 1 of the field Guaranty.SNCODE

**Example 2
function** ExampleSQL **(** vAFM **) {
var** str **=** "SELECT TRDR, CODE, NAME FROM TRDR "
**+** "\n WHERE COMPANY=:X.SYS.COMPANY AND SODTYPE=13 AND AFM=:1" **;
return** X**.** SQL **(** str **,** vAFM **);
}**
//Return Example: 1, 1234, TestCustomer

```
X.SQL – Example in Advanced JavaScript
```

### STRINGS (StringList: string, Key: string): string

Returns the value of the given StringList key. If no key-value pair is found, then an empty string is returned.

**StringList** : String List name (e.g. SOSOURCE, SODTYPE)

**Key** : List key of the lookup record

**Examples**
X**.** STRINGS **(** "SODTYPE" **,** "96" **);** //returns: Actions
X**.** STRINGS **(** "Fprms" **,** 1351 **);** //returns: SALFPRMS
X**.** STRINGS **(** "MonthNames" **,** 6 **);** //returns: June
X**.** STRINGS **(** "ShortMonthNames" **,** 8 **);** //returns: Aug
X**.** STRINGS **(** "CstType" **,** 12 **);** //returns: Data Flow Rules
X**.** STRINGS **(** "Editors" **,** "UT1" **);** //returns: UTBL01(F[SODTYPE=:CSEL.SODTYPE])
X**.** STRINGS **(** "PayDay" **,** "0" **);** //returns: Sunday

### SUM (FieldName: string): real

Summarizes the data of the field “FieldName” for all the rows of the given datagrid.
It’s recommended to use the function X.FILTERSUM with parameter Filter '1=1'.

**Example**
X**.** SUM **(** 'ITELINES.NUM01' **);**
//Summarizes the data of the field ITELINES.NUM01

### TEMPDIR: string

Returns the path of the windows user’s temporary folder.

**Example**
X**.** WARNING **(** X**.** TEMPDIR **);**

### TIME: string..................................................................................................................................................................................................

Returns the current time in hh:mm format

**Example**
X**.** WARNING **(** "Current time is: " **+** X**.** TIME **);**

### USERVALIDATE(UserName: string, Password: string): boolean

Returns true if a user with credentials "UserName" and "Password" is found in the database.


### WEBREQUEST (JSONRequest: string): string

Executes a SoftOne web service request that uses built-in services (SetData, GetData, GetBrowserInfo etc.) and
returns the data in JSON format. For custom web services (created in Advanced JavaScript) use the function
WSCALL.

It can be used either for external or internal requests (e.g. Add new customer using SETDATA).

**Example 1**
**_Function that makes a web request to “S1 SQL Scripts” (SERVICE =”SqlData”), locates a specific record
(SQLNAME = “CallFromForm”) and returns the data retrieved from the SQL statement._**
**function** getItems **() {
var** ws **= {};**
ws**.** SERVICE **=** "SqlData" **;**
ws**.** SQLNAME **=** "CallFromForm" **;**
ws**.** PARAM1 **=** "2020,2021,2022,2023" **;
var** result **=** X**.** WEBREQUEST **(** JSON**.** stringify **(** ws **));
return** JSON**.** parse **(** result **);
}**


**Example 2**
**_Return data of INST (specific columns) using the service “getData”._**
**function** getInstData **(** key **) {
var** ws **= {};**
ws**.** SERVICE **=** "getData" **;**
ws**.** OBJECT **=** "INST" **;**
ws**.** KEY **=** key **;**
ws**.** appid **=** 3000 **;**
ws**.** LOCATEINFO **=** "INST:INST,CODE,NAME,GDATEFROM,GDATETO" **;** //Return fields

**var** result **=** X**.** WEBREQUEST **(** JSON**.** stringify **(** ws **));**

**return** JSON**.** parse **(** result **);
}**

**Example 3**
**_Update customer data using the service call setData._**
**function** updateCustomerData **(** cusdata **) {
var** ws **= {};**
ws**.** SERVICE **=** "setData" **;**
ws**.** OBJECT **=** "CUSTOMER" **;**
ws**.** appid **=** 3004 **;**
ws**.** key **=** cusdata**.** trdr **;**
ws**.** DATA **= {};**
ws**.** DATA**.** CUSTOMER **= [];**

**var** mycus **= {};**
mycus**.** payment **=** cusdata**.** payment **;**
mycus**.** email **=** cusdata**.** email **;**

ws**.** DATA**.** CUSTOMER**.** push **(** mycus **);**
X**.** LOG **(** "updateCustomerData: " **+** JSON**.** stringify **(** ws **));**

**var** result **=** X**.** WEBREQUEST **(** JSON**.** stringify **(** ws **));
return** JSON**.** parse **(** result **);
}**


### WSCALL (scope: variant, uri: string, postData: string, callbackFunc: variant): string

Executes any SoftOne web service request (built-in or custom) and returns the data in JSON format.

For built-in requests leave “Uri” param null, while for custom ones enter the URL part of the custom webservice
created in Advanced JavaScript (e.g. “/s1services/JS/mywebcall”).

**Example 1**
**_Function that makes a web request to Advanced Javascript function “getItemCategories”._**
**function** CustomWSRequest **() {
var** ws **= {};**
ws**.** clientID **=** "xxx" **;**
ws**.** categ **=** 100 **;
var** url = "/s1services/JS/myWS/getItemCategories";
**var** result **=** X**.** WSCALL **(null,** url, JSON**.** stringify **(** ws **), null);
return** JSON**.** parse **(** result **);
}**


## D. Dataset Methods

This module demonstrates all the Dataset methods you can use in form scripts.

### APPEND

Opens a new, empty record at the end of the dataset and makes the empty record the current one so that field
values for the record can be entered either by a user or by code.

**Example**
**_Function that inserts a record in document item lines for the item with code= 200_**
**function** AppendNewRecord **() {**
ITELINES**.** APPEND **;**
ITELINES**.** MTRL **=** X**.** ID **(** 'ITEM' **,** '200' **);**
ITELINES**.** QTY1 **=** 1 **;**
ITELINES**.** LINEVAL **=** 100 **;**
ITELINES**.** POST **;
}**

### DELETE

Deletes the current record and puts the Dataset in dsBrowse state. The record that followed the deleted record
becomes the current record.

**Example**
**_Function that deletes a record in document item lines when the item code=100_**
**function** DeleteRecord **() {
if(** ITELINES**.** LOCATE **(** 'X_CODE' **,** 100 **) ==** 1 **)**
ITELINES**.** DELETE **;
}**

### DISABLECONTROLS

Disables the windows controls of the specified dataset.
It can be used in master or detail tables of an object and it increases the performance, especially when iterating
datagrids.
**Attention**
It cannot be used in secondary detail tables.
Always use it in a try/finally block in order to avoid accidental disable of Dataset controls.

**Example 1**
**_Loop through document item lines datagrid by deactivating Window Controls_**
**function** LoopDataset **() {**
ITELINES**.** DISABLECONTROLS **;
try {**
ITELINES**.** FIRST **;
while(!** ITELINES**.** EOF **) {**
//Add Code Here
ITELINES**.** NEXT **;
}
}
finally {**
ITELINES**.** ENABLECONTROLS **;
}
}**

### ENABLECONTROLS

Activates the window controls of a given Dataset. Example can be found in “ **DisableControls** ” function.


### EDIT

Puts the Dataset into dsEdit state if it is not already in dsEdit or dsInsert states

**Example**
myDataset**.** EDIT **;**

### FIRST

Moves to the first record of the Dataset

**Example**
**_Fill the field NUM01 in all document item lines datagrid with a specific value._**
**function** FillDatasetRecords **() {**
ITELINES**.** DISABLECONTROLS **;
try {**
ITELINES**.** FIRST **;
while(!** ITELINES**.** EOF **) {**
ITELINES**.** NUM01 **=** ITELINES**.** LINEVAL ***** SALDOC**.** LRATE **;**
ITELINES**.** NEXT **;
}
}
finally {**
ITELINES**.** ENABLECONTROLS **;
}
}**

### INSERT

Opens a new, empty record before the current record, and makes the empty record the current one so that field
values for the record can be entered either by a user or by code.

**Example**
**_Locate the first record of documents lines that has “Item Code”=”01-001”, then add a new record before this
line using: “Item Code”=”01- 00 2”, “Qty1”=1 and “Lineval”=100._**
**function** InsertRecord **() {
if(** ITELINES**.** LOCATE **(** 'X_CODE' **,** ' 01 - 001 ' **) ==** 1 **) {**
ITELINES**.** INSERT **;**
ITELINES**.** MTRL **=** X**.** ID **(** 'ITEM' **,** ' 01 - 002 ' **);**
ITELINES**.** QTY1 **=** 1 **;**
ITELINES**.** LINEVAL **=** 100 **;**
ITELINES**.** POST **;
}
}**

### LAST................................................................................................................................................................................................................

Moves to the last record of the Dataset

**Example**
ITELINES**.** LAST **;**

### NAME

Returns the name of the current object

**Example**

var objName = X.NAME **;**
X.WARNING(objName) **;**


### NEXT

Moves to the next record of the Dataset

**Example**
**_In documents, search for item lines that have discount more than 50% and display a warning message._**
**function** FillDatasetRecords **() {**
ITELINES**.** DISABLECONTROLS **;
try {**
ITELINES**.** FIRST **;
while(!** ITELINES**.** EOF **) {
if (** ITELINES**.** DISC1PRC **>** 50 **)**
X**.** WARNING **(** 'Discount is greater than 50% in item code: ' **+**
ITELINES**.** X_CODE **);**
ITELINES**.** NEXT **;
}
}
finally {**
ITELINES**.** ENABLECONTROLS **;
}
}**

### POST

Attempts to post the new or altered record.
If successful, the Dataset is put in dsBrowse state. If unsuccessful, the Dataset remains in its current state.

**Example**
**_Fill document item lines datagrid with the items of the login company that a specific field meets a certain
condition (CCCMYFLAG = 1)_**
**function** AppendNewRecord **() {**
ds **=** X**.** GETSQLDATASET **(** 'SELECT MTRL FROM MTRL WHERE CCCMYFLAG = 1 AND SODTYPE=51
AND COMPANY=' **+** X**.** SYS**.** COMPANY **,null);
if (** ds**.** RECORDCOUNT **>** 0 **) {**
ITELINES**.** APPEND **;**
ITELINES**.** MTRL **=** ds**.** MTRL **;**
ITELINES**.** QTY1 **=** 1 **;**
ITELINES**.** LINEVAL **=** 10 **;**
ITELINES**.** POST **;**
ds**.** NEXT **;
}
}**

### PRIOR

Moves to the previous record of the Dataset

**Example**
ITELINES**.** PRIOR **;**

### SETREADONLY (FieldName: string, Value: True/False)...............................................................................................................

Sets the " _FieldName_ " field in Read Only mode. If you use it in a datagrid then it sets the whole column in read only
mode.

**Example**
**_Change the status of the field CUSTOMER.TRDCATEGORY to read only._**
CUSTOMER**.** SETREADONLY **(** 'TRDCATEGORY' **,** 'TRUE' **);**
//or
CUSTOMER**.** SETREADONLY **(** 'TRDCATEGORY' **,** 1 **);**


### SETDATASETLINKS(ModuleHandle, DatasetHandle, Value)

SBSL (ModuleIntf) function that is very useful in form scripts. When you populate a Dataset (e.g. virtual table) that
has fields linked to tables, then for every record added, a query runs for each of these fields in order to link them to
the tables. This function provides the ability to send the queries once, when all records are filled.

**Values** : **0** = Disable links, **1** = Enable links

**Syntax** : X.EXEC('CODE:ModuleIntf.SetDatasetLinks', X.MODULE, dsHandle, 0 or 1);

**Example 1**
dsHandle **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataset' **,** X**.** MODULE **,** 'MyDataset' **);**
X**.** EXEC **(** 'CODE:ModuleIntf.SetDatasetLinks' **,** X**.** MODULE **,** dsHandle **,** 0 **);**

**Example 2**

See → Case Study 6

### SETFIELDPROPERTY(FieldHandle, PropertyIndex, PropertyValue);........................................................................................

SBSL (ModuleIntf) function that is used to modify field properties (Required and Read-only).

**PropertyIndex** accepts the following values:
**5** : Required (1=true, 0=false)
**6** : Read-only (1=true, 0=false)

**Example – JavaScript**
**_In conversion dialog object change the “required” property of the field “Delivery Date” (DELIVDATE) to
mandatory (using Advanced JS)._**
**function** ON_CREATE **() {
var** ds **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** 'CONVERTFPRMS' **);
var** fld **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** ds **,** 'DELIVDATE' **);**
X**.** EXEC **(** 'CODE:ModuleIntf.SetFieldProperty' **,** fld **,** 5 **,** 1 **);
}**

### GETFIELDPROPERTY(FieldHandle, PropertyIndex);

SBSL (ModuleIntf) function that returns field properties (for the following property indexes).

**PropertyIndex** accepts the following values:
**1** : Field Name
**2** : Data Type
**3** : Size
**4** : Display Name
**5** : Required
**6** : Read-only

**Example
function** ON_ITEM_CODE **() {
var** vProp **=** GetFieldProp **(** 'ITEM' **,** 'CODE' **,** 5 **);**
X**.** WARNING **(** "From Adv.JS\nProperty 'Required' of 'Code' is: " **+** vProp **);
}**

**function** GetFieldProp **(** tableName **,** fieldName **,** fieldProperty **) {**
//1:FieldName, 2:DataType, 3:Size, 4:DisplayName, 5:Required, 6:ReadOnly
**var** ds **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** tableName **);
var** fld **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** ds **,** fieldName **);
return** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldProperty' **,** fld **,** fieldProperty **);
}**


**Figure – Advanced JS - GetFieldProperty**


## E. Dataset Functions

This module demonstrates all the object functions you can use in form scripts.

### ACTIVE: boolean

Returns TRUE or 1when the data of a dataset can be read or edited.

### BOF: boolean

Returns TRUE or 1 if the Dataset is on the first record

**Example**
ITELINES**.** LAST **;
while(!** ITELINES**.** BOF **) {**
//Add Code Here
ITELINES**.** PRIOR **;
}**

### EOF: boolean...............................................................................................................................................................................................

Returns TRUE or 1 if the Dataset is on the last record

**Example**
SRVLINES**.** FIRST **;
while(!** SRVLINES**.** EOF **) {**
//Add Code Here
SRVLINES**.** NEXT **;
}**

### FIELDBYNAME (FieldName: string): variant

Returns the value of field "FieldName"

**Example
for(** i **=** 1 **; i <=** 3 **;** i **++) {**
myfield **=** SALDOC**.** FIELDBYNAME **(** 'CCCMYFIELD' **+** i **);
if (** myfield **==** 'Value' **) {**
//Add Code Here
**}
}**

### FIELDCOUNT: integer

Returns the number of fields in the Dataset

**Example
for (** i **=** 0 **;** i **<** SALDOC**.** FIELDCOUNT **-** 1 **;** i **++) {**
//Add Code Here
**}**


### FIELDNAME (index: integer): string

Returns the name of the index field

**Example**
**_Lock all fields of Installations module (INST) except for field REMARKS. Fields will be read-only for all users
except for Administrator group of users._**
**function** ON_INSERT **() {**
LockRecord **(** 0 **);** //Unlock fields on insert
**}**

**function** ON_LOCATE **() {
if (** X**.** SYS**.** GROUPS **!=** 100 **) {** //Group Administrator
LockRecord **(** 1 **);** //Lock fields on locate
**}
}**

**function** LockRecord **(** vReadonly **) {
for (** i **=** 0 **;** i **<=** INST**.** FIELDCOUNT **-** 1 **;** i **++) {
if (** INST**.** FIELDNAME **(** i **) ==** 'REMARKS' **) {** //always editable
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.' **+** INST**.** FIELDNAME **(** i **),** 'READONLY' **,** 0 **);
} else {**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INST.' **+** INST**.** FIELDNAME **(** i **),** 'READONLY' **,**
vReadonly **);
}
}
for (** i **=** 0 **;** i **<=** INSTLINES**.** FIELDCOUNT **-** 1 **;** i **++) {**
X**.** SETPROPERTY **(** 'FIELD' **,** 'INSTLINES.' **+** INSTLINES**.** FIELDNAME **(** i **),** 'READONLY' **,**
vReadonly **);
}
}**

### FIELDTYPE (FieldName: string): integer

Returns a number that applies to the type of the field. Values returned are:
**1** =String, **2** =Smallint, **3** =Integer, **4** =Word, **6** =Float, **11** =DateTime, **16** =Memo

**Example**
MTRSUBSTITUTE**.** FIELDTYPE **(** 'NAME' **);** //Returns 1 (String)

### FIELDS (index: integer): variant

Returns the value of the index field

### FILTER: string

String used for filtering the Dataset

**Example 1**

vFilter **=** '{ITELINES.MTRL_ITEM_CODE}=
' **+** String**.** fromCharCode **(** 39 **)+** '12345' **+** String**.** fromCharCode **(** 39 **);**
ITELINES**.** FILTER **=** '(' **+** vFilter **+** ')' **;**
ITELINES**.** FILTERED **=** 1 **;**

**Example 2**

See →Case Study 5


### FILTERED: boolean

Enables(1) - Disables(0) filtering and returns the filtered status of the Dataset

**Example 1**
vFilter **=** '{ITELINES.MTRL_ITEM_NAME}=
' **+** String**.** fromCharCode **(** 39 **)+** 'MyItem' **+** String**.** fromCharCode **(** 39 **);**
ITELINES**.** FILTER **=** '(' **+** vFilter **+** ')' **;**
ITELINES**.** FILTERED **=** 1 **;**

**Example 2**

See →Case Study 5

### GETGRAPH (LabelFieldName: string; ValueFieldName: string): string

Creates a Chart Image in bmp format and returns the full path and filename. The chart is created with data from the
field "LabelFieldName" and values from the field "ValueFieldName"

**Example**
**_Function that creates a bmp file and saves the path and filename in the REMARKS field of the located custom
table (CCCMYTABLE) record._**
**function** Createbmpfile **() {**
str **=** "SELECT TOP 5 A.NAME, ISNULL(B.LBAL,0) AS BAL FROM TRDR A INNER JOIN
TRDFINDATA B ON A.TRDR=B.TRDR WHERE A.COMPANY=" **+** X**.** SYS**.** COMPANY **+** " AND A.SODTYPE=13
ORDER BY 2 DESC" **;**
ds **=** X**.** GETSQLDATASET **(** str **,** "" **);**
CCCMYTABLE**.** REMARKS **=** ds**.** GETGRAPH **(** 'NAME' **,** 'BAL' **);** //Creates the bmp file and
returns the full path
**}**

### GETHTML (FieldNames: string): string

Returns the values of "FieldNames" fields in HTML format

**Example**
**_Function that returns the fields “Code” and “Name” of table TRDR (with ids 123 and 124) in html format._**
**function** GETHTMLFormat **() {
var** ds **=** X**.** GETSQLDATASET **(** 'SELECT CODE, NAME FROM TRDR WHERE TRDR IN
(123,124)' **,** '' **);
var** myhtml **=** ds**.** GETHTML **(** 'CODE;NAME' **);
return** myhtml **;
}
//Returns**
<table id= **"seltbl"** width= **"10"** count= **"1"** >
<tbody>
<tr>
<td> **09** </td>
<td> **Test Customer 1** </td>
</tr>
<tr>
<td> **10** </td>
<td> **Test Customer 2** </td>
</tr>
</tbody>
</table>


### GETXML (WriteMetadata: Boolean, DisplayTagsOnNullValues: Boolean): string

Returns the Dataset in XML format

**Example**
**_Function that returns the fields “Code” and “Name” of the selected customer in sales documents in xml
format._**
**function** GetXMLFormat **(** withmetadata **) {
var** ds **=** X**.** GETSQLDATASET **(** "SELECT CODE, NAME FROM TRDR WHERE TRDR=:1" **,**
SALDOC**.** TRDR **);
return** ds**.** GETXML **(** withmetadata **);
}**

**//0 (No MetaData) Returns**
<?xml version= **"1.0"** encoding= **"ISO- 8859 - 7"**? >
<SODATA>
<ROWDATA><ROW CODE= **"09"** NAME= **"Test Customer 1"** />
</ROWDATA>
</SODATA>

**//1 (With MetaData) Returns**
<?xml version= **"1.0"** encoding= **"ISO- 8859 - 7"**? >
<SODATA>
<METADATA>
<FIELDS>
<FIELD fieldname= **"CODE"** fieldtype= **"string"** WIDTH= **"25"** fieldcaption= **""** />
<FIELD fieldname= **"NAME"** fieldtype= **"string"** WIDTH= **"64"** fieldcaption= **""** />
</FIELDS>
<PARAMS PRIMARY_KEY= **""** />
</METADATA>
<ROWDATA>
<ROW CODE= **"09"** NAME= **"Test Customer 1"** />
</ROWDATA>
</SODATA>

### ISNULL (FieldName: string): boolean

Returns True or 1 when field "FieldName" is null

**Example**
**_When saving a customer record check if a field(ZIP) is null and display a message_**
**function** ON_POST **() {**
CheckNull **(** 'ZIP' **);
}**

**function** CheckNull **(** fldn **) {
if (** CUSTOMER**.** ISNULL **(** fldn **) ==** 1 **)**
X**.** WARNING **(** fldn **+** " IS NULL!" **);
else**
X**.** WARNING **(** fldn **+** " IS NOT NULL!" **);
}**


### JSON: string

Returns the columns and the data of a table or dataset in JSON format.

**Example 1
function** MyGetJson **() {
var** vjson **;**
vjson **=** MTRSUBSTITUTE**.** JSON **;**
X**.** WARNING **(** vjson **);
}**

**Example 2**

See → Advanced Javascript - Debug Functions

### LOCATE (KeyFields: string; KeyValues: variant): boolean

Searches the dataset for a specific record and returns TRUE if found. It also makes it the active record.
**_KeyFields_** are separated with semicolons while **_KeyValues_** with commas.

**Example 1**
**_In Sales Documents entity, try to locate a line that has an item with id 12345 (MTRL=12345) and the quantity
of the line is 10 (QTY1=10). If a line meets the above filters then display a message._**
**if(** ITELINES**.** LOCATE **(** 'MTRL;QTY1' **,** 12345 **,** 10 **) ==** 1 **)**
X**.** WARNING **(** "Located line..." **);
else**
X**.** WARNING **(** "Record not found" **);**

**Example 2**
**_Locate a memory table record._**
**if(** X.PAYMENT.LOCATE('CODE' **,** 1001 **) ==** 1 **)**
X**.** WARNING **(** "Located Payment record..." **);
else**
X**.** WARNING **(** "Record not found" **);**

### LOOKUP (KeyFields: string; KeyValues: Variant; ResultFields: string): Variant;

Returns field values from a record that matches specified search values, without the use of SQL queries. _KeyFields_
are separated with semicolons while _KeyValues_ with commas. Note also that this function is used in memory tables.

**Example 1**
**_Return the email field of the login user._**
**var** vUserCode **=** X**.** SYS**.** USER **;** //Login User Code
**var** vUserEmail **=** X**.** USERS**.** LOOKUP **(** 'USERS' **,** vUserCode **,** 'EMAIL' **);** //Returns e-mail field

**Example 2**
**_Return the description (name field) of payment with Company =1000, Sodtype =13 and Code =1000._**
**var** vPaymentDescr **=** X**.** PAYMENT**.** LOOKUP **(** 'COMPANY;SODTYPE;PAYMENT' **,** 1000 **,** 13 **,** 1000
**,** 'NAME' **);
if (** vPaymentDescr **!= null)**
X**.** WARNING **(** vPaymentDescr **);**

### RECNO: integer

Returns the current record number of the Dataset.

**Example
var** curRec **=** ITELINES**.** RECNO **;**


### RECORDCOUNT: integer

Returns the total number of records in the Dataset

**Example 1
if (** ITELINES**.** RECORDCOUNT **>** 0 **) {**
//Add Code Here
**}**

**Example 2**

See →Case Study 2

### STATE: integer

Returns the State of the Dataset. The available values are summarized below:

**0=dsInactive**

Dataset closed. Data unavailable.

**1=dsBrowse**

Dataset open. Data can be viewed, but not changed. This is the default state of an open Dataset.

**2=dsEdit**

Dataset open. The current row can be modified.

**3=dsInsert**

Dataset open. A new row is inserted or appended.

**6=dsFilter**

Dataset open. Indicates that a filter operation is under way. A restricted set of data can be viewed, and no data can
be changed.

### SUM (FieldName: string, Filter: string): real

Summarizes the data of the " **FieldName** " field of the given datagrid for entries that meet the " **Filter** " expression.
Use filter "1=1" for not applying any filters.

**Examples
var** vQuantA **=** ITELINES**.** SUM **(** "QTY1" **,** "MTRUNIT=1" **);
var** vQuantB **=** ITELINES**.** SUM **(** "QTY1" **,** "X_CODE LIKE 'A*'" **);
var** vQuantC **=** ITELINES**.** SUM **(** "QTY1" **,** "1=1" **);**


## F. Field Events

These events fire when users alter the data of fields and are summarized below.

### ON_ObjectName_FieldName_VALIDATE

Fires on field value change (Before Change).
Its main use is to validate data and prevent field value change.

**Example**

**Module** : Sales Documents

**Job** : Prevent users from modifying customer in sales documents (series 7021) that have been posted.

**function** ON_SALDOC_TRDR_VALIDATE **() {
if ((** SALDOC**.** SERIES **==** 7021 **) && (** SALDOC**.** FINDOC **>** 0 **)) {**
X**.** EXCEPTION **((** X**.** SYS**.** USERLANG **==** "EL"**?** "Απαγορεύεται η αλλαγή πελάτη, το
παραστατικό είναι καταχωρημένο!" **:
(** X**.** SYS**.** USERLANG **==** "SR"**?** "Не можете да промените клијента, документ је
регистрован" **:** "Altering Customer is not permitted, the document is posted!" **))));
}
}**

### ON_ObjectName_FieldName

Fires on field value change (After Change).

**Example 1
Module** : Sales Documents

**Job** : Show/Hide a panel based on Series value and the Login User Code

**function** ON_SALDOC_SERIES **() {
if (((** SALDOC**.** SERIES **==** 7650 **) || (** SALDOC**.** SERIES **==** 7630 **)) && (** X**.** SYS**.** USER **==** 111 **))**
X**.** SETPROPERTY **(** 'PANEL' **,** 'PANEL14' **,** 'VISIBLE' **,** 'TRUE' **);
else**
X**.** SETPROPERTY **(** 'PANEL' **,** 'PANEL14' **,** 'VISIBLE' **,** 'FALSE' **);
}**

**Example 2**

**Module** : Installations
**Job** : Alter the data of field “DateTo” based on the data of field “DateFrom”

**function** ON_INST_WDATEFROM **() {
if (** INST**.** ISNULL **(** 'WDATEFROM' **) ==** 1 **)**
INST**.** WDATETO **= null;
else**
INST**.** WDATETO **=** X**.** EVAL **(** 'INCYEAR(INST.WDATEFROM,1)' **);
}**


## G. Datagrid Events

The events that are triggered when users alter datagrids are summarized below.

### ON_DatagridName_NEW

Triggered when a new record is added in a datagrid.
Usually used for setting default values.

**Example**

**Module** : Sales Documents

**Job** : Add default values in customer branches datagrid when users insert a new row (only for the 1st one).

**function** ON_CUSBRANCH_NEW **() {
if(** CUSBRANCH**.** RECORDCOUNT **==** 0 **) {**
CUSBRANCH**.** CODE **=** "0000" **;**
CUSBRANCH**.** NAME **=** CUSTOMER**.** NAME **;
}
}**

### ON_DatagridName_POST

Fires on datagrid before-post, before the changes to the record are posted.
Use it to perform any actions that you want to occur before a datagrid record is posted. It is commonly used to
change values, to perform validation and to raise custom error messages.

**Example**

**Module** : Sales Documents
**Job** : Display a message that prevents the user from adding item lines using discount greater than 50%.

**function** ON_ITELINES_POST **() {
if(** ITELINES**.** DISC1PRC **>** 50 **)**
X**.** EXCEPTION **(** "Discount can not be greater than 50%." **);
}**

### ON_DatagridName_AFTERPOST

Fires on datagrid after-post, after the changes to a datagrid record have been posted.
Usually used to display / send a message or for calculating purposes in order to update values of other tables.

**Example**

**Module** : Sales Documents
**Job** : Summarize the data of a custom item lines field and display the result in a header field when users

post Item Lines record. Use also custom filters and display the filtered sum in a different header field.

**function** ON_ITELINES_POST **() {**
CalculateLinesData **();
}**

**function** CalculateLinesData **() {
var** vTotLinesCCCValue **=** X**.** FILTERSUM **(** 'ITELINES.CCCLINEVAL' **,** '1=1' **);**
SALDOC**.** CCCTOTCCCVAL **=** vTotLinesCCCValue **;**

**var** vTotFilteredValue **=** X**.** FILTERSUM **(** 'ITELINES.CCCLINEVAL' **,** 'MTRCATEGORY=1 AND
CCCLINESFIELD=1 AND CCCMYCOMPANY=' **+** X**.** SYS**.** COMPANY **);**
SALDOC**.** CCCTOTFILTVAL **=** vTotFilteredValue **;
}**


### ON_DatagridName_BEFOREDELETE

Fires on datagrid before-delete, before a datagrid record is deleted.
Use it to perform validation or for raising custom error messages.

**Example**

**Module** : Sales Documents
**Job** : Prevent users from deleting an item line based on certain criteria.

**function** ON_ITELINES_BEFOREDELETE **() {
if (** ITELINES**.** CCCS1UPD **==** 1 **)**
X**.** EXCEPTION **(** 'This item line cannot be deleted.' **);
}**

### ON_DatagridName_AFTERDELETE

Fires on datagrid after-delete, after a datagrid record is deleted.
Use it to raise custom messages or perform any update actions to other tables.

**Example
Module** : Sales Documents

**Job** : When users delete Item Lines, summarize the data of a field in lines and display the result in a

header field. Use also custom filters and display the filtered sum in a different header field.

**function** ON_ITELINES_AFTERDELETE **() {**
CalculateLinesData **();
}**

**function** CalculateLinesData **() {
var** vTotLinesCCCValue **=** X**.** FILTERSUM **(** 'ITELINES.CCCLINEVAL' **,** '1=1' **);**
SALDOC**.** CCCTOTCCCVAL **=** vTotLinesCCCValue **;**

**var** vTotFilteredValue **=** X**.** FILTERSUM **(** 'ITELINES.CCCLINEVAL' **,** 'MTRCATEGORY=1 AND
CCCLINESFIELD=1 AND CCCMYCOMPANY=' **+** X**.** SYS**.** COMPANY **);**
SALDOC**.** CCCTOTFILTVAL **=** vTotFilteredValue **;
}**


## H. Object Events

All the events that fire on SoftOne objects (modules) are discussed in the following pages.

### ON_CREATE

Fires when an object is created (when you open it from the menu).
Usually used for adding params, initializing variables or altering object string lists (like Browser Context Menu).

**Example 1**

**Module** : Sales Documents

**Job** : In new entries, auto open a QuickView from Items that retrieves data from line Item.

**var** vOpenOnce **=** 0 **;**

**function** ON_CREATE **() {**
vOpenOnce **=** 1 **;
}**

**function** ON_INSERT **() {
if (** vOpenOnce **==** 1 **) {** //Check to open quickview only one time
X**.** QUICKVIEW **(** 'ITEM' **,** 'ItemBalanceQV' **,** 'ITELINES.MTRL' **);**
vOpenOnce **=** 0 **;
}
}**

**Example 2**

**Module** : Sales Documents

**Job** : Add right click menu jobs under a custom folder “MyJobs”: “Customer Financial data” and “NewJob”

**function** ON_CREATE **() {**
ChangeBrowserMenu **();** //Change context menu of browser
**}
function** ChangeBrowserMenu **() {
if ((** X**.** SYS**.** GROUPS **==** 117 **) || (** X**.** SYS**.** GROUPS **==** 201 **)) {**
//StringList of most SoftOne Objects Browser is BRMENU
**var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '-=-' **);** //divider
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201809191=1;Customer Financial
Data?My Jobs' **);** // **1;** displays the job when one or more rows are selected.
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 90925 1=1;NewJob A?My Jobs' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201 909252 =1;NewJob B?My Jobs' **);**
// **?Name** displays the job under a sub-menu/folder (e.g. My Jobs)
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201910023=3;Displayed on Lines
Analysis Browser' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);
}
}
function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201809191 **) {** //Browser right click - Customer Financial Data
**var** vSelRecs **;**
vSelRecs **=** X**.** GETPARAM **(** 'SELRECS' **);**
vSelRecs **=** vSelRecs**.** replace **(/\?/g,** "," **);
var** vds **=** X**.** GETSQLDATASET **(** 'SELECT DISTINCT TRDR FROM FINDOC WHERE ' **+**
vSelRecs **, null);
if (** vds**.** RECORDCOUNT **==** 1 **)**
X**.** EXEC **(** 'XCMD:CUSTOMER[FORM=Financial Data,AUTOLOCATE=' **+** vds**.** TRDR **+** ']' **);
}
if (** cmd **==** 201909251 **) {**
//Add code here
**}
}**


### ON_FORMLOAD

Fires on form load (after the event ON_CREATE).

### ON_DESTROY

Fires on destroy of an object.

### ON_CANCEL

Fires before cancelling the record changes inside an object

### ON_LOCATE

Fires after locating a record of an object.
Usually used for initiating variables, displaying messages or changing the layout of the form (show/hide controls).

**Example 1**

**Module** : Sales Documents

**Job** : Show/hide panels when certain conditions are met.

**function** ON_LOCATE **() {**
CheckVisiblePanels **();
}**

**function** CheckVisiblePanels **() {
if ((** SALDOC**.** FINDOC **>** 0 **) && (** SALDOC**.** ISCANCEL **==** 0 **)) {
if (** SALDOC**.** CCCAPPRVSTAT **==** 0 **) {**
X**.** SETPROPERTY **(** 'PANEL' **,** 'CCCPanelAprroveButtons' **,** 'VISIBLE' **,** 'TRUE' **);**
X**.** SETPROPERTY **(** 'PANEL' **,** 'CCCPanelBtnSendApprv' **,** 'VISIBLE' **,** 'TRUE' **);
} else {**
X**.** SETPROPERTY **(** 'PANEL' **,** 'CCCPanelAprroveButtons' **,** 'VISIBLE' **,** 'FALSE' **);**
X**.** SETPROPERTY **(** 'PANEL' **,** 'CCCPanelBtnSendApprv' **,** 'VISIBLE' **,** 'FALSE' **);
}
}
}**

**Example 2
Module** : Sales Documents

**Job** : Disable record editing (make all fields read-only) when certain conditions are met.

**function** ON_INSERT **() {**
X**.** SetProperty **(** "EDITOPTIONS" **,** "READONLY=FALSE" **);** //Unlocks Editing
**}**

**function** ON_CANCEL **() {**
X**.** SetProperty **(** "EDITOPTIONS" **,** "READONLY=FALSE" **);** //Unlocks Editing
**}**

**function** ON_LOCATE **() {**
CheckLockRecord **();
}**

**function** CheckLockRecord **() {
if ((** SALDOC**.** ISPRINT **==** 1 **) && (** X**.** SYS**.** ISADMIN **!=** 1 **))**
X**.** SetProperty **(** "EDITOPTIONS" **,** "READONLY=FALSE" **);** //Unlocks Editing
**else**
X**.** SetProperty **(** "EDITOPTIONS" **,** "READONLY=TRUE" **);** //Locks Editing
**}**


### ON_POST

Fires before the changes of a record are posted to the database.
For example, it might be used to perform validity checks on data changes before posting them to the database.
Posting is aborted when X.EXCEPTION function is used.

### ON_AFTERPOST

Fires after the record is saved in the database.
For example, it fires when users edit / change the contents of a record and then click on “Save” button.

### ON_DELETE

Fires before deleting a record of an object.
Usually used for preventing users from deleting a record, because it fires before delete is committed.
Delete of record is cancelled with the use of X.EXCEPTION function.

### ON_AFTERDELETE

Fires after deleting a record of an object.
Usually used for performing actions (send messages / add log data) when users delete a record, because it is
triggered after the changes take effect.

### ON_INSERT

Fires when a new record of an object is created, **not saved** (Click on toolbar button “ **New** ”)
Usually used for setting default values, changing field editors, hiding panels, etc.

**Example**

**Module** : Purchase Documents

**Job** : Change the editor of item lines (field MTRL) according to Project field data.

**function** ON_INSERT **() {**
SetNewEditors **();
}**

**function** ON_LOCATE **() {**
SetNewEditors **();
}**

**function** ON_PURDOC_PRJC **() {**
SetNewEditors **();
}**

**function** SetNewEditors **() {
if (** PURDOC**.** ISNULL **(** 'PRJC' **) ==** 0 **)** //not null
X**.** SETFIELDEDITOR **(** 'ITELINES.MTRL' **,** 'ITEM(W[EXISTS(SELECT 1 FROM CCCMYTABLE A1
WHERE A1.MTRL=A.RELITEM AND A1.PRJC=' **+** PURDOC**.** PRJC **+**
')],F[SODTYPE=&ITESODTYPE],I[QTY1],U[VAT;MTRUNIT;MTRSEASON;CDIM1;CDIM2;CDIM3;MTRPRJCB
LD;MTRCATEGORY=VAT;MTRUNIT4;MTRSEASON;CDIM1;CDIM2;CDIM3;MTRPRJCBLD;MTRCATEGORY@])' **);
else**
X**.** SETFIELDEDITOR **(** 'ITELINES.MTRL' **,**
'ITEM(W[1=0],F[SODTYPE=&ITESODTYPE],I[QTY1],U[VAT;MTRUNIT;MTRSEASON;CDIM1;CDIM2;CDIM3
;MTRPRJCBLD;MTRCATEGORY=VAT;MTRUNIT4;MTRSEASON;CDIM1;CDIM2;CDIM3;MTRPRJCBLD;MTRCATEGO
RY@])' **);
}**


### ON_DOCPRINT

Fires before printing a print-out form

### ON_OPENREPORT

Fires before the execution of a report

### EXECCOMMAND (cmd)

Fires when a command is triggered (e.g. button click, right-click menu option)

### EXECCOMMAND(cmd) (cmd=-1)

Fires before a record is copied to another record (before “Copy from last”)

### EXECCOMMAND(cmd) (cmd=-2)

Fires after a record is copied to another record (after “Copy from last”)

### ON_RESTOREEVENTS

Fires when a new record is added from conversion of another record (e.g. right click menu-job “Sales Conversion”)

**Example
Module** : Sales Documents

**Job** : Preserve document pay-terms data on conversion.

**function** ON_RESTOREEVENTS **() {**
GetPreviousDocPayTerms **();
}**

**function** GetPreviousDocPayTerms **() {**
ITELINES**.** FIRST **;
if (** ITELINES**.** FINDOCS **>** 0 **) {
var** str **=** "SELECT FINPAYTERMS, FINALDATE, AMNT FROM FINPAYTERMS WHERE
FINDOC=:1" **;
var** ds **=** X**.** GETSQLDATASET **(** str **,** ITELINES**.** FINDOCS **);
if (** ds**.** RECORDCOUNT **>** 0 **) {
while (** FINPAYTERMS**.** RECORDCOUNT **>** 0 **) {**
FINPAYTERMS**.** DELETE **;
}**
VDOSEIS**.** EDIT **;
while (!** ds**.** EOF **) {**
FINPAYTERMS**.** APPEND **;**
FINPAYTERMS**.** FINALDATE **=** ds**.** FINALDATE **;**
FINPAYTERMS**.** AMNT **=** ds**.** AMNT **;**
FINPAYTERMS**.** POST **;**
ds**.** NEXT **;
}
}
}
}**


### ON_EDIT

Fires when users alter the data of any field inside a record of an object

**Example
Module** : Sales Documents

**Job** : Prohibit a specific group of users of editing records in purchase documents.

**function** ON_EDIT **() {
if (** X**.** SYS**.** GROUPS **==** 100 **)** //Checks if user’s group is 100
X**.** CANCELEDITS **;
}**

### ON_AFTEREXECUTE

Event that fires in dialog objects after batch jobs are completed.

**Example**

**Batch Job** : CONVERTDLG
Convert sales documents using mass conversion **(** Figure H3) and get the ids of the created documents.

**function** ON_AFTEREXECUTE **() {** //After Batch Job Execution
X**.** WARNING **(** 'ON_AFTEREXECUTE Event Fired' **);**
//debugger;
**if (** X**.** GETPARAM **(** 'SOSOURCE' **) ==** 1351 **) {
if (** CONVERTFPRMS**.** VIEWTRANSMODE **==** 2 **) {** //Mass Convert
**var** vNewFindocIds **=** "" **;**
VFIN**.** FIRST **();** //VFIN Table stores the new ids (Field VFIN.FINDOC)
**while (!** VFIN**.** EOF **) {
if (** VFIN**.** FINDOC **!=** 0 **) {**
vNewFindocIds **+=** VFIN**.** FINDOC **+** "," **;**
// Create SALDOC object, Locate record, Alter data, DBPost
**}**
VFIN**.** NEXT **;
}
if (** vNewFindocIds **!=** "" **) {**
vNewFindocIds **=** vNewFindocIds**.** slice **(** 0 **, -** 1 **);** //Remove last comma
//X.RUNSQL("UPDATE FINDOC SET FINSTATES=10 WHERE FINDOC IN (" +
vNewFindocIds + ")", null);
X**.** WARNING **(** "New document ids: " **+** vNewFindocIds **);
}
}
}
}**

```
Figure H 1 – JS Main
```

```
Figure H2 – Event “ON_AFTEREXECUTE”
```
**Figure H3 – Dialog Filter “Mass Conversion”**


## I. Sub Form Events

This module demonstrates all the events that occur in sub-forms (pop-up forms).

**Attention** : Sub-Form names must not contain underscores.

### ON_SubFormName_SHOW

Fires on before-show of a sub form.

**Example**

**Module:** Sales Documents

**Job:** Populate a custom virtual table CCCPICKITEMS using specified SQL query. The data (Item, Qty, etc.)
are displayed in a pop-up form (FORMPICKITEMS).

**function** ON_FORMPICKITEMS_SHOW **() {**
CCCPICKITEMS**.** FIRST **;
while (** CCCPICKITEMS**.** RECORDCOUNT **>** 0 **) {**
CCCPICKITEMS**.** DELETE **;
}
if (** SALDOC**.** TRDR **>** 0 **) {**
vToDate **=** X**.** EVAL **(** 'SQLDate(LoginDate+1)' **);**
vMonthDate **=** X**.** EVAL **(** 'SQLDate(IncMonth(LoginDate,-1))' **);**
vYearDate **=** X**.** EVAL **(** 'SQLDate(IncYear(LoginDate,-1))' **);
var** ds **=** X**.** GETSQLDATASET **(** 'SELECT M.MTRL, M.CODE, M.NAME, ' **+**
'(SELECT SUM(V1.EXPQTY1) ' **+**
' FROM VMTRSTAT V1 ' **+**
' WHERE V1.MTRL=M.MTRL ' **+**
' AND V1.TRNDATE>=' **+** vMonthDate **+** ' ' **+**
' AND V1.TRNDATE<' **+** vToDate **+** ') AS QTY1MONTH, ' **+**
'(SELECT SUM(V2.EXPQTY1) ' **+**
' FROM VMTRSTAT V2 ' **+**
' WHERE V2.MTRL=M.MTRL ' **+**
' AND V2.TRNDATE>=' **+** vYearDate **+** ' ' **+**
' AND V2.TRNDATE<' **+** vToDate **+** ') AS QTY1YEAR ' **+**
'FROM MTRL M ' **+**
'WHERE M.COMPANY=' **+** X**.** SYS**.** COMPANY **+** ' ' **+**
' AND M.SODTYPE=51 ' **+**
' AND EXISTS(SELECT 1 ' **+**
' FROM MTRTRN N ' **+**
' WHERE N.MTRL=M.MTRL ' **+**
' AND N.TRDR=' **+** SALDOC**.** TRDR **+** ') ' **+**
'ORDER BY M.CODE, M.NAME' **, null);
if (** ds**.** RECORDCOUNT **>** 0 **) {**
ds**.** FIRST **;
while (!** ds**.** EOF **()) {**
CCCPICKITEMS**.** APPEND **;**
CCCPICKITEMS**.** MTRL **=** ds**.** MTRL **;**
CCCPICKITEMS**.** CODE **=** ds**.** CODE **;**
CCCPICKITEMS**.** NAME **=** ds**.** NAME **;**
CCCPICKITEMS**.** QTY1 **=** 0 **;**
CCCPICKITEMS**.** QTY1OLD **=** ds**.** QTY1MONTH **;**
CCCPICKITEMS**.** QTY1CONTRACT **=** ds**.** QTY1YEAR **;**
CCCPICKITEMS**.** POST **;**
ds**.** NEXT **;
}
} else {**
X**.** WARNING **(** 'No transactions found for the specific customer!' **);
}
} else {**
X**.** WARNING **(** 'Please select a customer!' **);
}
}**


### ON_SubFormName_ACTIVATE

Fires on after-show of a sub form. Usually used to change the layout (hide panels, change colors).

**function** ON_MYPOPUPFORM_ACTIVATE **() {**
X**.** FIELDCOLOR **(** 'CCCMYVIRTUALTABLE.CCCS1INIT_CCCS1INIT_MYITEMSNO' **,** 50000 **);
}**

### ON_SubFormName_ACCEPT

Fires when users click on the “OK” button of a sub form.

**Example
Module** : Sales Documents

**Job** : Add items to sales document from custom virtual table (CCCPICKITEMS), that is displayed through

pop up form (FORMPICKITEMS). The virtual table is populated when the pop-up form is displayed (event
ON_SHOW, see above example).

**function** ON_FORMPICKITEMS_ACCEPT **() {**
CCCPICKITEMS**.** FIRST **;
while (!** CCCPICKITEMS**.** EOF **()) {
if (** CCCPICKITEMS**.** QTY1 **>** 0 **) {**
ITELINES**.** APPEND **;**
ITELINES**.** MTRL **=** CCCPICKITEMS**.** MTRL **;**
ITELINES**.** QTY1 **=** CCCPICKITEMS**.** QTY1 **;**
ITELINES**.** POST **;
}**
CCCPICKITEMS**.** NEXT **;
}
}**

### ON_SubFormName_CANCEL

Fires when users click on the “CANCEL” button of a sub form.


## J. Report Objects Events

This module demonstrates all the line printing events that you can use in report objects.

### ON_BANDSTART(BandName)

Start Band Print

### ON_BANDEND(BandName)

End Band Print

### ON_BANDLINE(BandName)

Line Band Print

### ON_BANDTRANSFER(BandName)......................................................................................................................................................

Print Transfer Values

**Example
function** ON_OPENREPORT **() {**
X**.** SETPARAM **(** 'STARTPAGEFIELD' **,** USR**.** FPAGEL **);
return true;
}**

**function** ON_BANDTRANSFER **(** BandName **) {**
X**.** SETTRANSFERVALUE **(** BandName **,** 'MYACNTRN.X1' **,** 1 **);**
X**.** SETTRANSFERVALUE **(** BandName **,** 'MYACNTRN.P1' **,** 2 **);
return true;
}**

**function** ON_BANDEND **(** BandName **) {
if (** BandName **==** 'MYACNTRN' **) {**
X**.** SETPRINTPARAM **(** BandName **,** "CAPTIONFIELDNAME" **,** "THECAPTION" **);**
ds **=** X**.** GETENDBANDDATASET **(** 'MYACNTRN' **);**
ds**.** APPEND **;
for (** i **=** 0 **;** i **<** ds**.** FIELDCOUNT **;** i **++)** ds**.** FIELDS **(** i **)=** i **;**
ds**.** THECAPTION **=** "MyCaption" **;**
ds**.** POST **;
}
return true;
}**

**function** ON_BANDLINE **(** BandName **) {
if (** BandName **==** 'MYACNTRN' **) {**
MYACNTRN**.** EDIT **;
if (** MYACNTRN**.** FINCODE **==** 'Sum' **)**
MYACNTRN**.** FINCODE **=** 'NewName' **;
}
return true;
}**


## K. Advanced JavaScript

Advanced JavaScript is an embedded tool for writing scripts in JavaScript. Its main purpose is to override SoftOne
objects (internal or custom) functionality, as form scripts, but the main difference is that it affects all the forms of an
object (as EDA). It uses the same principles, events, methods and functions as form scripts and it’s categorized in
modules and packages, where one package may contain many modules. There is also another way to use it, which is
for creating custom web services that is discussed in Chapter Web Services.

Modules are saved as records inside the table CSTINFO (CSTTYPE=16) and can be imported / exported as “.cst”,
“.auv” files using the “Custom Administration” tool.

### K.1 JSMain

The Module that is triggered on Login is **JSMain** and it needs to be added manually. Right click on “Custom”
Package, select “New Module” and enter the name JSMain (Figure K 1 .1).
Inside this module enter the SoftOne objects and the names of the corresponding modules using the function
below (use any name for the modules).

**AddCode(** 'ObjectName' **,** 'ModuleName' **);**

In the example of Figure K1. 2 , JSMain adds JavaScript code that overrides the functionality of the objects ITEM,
CUSTOMER and CONVERTDLG (Documents Conversion).

```
Figure K 1 .1 – JS Main
```
```
Figure K1. 2 – Custom Library
```

Module **CustomerJSCode** (Figure K1.3) contains code that displays a warning message when a new customer
record is posted. Notice in Figure K1. 4 that the selected form is the default one.

The custom function **CheckUsersAccess** , that is used in **ON_FORMLOAD** and **ON_LOCATE** events, uses the
function **X.FORM** in order to ban specific users from using the form SOACTIONDBView (Figure K1.5).

```
Figure K1. 3 – Module CustomerJSCode
```
```
Figure K1. 4 – Warning Message on Customer post
```
```
Figure K1. 5 – Prohibition Message
```
The module **CONVERTDLGJSCode** (Figure K1. 6 ) contains code that affects the dialog of documents conversion.


It uses the ON_CREATE event to change the Expenses filter flag to Yes, only for Sales Documents Conversion
(sosource=1351).

It also overrides the change event of the filter field Company, in order to alter the value of Series (Figure K1.8).
Notice the custom warning messages (sosource and selected records) that are displayed when the dialog is created
(Figure K1.7).

```
Figure K1.6 – Conversion Dialog script
```
**function** ON_CREATE **() {**
X**.** WARNING **(** X**.** GETPARAM **(** 'SOSOURCE' **));**

**if (** X**.** GETPARAM **(** 'SOSOURCE' **) ==** 1351 **) {** //Sales Documents Conversion
CONVERTFPRMS**.** EDIT **;**
CONVERTFPRMS**.** KEEPEXPN **=** 1 **;** //Change the Expenses flag

**var** vSelRecs **=** X**.** GETPARAM **(** 'SELRECS' **);** //Get the selected records ...
X**.** WARNING **(** vSelRecs **);
}
else if (** X**.** GETPARAM **(** 'SOSOURCE' **) ==** 1251 **) {** //Purchases Documents Conversion
//Add code here
**}
}**

**function** ON_CONVERTFPRMS_COMPANY **() {** //On Change event of a field(e.g. Company)
**if (** X**.** GETPARAM **(** 'SOSOURCE' **) ==** 1351 **) {** //Check if "Sales Conversion"
CONVERTFPRMS**.** EDIT **;
if (** CONVERTFPRMS**.** COMPANY **>** 0 **) {**
CONVERTFPRMS**.** SERIES **=** 7063 **;** //Assign a value to a filter field
**}
}
}**


**Figure K1.7 – Conversion Sosource parameter and selected records**

```
Figure K1.8 – Conversion Dialog Filters
```

### K.2 Library

Another feature of Advanced JS is that it can be used as library that holds custom functions, which can be later
referenced in other Adv.JS or Form scripts through the command **lib.include('MyCustomLib')** (Figures K2. 1 & K 2. 2 ).

```
Figure K2. 1 – Custom Library
```
```
Figure K2.2 – Library reference in Sales Documents script
```

### K.3 Debug Functions

All the functions created in Advanced JavaScript can be tested using the button “Run JavaScript”. Enter the name
of the function inside “Function Name” and click on “Run”. The Result will appear as in Figure K3.1.

Functions with parameters can be tested as in Figure K3.2.

**function** GetOrdersJSON **(** vFiscprd **,** vPeriod **) {
var** str **=** "SELECT FINDOC, SERIES, TRDR, SUMAMNT FROM FINDOC WHERE COMPANY=:1 AND
TFPRMS=201 AND FISCPRD=:2 AND PERIOD=:3" **;
var** ds **=** X**.** GETSQLDATASET **(** str **,** X**.** SYS**.** COMPANY **,** vFiscprd **,** vPeriod **);
return** ds**.** JSON **;
}**

```
Figure K3. 1 – Test Function
```
```
Figure K3.2 – Test Function with Parameters
```

## Case Studies

### 1. Print Form using dialog that asks for number of copies

**Module** : Sales Documents
**Job** : Print item templates form using custom button for the selected item line.

**Extra features** : Prompt user to enter number of copies to print, through a dialog message box. Default
value is the quantity of the selected item line.

**function** EXECCOMMAND **(** cmd **) {** //Controls Commands
**if(** cmd **==** 20180101 **) {** //Checks the ID of the button clicked
iCopies **=** X**.** INPUTQUERY **(** 'Print item' **,** 'Number of copies: ' **,** ITELINES**.** QTY1 **,** 0 **);**
//The above line displays a dialog box, which allow users to specify the
number of copies to print. Default value is the quantity of the item line.
**if(** iCopies **!=** '' **) {
var** ObjItem **;**
i **=** 1 **;**
ObjItem **=** X**.** Createobj **(** 'ITEM' **);** //Create Object Item
**try {**
ObjItem**.** DBLocate **(** ITELINES**.** MTRL **);** //Locate ITEM using the selected
item from document lines
**while(** i **<=** iCopies **) {**
ObjItem**.** PRINTFORM **(** 100 **,** 'HP LaserJet 4100 Series PCL' **,** '' **);**
i **++;
}
}
catch(** e **) {
if (** myObj **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error:
" **+** myObj**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}
}
}
}**

```
Figure CS1.1 - Item Printout Form
```

```
Figure CS1.2 – Form button design
```
**Figure CS1.3 – Dialog “Number of Copies”, on click of button "Print Labels"**


### 2. Delete related converted documents

**Module** : Sales documents
**Job** : Button that deletes the converted documents related to the located record.

**function** EXECCOMMAND **(** cmd **) {** //Controls Commands
**if(** cmd **==** 100002 **) {** //Check the ID of the button clicked
DelConvertedDocs **();
}
}**

**function** DelConvertedDocs **() {** //Finds and deletes converted documents.
//SQL statement for searching converted documents based on the located
strqry **=** 'SELECT DISTINCT FINDOC AS FINDOC FROM MTRLINES WHERE SOSOURCE=1351 '
**+** 'AND COMPANY **=** '+X.SYS.COMPANY+' AND FINDOCS **=** ' + SALDOC.FINDOC;
ds **=** X**.** GETSQLDATASET **(** strqry **,null);**
ds**.** FIRST **;
while(!** ds**.** EOF **()) {** //Loop and delete the documents found
ObjConv **=** X**.** CreateObj **(** 'SALDOC' **);** //Create Sales Object
**try {**
ObjConv**.** DBLocate **(** ds**.** FINDOC **);** //Locate record
ObjConv**.** DBDelete **;** //Delete record
**}
catch(** e **) {
if (** ObjConv **!= null)**
X**.** WARNING **(** "General Error: " **+** e**.** message **+** "\nObject Error: " **+**
ObjConv**.** GETLASTERROR **);
else**
X**.** WARNING **(** "General Error: " **+** e**.** message **);
}
finally {
}**
ds**.** NEXT **;
}
}**


### 3. Get Compressed Data

Open “compressed” field SOVAL (table FPRMS), find the value of the accounting field (ACNMSK) and
display it in a message box.

**function** GetACNMSK **() {
var** dsFPRMS **=** X**.** GETSQLDATASET **(** "SELECT SOVAL "
**+** "\n FROM FPRMS "
**+** "\n WHERE SOSOURCE=1351 "
**+** "\n AND COMPANY=" **+** X**.** SYS**.** COMPANY **+** " AND
FPRMS=" **+** SALDOC**.** FPRMS **,** "" **);
var** strSOVAL **=** dsFPRMS**.** SOVAL **;**

**var** sVal **=** X**.** EVAL **(** "GETQUERYVALUE('" **+** strSOVAL **+** "',0,25)" **);**
//Returns the value of the 1st line (zero based) and 26th place of the field
SOVAL delimeted by character |. (The above example uses 0,25)

X**.** WARNING **(** "Account field value for Type " **+** SALDOC**.** FPRMS **+** " is : " **+** sVal **);
}**

```
Figure CS3.1 – FPRMS form – Account Field (CTRL + SHIFT + F12)
```
```
Figure CS3.2 - SQL statement that returns the data of the field SOVAL (Position of the field ACNMSK)
```

### 4. Run Batch Job

**Module** : Items
**Job** : Execute the batch job "Modify sales prices" using a custom button.

**Extras** : 1) Change the value of the job filter "Current prices and given percentage".
2) Promt user to enter the percentage that will be used as job filter.

**function** ChangePrices **() {**
ObjIteCost **=** X**.** CreateObj **(** 'IteCalcMarkUp' **);
try {**
ObjIteCost**.** DBInsert **;**
TblIteCost **=** ObjIteCost**.** FindTable **(** 'MTRDIALOG' **);**
TblIteCost**.** Edit **;**
TblIteCost**.** FROMCODE **=** ITEM**.** CODE **;**
TblIteCost**.** TOCODE **=** ITEM**.** CODE **;**
iSODOUBLE1 **=** X**.** INPUTQUERY **(** 'Modify sales prices' **,** 'Percentage value' **,** 0 **,** 0 **);
if(** iSODOUBLE1 **!=** '' **) {** //Not Cancel
TblIteCost**.** SODTYPE **=** 1 **;** //Calculation based on "Current prices and given
percentage"
TblIteCost**.** SODOUBLE1 **=** iSODOUBLE1 **;**
ObjIteCost**.** BatchExecute **;**
X**.** EXEC **(** 'button:Save' **);** //Saves current item record and relocates to
display the calculation
X**.** WARNING **(** "Job completed!" **);
}
}
finally {
}
}**

```
Figure CS4.1 – Design button (using virtual table field) Figure CS4.2 - JavaScript code inside Items form
```

**Figure CS4.3 - Items form – Button click– Display of dialog window**

```
Figure CS4.4 - Results (Price is increased by 20%)
```

### 5. Custom Screen Filters

**Module** : Sales documents
**Job** : Filter line items by name, based on custom field inside the form.

**function** ON_SALDOC_V1 **() {**

vFilterString **=** '{ITELINES.MTRL_ITEM_NAME}=' **+** String**.** fromCharCode **(** 39 **)+** SALDOC**.** V1 **+** String**.** f
romCharCode **(** 39 **)
if(** SALDOC**.** V1 **==** '' **) {**
ITELINES**.** FILTERED **=** 0 **;** //Deactivates all filters on ITELINES
**}
else {**
ITELINES**.** FILTER **=** '(' **+** vFilterString **+** ')' **;** //Filter value
ITELINES**.** FILTERED **=** 1 **;** //Runs filter
**}
}**

**function** ON_POST **() {**
ITELINES**.** FILTERED **=** 0 **;** //Deactivates all filters on ITELINES
**}**

**function** ON_CANCEL **() {**
ITELINES**.** FILTERED **=** 0 **;** //Deactivates all filters on ITELINES
**}**

```
Figure CS5.1 - Documents screen with lines filter field
```

```
Figure CS5.2 - Lines display after using the filter
```
**Figure CS5.3 - The user-defined field must be inserted in FINDOC (Sales documents) table**


### 6. Virtual Table – Item Purchases

**Module** : Sales documents
**Job** : Pop up form that displays item purchases on item line click.

**Extras** : 1) Price Calculation inside the grid of the pop-up form based on user values.
2) Button that adds the calculated price as line price in item lines.

**Design**

Create a virtual table in database designer named CCCITEMPURDOC with fields as in Figure CS6.1.

```
Figure CS6.1 - Virtual Table Fields
```
In sales documents create a new panel containing a datagrid with fields from the virtual table you created. Add also
a new button (Figure CS6.2).

```
Figure CS6.2 - Sales View – Virtual table design
```
In form script enter the following code that finds the latest purchases for the selected line item and displays them in
a datagrid of a pop up window.

**var** vIncrement **;** //Increment percentage
**function** ON_MYPOPUPFORM_SHOW **() {**
vIncrement **=** 40 **;**
GetItemPurdoc **();** //Gets the purchases for the selected Item
CCCVTITEMPUR**.** FIRST **;
}**

**function** InsPRCtoMTRLINES **(** vTable **) {** //Insert Price to Mtrlines
ITELINES**.** PRICE **=** vTable**.** PRICE **;
}**

**function** GetItemPurdoc **() {** //Last 20 Purchases for selected item
strqry **=** "SELECT TOP 20 A2.TRDR, A1.MTRLINES, A1.FINDOC,"
**+** "\n (A1.LINEVAL/case A1.QTY1 when 0 then 1 else A1.QTY1 end) AS LINEVAL,
A1.QTY1"


**+** "\n FROM MTRLINES A1 INNER JOIN FINDOC A2 ON A1.FINDOC=A2.FINDOC AND
A1.COMPANY=A2.COMPANY"
**+** "\n WHERE "
**+** "\n A2.SOSOURCE=1251 "
**+** "\n AND A2.TFPRMS IN(102,103) "
**+** "\n AND A1.COMPANY=" **+** X**.** SYS**.** COMPANY
**+** "\n AND A1.MTRL=" **+** ITELINES**.** MTRL
**+** "\n ORDER BY A2.TRNDATE DESC" **;**
ds **=** X**.** GETSQLDATASET **(** strqry **,** '' **);**
CCCVTITEMPUR**.** FIRST **;
while (** CCCVTITEMPUR**.** RECORDCOUNT > 0 **) {**
CCCVTITEMPUR**.** DELETE **;
}
if (** ds**.** RECORDCOUNT **>** 0 **) {
try {**
dsLink **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataset' **,** X**.** MODULE **,** 'CCCVTITEMPUR' **);**
X**.** EXEC **(** 'CODE:ModuleIntf.SetDatasetLinks' **,** X**.** MODULE **,** dsLink **,** 0 **);**
//Disables Links
**while (!** ds**.** EOF **()) {**
CCCVTITEMPUR**.** APPEND **;**
CCCVTITEMPUR**.** TRDR **=** ds**.** TRDR **;**
CCCVTITEMPUR**.** FINDOC **=** ds**.** FINDOC **;**
CCCVTITEMPUR**.** MTRLINES **=** ds**.** MTRLINES **;**
CCCVTITEMPUR**.** PRICESTART **=** ds**.** LINEVAL **;**
CCCVTITEMPUR**.** INCREMENT **=** vIncrement **;**
CCCVTITEMPUR**.** QTY **=** ds**.** QTY1 **;**
CCCVTITEMPUR**.** POST **;**
ds**.** NEXT **;
}
}
finally {**
X**.** EXEC **(** 'CODE:ModuleIntf.SetDatasetLinks' **,** X**.** MODULE **,** dsLink **,** 1 **);** //Enables
Links - Sends at the end 1 query for all
**}
}
}
function** ON_CCCVTITEMPUR_INCREMENT **() {** //On change of the increment percentage the
final price will be updated
CCCVTITEMPUR**.** PRICE **=** CCCVTITEMPUR**.** PRICESTART **+ (** CCCVTITEMPUR**.** PRICESTART *****
CCCVTITEMPUR**.** Increment **/** 100 **);
}**

Double click on each line of the document to display the pop up window as shown in Figure D6.3

```
Figure CS6.3 - Pop up Window from double clicking on the item lines
```

### 7. HTTP Request – Google Maps Distance

**Module** : Sales documents
**Job** : Use Google maps API to calculate distance and shipping cost.

Distance is calculated in km and uses the address and the postal code of the “WHouse” that is in the
header of the document (MTRDOC.WHOUSE) and the shipment address and postal code of the

document.

There is also a button “Show map” that displays the distance in Google maps web page.

**Design**

Create a new form in sales documents and design panels with the following buttons and fields:

**Button «Calc Trans Cost»** (RUNB_700001=Calc Ship Cost)
Virtual field that will be used to calculate the distance from Google Maps.

**Fields SALDOC.NUM01 «Distance(Km)» and SALDOC.NUM02 «Duration(min)»**
Fields that will be updated from Google Maps (button Calc Ship Cost).

**Fields SALDOC.NUM03 «Cost/Km» and SALDOC.NUM04 «Total Cost»**
Fields that will be calculated by field Distance.

**Button «Add to Expenses»** (RUNB_700002=Add to Expenses)
Virtual field that will be used to insert a new record in table expenses with the value of the field “Total Cost”
(SALDOC.NUM04).

**Button «ShowMap»** (RUNB_700003=ShowMap)
Virtual field that will be used to open the google maps web page with the selected SoftOne values.

The form will look as in figure CS7.1. In the form script insert the code (JavaScript) of the next pages.

```
Figure CS7.1
```

**How it works**

When user clicks on button "Calc Ship Cost" then distance will be calculated using:

**From address** :
Address and postal code are retrieved from the “WHouse” selected in the document. The country is retrieved from
the branch of the document.

**To address** :
Calculated from the fields shipping address (MTRDOC.SHIPPINGADDS) and shipping postal code (MTRDOC.SHPZIP)
from the sales document.

After the calculation the fields Distance(km) and Duration(min) are updated with data from Google Maps. Also the
field Cost/km is updated with the value 0.10 if the km are below 50 or else with the value 0.20.
Finally, the field Total Cost is calculated from the fields Distance and Cost/km.

Clicking on button «Add to Expenses» creates a new record in table expenses using the expense with code 101 and
the value of the field Total Cost.

**function** distancematrix **(from,** to **) {
this.from= from ||** "" **;
this.** to **=** to **||** "" **;
this.** onSuccess **= function(){};
this.** onNoReply **= function(){};
this.** onError **= function(){};
this.** request **= null;
var** me **= this,**
url **;
this.** execute **=
function() {
from = encodeURIComponent(from);**
to **= encodeURIComponent(** to **);**
url **=**
'http://maps.googleapis.com/maps/api/distancematrix/json?sensor=false&origins='
**+ from +** '&destinations=' **+** to **;
this.** request **= new** ActiveXObject **(** "MSXML2.XMLHTTP" **);
this.** request **.open(** 'GET' **,** url **, true);
this.** request**.** onreadystatechange **=
function() {
if (** me**.** request**.** readyState **==** 4 **) {
if (** me**.** request **.status==** 200 **)**
me**.** onSuccess **(** me**.** request**.** responseText **);
else**
me**.** onNoReply **();
}
}
try {
this.** request**.** send **();
}
catch(** e **) {
this.** onError **(** e **);
}
}
}**


**function** GetDirections **() {
var** distance **=** 0 **;
var** duration **=** 0 **;**
str **=** " SELECT ADDRESS, ZIP"
**+** "\n , (SELECT NAME FROM COUNTRY "
**+** "\n WHERE COUNTRY=(SELECT COUNTRY FROM BRANCH "
**+** "\n WHERE COMPANY=" **+** SALDOC**.** COMPANY
**+** "\n AND BRANCH=" **+** SALDOC**.** BRANCH **+** ") ) AS COUNTRY"
**+** "\n FROM WHOUSE "
**+** "\n WHERE COMPANY=" **+** SALDOC**.** COMPANY **+** " AND WHOUSE=" **+** MTRDOC**.** WHOUSE **;**
ds **=** X**.** GETSQLDATASET **(** str **,null);
var from =** ds**.** ADDRESS **+** ',' **+** ds**.** ZIP **+** ',' **+** ds**.** COUNTRY **,**
to **=** MTRDOC**.** SHIPPINGADDR **+** ',' **+** MTRDOC**.** SHPZIP **+** ',' **+** ds**.** COUNTRY **;**
dm **= new** distancematrix **(from,** to **);**
dm**.** onSuccess **=
function(** reply **) {**
eval **(** 'var data = ' **+** reply **);
if (** data **.status ===** 'OK' **) {**
distance **=** roundNumber **((** data**.** rows **[** 0 **].elements[** 0 **].** distance**.** value **/** 1000 **),** 2 **);**
duration **=** roundNumber **((** data**.** rows **[** 0 **].elements[** 0 **].** duration**.** value **/** 60 **),** 2 **);**
SALDOC**.** NUM01 **=** distance **;**
SALDOC**.** NUM02 **=** duration **;
}
else {**
X.WARNING("Google maps API Error: " + data.status + "\n\nError Message: "+
data.error_message);
**}
};**
dm**.** execute **();
}**

**function** roundNumber **(** num **,** dec **) {
var** result **=** Math**.** round **(** num ***** Math**.** pow **(** 10 **,** dec **))/** Math**.** pow **(** 10 **,** dec **);
return** result **;
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** '700001' **)**
GetDirections **();
if (** cmd **==** '700002' **) {**
X**.** FOCUSFIELD **(** 'SALDOC.NUM01' **);**
AddtoExpenses **();
}
if (** cmd **==** 700003 **)**
ShowMap **();
}**

**function** AddtoExpenses **() {
if(** SALDOC**.** NUM04 **!=** '' **) {**
EXPANAL**.** APPEND **;**
EXPANAL**.** EXPN **=** 101 **;**
EXPANAL**.** EXPVAL **=** SALDOC**.** NUM04 **;**
EXPANAL**.** POST **;
}
}**

**function** ON_SALDOC_NUM01 **() {**
CalculateShipCost **();
}**


**function** CalculateShipCost **() {
if(** SALDOC**.** NUM01 **<=** 50 **) {**
SALDOC**.** NUM03 **=** 0.10 **;
}
else {**
SALDOC**.** NUM03 **=** 0.20 **;
}**
SALDOC**.** NUM04 **=** SALDOC**.** NUM03 ***** SALDOC**.** NUM01 **;
}**

**function** ShowMap **() {**
str **=** " SELECT ADDRESS"
**+** "\n , ZIP"
**+** "\n , (SELECT NAME FROM COUNTRY "
**+** "\n WHERE COUNTRY=(SELECT COUNTRY FROM BRANCH "
**+** "\n WHERE COMPANY=" **+** SALDOC**.** COMPANY
**+** "\n AND BRANCH=" **+** SALDOC**.** BRANCH **+** ") ) AS COUNTRY"
**+** "\n FROM WHOUSE "
**+** "\n WHERE COMPANY=" **+** SALDOC**.** COMPANY **+** " AND WHOUSE=" **+** MTRDOC**.** WHOUSE **;**
ds **=** X**.** GETSQLDATASET **(** str **,null);
var** from **=** ds**.** ADDRESS **+** ',' **+** ds**.** ZIP **+** ',' **+** ds**.** COUNTRY **,
var** to **=** MTRDOC**.** SHIPPINGADDR **+** ',' **+** MTRDOC**.** SHPZIP **+** ',' **+** ds**.** COUNTRY **;**

**if** ( (MTRDOC.SHIPPINGADDR == '') || (MTRDOC.SHPZIP =='') || (ds.ADDRESS == '') ||
(ds.ZIP =='')){
X.EXCEPTION('Not valid data');
}

from **=** from**.** replace **(** ' ' **,** '+' **);**
to **=** to**.** replace **(** ' ' **,** '+' **);**

**var** shellObj **= new** ActiveXObject **(** "WSCript.Shell" **);
var** aCommand **=** 'chrome
[http://maps.google.com/maps?saddr='](http://maps.google.com/maps?saddr=') **+from+** '&daddr=' **+** to **+** '&hl=en' **;**
shellObj**.** Run **(** aCommand **,true);
}**


### 8. Run External Application

**Module** : Stock Items
**Job** : Run external application on button click, using the data of the field ITEEXTRA.VARCHAR01 as

command line arguments.

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201909081 **) {**
RunExternalApplication **();
}
}**

**function** RunExternalApplication **() {
var** oShell **= new** ActiveXObject **(** "Shell.Application" **);
var** sFile **=** "C:\\SoftoneVersions\\Soft1Current\\Xplorer.exe" **;
var** vArguments **=** "/" **+** ITEEXTRA**.** VARCHAR01 **;
var** vDirectory **=** "" **;
var** vOperation **=** "open" **;
var** vShow **=** "1" **;**
oShell**.** ShellExecute **(** sFile **,** vArguments **,** vDirectory **,** vOperation **,** vShow **);**

// == vShow Parameters == //
// https://docs.microsoft.com/en-us/windows/desktop/shell/shell-shellexecute
//0=Open the application with a hidden window.
//1=Open the application with a normal window. If the window is minimized or
maximized, the system restores it to its original size and position.
//2=Open the application with a minimized window.
//3=Open the application with a maximized window.
//4=Open the application with its window at its most recent size and position. The
active window remains active.
//5=Open the application with its window at its current size and position.
//7=Open the application with a minimized window. The active window remains active.
//10=Open the application with its window in the default state specified by the
application.
**}**


### 9. Add Related Jobs in SoftOne Objects

**Module** : Sales Documents
**Job** : Add two custom related jobs in Sales Documents. The first job executes a Dialog object, that is

previously created in SoftOne Database Designer and the second one is handled by the EXECCOMMAND
function.

**function** ON_CREATE **() {**
AddRelativeJob **();
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 201809091 **) {**
X**.** WARNING **(** "Custom Relative Job 2 clicked" **);**
//Add code here (open sub form, run scripts, etc.)
**}
}**

**function** AddRelativeJob **() {
var** fObjectName **=** 'SALDOC' **;
var** fCmd **=** '' **;**

fCmd **=** 'CCCMYDIALOGOBJECT' **;** //Dialog object inside SoftOne Database Designer
**if (** RelJobExists **(** fObjectName **,** fCmd **) ==** 0 **)** //Check to prevent double entries
X**.** EXEC **(** 'CODE:SysRequest.InsRelativeJob' **,** fObjectName **,** 'Rel Job 1' **,** fCmd **);**

fCmd **=** '201809091' **;
if (** RelJobExists **(** fObjectName **,** fCmd **) ==** 0 **)**
X**.** EXEC **(** 'CODE:SysRequest.InsRelativeJob' **,** fObjectName **,** 'Rel Job 2' **,** fCmd **);
}**

**function** RelJobExists **(** fObjectName **,** fRelJobCmd **) {
var** fRelJobExists **=** 0 **;
var** fRelJob **=** '' **;
var** i **=** 0 **;**

**while (** i **==** 0 **||** fRelJob **!=** '' **) {**
fRelJob **=** X**.** EXEC **(** 'CODE:SysRequest.GetRelativeJob' **,** fObjectName **,** i **);
if (** fRelJob**.** indexOf **(** fRelJobCmd **) >** 0 **)**
fRelJobExists **=** 1 **;**
i **=** i **+** 1 **;
}
return** fRelJobExists **;
}**


### 10. Run SBSL script without UI (filters screen)

**Module** : Sales Documents
**Job** : Auto-execute SBSL script after posting a sales documents record without displaying the script filters

screen (use the default script filter values).

**function** ON_AFTERPOST **() {**
RunSBSLScript **();
}**

**function** RunSBSLScript **() {
var** obj **=** X.CREATEOBJFORM('CLIENTIMPORT2,SCRIPTNAME:MYSBSLSCRIPT' **);**
obj.BATCHEXECUTE **;
}**

**_Note that you can also pass parameters to the script (see section E.4 Run using Parameters)._**
X**.** CREATEOBJFORM **(** 'CLIENTIMPORT,SCRIPTNAME:MYSCRIPT,par1:10,par2:' **+** SALDOC**.** CCCMYFIELD **);**

```
Figure CS10.1 – Run SBSL script without UI
```

### 11. Auto a pply ABC model.

**Module** : Supplier Other Transactions
**Job** : Auto apply ABC **model** in lines of “Supplier Other Transactions”. The ABC Model that is applied in

LINLINES is taken either from LINEITEM object or from PRNSIN, depending on lines data.

The function that applies the ABC Model is the following:

**X.CALLPUBLISHED('ProgLibIntf.ModuleCommand', X.MODULE, 10120 , sCommand)**

**10120** is an internal command that applies ABC Model using table name and ABC dimension model IDs

from the parameter sCommand.

sCommand **=** S1Tablename **+** ';' **+** dim1ABCModelID **+** ';' **+** dim2ABCModelID **+** ';' **+** dim3ABCModelID **+** ';'
**+** dim4 **+** ';' **+** dim5 **+** ';' **+** dim6 **+** ';' **+** dim7 **+** ';' **+** dim8 **+** ';' **+** dim9 **+** ';' **+** dim10 **;
Example:** sCommand **=** 'LINLINES;10;43;0;0;0;0;0;0;0;0' **;**

**function** ON_POST **() {**
CheckToAUTOCreateABC **();**
//Gets ABC Model from PRSNIN or LINEITEM (if LINLINES.PRSN is null)
**}**

**function** CheckToAUTOCreateABC **() {**
LINLINES**.** DISABLECONTROLS **();**
FINDOC**.** NOTCALC **=** 1 **;
try {**
LINLINES**.** FIRST **;
while(!** LINLINES**.** EOF **) {
if ( (** LINLINES**.** LINEVAL **!=** 0 **)
&& (** LINLINES**.** ISNULL **(** 'MTRL' **) ==** 0 **)
&& (** LINLINES**.** ISNULL **(** 'SALESMAN' **) ==** 1 **) )**
//53=Debits/Credits-->Model from object LINEITEM
AutoFillABCfromModel **(** 'LINLINES' **,** LINLINES**.** MTRL **,** 53 **);
if ( (** LINLINES**.** LINEVAL **!=** 0 **)
&& (** LINLINES**.** ISNULL **(** 'MTRL' **) ==** 0 **)
&& (** LINLINES**.** ISNULL **(** 'SALESMAN' **) ==** 0 **) )**
//20=Company employees --> Model from object PRSNIN
AutoFillABCfromModel **(** 'LINLINES' **,** LINLINES**.** SALESMAN **,** 20 **);**
LINLINES**.** NEXT **;
}
}
finally {**
FINDOC**.** NOTCALC **=** 0 **;**
LINLINES**.** ENABLECONTROLS **();
}
}**


**function** AutoFillABCfromModel **(** S1Tablename **,** iID **,** iSodtype **) {**
//ABC Dimensions (1,2,13,14) are defined in ABC Settings --> Replace with your own
str **=** ";WITH cte AS"
**+** " (SELECT 1 x"
**+** " UNION ALL"
**+** " SELECT x + 1"
**+** " FROM cte"
**+** " WHERE x < 10)"
**+** " SELECT x,ISNULL(a.ABCDIMMDL,0) AS ABCDIMMDL"
**+** " FROM cte c "
**+** " LEFT OUTER JOIN ABCMDLMASTER a on c.x = (CASE a.DIMENSION "
**+** " WHEN 1 THEN 1 "
**+** " WHEN 2 THEN 2 "
**+** " WHEN 13 THEN 3 "
**+** " WHEN 14 THEN 4 "
**+** " ELSE 0 END)"
**+** " AND a.COMPANY=" **+** X**.** SYS**.** COMPANY
**+** " AND a.ABCDTYPE=" **+** iSodtype
**+** " AND a.MASTERID=" **+** iID
**+** " ORDER BY 1" **;**
ds **=** X**.** GETSQLDATASET **(** str **,null);
var** strModels **=** '' **;
if (** ds**.** RECORDCOUNT **>** 0 **) {**
ds**.** FIRST **;
while (!** ds**.** EOF **) {**
strModels **+=** ';' **+** ds**.** ABCDIMMDL **;**
ds**.** NEXT **;
}**
sCommand **=** S1Tablename **+** strModels **;** //X.WARNING("sCommand="+sCommand);
//sCommand = S1Tablename+';'+dim1+';'+dim2+';'+dim3+';'+dim4+';'+dim5+';'
+dim6+';'+dim7+';'+dim8+';'+dim9+';'+dim10;
X**.** CALLPUBLISHED **(** 'ProgLibIntf.ModuleCommand' **,** X**.** MODULE **,** 10120 **,** sCommand **);
}
}**

```
Figure CS11.1 – ABC Dimension Parameters
```

### 12. SubMenu in Button

**Module** : Sales Documents
**Job** : Create and show a sub menu when user clicks on a button (id “20202020”) and display warning

messages when sub menu items are clicked.

**Design**

Create a form in sales documents and add a new button: **RUNB_20202020=Button with SubMenu** (Figure CS12.2).

In Configuration window add a new StringList named “ **MyButtonMenu** ” and insert two items as in Figure CS12.3.
This string list defines the sub menu items that will be displayed on button click. The event that fires when users
click on these items is the **EXECCOMMAND**.

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20202020 **) {
var** mysubmenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'MyButtonMenu' **);
var** mypopup **=** X**.** EXEC **(** 'CODE:SysRequest.CreateApplPopup' **,** X **,** 0 **);**
X**.** EXEC **(** 'CODE:SysRequest.ShowApplPopup' **,** mypopup **,** mysubmenu **);
}
else if (** cmd **==** 20202021 **) {**
X**.** WARNING **(** "Button SubMenu 1 Clicked" **);
}
else if (** cmd **==** 20202022 **) {**
X**.** WARNING **(** "Button SubMenu 2 Clicked" **);
}
}**

```
Figure CS12.1 – Submenu on button click
```

```
Figure CS12.2 – Button Properties in Design Form
```
**Figure CS12.3 – SubMenu Items (created as StringList)**


### 13. ASCII Export / Import encoded file

**Module** : Sales Documents
**Job** : Button 1 that creates an output encoded Ascii file, that contains data from item lines

(Code,Name,Qty1,Price,Lineval) and uses specific delimiter.
Button 2 that reads Ascii file using specific codepage and displays the data in message boxes.

**Design**

Create a form inside sales documents and add two new buttons:
**RUNB_2020 0729 =ASCII Export Lines** and **RUNB_20200730=ASCII Read Lines** (Figure CS 13. 1 ).

Add the following code inside the tab “Script” of the “Configuration” window.

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20200729 **){**
AsciiExportLines **();
}
if (** cmd **==** 20200730 **){**
AsciiReadLines **();
}
}**

**function** AsciiExportLines **() {
var** vCodePage **=** 65001 **;** //UTF-8=65001, ANSI Greek=1253,
**var** vTextWrite **=** X**.** EXEC **(** "CODE:PILib.CreateText" **,** 'C:\\Temp\\AsciiExport.txt' **,**
vCodePage **);
var** vLine **=** "" **;
var** vSep **=** "|" **;**
ITELINES**.** DISABLECONTROLS **;
try {**
ITELINES**.** FIRST **;
while (!** ITELINES**.** EOF **) {**
vLine **=** ITELINES**.** X_CODE **+** vSep **+** ITELINES**.** X_NAME **+** vSep **+** ITELINES**.** QTY1 **+**
vSep **+** ITELINES**.** PRICE **+** vSep **+** ITELINES**.** LINEVAL **;**
X**.** CALLPUBLISHED **(** 'PILib.WriteLine' **,** vTextWrite **,** vLine **);**
ITELINES**.** NEXT **;
}**
X**.** EXEC **(** 'CODE:PILib.CloseText' **,** vTextWrite **);
}
catch (** e **) {**
X**.** WARNING **(** e**.** message **);
}
finally {**
ITELINES**.** ENABLECONTROLS **;
}**
X**.** WARNING **(** "Data Exported succesfully" **);
}
function** AsciiReadLines **() {
var** vTextFile **=** X**.** EXEC **(** 'CODE:PILib.OpenText **,** 'C:\\Temp\\AsciiFile.txt' **,** 65001 **);
var** vLine **=** "" **;
try {
while (!** X**.** EXEC **(** 'CODE:PILib.EOF' **,** vTextFile **)) {**
vLine **=** X**.** EXEC **(** 'CODE:PILib.ReadLine' **,** vTextFile **);**
X**.** WARNING **(** vLine **);
}
}
catch (** e **) {**
X**.** WARNING **(** e**.** message **);
}
finally {**
X**.** EXEC **(** 'CODE:PILib.CloseText' **,** vTextFile **);
}
}**


**Figure CS13.1 – Button “ASCII Export Lines”**

```
Figure CS13.2 – Ascii Export - Job Results
```

### 14. Get Browser field data

**Module** : Customers
**Job** : Browser right-click option that retrieves the selected browser records and displays the data of all the

fields ( **including user-defined ones** ). The following example fires only on browser “WS_MultiResultsSQL”
(Figure CS14.1), which uses the user-defined fields (Debit, Credit) created in section Multi Results SQL.

```
Figure CS14.1 – Job runs only on specific browser
```
```
Figure CS14.2 – Selected records data
```

**Design**

Create an Advanced JavaScript module for object CUSTOMER (e.g. _CustomerJSCode_ ) and add a reference in JSMain
module (Figure CS14. 3 ). Open _CustomerJSCode_ and enter the following code.

AddCode **(** 'CUSTOMER' **,** 'CustomerJSCode' **);**

```
Figure CS14. 3 – Ascii Export - Job Results
```
**How it works**

Browser data are stored in a dataset (e.g. dsBrowser) using the function GetDataset:

**var** dsBrowser **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataset' **,** X**.** Module **,** 'BROWSER' **);**

Field values are retrieved using the function GetFieldValue (e.g. field TRDR):

fldTRDR **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'TRDR' **);**

Iteration through all Browser records can be achieved using the following

X**.** EXEC **(** 'CODE:ModuleIntf.DatasetFirst' **,** dsBrowser **);** //Move to the first record
**while (** X**.** EXEC **(** 'CODE:ModuleIntf.DatasetEof' **,** dsBrowser **) ==** 0 **) {** //Iterate All Browser
Data
fldTRDR **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'TRDR' **);**
fldName **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'NAME' **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetNext' **,** dsBrowser **);
}**

In our example we store the selected records (SELRECS) in a variable (vSelRecs) and then we create a dataset
(vds) that contains the selected record ids.
Then we iterate over its data and locate the related dsBrowser records using the following:

**if (** X**.** EXEC **(** 'CODE:ModuleIntf.DatasetLocate' **,** dsBrowser **,** 'TRDR' **,** vds**.** TRDR **) ==** 1 **) {**
fldTRDR **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'TRDR' **);**
//...

vds**.** NEXT **;
}**


**Full Code**

**function** ON_CREATE **() {
var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '-=-' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '20200903=1;Get Browser Data' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20200903 **) {
if (** X**.** LIST **==** "WS_MultiResultsSQL" **)**
GetBrowserFieldData **();
else**
X**.** WARNING **(** "This option is available only for browser 'WS_MultiResultsSQL'" **);
}
}**

**function** GetBrowserFieldData **() {
var** vSelRecs **;
var** fldTRDR **;
var** fldName **;
var** fldDebit **;
var** fldCredit **;
var** SelData **=** "" **;
try {**
vSelRecs **=** X**.** GETPARAM **(** 'SELRECS' **);**
vSelRecs **=** vSelRecs**.** replace **(/\?/g,** "," **);**

**var** dsBrowser **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataset' **,** X**.** Module **,** 'BROWSER' **);**
//Browser dataset
**var** vds **=** X**.** GETSQLDATASET **(** 'SELECT DISTINCT TRDR FROM TRDR WHERE ' **+** vSelRecs **,
null);**
vds**.** FIRST **;
while (!** vds**.** EOF **()) {
if (** X**.** EXEC **(** 'CODE:ModuleIntf.DatasetLocate' **,** dsBrowser **,** 'TRDR' **,** vds**.** TRDR **) ==** 1 **) {**
fldTRDR **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'TRDR' **);**
fldName **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'NAME' **);**
fldDebit **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'Debit' **);**
fldCredit **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetFieldValue' **,** dsBrowser **,** 'Credit' **);**

fldDebit **=** S1P**.** Round **(** fldDebit **,** 2 **);**
fldCredit **=** S1P**.** Round **(** fldCredit **,** 2 **);**

SelData **+=** "Name: " **+** fldName **+** "\nDebit: " **+** fldDebit **+** "\nCredit: " **+**
fldCredit **+** "\n\n" **;
}**
vds**.** NEXT **;
}
if (** SelData**.** length **>** 0 **)**
SelData **=** SelData**.** slice **(** 0 **, -** 2 **);** //Remove last 2 characters
X**.** WARNING **(** SelData **);**
// X.EXEC('CODE:ModuleIntf.DatasetFirst', dsBrowser); //Move to the first record
// while (X.EXEC('CODE:ModuleIntf.DatasetEof', dsBrowser)==0) { //Iterate All
Browser Data
// fldTRDR = X.EXEC('CODE:ModuleIntf.GetFieldValue', dsBrowser, 'TRDR');
// fldName = X.EXEC('CODE:ModuleIntf.GetFieldValue', dsBrowser, 'NAME');
// X.EXEC('CODE:ModuleIntf.DatasetNext', dsBrowser);
// }
**} catch (** e **) {**
X**.** WARNING **(** "Error: " **+** e**.** message **);
}
return** SelData **;
}**


### 15. Add / Retrieve HTML data

**Job** : Functions that locate a SoftOne Object record (e.g. SOEMAIL) and add or retrieve HTML data from a
blob field (e.g. SOMAIL.SOBODY).

They can also be used inside a custom Advanced JS library and included in any form script (Figures below).

**function** GetHTMLFromField **(** ObjectName **,** RecordID **,** TableName **,** FieldName **) {
var** strHTML **=** "" **;
try {
var** S1Module **=** X**.** EXEC **(** 'CODE:ModuleIntf.CreateModule' **,** ObjectName **);**
X**.** EXEC **(** 'CODE:ModuleIntf.LocateModule' **,** S1Module **,** RecordID **);
var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** S1Module **,** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** FieldName **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 2 **,** vBlobField **);**
strHTML **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.GetDocHTMLPart' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DestroyModule' **,** S1Module **);
} catch (** e **) {**
X**.** WARNING **(** e**.** message **);
}
return** strHTML **;
}**

**function** AddHTMLToField **(** ObjectName **,** RecordID **,** TableName **,** FieldName **,** HTMLCode **) {
try {
var** S1Module **=** X**.** EXEC **(** 'CODE:ModuleIntf.CreateModule' **,** ObjectName **);**
X**.** EXEC **(** 'CODE:ModuleIntf.LocateModule' **,** S1Module **,** RecordID **);
var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** S1Module **,** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** FieldName **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 1 **,** HTMLCode **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetEdit' **,** vdsTable **);**
X**.** EXEC **(** 'CODE:SOHTMLDOC.SaveDoctoBlob' **,** vBlobPointer **,** vBlobField **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetPost' **,** vdsTable **);**
X**.** EXEC **(** 'CODE:ModuleIntf.PostModule' **,** S1Module **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DestroyModule' **,** S1Module **);
} catch (** e **) {**
X**.** WARNING **(** e**.** message **);
}
}**

**How it works**

Both functions use SBSL methods to create the object (CreateModule) and locate the record (LocateModule).
The following methods are used to add HTML data to a blob field.

**var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 1 **,** HTMLCode **);**
X**.** EXEC **(** 'CODE:SOHTMLDOC.SaveDoctoBlob' **,** vBlobPointer **,** vBlobField **);**

The following methods are used to retrieve HTML data from a blob field.

**var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 2 **,** vBlobField **);**
strHTML **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.GetDocHTMLPart' **,** vBlobPointer **);**

Use the following functions when you need to get/set blob fields for a current module (already located in a record).
Replace S1Module with X.Module and remove CreateModule, LocateModule, PostModule and DestroyModule.

**function** GetHTMLFromModuleField **(** TableName **,** FieldName **) {
var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** FieldName **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 2 **,** vBlobField **);
var** strHTML **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.GetDocHTMLPart' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);
return** strHTML **;
}
function** AddHTMLToModuleField **(** TableName **,** FieldName **,** HTMLCode **) {**


**var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** FieldName **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetEdit' **,** vdsTable **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 1 **,** HTMLCode **);**
X**.** EXEC **(** 'CODE:SOHTMLDOC.SaveDoctoBlob' **,** vBlobPointer **,** vBlobField **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);
}**

```
Figure CS15.1 – Email record (ID=3358)
```
```
Figure CS15.2 – Get HTMLData using GetHTMLFromField from Advanced JavaScript
```

**Figure CS15.3 – Add HTMLData using AddHTMLToField**

```
Figure CS15.4 – Email record (New HTML data)
```

### 16. Check / Add / Delete ABC (Activity Based Costing) data

**Job** : Function “CheckABCData” checks if users have entered data in ABC Lines.
Function “DeleteAllABCData” deletes all ABC Lines. Function “AddABCData” adds data in ABC Lines.

**function** GetObjectABC **(** vModule **,** vLineObject **) {
var** ptrABC **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetChildModule' **,** X**.** MODULE **,** 'ABCTRNLINES' **);**
//try to get the childmodule ABCTRNLINES
**if (** ptrABC **<=** 0 **) {**
X**.** CALLPUBLISHED **(** 'ProgLibIntf.ModuleCommand' **,** X**.** MODULE **,** 10122 **,** vLineObject **);**
//Activates the ChildModule when users have not already opened it at least
one time (right-click "Activity Based Costing")
ptrABC **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetChildModule' **,** X**.** MODULE **,** 'ABCTRNLINES' **);
}
return** X**.** GetObject **(** ptrABC **);** //returns the ABC object, which contains all the data
of the table ABCTRNLINES (e.g. objABC.ABCTRNLINES.ABCST1)
**}**

**function** CheckABCData **() {
var** objABC **=** GetObjectABC **(** X**.** MODULE **,** 'LINLINES' **);**
// X.WARNING(ABCobj.ABCTRNLINES.RECORDCOUNT);
**if (** objABC**.** ABCTRNLINES**.** RECORDCOUNT **==** 0 **)**
X**.** EXCEPTION **(** 'Please fill in the ABC data for all the document lines!' **);
}**

**function** DeleteAllABCData **() {
var** objABC **=** GetObjectABC **(** X**.** MODULE **,** 'LINLINES' **);**
LINLINES**.** FIRST **;
while (!** LINLINES**.** EOF **) {**
DeleteABCData **(** objABC **);**
LINLINES**.** NEXT **;
}
}**

**function** DeleteABCData **(** objABC **) {**
objABC**.** VPAGEFIELD**.** EDIT **;**

objABC**.** VPAGEFIELD**.** PAGEFIELD **=** 0 **;
while (!** objABC**.** VDIMTRNLINES1**.** EOF **)**
objABC**.** VDIMTRNLINES1**.** DELETE **;**

objABC**.** VPAGEFIELD**.** PAGEFIELD **=** 1 **;
while (!** objABC**.** VDIMTRNLINES2**.** EOF **)**
objABC**.** VDIMTRNLINES2**.** DELETE **;**

objABC**.** VPAGEFIELD**.** PAGEFIELD **=** 2 **;
while (!** objABC**.** VDIMTRNLINES3**.** EOF **)**
objABC**.** VDIMTRNLINES3**.** DELETE **;
}**

**function** AddABCData **() {
var** objABC **=** GetObjectABC **(** X**.** MODULE **,** 'LINLINES' **);**
objABC**.** VPAGEFIELD**.** PAGEFIELD **=** 0 **;**

objABC**.** VDIMTRNLINES 1**.** APPEND **;**
objABC**.** VDIMTRNLINES 1**.** ABCST **=** 101 **;**
objABC**.** VDIMTRNLINES 1**.** COEF **=** 70 **;**
objABC**.** VDIMTRNLINES 1**.** POST **;**

objABC**.** VDIMTRNLINES 1**.** APPEND **;**
objABC**.** VDIMTRNLINES 1**.** ABCST **=** 102 **;**
objABC**.** VDIMTRNLINES 1**.** COEF **=** 30 **;**
objABC**.** VDIMTRNLINES 1**.** POST **;
}**


## 10. Data Flows

#### A. Overview

#### B. Data Flow Rules

#### C. Data Flow Scenarios

#### D. Execute Data Flows from Screen Scripts

#### E. Case Studies


Chapter 10 – Data Flows

### A. Overview

Data flows is a process tool for transferring data between SoftOne modules, using a graphical interface and writing
few lines of code. They are usually executed using flow scenarios, but there is also a function to run them through
form scripts. Flow scenarios are context menu items that are displayed in browsers right click.

This very powerful tool allows you to create data-transfer batch jobs without the knowledge and use of SBSL scripts.
Results log of the jobs is stored in the database table named **TRNFTRC**.

Figure A1 displays an example of data flow rule design, that creates customers from draft entries. The source entity
contains the object SODRAFT (1) and the target entity the object CUSTOMER (2).

The target entity “Customers” (3) in which data will be imported, is set to retrieve data from the source table “Draft
entries” (4). Datagrid displays the value assignments in the target fields.

```
Figure A1
```

Chapter 10 – Data Flows

The job is created and displayed in the draft entries browser through a flow scenario (Figure A2).
Figure A3 shows the pop-up menu that appears upon right clicking on the draft entries browser.

```
Figure A 2
```
```
Figure A 3
```

Chapter 10 – Data Flows

### B. Data Flow Rules

Data flow rules is the tool where you define the jobs that will be executed when transferring data from one entity to
another. Rules description is set through the “Description” textbox.

Data flow rules’ design is saved in the blob field SODATA of the table CSTINFO (CSTTYPE=12) and can be easily
transferred through different installations as “.cst” or “.auv” files using the “Custom Administration” tool.

#### B.1 Source entity

The source entity (object) is the module that contains the data to be transferred (e.g. SALDOC - sales documents).
Inside the textbox " **Name** " you enter the name of the source object or you can select it by clicking on the link.

The “ **View** ” combo box lets you pick from the available views (forms) of the object. By selecting a specific form of
the object, its tables, **including the custom ones** are displayed in the datagrid of the tab “Data tables”. If no view is
selected then the default one is used.

The datagrid of the tab “ **Data** ” lists all the tables you can use as “ **Data source** ” for your target tables. Fields from
data source tables can be used to assign values to fields of the target tables.

**- Grouping** of source data can be done for any table of the source entity **(Figure B1.1 [ 1 ])**. Select the table from
    the datagrid of the tab “ **Data tables** ”, click the button “ **Grouping** ” and then select a field of the source table.
**- Filters** can be applied to the records of any source table **(Figure B1.1 [2])**. Filters are added in the where clause
    of the SQL query that runs for the source entity. The accepted Values are:
- **Numbers** : Adds the filter in the where clause using the SQL operator “=” (e.g. A.SODTYPE=51).
- **Comma separated string** : Adds the filter in where clause using the operator “IN” (e.g. A.MTRMARK IN (1,2)).
- **NULL** , **NOTNULL** : Adds the following in the where clause: **AND FIELD IS NULL** , **AND FIELD IS NOT NULL**.
- **SQL statement** : Adds the SQL statement of the cell “Value” in the where clause of the main query. It requires
manually entry of the keyword **SQLFILTER** inside the cell of the column “Field”.

```
Figure B1.1
```

Chapter 10 – Data Flows

Inside the datagrid of the " **Modifications** " tab you can insert the fields of the source data tables that will be
updated after the execution of the job (Figure B1.2).

If you enable the option " **Use Object** " (Figure B1.3) then the modification of the fields will be done through object
(CreateObj, Locate, DBPost) using the form you have defined in the “ **View** ” combo box. This means all SoftOne
business commands and validations will be executed. Apart from that, all the custom functions & commands you
may have written in form script will also run.

When the option “Use Object” is not enabled then the updates are executed through SQL update statements
directly to the database.

```
Figure B1.2
```
```
Figure B1.3
```

Chapter 10 – Data Flows

#### B.2 Target entity

The target entity contains the data of the target object, which is the one that will be created
(e.g., PRDDOC - production documents). Inside the textbox " **Name** " type the name of the object or select it by
clicking on the link.

If you select a specific form from the combo box " **View** " then the new record will be created using this form,
meaning that the custom script and commands of this form will occur.

In " **Tables** " combo box select the tables that will be used for assigning values through the source tables. For every
table selected, new tabs automatically open labeled with tables’ name ( **Figure B2.1** ).

```
Figure B2.1
```
Each table of the target entity is displayed in a different tab. The " **Data source** ” combo box contains all the available
tables of the Source Entity **(Figure B2.2)**. Pick the Data source table keeping in mind that its fields will be available
when you assign values to the target table fields.

```
Figure B2.2
```

Chapter 10 – Data Flows

Inside the datagrid " **Assign field values** " you set the field values of the selected target table **(Figure B2.3)**.

- Column " **Field** "(1): Target fields. Select the fields of the target entity that will be updated during the process.
- Column " **Expression** "(2): Enter the values that will be assigned to the target fields. You can use any internal
    function (e.g., IF, RUNSQL) or you can select any field from the source entity.

```
Figure B2.3
```
Double click on any line of the target entity datagrid zooms in the expressions **(Figure B2. 4 )**.

```
Figure B2. 4
```

Chapter 10 – Data Flows

- Column " **Aggregation** ": allows you to specify math operations (Sum, Greater than, etc.) in the fields of the
    datagrid. This can take place only if you have defined a source table that is grouped by certain values.
    For example, if you want to create a Sales document from another Sales document and apply packing of items
    (in item lines), then you have to group the items by MTRL (in source table Item lines) and set their target quantity
    as the sum of the quantities per grouped item and their price as the max item price **(Figure B2. 5 )**.

```
Figure B2.5
```

Chapter 10 – Data Flows

#### B.3 Runtime Settings

In the tab " **Run** " you set whether during running the job, the records created will be displayed on the screen and
you can also define the dialog parameters, as well as the connection properties.

Enable the option " **Display screen** " when you wish to display the new records created on the screen and wait for
the user to save them. If the option is not enabled then when the job is completed, the new records created will be
displayed in log text under the link “Results” of the dialog.

The option " **Display dialog** " displays the dialog filters before running the job.

The dialog parameters are set through the datagrid " **Dialog parameters** " **(Figure B3.1)**.
The records of the datagrid indicate the filter fields and the columns define their properties. These fields can be
used either in the source entity for filtering the source tables or as values of the target table fields (Figure B 9 ).

Enabling the option " **Exclude login company** " defines that the new records will not be created in the login
company.

Inside the datagrid " **Other connections to apply** " you can set the companies that the new records will be
created, as well as the branch and the credentials of the login user. If you do not apply the user credentials, then the
entries will be created using the login user.
Inside the column “ **Connection file XCO** ” you can define a connection to a different database.

```
Figure B3.1
```

Chapter 10 – Data Flows

### C. Data Flow Scenarios

Inside data flow scenarios you can set the jobs (data flow rules or SBSL scripts) to be displayed and run when right
clicking on the browsers of the specified objects. Data flow scenarios can be exported from the Custom
Administration tool, where you can also set user rights.

Data flow scenarios’ design is saved in the blob field SODATA of the table CSTINFO (CSTTYPE=13) and can be easily
transferred through different installations as “.cst” or “.auv” files using the “Custom Administration” tool.

Figure C1 shows an example of a data flow scenario created to run through the “Items” browser (Entity ITEM).
At runtime, if the dataflow rule is set to display a dialog, then the dialog will be displayed as in Figure C2.

```
Figure C1
```

Chapter 10 – Data Flows

```
Figure C2
```
A data flow scenario is created through the menu Job “Tools – S.D.K. – Customization Tools – Data Flow Scenarios”.

Create a new one, enter the “Description”, that will also be displayed in the right click pop up menu, and the “Entity”
name of the object that this scenario will be applied.
Inside the datagrid set the data flow rules or SBSL scripts that will be executed when selecting the specific scenario
from the pop-up menu of the browser (Figure C3).

A data flow scenario can run one or more data flow rules and SBSL scripts (Figure C 4 ).

**Note** : Data flow rules are linked to data flow scenarios through their description. This means that if you change the
description of a data flow rule then you have to link it again inside the dataflow scenario.

```
Figure C3
```

Chapter 10 – Data Flows

```
Figure C4
```

Chapter 10 – Data Flows

### D. Execute Data Flows from Screen Scripts

Data flows can be called through form scripts of the screens, through function X.EVAL. You can call either the flow
rules or scenarios using the following commands:

**_SOTRANSFORM.RULEBYID (CSTINFO: integer, IDs: string)_**

**CSTINFO** : Data flow rule ID
**IDs** : IDs of the entries, where the rule will be applied, separated by commas (,) or question marks (?)

**_SOTRANSFORM.RULEBYNAME (CSTNAME: string, IDs: string)_**

**CSTNAME** : Data flow rule Name
**IDs** : IDs of the entries where the rule will be applied, separated by commas (,) or question marks (?)

**_SOTRANSFORM.MODELBYID (CSTINFO: integer, IDs: string)_**

**CSTINFO** : Data flow scenario ID
**IDs** : IDs of the entries, where the scenario will be applied, separated by commas (,) or question marks (?)

**_SOTRANSFORM.MODELBYNAME (CSTNAME: string, IDs: string)_**

**CSTNAME** : Data flow scenario Name
**IDs** : IDs of the entries, where the scenario will be applied, separated by commas (,) or question marks (?)

**Example**
**_Run the data flow rule with code 1026 , that converts a draft entry to a customer through the screen script of
the draft entries object. The rule is executed after clicking a button (cmd = 20180607 ) (Figure D1) and
displays the dialog window that is set within the rule (Figure D2)._**
**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20180607 **)**
Transfertocustomer **();
}
function** Transfertocustomer **() {
if (** SODRAFT**.** SODRAFT **>** 0 **)**
A **=** X**.** EVAL **(** 'SOTRANSFORM.RULEBYID( 1026 ,' **+** SODRAFT**.** SODRAFT **+** ')' **);
}**

```
Figure C4
```

Chapter 10 – Data Flows

### E. Case Studies

#### 1. Sales to Purchases Conversion

Batch job created with data flow rule that transfers **sales documents to purchase documents** with series
and supplier selection in dialog filters.

Create a new data flow rule and select the object SALDOC as source entity. The “Data tables” tab displays the
available data tables of this object (Figure E.1.1).

```
Figure E1.1
```
The dialog filters are created through the “Run” Tab. For each field, enter the description, the data type, Display
size, Editor and any other property required (Figure E.1.2).

```
Figure E1.2
```

Chapter 10 – Data Flows

The data will be transferred to “purchase documents”, thus the object of the target entity must be PURDOC. Select
the target tables (e.g. Transactions and Item lines) and then for each table (Tab) select the source table from which
fields values will be assigned. Inside the datagrid select the fields and add their values in the “Expression” column
(pick from source table fields or filter parameters) (Figure E.1.3).

```
Figure E1.3
```
Conversion (Originated from) is done through the fields FINDOCS and MTRLINESS of Item Lines (Figure E1.4).

```
Figure E1.4
```
The last step is to create a data flow scenario using this data flow rule in order to display the job upon right-clicking
in the “sales documents” browser (Figure E1.5).

```
Figure E1.5
```

Chapter 10 – Data Flows

#### 2. Sales to Sales (Company)

Batch job created by data flow rule for transferring **sales documents from the login company to sales
documents of another company** and branch. It also applies customers grouping.

The source entity is created as in the previous example using SALDOC. Grouping with customers table is executed
by selecting the record (table) "Sales Transactions" in the datagrid of the “Data tables” tab, clicking on the button
“Grouping” and selecting the field "Customer" (FINDOC.TRDR) of the sales documents (Figure E2.1).

Customers (TRDR) and items (MTRL) have different ids in each company, so the matching should be done by their
“Code” field. This can be done by using the function “ID” that returns the id of a table for a given code (Figures E2.2
and E2.3). Alternatively you can use a SQL statement using the internal function RUNSQL. Of course, you have to
make sure that in order for the data flow to work correctly you must have the same customer codes and item codes
in both companies.

```
Figure E2.1
```

Chapter 10 – Data Flows
**Figure E2.2**

```
Figure E2.3
```
In the Run Tab, in the "Advanced connection properties" select to exclude the login company and then in the
datagrid below add a new record with the target company and branch (Figure E2.4).

```
Figure E2.4
```
After running the data flow scenario by right clicking the browser of sales documents, the results that indicate
whether transfer was executed correctly will be displayed as in Figure E2.5.

```
Figure E2.5
```

Chapter 10 – Data Flows

#### 3. Items to Purchases...............................................................................................................................................................................

Batch job created by data flow rule that will run through the inventory **items** browser and then **create
purchase documents** with grouping based on the ordinary supplier of the items. For the items that don’t

have a main supplier, the supplier indicated in the dialog filters will be inserted. If no purchase quantity is

entered in items, line items shall have quantity 1.

In the source entity select the object ITEM. Grouping items per ordinary supplier is executed using the field
MTRL.MTRSUP (Figure E3.1).

```
Figure E3.1
```
The dialog filters display the purchase series and the supplier that will be used only for items that do not have an
main supplier (Figure E3.2).

```
Figure E3.2
```

Chapter 10 – Data Flows

In the target entity enter the object PURDOC (purchase documents) and select " _Transactions_ " and " _Item lines_ " as
target tables (Tables 1,7).
The header of the new document (Transactions (Pucrhases)) will have as a datasource the _Items_ table, because of the
grouping per items ordinary supplier. The assignment of field values is executed as in Figure E3.3.
Supplier is filled using the expression: IF **({** MTRL**.** MTRSUP **}=** '' **,{** DLGPRMS**.** SUPPLIERPUR **},{** MTRL**.** MTRSUP **})**

```
Figure E3.3
```
Item lines cannot be updated from the items table of the source entity because this particular table has been
grouped per item main supplier, thus it contains only the distinct supplier records. So, you need to add again the
item table by creating a new table in the source entity, which will contain all the item records (Figure E3.4).

Then you can use it as the data source table for the item lines (Figure E3.5).

```
Figure E3.4
```
```
Figure E3.5
```

Chapter 10 – Data Flows

In the example of Figure E3.6, seven items with four different suppliers are selected. After running the job, four new
documents will be created (three of them are based on item suppliers and one is based on the supplier provided
from the dialog) (Figure E3.7).

```
Figure E3.6
```
```
Figure E3.7
```

Chapter 10 – Data Flows

#### 4. Production to Purchases

Batch job created by data flow rule that **creates purchase documents from production documents**.
The items will be inserted based on the raw materials lines. The quantity will be entered through

calculation of the lines’ quantity and waste.

In the source entity select the object PRDDOC (production documents) and in the target entity the object PURDOC
(Figure E4.1).

```
Figure E4.1
```
The dialog filters will have the purchases series and the supplier (Figure E4.2)

```
Figure E4.2
```
The assignment of the values of the final entity will be executed for tables "Transactions" and "Item lines". In the
transactions table enter the fields you want to be updated based on the source table of the production documents
(Figure E4.3).


Chapter 10 – Data Flows

```
Figure E4.3
```
In item lines table enter the fields from the corresponding source table “Lines of Raw/Aux materials” (Figure E4. 4 ).

```
Figure E4.4
```
Create a new data flow scenario using the data flow rule above and run it from the production documents browser.
The results will appear as in Figure E4.5.

```
Figure E4.5
```

Chapter 10 – Data Flows

#### 5. Marketing Campaigns to Tasks

Batch job created from data flow rule that **creates Tasks from Marketing Campaigns** with a specific
form that has default values for Tasks fields.

In the source entity select the object PRJC (sales opportunities) and filter PRJC as in figure E5.1 (PRJC.PRJCRM = 1).

```
Figure E5.1
```
In the target entity enter the object SOTASK and select the desirable form, that has default values for specific fields.
The assignment of values for the fields in the Tasks table is done as in Figure E5.2. Select the option “Display
dialogue” in order to display the filters dialog when running the data flow scenario.

```
Figure E5. 2
```

Chapter 10 – Data Flows

Create a new data flow scenario as in Figure E5.3. Run the data flow scenario through the marketing campaigns
browser (Figure E5. 4 ) the entries in the Tasks will be created as in Figure E5. 5.

```
Figure E5.3
```
```
Figure E5.4
```
```
Figure E5.5
```

## 11. SoftOne Batch Script Language (SBSL)...............................................................................

#### A. Overview

#### B. Syntax Basics

#### C. Dialog screen design (Interface)

#### D. Main Code

#### E. SBSL Script Execution

#### F. Built-in Functions

#### G. SoftOne Libraries

#### H. Case Studies


Chapter 12 – SBSL

### A. Overview

S1 Batch Script Language (SBSL) is a programming language developed initially by SoftOne for data import
purposes from other applications. This language quickly proved to be a very powerful tool that can be used for
process design through batch jobs.

One of the numerous advantages of SBSL compared to SQL scripts is that it follows the rules and logic of the
application - something that cannot be done directly with SQL statements. This means for example that it inserts -
updates or deletes records in SoftOne tables, in the same way that a user could do throughout the objects interface.

Scripts in SBSL produce objects similar to batch jobs whose interface (dialog parameters) is designed by code. SBSL
scripts can be incorporated inside the section “S1 scripts” or can be saved in files with “.imp” extension.

With the use of SBSL scripts you can develop numerous batch jobs such as:

- Import / modify data in any SoftOne object
- Export data from SoftOne objects to ASCII files
- Transfer data to external SQL, Oracle, Access tables
- Create XXF file from any object of SoftOne
- General Batch job execution (e.g. cost price update)

**SBSL scripts can be executed using:**

- Right-click on selected browser records
- Menu jobs
- Functions in form screen scripts

```
Figure A1 shows an example of a batch job dialog screen.
```
```
Figure A1
```

Chapter 12 – SBSL

### B. Syntax Basics

The following sections include information about the different elements that comprise the SBSL language.

#### B.1 Case Insensitive

SBSL is case insensitive which means that all commands, variables and functions can be written using either small or
capital letters.

#### B.2 Semicolons

SBSL statements must be terminated with semicolons (;).

#### B.3 Comments

Comments syntax is the same as in JavaScript, C# etc. using //.

**Example:**
// my comments

#### B.4 Variables

Variable are declared with a var statement. Their type is variant; when used their type is recognized automatically.

**Example:
var** x **,** y **,** temp **;**

#### B.5 Libraries References..........................................................................................................................................................................

References to built-in SoftOne libraries or to custom “code libraries” is made by using the keyword “include”.

**Examples**
include 'PILib' **;**
include 'ModuleIntf' **;**
include 'SysRequest' **;**
include 'myscript' **;**

#### B.6 Functions...............................................................................................................................................................................................

Functions are written as code blocks (inside curly {} brackets) preceded by the keyword “function”.

**function** PrintOnScreen **(** fMess **)
{**
x **=** SendResponse **(** ReplaceStr **(** fMess **,** '...' **,** '' **),** 'ImpTable.vMess' **);
}**

The code inside functions will be executed when it is called from the SBSL script.

x **=** PrintOnScreen **(** 'Complete job execution' **);**

Functions can also return values back to where the call was made. This can be done by using the “return” statement.

**function** myfunctionname **(** var1 **,** var2 **){**
//testcode
**return** var1 ***** var2 **;
}**
x **=** myfunctionname **(** 10 **,** 5 **);** //assigns the value 50 to the x variable


Chapter 12 – SBSL

#### B.7 Error Messages

Custom error messages can be created using the RaiseException function.

x **=** RAISEEXCEPTION **(** 'Process Stopped!' **);**

#### B.8 Comparison symbols........................................................................................................................................................................

Comparison is done using the following symbols

**=** Equal
**<>** Not equal
**>** Greater than
**>=** Greater than or equal to
**<** Less than
**<=** Less than or equal to

#### B.9 Logical operators

SBSL provides the following logical operators

**AND** Conjunction
**OR** Disjunction
**NOT** Negation


Chapter 12 – SBSL

### C. Dialog screen design (Interface)

The first section of the SBSL script consists of the commands that design the dialog screen.
The design primitives are the same as in screen forms. Fields, tables, tabs, panels and datagrids can be displayed in
the dialog screen as long as they are inserted inside block Form. Form block may include the sections [TABLES],
[CACHETABLES], [PANELS] and [STRINGS].

Form **{
[** TABLES **]**

**[** CACHETABLES **]**

**[** PANELS **]**

**[** STRINGS **]**

**}**

#### C.1 Section TABLES

Inside this section you define the virtual tables (Datasets) that will be used in the dialog window.
A table is defined by stating its name (which shall be used in order to refer to the table within the script) as well as
its caption, using the following syntax.

**TableName = ;;;;TableCaption;3;0**

**Example (Ex C.1)
[** TABLES **]**
HeaderTable1 **= ;;;;** MyHeader **;** 3 **;** 0
GridTable1 **= ;;;;** MyGrid **;** 3 **;** 0
CacheTable1 **= ;;;;** MyCache **;** 3 **;** 0

**_C.1.1 Table / Dialog Fields_**

The declaration of the fields inside the tables is done with the creation of sections for each TableName entered in
Tables section. Fields are imported using the following syntax.

**FieldName = DataType; DisplaySize; Required; Visible; ReadOnly; Caption; Editor; TblEdit; Forced; Default;
Decimals**

```
PROPERTY DESCRIPTION
```
```
DataType
```
```
Field type: 1 =String, 2 =Smallint, 3 =Integer, 4 =Word, 6 =Float, 7 =Currency, 9 =Date,
11 =DateTime, 16 =Memo
```
```
DisplaySize Field width
```
```
Required Defines if the field is mandatory or not. 0 = not required, 1 = required
```
```
Visible 0 = not displayed, 1 = displayed
```
```
ReadOnly 0 =allows data modification in the field, 1 =does not allow data modification
```
```
Caption Label of the field
```
```
Editor Field editor (See C.7 Selector List, G. Editor Attributes)
```
```
TblEdit Internal use only
```
```
Forced Forced field value
```
```
Default Default field value
```
```
Decimals Decimal points (for numeric fields).^
If used in memo fields then it shows the scrollbars ( 1 =Horizontal, 2=Vertical, 3 =Both).
```

Chapter 12 – SBSL

**Examples**

**_1. Small integer field displayed as Boolean control (Yes/No) with caption "Job confirmation" and default
value “Yes”._**
**[** HeaderTable1 **]**
vImpOk **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** Job confirmation **;** $Y **;;;** 1
**_2. Small integer field displayed as combobox control populated with the sales series (using editor), with
default value “ 7021 ”._**
vSalSeries **=** 2 **;** 30 **;** 1 **;** 1 **;** 0 **;** Sales series **;** SERIES **(** F **[** SOSOURCE **=** 1351 **]);;;** 7021
**_3. Date field with default value the login date._**
vDate **=** 11 **;** 25 **;** 1 **;** 1 **;** 0 **;** From insertion date **;;;;:** X**.** SYS**.** LOGINDATE
**_4. Text field that can be used in memo textbox for displaying job log messages._**
vImpMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Job messages **...;;;;**
**_5. Small integer field displayed as combobox control populated with the commercial categories of items
(using editor)._**
vItemCategory **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Commercial category **;** ITECATEGORY **;;;**
**_6. String field displayed as text picker control populated with items (using editor)that returns the value of the
field “code”._**
vItemCode **=** 1 **;** 25 **;** 0 **;** 1 **;** 0 **;** From item code **;** ITEM **(** M **,** R **[** CODE **]);;;**
**_7. String field displaying a file picker dialog box. Returns file path._**
vFile **=** 1 **;** 256 **;** 1 **;** 1 **;** 0 **;** Pick File **;** $Filename **;;;**
**_8. Small integer field displayed as hyperlink button that can be used to execute a job. The button of this
particular example displays the object“CUSTOMER” when clicked._**
vButton **=** 2 **;** 15 **;** 0 **;** 1 **;** 0 **;** Button **;** XCMD **:** CUSTOMER **;;;**
**_9. Small integer field displayed as combobox control populated with warehouses (WHOUSE editor)and
filtered from other dialog filters (vBranch and vFilter)._**
vWhouse **=** 1 **;** 15 **;** 0 **;** 1 **;** 0 **;** W**.** h **..;** WHOUSE **(** W **[** EXISTS **(** SELECT 1 FROM BRANCH B WHERE B**.** COMPANY **=**
A**.** COMPANY AND B**.** BRANCH **=:** ImpTable**.** vBranch AND
CHARINDEX **(:** ImpTable**.** vFilter **+** CAST **(** A**.** WHOUSE AS
VARCHAR **)+:** ImpTable**.** vFilter **,:** ImpTable**.** vFilter **+** B**.** WHOUSES **+:** ImpTable**.** vFilter **)>** 0 **)],** Z **,** M **,** R **[** W
HOUSE **]);**
**_10. Small integer field displayed as combobox control populated with MTRUNIT editor that auto updates(U)
another dialogfield (vMtrUnit1)._**
vMtrunit1Init **=** 1 **;** 40 **;** 0 **;** 1 **;** 1 **;** UOM **of** initial code **;** MTRUNIT **(** U **[** vMtrunit1 **=** MTRUNIT@ **]);;**
vMtrunit1 **=** 1 **;** 40 **;** 0 **;** 1 **;** 1 **;** U**.** O**.** M.1 **of** New code **;** MTRUNIT **;;**


Chapter 12 – SBSL

**_C.1.2 Browser Selected Records_**

SBSL scripts executed through right click in browsers return the selected browser records using the command
&SELRECS, which must be used inside a field of the section [TABLES]. &SELRECS returns the primary keys of the
selected records either whether they are header tables or lines analysis tables.

The command **&SELRECS** must be used in a text dialog variable and the syntax is as follows:

**vWhere=16;80000;0;1;0;Records selected from Browser;;;&SELRECS;&SELRECS**

**Example**
**_Browser selected records (SQL where clause)_**
Form **{
[** TABLES **]**
ImpTable **=;;;;;** 3 **;** 0
**[** ImpTable **]**
vWhere **=** 16 **;** 80000 **;** 0 **;** 1 **;** 0 **;** Selection **of** documents from Browser **;;;&** SELRECS **;&** SELRECS
**}**

Connect Xplorer SoftoneCon **{**
connect **();**
sDoc **=** SELECT FINDOC**.** FINCODE **,** FINDOC**.** TRDR
FROM FINDOC
WHERE **(** $REMOVEQUOTES **(:** $ImpTable**.** vWhere **) );
}**

Var x **;
{**
//fetch sDoc{}
x **=** ShowWarning **(** VarToStr **(:** ImpTable**.** vWhere **));
}**

```
Figure C1. 1
```

Chapter 12 – SBSL

#### C.2 Section CACHETABLES

This section contains datasets (cache tables) that are populated from SQL statements and **run during script
initialization** and is usually used for initialization of dialog filter fields.
These datasets can be used either as editors in fields or anywhere else inside the main SBSL script.

**Example 1**
**_Field vPayment uses a dynamic editor (TblPayment) which is filtered by a user-selected field (vSodtype)._**
Form **{
[** TABLES **]**
ImpTable **=;;;;;** 3 **;** 0
TblPAYMENT **=;;;;** TblPAYMENT **;** 3 **;** 0

**[** ImpTable **]**
vSodtype **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Type SODTYPE **;** $SODTYPE **(** W **[** 12 **,** 13 **]);;**
vPayment **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Payment **;** TblPAYMENT **(** W **[** SODTYPE **=:** ImpTable**.** vSodtype AND
COMPANY **=:** X**.** SYS**.** COMPANY **]) ;;;**

**[** TblPAYMENT **]**
PAYMENT **=** 2 **;** 5 **;** 0 **;** 1 **;** 0 **;;;;;**
NAME **=** 1 **;** 30 **;** 0 **;** 1 **;** 0 **;;;;;**
COMPANY **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**
SODTYPE **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**

**[** CACHETABLES **]**
TblPAYMENT **=** SELECT PAYMENT **,** NAME **,** COMPANY **,** SODTYPE AS SODTYPE FROM PAYMENT

**[** PANELS **]**
PANEL11 **=** 0 **;;** 0 **;** 50

**[** PANEL11 **]**
ImpTable**.** vSodtype
ImpTable**.** vPayment
**}**

```
Figure C2. 1
```

Chapter 12 – SBSL

**Example 2**
**_Field vPayment uses a dynamic editor (TblPayment) which is filtered by browser selected records (Sales)._**
include 'SysRequest' **;**
Form **{
[** TABLES **]**
ImpTable **= ;;;;** Master **;** 3 **;** 0
TblPAYMENT **=;;;;** TblPAYMENT **;** 3 **;** 0
**[** ImpTable **]**
vPayment **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Payment **;** TblPAYMENT **(** W **[** SODTYPE **=** 13 AND COMPANY **=:** X**.** SYS**.** COMPANY **]);;;**
vWhere **=** 16 **;** 80000 **;** 0 **;** 1 **;** 0 **;** Browser records selection **;;;&** SELRECS **;&** SELRECS
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;;;;;**

**[** TblPAYMENT **]**
PAYMENT **=** 2 **;** 5 **;** 0 **;** 1 **;** 0 **;;;;;**
NAME **=** 1 **;** 30 **;** 0 **;** 1 **;** 0 **;;;;;**
COMPANY **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**
SODTYPE **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**

**[** PANELS **]**
PANEL1 **=** 0 **;;** 0 **;** 30 **,** 30 **,** 30 **,** 0 **,** N **,** H25
PANEL2 **=** 4 **;** Messages **;** 0 **;** H100

**[** PANEL1 **]**
ImpTable**.** vPayment
**[** PANEL2 **]**
ImpTable**.** vMess

**[** CACHETABLES **]**
TblPAYMENT **=** SELECT PAYMENT **,** NAME **,** COMPANY **,** SODTYPE AS SODTYPE FROM PAYMENT WHERE SODTYPE **=** 13 AND
COMPANY **=:** X**.** SYS**.** COMPANY AND PAYMENT IN **(** SELECT FINDOC**.** PAYMENT FROM FINDOC WHERE
$RemoveQuotes **(:** ImpTable**.** vWhere **) );
}**

**var** x **,** UserResp **,** icnt **,** vSelRecs **,** vSelected **,** vMess **,** vImpTable **,** Count **,** DsFinDoc **,** Module **;**

Connect Xplorer SoftOne **{**
connect **();**

vSelected **=** SELECT FINDOC **,** PAYMENT
FROM FINDOC
WHERE SOSOURCE **=** 1351 AND COMPANY **=:** $X**.** SYS**.** COMPANY AND **(** $REMOVEQUOTES **(:** $ImpTable**.** vWhere **));
}**

**function** PrintMessage **(** fMess **){**
vMess **=** vMess **+** fMess **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vMess **,** 'ImpTable.vMess' **);
}**

**{**
Count **=** 0 **;**
vSelRecs **=** VarToStr **(** GetParamValue **(** XModule **,** 'SELRECS' **));**

Module **=** CallPublished **(** 'ModuleIntf.CreateModule' **,** 'SALDOC,WARNINGS:OFF,NOMESSAGES:1' **);**
DsFinDoc **=** CallPublished **(** 'ModuleIntf.GetDataset' **,** VarArray **(** Module **,** 'FINDOC' **,** 2 **));**

Count **=** 0 **;**
fetch vSelected **{**
Count **=** Count **+** 1 **;
}**
x **=** SendResponse **(** Count **,** 'RESULTS.TOTREC' **);**

**if (** vSelRecs **=** '' **) {**
x **=** RaiseException **(** 'No records are selected' **);
}**

Count **=** 0 **;**
fetch vSelected **{**
x **=** PrintMessage **(** 'Payment: ' **+** VarToStr **(** vSelected**.** PAYMENT **)+** ', Findoc:
' **+** VarToStr **(** vSelected**.** FINDOC **)+** # 13 **+** # 10 **);**
x **=** CallPublished **(** 'ModuleIntf.LocateModule' **,** VarArray **(** Module **,** vSelected**.** FINDOC **,** 2 **));**
Count **=** Count **+** 1 **;**
x **=** SendResponse **(** Count **,** 'RESULTS.CURREC' **);**
x **=** CallPublished **(** 'ModuleIntf.DatasetEdit' **,** DsFinDoc **);**
x **=** CallPublished **(** 'ModuleIntf.SetFieldValue' **,** VarArray **(** DsFinDoc **,** 'PAYMENT' **, :** ImpTable**.** vPayment **,** 3 **));**
x **=** CallPublished **(** 'ModuleIntf.PostModule' **,** Module **);
}
}**


Chapter 12 – SBSL

```
Figure C2.2 – Browser Selection (Distinct Payments are only 2)
```
```
Figure C2.3 – Field vPayment displays only the selected payments
```

Chapter 12 – SBSL

#### C.3 Section PANELS

This section contains all the information needed to design the interface of the dialog screen. The available controls
are stated through the following syntax.

**ControlName = Control; Caption; Level; Info**

```
PROPERTY DESCRIPTION
```
```
Control Control^ Type Definition:^
0 =Panel, 1 =Tab, 2 =Datagrid, 4 =Memo textbox
```
```
Caption Text that defines the caption of the control
```
```
Level Number that defines the level of the control. Used for nested controls (panel inside tab)
```
```
Info
```
```
Properties of the Control (Comma Separated). Use any of the following properties:
Columns width (i.e. Panel with 3 columns is defined using 50,30,20),
G =Group Name (i.e. G10),
N =Bottom Line (displayed only in old UI),
L =Lines (i.e. 5 lines are defined using L5),
H =Height (i.e. 20% is defined using H20),
E0 =Expandable (not Expanded) E1 =Expandable (Expanded),
F =Floating (usage only with other panels that have L – not H)
Note: Old UI Page controls need to be floating – property F. (e.g. PANEL11 = 1;'Tab1';0;F)
```
**Example**
**_Design a dialog interface with 3 tabs. The 1st tab will have 2 panels and a memo textbox, the 2nd tab will
have one panel with 2 horizontal split panels (50-50) and the 3rd tab will have a datagrid._**
Form **{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0
**[** ImpTable **]**
vImpOk **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** Job confirmation **;** $Y **;;** 0 **;**
vSeries **=** 3 **;** 30 **;** 1 **;** 1 **;** 0 **;** Sales series **;** SERIES **(** F **[** SOSOURCE **=** 1351 **]);;;** 7021
vJOB **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** Job **;** JOB **;;;&** JOB
vDate **=** 11 **;** 25 **;** 1 **;** 1 **;** 0 **;** Date **;;;;:** X**.** SYS**.** LOGINDATE
vFile **=** 1 **;** 4000 **;** 1 **;** 1 **;** 0 **;** File **;** $Filename **;;;** C **:** \MyFiles
vIteCat **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Commercial category **;** ITECATEGORY **;;;**
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 0 **;** Messages **;;;;
[** PANELS **]**
PANEL11 **=** 1 **;** 'Page1-Areas' **;** 0 **;** F
PANEL112 **=** 0 **;** 'Area1' **;** 1 **;** 50 **,** 50 **,** 0 **,** 0 **,** N **,** H10
PANEL113 **=** 0 **;** 'Area2' **;** 1 **;** 40 **,** 0 **,** 0 **,** 0 **,** H10
PANEL114 **=** 4 **;** 'Memo' **;** 1 **;** H80
PANEL12 **=** 1 **;** 'Page2-AreaSplit' **;** 0 **;** F
PANEL121 **=** 0 **;** 'AreaSplit' **;** 1 **;** 50 **,** 50 **,** 0 **,** 0
PANEL1211 **=** 0 **;** 'AreaSplit 1' **;** 2 **;** 100 **,** 0 **,** 0 **,** 0
PANEL1212 **=** 0 **;** 'AreaSplit 2' **;** 2 **;** 100 **,** 0 **,** 0 **,** 0
PANEL13 **=** 1 **;** 'Page3-Grid' **;** 0 **;** F
PANEL131 **=** 2 **;** 'Grid' **;** 1 **;
[** PANEL112 **]**
ImpTable**.** vImpOk
ImpTable**.** vFile
**[** PANEL113 **]**
ImpTable**.** vSeries
**[** PANEL114 **]**
ImpTable**.** vMess
**[** PANEL1211 **]**
ImpTable**.** vIteCat
**[** PANEL1212 **]**
ImpTable**.** vDate


Chapter 12 – SBSL
**[** STRINGS **]**
JOB **=** JOB
**[** JOB **]**
1 **=** Items **import**
2 **=** Documents **import
}**

When executing the above code, the dialog window will be displayed as in Figures C3.1, C3.2 and C3.3.

```
Figure C3.1
```
```
Figure C3.2
```

Chapter 12 – SBSL

```
Figure C3.3
```

Chapter 12 – SBSL

#### C.4 Section STRINGS

In this section you define the string lists to be used and displayed as editors in combo box fields in the same way as
you state them in database designer or form designer. Syntax is the following:
**StringListName = StringListName**

**Example (Figure C4.1)**
**_Design a dialog window with 3 combo boxes populated from string lists. This example uses also a string list
named SQLOrder within the main code for sorting a SQL statement based on user selection. It also uses the
string lists as parameters for the execution of the batch job (&MyString1, &Job, &SQLOrder)._**
Form **{
[** TABLES **]**
ImpTable **= ;;;;** Master **;** 3 **;** 0
**[** ImpTable **]**
vMyString1 **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** StringList1 **;** MyString1 **;;;&** MyString1
vJob **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** StringList2 **;** Job **;;;&** Job
vSQLOrder **=** 1 **;** 15 **;** 1 **;** 1 **;** 0 **;** StringList3 **;** SQLOrder **;;;&** SQLOrder
**[** STRINGS **]**
MyString1 **=** MyString1
Job **=** Job
SQLOrder **=** SQLOrder
**[** MyString1 **]**
1 **=** Display New Codes
2 **=** Update Table
3 **=** Create New Password
4 **=** Create Composition Documents
**[** Job **]**
1 **=** Documents **export (** One time **)**
2 **=** Repeat documents exports
**[** SQLOrder **]**
T**.** MTRMANFCTR **=** Manufacturer
ML**.** LINENUM **=** Initial order
**[** PANELS **]**
PANEL1 **=** 0 **;** 'Area1' **;** 0 **;** 30 **,** 30 **,** 30 **,** 0 **,** N **,** H100
**[** PANEL1 **]**
ImpTable**.** vMyString1
ImpTable**.** vJob
ImpTable**.** vSQLOrder
**}**
Connect Xplorer SoftoneCon **{**
connect **();**
sIteLines **=** SELECT ML**.** MTRL **,** ISNULL **(** ML**.** QTY1 **,** 0 **),** ML**.** PRICE
FROM MTRLINES ML **,** MTRL MT
WHEREML**.** FINDOC **= :** $sDoc**.** FINDOC AND ML**.** MTRL **=** MT**.** MTRL
ORDER BY $REMOVEQUOTES **(:** $ImpTable**.** vSQLOrder **);
}**

```
Figure C4.1
```

Chapter 12 – SBSL

#### C.5 Section FIELDEXEC

Fields added in this section trigger the execution of the main script code upon each value modification performed
by the user. This means that if for example you have added a string list field in this section, then when the user
selects a value, the “Run” button will be activated and the script will be executed.

Using the appropriate "if" statement inside your code you can enable different processed to be executed depending
on the selected values, such as filling a datagrid of the dialog filter or hiding panels.

**Example**
**_Design a dialog window that changes the visible property of panels and the caption of a field based on user
selections. Note: In order to run the script, use the ClientImport execution method._**
Form
**{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vImpOk **=** 2 **;** 15 **;** 0 **;** 1 **;** 0 **;** Job confirmation **;** $Y **;;** 0 **;**
vJob **=** 2 **;** 10 **;** 0 **;** 1 **;** 0 **;** Job **;** JOB **;;;**
vSeries **=** 1 **;** 1024 **;** 0 **;** 1 **;** 0 **;** Purchases series **;** #SERIES **(** W **[** SOSOURCE **=** 1251 AND
**(** TFPRMS **=** 102 OR TFPRMS **=** 103 OR TFPRMS **=** 151 OR TFPRMS **=** 152 **)]);;;**
vItemCode **=** 1 **;** 25 **;** 0 **;** 1 **;** 0 **;** From item code **;** ITEM **(** M **,** R **[** CODE **]);;;**
vFile **=** 1 **;** 256 **;** 0 **;** 1 **;** 0 **;** Pick File **;** $Filename **;;;
[** FIELDEXEC **]**
ImpTable**.** vJob

**[** PANELS **]**
PANEL1 **=** 0 **;** Job **;** 0 **;** 100 **,** G10
PANEL2 **=** 0 **;** Series **;** 0 **;** 100 **,** G10
PANEL3 **=** 0 **;** Item **;** 0 **;** 100 **,** G10
PANEL4 **=** 0 **;** Select file **;** 0 **;** 100 **,** G10
PANEL5 **=** 0 **;** Job confirmation **;** 0 **;** 100 **,** G10

**[** PANEL1 **]**
ImpTable**.** vJob
**[** PANEL2 **]**
ImpTable**.** vSeries
**[** PANEL3 **]**
ImpTable**.** vItemCode
**[** PANEL4 **]**
ImpTable**.** vFile
**[** PANEL5 **]**
ImpTable**.** vImpOk

**[** STRINGS **]**
JOB **=** JOB

**[** JOB **]**
1 **=** Data **import**
2 **=** Data Export
**}**

include 'ModuleIntf' **;**

Connect Xplorer Export
**{**
connect **();
}
{** //Main code
Var x **,** vImpTable **,** vJob **,** vImpOk **;**

vImpTable **=** GetDataset **(** xModule **,** 'ImpTable' **);**
vJob **=** GetFieldValue **(** vImpTable **,** 'vJob' **);**


Chapter 12 – SBSL
vImpOk **=** GetFieldValue **(** vImpTable **,** 'vImpOk' **);**

**if (** vJob **=** 1 **)
{**
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL2' **,** 'VISIBLE' **,** 'TRUE' **);** // Panel
visible
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL3' **,** 'VISIBLE' **,** 'FALSE' **);** // Panel
hidden
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL4' **,** 'VISIBLE' **,** 'TRUE' **);**
x **=** SetProperty **(** xModule **,** 'FIELD' **,** 'ImpTable.vFile' **,** 'CAPTION' **,** 'Import file' **);
}
else if (** vJob **=** 2 **)
{**
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL3' **,** 'VISIBLE' **,** 'TRUE' **);**
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL2' **,** 'VISIBLE' **,** 'FALSE' **);**
x **=** SetProperty **(** xModule **,** 'PANEL' **,** 'USR_PANEL4' **,** 'VISIBLE' **,** 'TRUE' **);**
x **=** SetProperty **(** xModule **,** 'FIELD' **,** 'ImpTable.vFile' **,** 'CAPTION' **,** 'Export file' **);
}
if (** vImpOk **=** 1 **)** //The code below is executed only when the user clicks “Yes” in
field “Job confirmation”
**{
if (** vJob **=** 1 **)
{**
//Add Code Here that will be executed when vJob=1
**}
if (** vJob **=** 2 **)
{**
//Add Code Here that will be executed when vJob=2
**}
}
}**

The following figures show the different panels and field caption displayed according to the selection of the field
“Job”.

```
Figure C5.1
```

Chapter 12 – SBSL

```
Figure C5.2
```

Chapter 12 – SBSL

#### C.6 Section SCRIPT

This section uses JavaScript code to interact with dialog object and field events.
One way to use this section is when you need to add a calculated value as default filter value. The calculations may
be entered inside the event “ON CREATE”. You can also use it to populate a grid of dialog filters.
Another way to use this section is in cases of displaying different dialog filters (panels) based on field value changes.
This means that you can trigger the on-change event of fields and show/hide panels according to field values.

**Example
form {**

**[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vFDateFrom **=** 11 **;** 15 **;** 0 **;** 1 **;** 0 **;** Date From **;;;;;**
vFDateTo **=** 11 **;** 15 **;** 0 **;** 1 **;** 0 **;** Date To **;;;;;**
vTxtFile **=** 1 **;** 255 **;** 0 **;** 1 **;** 0 **;** Choose File **;** $Filename **;;;**
vOrderNo **=** 1 **;** 32 **;** 0 **;** 1 **;** 0 **;** New Order No **;;;;**
vImpMess **=** 16 **;** 84000 **;** 0 **;** 1 **;** 1 **;** Job Messages **...;;;;**

##### [ PANELS ]

PANEL1 **=** 0 **;** Filters **;** 0 **;** 035 **,** 000 **,** 000 **,** 000 **,** G10
PANEL15 **=** 4 **;** Job Messages **...;** 0 **;** 100 **,** L5

**[** PANEL1 **]**
ImpTable**.** vFDateFrom
ImpTable**.** vFDateTo
ImpTable**.** vTxtFile
ImpTable**.** vOrderNo

**[** PANEL15 **]**
ImpTable**.** vImpMess

**[** Script **]**
//X.WARNING("test"); //Runs on init

**function** ON_CREATE **() {**
//X.WARNING("OnCreate Event");
GetNewOrderTimestamp **();
}**

**function** ON_ImpTable_vFDateFrom **(){**
X**.** WARNING **(** "ImpTable.vFDateFrom changed" **);
debugger;
if (** ImpTable**.** ISNULL **(** "vFDateFrom" **) ==** 0 **) {**
ImpTable**.** vFDateTo **=**
X**.** FORMATDATE **(** "dd/MM/yyyy" **,** X**.** EVAL **(** 'INCYEAR(ImpTable.vFDateFrom,1)' **));**
ImpTable**.** vImpMess **=** "Data from OnChange event: " **+** ImpTable**.** vFDateTo **;
}
}**

**function** ON_POST **() {** //On run button
X**.** WARNING **(** "POST Event" **);
}**


Chapter 12 – SBSL

**function** ON_ImpTable_vTxtFile **() {**
GetNewOrderTimestamp **();
}**

**function** GetNewOrderTimestamp **() {
var** myDate **= new** Date **();
var** year **=** "" **+** myDate**.** getFullYear **();
var** month **=** "" **+ (** myDate**.** getMonth **() +** 1 **); if (** month**.** length **==** 1 **) {** month **=** "0"
**+** month **; }
var** day **=** "" **+** myDate**.** getDate **(); if (** day**.** length **==** 1 **) {** day **=** "0" **+** day **; }
var** hour **=** "" **+** myDate**.** getHours **(); if (** hour**.** length **==** 1 **) {** hour **=** "0" **+** hour **; }
var** minute **=** "" **+** myDate**.** getMinutes **(); if (** minute**.** length **==** 1 **) {** minute **=** "0" **+**
minute **; }
var** second **=** "" **+** myDate**.** getSeconds **(); if (** second**.** length **==** 1 **) {** second **=** "0" **+**
second **; }**

ImpTable**.** vOrderNo **=** year **+** month **+** day **+** "_" **+** hour **+** minute **+** second **;**
//X.FORMATDATE("yyyymmdd_hhMMss", X.SYS.CLIENTDATE);
**}
}**

```
Figure C6.1
```

Chapter 12 – SBSL

### D. Main Code

#### D.1 Converters

In any place of the code, you can add a Converter that runs a SQL statement based on the parameters and when
called returns the value of the return field defined. The syntax of Converters is the following:

**Converter funcname (TableName:String, 'ParameterVariables:String', ReturnFieldName:String)**

**Examples**

**_1. Converter that returns the company name based on company code given as parameter_**
Converter GetCompanyName **(** COMPANY **,** 'COMPANY' **,** NAME **);**
GetCompanyName **(** 1 **);**
**_2. Converter that returns item id based on the company code and item code given as parameters_**
Converter ConvItem **(** MTRL **,** 'COMPANY;SODTYPE=51;CODE' **,** MTRL **);**
MTRL **=** ConvItem **(:** X**.** SYS**.** COMPANY **,** '100-01' **);**
**_3. Converter that returns customer id based on the company code and customer code given as parameters_**
Converter ConvCustomer **(** TRDR **,** 'COMPANY;SODTYPE=13;CODE' **,** TRDR **);**
TRDR **=** ConvCustomer **(:** X**.** SYS**.** COMPANY **,** sSalDoc**.** CUSTOMERCODE **);**

#### D.2 Functions

Same as in converters you can define your own functions which can be called from anywhere inside the script and
may be used to return values.

**Examples**

**_1. Function that displays a warning message_**
**function** ShowMessage **(** fMess **)
{**
x **=** CallPublished **(** 'SysRequest.ExecuteXScript' **,** VarArray **(** XModule **,** 1 **,** 'function
RUN() { X.WARNING(' **+** # 39 **+** VarToStr **(** fMess **)+** # 39 **+** ');}' **,** 'RUN' **,** 4 **));
}**
//...
x **=** ShowMessage **(** 'This is a warning message' **);**
**_2. Function that adds text message in a memo textbox field (vMess)_**
**function** PrintOnScreen **(** fMess **)
{**
x **=** SendResponse **(** ReplaceStr **(** fMess **,** '...' **,** '' **),** 'ImpTable.vMess' **);
}**
//...
x **=** PrintOnScreen **(** 'Completed!' **+** # 13 **+** # 10 **);**


Chapter 12 – SBSL

**_3. Function that formats the output of a string field by adding spaces until it meets the specified length given
as parameter. This string field can be later used for the export of an ASCII delimited file._**
**function** AddStrLine **(** mystr **,** icount **)
{
if (** mystr **= null)
{**
mystr **=** '' **;
}**
mystr **=** Copy **(** mystr **,** 1 **,** icount **);
return (** mystr **+** Space **(** icount **-** Len **(** mystr **)));
}**
//...
vTextWrite **=** CallPublished **(** 'PILib.CreateText' **, :** ImpTable**.** vPath3 **);**
vLine **=** '' **;**
vLine **=** vLine **+** AddStrLine **(** '' **,** 1 **);**
vLine **=** vLine **+** AddStrLine **(** 'VAT' **,** 3 **);**
vLine **=** vLine **+** AddStrLine **(** '23,00' **,** 5 **);**
vLine **=** vLine **+** AddStrLine **(** 'VAT' **,** 3 **);**
vLine **=** vLine **+** AddStrLine **(** FormatFloat **(** '0.000' **,** HEADER**.** VAT3 **),** 5 **);**
vLine **=** vLine **+** AddStrLine **(** VarToStr **(** HEADER**.** VATVAL3 **),** 14 **);**
x **=** CallPublished **(** 'PILib.WriteLine' **,** VarArray **(** vTextWrite **,** vLine **,** 2 **));**
**_4. Function that returns the date in sql format_**
**function** getSQLDate **(** v1 **,** conName **)
{
var** sql **,** x **,** newd **;**
newd **=** FormatSqlText **(** conName **,** ':1' **,** v1 **);**
sql **=** 'Select convert(VARCHAR(8), ' **+** newd **+** ' , 112)' **;**
x **=** GetQueryResults **(** conName **,** sql **,** '' **);
return** x **;
}**
//...
newvMesDate **=** VarToStr **(** getSQLDate **(:** ImpTable**.** vMesDate **,** 'S1Con' **));**


Chapter 12 – SBSL

#### D.3 Connection Types

The connection types you can use inside SBSL scripts are SQL Server, Oracle and ODBC. For every connection you
must define a specific name (i.e. ConS1), which can be later used as a reference inside the script. Notice though that
you must always define a connection to SoftOne.

**_SoftOne_**

Connection to SoftOne login database ( **must always be defined** )

**_Syntax_**
Connect Xplorer ConS1
**{**
connect **();**
dsfin **= select findoc, trdr, ... from** findoc where sosource=1351 and ... **;
}**

**_SQL SERVER_**

Connection to SQL Server database

**_Syntax_**
Connect DBDriver DocData
**{**
//Driver, DBase, ServerName, User, Password, DataBaseName
connect **(** 'XADODrv.bpl' **,** 'MSSQL' **,** 'SERVER\MYSRV' **,** 'sa' **,** '123456' **,** 'DBNAME' **);
}**

**_ORACLE_**

Connection to ORACLE database

**_Syntax_**
Connect DBDriver SRSData
**{**
//Driver, DBase, ServerName, User, Password, DataBaseName
connect **(** 'XODAC.BPL' **,** 'ORACLE' **,** 'SERVER' **,** 'srvn1' **,** 'srvn1' **,** 'srvn1' **);**
//OldVersion connect('XADODrv.bpl', 'ORACLE', 'SERVER', 'srvn1', 'srvn1', 'srvn1');
ds1 **= select fld1, fld2, ... from** MYTABLE where myfld **=** 1 **;
}**

**_Syntax for Oracle 19 (add parameter USEOCI=1 and use Service Name instead of ServerName and Database)_**
Connect DBDriver SRSData
**{**
//Driver, DBase, ServiceName, User, Password, ServiceName
connect **(** 'XOdac.bpl' **,** 'oracle' **,** '' **,** 'usr' **,** 'pass' **,** '' **,** 'USEOCI=1' **);**
ds1 **= select fld1, fld2, ... from** MYTABLE where myfld **=** 1 **;
}**

**_ODBC_**

Connection through ODBC (Excel, Access, etc.) based on the connection string

**_Syntax_**
Connect DBDriver XlsData
**{**
connect **(** 'XADODrv.bpl' **,** 'CUSTOM' **,** 'Provider=MSDASQL.1;Persist Security
Info=False;Data Source=XlsMtrl' **);**
XlsMtrl **= select fld1, fld2, fld3, ... from [** mtrl$ **];
}**


Chapter 12 – SBSL

#### D.4 Variables

Script variables can be stated at any point of the code before being called. They are declared using the word “var”
and their type is variant; when used their type is recognized automatically.

**var** vTot **,** vLabelText **,** vRow **,** vRowCancel **,** UserResp **,** x **;**

#### D.5 Use Libraries

In the main script code you can call functions that exist either in internal SoftOne libraries, or in libraries that you
have created by using SBSL scripts. In order to use libraries, you have to add the “include” statement. Analysis of
SoftOne libraries can be found in the following modules.

**Examples**
include 'PILib' **;**
include 'ModuleIntf' **;**
include 'SysRequest' **;**

In order to create and use your own functions as libraries you have to add them in a SBSL script
(i.e. MyLib) and then call them from any other SBSL script by using include statement.

**Example:**
include 'MyLib' **;**

#### D.6 Execute Javascript from SBSL

Javascript can be executed inside SBSL scripts using the following steps.

**_Step 1. Create Javascript functions_**

Add a new SBSL script, enter your JavaScript Functions and then Save it (e.g. MyJavFunctions).

Example

**function** MyWarning **() {**
X**.** WARNING **(** 'Using JavaScript functions' **);
}**

**_Step 2. Call Javascript functions from SBSL_**

Add the following lines inside your main SBSL script, replacing MyWarning with the function you want to execute.

**var** jScript **;**
jScript **=** VarToStr **(** GetQueryResults **(** 'Softone' **,** 'SELECT SOIMPORT FROM SOIMPORT WHERE
CODE=' **+** # 39 **+** 'MyJavFunctions' **+** # 39 **,** Null **));**
x **=** CallPublished **(** 'SysRequest.ExecuteXScript' **,** VarArray **(** XModule **,** 1 **,** jScript **,**
MyWarning **,** 4 **));**

**_Pass parameters from SBSL to Javascript_**

a) Create your parameters inside the main SBSL script using the function SetParamValue

x **=** CallPublished **(** 'ModuleIntf.SetParamValue' **,** VarArray **(** sModule **,**
'MyMessage' **,:** ImpTable**.** vParameter1 **,** 3 **));
var** jScript **;**
jScript **=** VarToStr **(** GetQueryResults **(** 'Softone' **,** 'SELECT SOIMPORT FROM SOIMPORT WHERE
CODE=' **+** # 39 **+** 'MyJavFunctions' **+** # 39 **,** Null **));**
x **=** CallPublished **(** 'SysRequest.ExecuteXScript' **,** VarArray **(** XModule **,** 1 **,** jScript **,**
MyCustomWarning **,** 4 **));**

b) Get parameters from the script that contains the Javascript functions using GETPARAM

**function** MyCustomWarning **() {
var** strMessage **=** X**.** GETPARAM **(** 'MyMessage' **);**
X**.** WARNING **(** strMessage **);
}**


Chapter 12 – SBSL

### E. SBSL Script Execution

The scripts created using the SBSL can be executed from the menu using the following ways:

**FORMIMPORT** : Runs script on the server and transfer results to the client

**CLIENTIMPORT** : Runs script from the client

The first method (run on server) is clearly faster than the second one (client / server environment).

The call action using clientimport is used when the script must have access to local resources (screen, keyboard,
disks and file system). If for example the user must interact with the screen displayed after running the script (i.e.
document conversion including the display of the document screen before posting) then clientimport must be used.
Another example of use of clientimport is when importing or exporting files to disk.

A third method to run a script is **CLIENTIMPORT2** command; this method does not differ in the mode of data
transfer to the client (CLIENTIMPORT), it simply changes the appearance of the dialog window (first line with dialog
parameters is not displayed).

#### E.1 Menu Execution

SBSL scripts that are built to run as menu jobs must be created as follows:

**Job type** : Batch Job

**Command (Server):** FORMIMPORT,SCRIPTNAME:NameOfScript

**Command (Client):** CLIENTIMPORT,SCRIPTNAME:NameOfScript (Figure E1.1).

If the script is stored in a file, then you enter the entire file path (Figure E1.2).

```
Figure E1.1
```
```
Figure E1. 2
```

Chapter 12 – SBSL

#### E.2 Browser Execution

Execution of SBSL scripts through right click from browsers can be performed in two ways, either using the file
OBJINFOS.CFG, or the SoftOne tool Data Flow Scenarios (recommended).

**_E.2.1 Run using file OBJINFOS.CFG_**

If you choose this method, then you need to create a file named OBJINFOS.CFG in the application folder of each
client. The scripts called this way, are displayed in the bottom of the pop-up menu appearing upon right clicking on
browser records (Figure E2.1).

Within the file OBJINFOS.CFG (Figure E2.2) you define the objects which will run the SBSL scripts and the titles of the
jobs to be displayed on right click, using the following syntax.

**[** OBJECTNAME_BRMENU **]**
1 **;** Job title **=** FORMIMPORT **,** SCRIPTNAME **:** nameofscript
1 **;** Job title **=** CLIENTIMPORT **,** SCRIPTNAME **:** nameofscript

```
Figure E2.1
```
```
Figure E2.2 – Sales documents pop up menu displaying custom job “File Transfer...”
```

Chapter 12 – SBSL

**_E.2.2 Run using Flow Scenarios_**

Execution of SBSL scripts through flow scenarios (Figure E2.3) gives you the option of defining user rights for the
scenario (and thus for the SBSL script) using the same way as the definition of rights in any other module.

Another difference between calling SBSL script from a flow scenario and calling it from the file OBJINFOS.CFG is the
location of the job displayed under pop-up menus. The jobs are displayed and executed from a submenu of the
right click menu, which is named “Flow scenarios” (Figure E2.4).

**Example (Ex E.1)**
**_Display the script named “test1” in the pop up menu of sales documents using a flow scenario._**

Create a new flow scenario and enter the "Description", that indicates the title of the job that will appear upon right
clicking.

Inside "Entity" enter the SoftOne object (SALDOC) where the script will be displayed and executed from.

Inside the datagrid insert a new line, select "Import script" type and in description enter the command for the SBSL
script named "test1", which is: FORMIMPORT, SCRIPTNAME: test1 (Figure E2.3)

Restart the application, open the SoftOne object “Sales Documents”, select any records and then by right click
notice the new job, under the submenu “Data flow scenarios” (Figure E2.4).

```
Figure E2.3
```
```
Figure E2.4
```

Chapter 12 – SBSL

#### E.3 Form Execution

SBSL jobs can be executed through object form screen scripts using the function EXEC with the following syntax.

X**.** EXEC **(** 'XCMD: FormImport, ScriptName: NameOfScript' **)**

**Example (Ex E.2)**
**_Execute the SBSL script named "UpdateItem" using a button in items view for the located item id._**

Create a new button (cmd = 20180101 ) in items view (Figure E3.1).

```
Figure E3.1
```
Add the following form script in “Configuration” window.

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20180101 **) {**
RunSBSLJob **();
}
}**

**function** RunSBSLJob **() {**
X**.** EXEC **(** 'XCMD:FormImport,ScriptName:ItemsUpdate **);
}**

Create the SBSL script “ _ItemsUpdate_ ” as follows. The id of the located item is retrieved through the dialog parameter
**vItemId** , as long as you set its default value to be “ **:ITEM.MTRL** ” (Figure E3.2). This field should not necessarily be
visible in the job dialog filters.

**form {
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vImpOk **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** Approve Job **;** $Y **;;;** 0
vItemID **=** 3 **;** 15 **;** 1 **;** 1 **;** 0 **;** Item ID **;** ITEM **;;:** ITEM**.** MTRL

**[** PANELS **]**
PANEL1 **=** 0 **;;** 0 **;** 100

**[** PANEL1 **]**
ImpTable**.** vImpOk
ImpTable**.** vItemID
**}**


Chapter 12 – SBSL

```
Figure E3.2
```
When you click on the button “ _Run Job (SBSL)_ ” inside an item, notice that the filter “ _vItemID_ ” is populated with the id
of the located item (Figure E3.3).

```
Figure E3.3
```

Chapter 12 – SBSL

#### E.4 Run using Parameters

SBSL provides the ability to set parameters within the code which can be activated when calling the script.
Parameters can be inserted using the ampersand symbol, &, before a variable definition (e.g. **&JOB** ).

Script calling with a specific parameter is performed by adding the parameter name and its value at the end of the
execution call (e.g. FORMIMPORT, SCRIPTNAME:myscript **,JOB:1** ).

**Example (Ex E.3)**
**_Run the script of the example “Ex. C.3” (Section CACHETABLES) for a given SODTYPE.
The name of the script is "cache1"._**

The only change that must be done in the script of example Ex C.3 is inside the statement of the dialog parameter
vSodtype. You must indicate a value (i.e. &mySodtype) as the default value, which is the parameter that has to be
defined when calling the script.

Form **{
[** TABLES **]**
ImpTable **=;;;;;** 3 **;** 0
TblPAYMENT **=;;;;** TblPAYMENT **;** 3 **;** 0
**[** ImpTable **]**
vSodtype **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Type SODTYPE **;** $SODTYPE **(** W **[** 12 **,** 13 **]);;** &mySodtype
vPayment **=** 2 **;** 25 **;** 1 **;** 1 **;** 0 **;** Payment **;** TblPAYMENT **(** W **[** SODTYPE **=:** ImpTable**.** vSodtype AND
COMPANY **=:** X**.** SYS**.** COMPANY **]) ;;;**

**[** TblPAYMENT **]**
PAYMENT **=** 2 **;** 5 **;** 0 **;** 1 **;** 0 **;;;;;**
NAME **=** 1 **;** 30 **;** 0 **;** 1 **;** 0 **;;;;;**
COMPANY **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**
SODTYPE **=** 2 **;** 5 **;** 0 **;** 0 **;** 0 **;;;;;**

**[** CACHETABLES **]**
TblPAYMENT **=** SELECT PAYMENT **,** NAME **,** COMPANY **,** SODTYPE AS SODTYPE FROM PAYMENT

**[** PANELS **]**
PANEL11 **=** 0 **;;** 0 **;** 50

**[** PANEL11 **]**
ImpTable**.** vSodtype
ImpTable**.** vPayment
**}**

Adding the parameter &mySodtype allows you to call the script through form screens using specific Sodtype (e.g.
13 ) with the following syntax:

X**.** EXEC **(** 'XCMD:FormImport,ScriptName:cache1,mySodtype:13' **)**

You can also execute the SBSL script through a menu job for a specific SODTYPE(e.g. 12) using the syntax:

FormImport **,** ScriptName **:** cache1 **,** mySodtype **:** 12


Chapter 12 – SBSL

### F. Built-in Functions

This section lists all the internal functions you can use in SBSL scripts.

#### Abs(Number: numeric): numeric;

Returns the absolute value of the given number.

#### AddMessage(Text: string);

Adds the given text in the window that is displayed when user clicks the “Results” hyperlink after the execution of a
job.

**Example**
**_Add a text in Results window that redirects user to a specific sales document record._**
vObject **=** 'SALDOC' **;**
vMess **=** 'Document converted <' **+** sDoc**.** FINCODE **+** '$' **+** vObject **+** ';' **+**
VarToStr **(** sDoc**.** FINDOC **)
+** '> to document <' **+** vFincode **+** '$' **+** vObject **+** ';' **+** VarToStr **(** resultnum **) +** '>
successfully!' **+** # 10 **;**
x **=** AddMessage **(** vMess **);**

#### CallPublished(FunctionName: string, Params: VarArray);

Executes the function named “FuntionName” using the parameters defined in “Params”.
Use it when you want to call functions from SoftOne Libraries.

**Examples**

**_1. Reupdate sales documents (based on a specific query) by changing the value of the field PAYMENT._**

See Case Study 1

**_2. Import Excel file in a SQL table named “CCCIMPORTEXCEL” (using the function Evaluate from SoftOne
Library SysRequest and the function ExcelImport from built-in functions)._**
x **=** CallPublished **(** 'SysRequest.Evaluate' **,** VarArray **(** ImportModule **(** 'Imp' **),**
'ExcelImport(' **+** # 39 **+:** ImpTable**.** vExcelFile **+** # 39 **+** ',' **+** # 39 **+** 'CCCIMPORTEXCEL' **+** # 39 **+** ',1,2)' **,** 2 **));**

#### CharToOem (var:string);

Converts the given string to OEM.

**Example**
x **=** CallPublished **(** 'PILib.WriteLine' **,** VarArray **(** vFileWrite **,** CharToOEM **(** vLine **),** 2 **));**

#### Commit(Connectionstring: string);

Ends the transaction by committing the data from the given connection string. Works only on FORMIMPORT calls.

**Example**
x **=** Commit **(** 'SoftOne' **);**

#### Copy(Source: string, Start: integer, Count: integer);

Returns the Source text from "Start" character, for the number of “Count” characters.

### DateOfDateTime(DateTime: TDateTime);

Returns the date for a specific “TDATETIME”.

**Example**
TRNDATE **=** DateOfDateTime **(** sSalDoc**.** TRNDATE **);**


Chapter 12 – SBSL

### DayOfDate(DateTime: TDateTime): integer;

Returns an integer that represents the day of the given date.

### DayOfWeek(): integer;

Returns an integer that represents the day of the week. (1=Sunday, 2=Monday, ..., 7=Saturday)

### DaysinMonth(DateTime: TDateTime): integer;

Returns the number of days of the month of the given date.

### Delay(Time: Integer);

Pauses execution for the given time calculated in msec.

**Example**
**_Delay execution for 2 seconds_**
x **=** Delay **(** 2 ***** 1000 **);**

### DeQuotedStr (text:string);

Returns text without quotation marks.

### EncodeTime(Hours: integer, Minutes: integer, sec: integer, ms: integer): TDateTime;

Returns “TDateTime” for specific Hours, minutes, seconds and milliseconds.

### ExecPrg(File: string, Params: string);

Runs the file with given parameters

**Example**
vParams **=** '/c' **;**
x **=** ExecPrg **(** 'c:\windows\system32\cmd.exe' **,** vParams **);**

### ExecSQL(Connection: string, Query: string, Params: VarArray);

Executes the SQL “Query” statement based on the “Connection” string.

**Example**
x **=** ExecSql **(** 'SoftOne' **,** 'Update TEMP Set Updated = 1 Where CUSCODE=' **+**
QuotedStr **(** sCustomer**.** CUSTOMERCODE **) ,** Null **);**

### Fetch SQLCursorName

Retrieves the rows of a SQL statement defined in “SQLCursorName”.

**Example**

See Case Study 1

### FormatSQLText(Connection: string, text: string, Params: VarArray);

Returns the “text” in SQL format according to the given parameters.

**Example**
**_Returns the vDateL datein SQL format_**
FormatSqlText **(** 'SoftOne' **,** ':1' **, :** ImpTable**.** vDateL **)**


Chapter 12 – SBSL

### GetIndexVar (Array: VarArray, index: integer);

Returns the value of the index element of a zero-based array.

**Example
if (** VarArrayDimCount **(** fVar **) >** 0 **)**
fVar **=** GetIndexVar **(** fVar **,** 0 **);**

### GetTimeHour(DateTime: TDateTime): integer;

Returns the hour of a specific DateTime.

### GetTimeMin(DateTime: TDateTime): integer;

Returns the minutes of a specific DateTime.

### GetTimeSec(DateTime: TDateTime): integer;

Returns the seconds of a specific DateTime.

### GetTimems(DateTime: TDateTime): integer;

Returns the ms of a specific DateTime.

### GetQueryDataset(Datasetname: string, Connection: string, Query:string, Params:VarArray);

Populates a Dataset (e.g. datagrid in dialog window) with the data returned from the SQL “Query” statement. Fields
of the Dataset must be declared in the same order that they appear in the SQL statement.

Works only in CLIENTIMPORT calls.

**Example**
x **=** GetQueryDataset **(** 'TblSID' **,** 'MyConnection' **,** 'SELECT FIELD1, FIELD2 FROM CCCMYTABLE' **,
null);**

### GetQueryResults(Connection: string, Query: string, Params: VarArray);

Executes the sql “Query” statement and returnsthe result set.

**Example**
fVat **=** GetQueryResults **(** 'SoftOne' **,** 'SELECT TOP 1 VAT FROM VAT WHERE ISACTIVE=1' **,
null);**

### GetWhere(XModule, ParamWhere: string, Param3(0=and,1=where));

Creates the SQL where clause defined in “ParamWhere” string using and or where depending on Param3.

**Example 1**

vFilters **=** GetWhere **(** XModule **,** 'F.TRNDATE=:ImpTable.vDateL;:ImpTable.vDateH'
**+** # 13 **+** # 10 **+** 'F.SERIES=#:ImpTable.vSeries' **,** 0 **);**

**Example 2**

vFilters **=** GetWhere **(** XModule **,** 'F.TRNDATE=:ImpTable.vDateL;:ImpTable.vDateH'
**+** # 13 **+** # 10 **+** 'F.SERIES=#:ImpTable.vSeries' **,** 0 **);**

### GrConvert(text: string): string;..............................................................................................................................................................

Returns the text converted to Greek characters.

**Example**
vFINCODE **=** GrConvert **(** Trim **(** sSalDoc**.** FINCODE **));**


Chapter 12 – SBSL

### ImportModule(Module: string);

Returns the pointer of the import Module.

**Example**

**_Import Excel file from the path defined in the variable vExcelFile in SQL table named_** “ **_CCIMPORTEXCEL”_**

x **=** CallPublished **(** 'SysRequest.Evaluate' **,** VarArray **(** ImportModule **(** 'Imp' **),**
'ExcelImport(' **+** # 39 **+:** ImpTable**.** vExcelFile **+** # 39 **+** ',' **+** # 39 **+** 'CCCIMPORTEXCEL' **+** # 39 **+** ',1,2)' **,**
2 **));**
//ExcelImport(FileName:string, TableName:string, Param1(1=Excel file with Headers,
2=no Headers), Param2 (1=Keep table records, 2=Delete all table records)

### Len(text: string): integer;

Returns length of the text.

### ModuleCommand (Module, Soft1Command, Params: string);

Executes the “Soft1Command” (form button/job) using the given “Params” parameters.

**Example**
x **=** CallPublished **(** 'ProgLibIntf.ModuleCommand' **,** VarArray **(** vModule **,** 1032 **,** VartoStr **(** resultnum **)
,** 3 **));**

### MonthOfDate(DateTime: TDateTime): integer;

Returns the month of the given date.

### Now(): TDateTime;

Returns the current date and time.

### OEMToChar (oem: var);

Converts OEM key code to characters.

### QuotedStr (text: string);

Returns text in single quotes.

**Example**
x **=** GetQueryResults **(** 'SoftOne' **,** 'SELECT COUNT(*) FROM TRDR WHERE
COMPANY=' **+** VarToStr **(:** X**.** SYS**.** COMPANY **)+** ' AND SODTYPE=13 AND
CODE=' **+** QuotedStr **(** VarToStr **(** fAdd **)+** VarToStr **(** fCounter **)), null);**

### Pos(Text: string,Source: string): integer;

Returns an integer specifying the position of the first occurrence of “Text” in “Source” string.

**Example**
x **=** Pos **(** 'c' **,** 'abcdefg' **)** //Returns 3

### RaiseException(Message: string);

Teminates the process of the script and displays an exception message on the screen.

**Example**
**_Display an exception message if variable vImpOK is not “Yes”_**
**if (:** ImpTable**.** vImpOk **=** 0 **)**
x **=** RaiseException **(** 'Run confirmation not selected!!!' **);**


Chapter 12 – SBSL

### RefreshMemoryTable(MemoryTable: string);

Refreshes memory Table and returns the pointer.

**Example**
ds **=** RefreshMemoryTable **(** 'SERIES' **);**

### Resultnum;

Returns the id of the record that has already been posted.

**Example**

See Case Study 2

### ReplaceStr (text: string, String1: string, String2: string);

Replaces text in “String1” with the “String2” text.

**Example**
vWhere **=** ReplaceStr **(** vWhere **,** 'SOFT1' **,** 'SOFTONE' **);**

### RollBack(Connectionstring: string);

Rolls back data defined from connentionstring. Only works on FORMIMPORT calls.

**Example**
x **=** RollBack **(** 'SoftOne' **);**

### SafeCallPublished(FunctionName: string, Params: VarArray);

Executes the function “FunctionName” from the libraries of the application. If an error is displayed, the exception
does not appear on the screen. Moreover, it updates the internal variable of ImportError system.

**Example**

**_Import Excel file from the path defined in the variable vExcelFile in sql table named_** “ **_CCIMPORTEXCEL”_**

x **=** SafeCallPublished **(** 'SysRequest.Evaluate' **,** VarArray **(** ImportModule **(** 'Imp' **),**
'ExcelImport(' **+** # 39 **+:** ImpTable**.** vExcelFile **+** # 39 **+** ',' **+** # 39 **+** 'CCCIMPORTEXCEL' **+** # 39 **+** ',1,2)' **,**
2 **));**
//ExcelImport(FileName:string, TableName:string, Param1(1=Excel file with Headers,
2=no Headers), Param2 (1=Keep table records, 2=Delete all table records)

### SafeExecSQL(Connection: string, Query: string, Params: VarArray);

Executes the sql “Query” statement. In case of error it does not display the exception and continues the flow of the
code.

**Example**
**_Deletes data of SID table from the base (whether created or not)._**
x **=** SafeExecSQL **(** 'Export' **,** 'TRUNCATE TABLE SID' **,** Null **);** //if table does not exist then
no error is displayed

### SendResponse(Values, Fields: string);

Updates the default interface dialog fields of the batch job.

**Example**
**_Update the following interface fields:
Current(CurRec), Canceled(CanRec), Total(TotRec), Messages(LabelText)_**
x **=** SendResponse **(** vRow **,** vRowCancel **,** vTot **,** vLabelText **,**
'RESULTS.CURREC;RESULTS.CANREC;RESULTS.TOTREC;RESULTS.LABELTEXT' **);**


Chapter 12 – SBSL

**ShowWarning(Message: string);**

Displays a warning message on the screen.

**Example**
x **=** ShowWarning **(** 'Warning Message' **);**

### Space (num: integer);

Inserts the defined number of spaces.

**Example**
vLine **=** VarToStr **(** Exp**.** TRNDATE **) +** Space **(** 1 **);**

### StartTrans(Connectionstring: string);

Starts a new transaction for the given connection string. Works only on FORMIMPORT calls.

**Example**
x **=** StartTrans **(** 'SoftOne' **);**

### StrToDate(text: string, format: string): TDateTime;

Converts string to Date format.

**Example 1**
x **=** StrToDate **(** ' 20210414 ', 'dd/mm/yyyy' **);**

**Example 2
[** ImpTable **]**
vSalSeries **=** 1 **;** 512 **;** 0 **;** 1 **;** 0 **;** Series **;** #SERIES **(** W **[** SOSOURCE **=** 1351 **]);;;**
vDateL **=** 11 **;** 20 **;** 0 **;** 1 **;** 0 **;** Date **;** $DATERANGE **;;;** 131
vDateH **=** 11 **;** 20 **;** 0 **;** 1 **;** 0 **;;;;;**

Var vDateFrom **,** vDateTo **,** vSeries **;**

**{**
vSeries **=** ModuleIntf**.** GetFieldValue **(** vImpTable **,** 'vSalSeries' **);**
vDateFrom **=** ModuleIntf**.** GetFieldValue **(** vImpTable **,** 'vDateL' **);**
vDateTo **=** ModuleIntf**.** GetFieldValue **(** vImpTable **,** 'vDateH' **);**
vSQLWhere **=** 'AND F.SOSOURCE=1351'
**+** GetWhere **(** XModule **,** 'F.TRNDATE=' **+** StrToDate **(** vDateL **,** '' **) +** ';' **+** VarToStr **(** vDateH **),** 0 **)
+** GetWhere **(** XModule **,** 'F.SERIES IN (' **+** vSeries **+** ')' **,** 0 **);
}**

**Example 3**
vSQL = FormatSqlText **(** 'Xplorer' **,** ':1' **,** StrToDate **(** vCol2 **,** 'dd/mm/yyyy' **));**

### StrToFloat (var: string);

Converts float to string.

**Example**
Module = CallPublished('ModuleIntf.CreateModule','SALDOC,WARNINGS:OFF,NOMESSAGES:1');
DsMTRLINES = CallPublished('ModuleIntf.GetDataSet',VarArray(Module,'MTRLINES',2));
LinesQTY = **StrToFloat** (CallPublished('ModuleIntf.GetFieldValue', VarArray(DsMtrlines,
'QTY1', 2)));
x = CallPublished('ModuleIntf.SetFieldValue',VarArray(DsMtrlines,'QTY',LinesQTY,3));


Chapter 12 – SBSL

### StrToInt (var: string);

Converts string to integer.

### TableExists(Connection: string,TableName: string);

Checks if a table named “TableName” exists and returns True or False.

**Example**
**_Check whether SID table exists and creation thereof in case it doesn't_**
**if (** TableExists **(** 'Export' **,** 'SID' **) =** 'False' **)**
x **=** ExecSQL **(** 'Export' **,** 'CREATE TABLE SID (FR INT, FV INT)' **,** Null **);**

### Trim(text: string): string;

Removes spaces and returns the text.

### Time():TDateTime;

Returns the current time.

### VarArray(Var1, Var2, ..., Varn, n);

Declares an array of variants, where the last element is the number of variants.

### VarArrayDimCount (Array: VarArray);

Returns the number of dimensions of the Array.

**Example
if (** VarArrayDimCount **(** fVar **)>** 0 **)**
fVar **=** GetIndexVar **(** fVar **,** 0 **);**

### VarArrayHighBound(Array: VarArray, Dim: integer);

Returns the number of elements in the Array for dimension Dim.

**Example**
vCaptions **=** VarArray **(** VarArray **(** 'Code' **,** 'Description' **,** 'Category' **,** 3 **),** VarArray **(** 'Code' **,**
'Name' **,** 'Category' **,** 3 **),** 2 **);**
vCaptions **=** GetIndexVar **(** vCaptions **,** 1 **);** //Returns the 1st VarArray
vSQLCaptions **=** VarArray **(** 'cCODE' **,** 'cNAME' **,** 'cMTRCATEGORY' **,** 3 **)
while (** i **<=** VarArrayHighBound **(** vCaptions **,** 1 **)) {** //Compares the value I with the number
of the elements of vCaptions(3 elements)
vLang **=** vLang **+** ', ' **+** QuotedStr **(** GetIndexVar **(** vCaptions **,** i **))+** ' AS
' **+** GetIndexVar **(** vSQLCaptions **,** i **);**
i **=** i **+** 1 **;
}**

### VarToStr(Param: Variant);

Converts Param to string.

**Example**
vRow **=** 100 **;**
vMess **=** vMess **+** 'Found ' **+** VarToStr **(** vRow **) +** ' files...'


Chapter 12 – SBSL

### XModule();

Returns the pointer of a Module.

**Example**
Form **{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0
TblDates **=;;;;** Master **;** 3 **;** 0

**[** TblDates **]**
vDateFrom **=** 11 **;** 25 **;** 1 **;** 1 **;** 0 **;** Date From **;;;;**
vDateTo **=** 11 **;** 25 **;** 1 **;** 1 **;** 0 **;** Date To **;;;;**
vWRKHOURS **=** 3 **;** 15 **;** 1 **;** 1 **;** 0 **;** Work Hours **;** WRKHOURS **;;;**

**[** ImpTable **]**
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Job Messages **...;;;;**
vWhere **=** 16 **;** 80000 **;** 0 **;** 1 **;** 0 **;** Browser Selection **;;;&** SELRECS **;&** SELRECS

**[** PANELS **]**
PANEL1 **=** 2 **;** Shift selection **;** 0 **;** H40 **;**
PANEL13 **=** 4 **;** Job Messages **...;** 0 **;** 100 **,** G10 **,** N **,** L3
**[** PANEL1 **]**
TblDates**.** vDateFrom
TblDates**.** vDateTo
TblDates**.** vWRKHOURS

**[** PANEL13 **]**
ImpTable**.** vMess
**}
var** x **,** vTblDates **;
{**
vTblDates **=** GetDataSet **(** XModule **,** 'TblDates' **);**
x **=** DataSetFirst **(** vTblDates **);**
//x = DataSetDisableControls(vTblDates);
**while (** DataSetEof **(** vTblDates **) =** 0 **) {**
vTblDateFrom **=**
FormatDateTime **(** 'YYYYMMDD' **,** GetFieldValue **(** vTblDates **,** 'vDateFrom' **));**
vTblDateTo **=** FormatDateTime **(** 'YYYYMMDD' **,** GetFieldValue **(** vTblDates **,** 'vDateTo' **));**
vTblWRKHOURS **=** GetFieldValue **(** vTblDates **,** 'vWRKHOURS' **);**
//Create Action
vModule **=** CreateModule **(** 'SOPRSN,WARNINGS:OFF,NOMESSAGES:1' **);**
x **=** InsertModule **(** vModule **);**
vTask **=** GetDataSet **(** vModule **,** 'SOACTION' **);**
x **=** DataSetEdit **(** vTask **);**

x **=** SetFieldValue **(** vTask **,** 'SERIES' **,** 3001 **);**
//...
x **=** DataSetNext **(** vTblDates **);
}
}**

### XSupport();

Returns the pointer to the Connection.

### YearOfDate(DateTime: TDateTime): integer;

Returns the year of the given date.

**Example**
fTmp **= :** X**.** SYS**.** SYSDATE **;**
fYear **=** VarToStr **(** YearOfDate **(** fTmp **));**


Chapter 12 – SBSL

## G. SoftOne Libraries

In this module you will find an analysis of the SoftOne Libraries, including all methods and functions you can call
from SBSL script. Commands are called either by using the Callpublished function, or directly after prior definition of
the specific library using include command.

### G.1 ModuleIntf

**CreateSupport(XCOfile, UserName, Password, Company, Branch, LoginDate);**

Creates a new connection to a SoftOne database defined from the “XCOfile”. If the first three parameters (XCOfile,
UserName, Password) are omitted then the parameters from the login connection are used.

**Example**
include 'ModuleIntf' **;**
fCompany **= :** X**.** SYS**.** COMPANY **;**
fDefaultBranch **=** CallPublished **(** 'ProgLibIntf.GetDefaultBranch' **,** VarArray **(:** X**.** SYS**.** USER **,**
fCompany **,** 2 **));**
fModule **=** CreateSupport **(** '' **,** '' **,** '' **,** fCompany **,** fDefaultBranch **, :** X**.** SYS**.** LOGINDATE **);**

**DestroySupport(SupportHandle);**

Frees the connection created to Soft1 from“CreateSupport” function.

**Example**
x **=** DestroySupport **(** fSupport **);**

**CreateSupportModule(SupportHandle, ModuleName);**

Creates an instance of a module (SoftOne object) for the Connection specified from “CreateSupport” function.

**Example**

vSupport **=** CreateSupport **(** '' **,** '' **,** '' **,** 1000 **,** 1000 **, :** X**.** SYS**.** LOGINDATE **);**
fModuleName **=** 'SALDOC' **;**
fModule **=** CreateSupportModule **(** vSupport **,** fModuleName **);**

**GetTextValue(TextName);**

Reads the Resources from the pre files (e.g. SoftOne script) of the application.

**Example**
**_Return data of the SBSL script ‘CheckImportData’._**
vData **=** GetTextValue **(** 'CheckImportData' **);**

**OpenSubForm(ModuleHandle, SubFormName, OpenMode);**

Opens or closes the sub form called SubFormName. The form always opens in modal mode.
OpenMode accepts the following values:
**1** : Opens the sub form and fires the event “ _Before show form_ ”

**- 1** : Closes the sub form and fires the “ _Accept_ ” event
**- 2** : Closes the sub form and fires the “ _Cancel_ ” event

**CreateModule(ModuleName);**

Creates an instance of module (SoftOne object) only for the current login connection. In order to use a specific form,
you have to use the SysRequest function CreateForm and then GetFormModule.

**Example**
vModule **=** CreateModule **(** 'CUSTOMER,WARNINGS:OFF,NOMESSAGES:1' **);**


Chapter 12 – SBSL

**DestroyModule(ModuleHandle);**

Destroys the Module created using “ _CreateModule_ ” or “ _CreateSupportModule_ ” functions.

**Example**
x **=** DestroyModule **(** fModule **);**

**FindXStrings(Module, StringListName: string);**

Gets the string list of the defined module.

**Example
var** strlist **;**
strlist **=** FindXStrings **(** XModule **,** 'RELJOBS' **);**
strlist **=** FindXStrings **(** XModule **,** 'BRMENU' **);**

**InsertModule(ModuleHandle);**

Changes the status of a module (SoftOne object) to insert mode in order to accept data.

**Example**
**_Insert a new task (Series: 1003 , Comments: ‘Inserted from SBSL script’)
This specific example does not ‘include’ the library ModuleInf but alternatively it uses the function
CallPublished to execute the functions of the library, though it’s preferred to include libraries for better
performance._**
**var** x **,** fModule **,** vTask **;**

fModule **=**
CallPublished **(** 'ModuleIntf.CreateModule' **,** 'SOTASK,WARNINGS:OFF,NOMESSAGES:1' **);**
x **=** CallPublished **(** 'ModuleIntf.InsertModule' **,** fModule **);**

vTask **=** CallPublished **(** 'ModuleIntf.GetDataset' **,** VarArray **(** fModule **,** 'SOACTION' **,** 2 **));**
x **=** CallPublished **(** 'ModuleIntf.DatasetEdit' **,** vTask **);**

x **=** CallPublished **(** 'ModuleIntf.SetFieldValue' **,** VarArray **(** vTask **,** 'SERIES' **,** 1003 **,** 3 **));**
x **=** CallPublished **(** 'ModuleIntf.SetFieldValue' **,** VarArray **(** vTask **,** 'COMMENTS' **,** 'Inserted from
SBSL script' **,** 3 **));**

x **=** CallPublished **(** 'ModuleIntf.DatasetPost' **,** vTask **);**
x **=** CallPublished **(** 'ModuleIntf.PostModule' **,** fModule **);**
x **=** CallPublished **(** 'ModuleIntf.DestroyModule' **,** fModule **);**

**LocateModule(ModuleHandle, RecordID);**

Locates a record of a module (ModuleHandle) based on the RecordID.

**Example**
fModule **=** CreateModule **(** 'CUSTOMER,WARNINGS:OFF' **);**
vCustomerID **=** 11999 **;**
x **=** LocateModule **(** fModule **,** vCustomerID **);**

**DeleteModule(ModuleHandle);**

Deletes a record of a module (ModuleHandle) that is previously located.

**Example**
**_Delete the customer with id = 119 9 9._**
include 'ModuleIntf' **;
var** x **,** fModule **,** vCustomerID **;**
fModule **=** CreateModule **(** 'CUSTOMER,WARNINGS:OFF' **);**
vCustomerID **=** 11999 **;**
x **=** LocateModule **(** fModule **,** vCustomerID **);**
x **=** DeleteModule **(** fModule **);**


Chapter 12 – SBSL

**PostModule(ModuleHandle);**

Posts in the database the data of a module (SoftOne object), applying all SoftOne methods.

**Example**
**_Insert new customer with code ‘1000’ and name ‘TempCustomer’_**
include 'ModuleIntf' **;
var** x **,** fModule **,** vTableTRDR **;**
fModule **=** CreateModule **(** 'CUSTOMER,WARNINGS:OFF' **);**
x **=** InsertModule **(** fModule **);**
vTableTRDR **=** GetDataset **(** fModule **,** 'TRDR' **);**
x **=** DatasetEdit **(** vTableTRDR **);**
x **=** SetFieldValue **(** vTableTRDR **,** 'CODE' **,** '1000' **);** //Sets code 1000 to field TRDR.CODE
x **=** SetFieldValue **(** vTableTRDR **,** 'NAME' **,** 'TempCustomer' **);** //Sets name'TempCustomer' to
field TRDR.NAME
x **=** DatasetPost **(** vTableTRDR **);
x = PostModule(fModule);**
x **=** DestroyModule **(** fModule **);**

**GetParentModule(ModuleHandle);**

Returns the ParentModule of the current Module

**GetChildModule(ModuleHandle, Name);**

Returns the ChildModule of the current Module

**GetDataset(ModuleHandle, Name);**

Returns the Dataset of the Module

**Example**
**_Insert new supplier with code ' 2000 ' and name 'TempSupplier'_**
include 'ModuleIntf' **;
var** x **,** fModule **,** vTableTRDR **;**
fModule **=** CreateModule **(** 'CUSTOMER,WARNINGS:OFF' **);**
x **=** InsertModule **(** fModule **);
vTableTRDR = GetDataset(fModule,'TRDR');**
x **=** DatasetEdit **(** vTableTRDR **);**
x **=** SetFieldValue **(** vTableTRDR **,** 'CODE' **,** '2000' **);** //Sets code 2000 to field TRDR.CODE
x **=** SetFieldValue **(** vTableTRDR **,** 'NAME' **,** 'TempSupplier' **);** //Sets name 'TempSupplier' to
field TRDR.NAME
x **=** DatasetPost **(** vTableTRDR **);**
x **=** PostModule **(** fModule **);**
x **=** DestroyModule **(** fModule **);**

**GetFieldProperty(FieldHandle, PropertyIndex);**

Returns the field’s property value for the given property index.

**PropertyIndex** accepts the following values:
**1** : Field Name
**2** : Data Type
**3** : Size
**4** : Display Name
**5** : Required
**6** : Read-only

**Example**
vDs **=** ModuleIntf.GetDataSet(XModule **,** 'CUSTOMER' **);**
vFld1 **=** ModuleIntf.GetField **(** vDs **,** 'NAME' **);**
vProp 1 **=** GetFieldProperty **(** vFld1 **,** 5 **);** //returns 1 when field is mandatory


Chapter 12 – SBSL

**SetFieldProperty(FieldHandle, PropertyIndex, PropertyValue);**

Modifies field property value for the given property index.

**PropertyIndex** accepts the following values:
**5** : Required (1=true, 0=false)
**6** : Read-only (1=true, 0=false)

**Example – JavaScript**
**_In conversion dialog object change the “required” property of the field “Delivery Date” (DELIVDATE) to
mandatory (using Advanced JS)._**
**function** ON_CREATE **() {
var** ds **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** 'CONVERTFPRMS' **);
var** fld **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** ds **,** 'DELIVDATE' **);**
X**.** EXEC **(** 'CODE:ModuleIntf.SetFieldProperty' **,** fld **,** 5 **,** 1 **);
}**

**GetParamValue(ModuleHandle, PrmName);**

Returns the value of PrmName

**Example**
vFile **=** GetParamValue **(** XModule **,** 'MyParameterName' **);**

**SetParamValue(ModuleHandle, PrmName, PrmValue);**

Sets a new value in the parameter “PrmName” of the Module.

**Example**
fDataset **=** GetDataset **(** vModule **,** 'SERIES' **);**
x **=** SetParamValue **(** fDataset **,** 'MyParameter' **,** 10 **);** //Creates a new parameter
(MyParameter) and sets its value to 10

**CreateDataset(ModuleHandle, DatasetName);**

Creates a Dataset named “DatasetName”

**DatasetLocate(DatasetHandle, FieldNames, FieldValues);**

Returns True if a record is found in Dataset and then locates it.

**Example 1**
vFISCPRD **=** RefreshMemoryTable **(** 'FISCPRD' **);**
x **=** DatasetLocate **(** vFISCPRD **,** 'FISCPRD' **,** GetFieldValue **(** vQUESTIONS **,** 'FISCPRD' **));**

**Example 2**
x **=** CallPublished **(** 'ModuleIntf.DataSetLocate' **,** VarArray **(** vIteLines **,** 'MTRL;MTRLINES' **,**
VarArray **(** vItem**.** MTRL **,** vItem**.** MTRLINES **,** 2 **),** 3 **));**

**Example 3**
x **=** CallPublished **(** 'ModuleIntf.DataSetLocate' **,** VarArray **(** vSpcLines **,** 'MTRL;SPCLINES' **,**
VarArray **(** vLines**.** MTRL **,** vLines**.** SPCLINES **,** 2 **),** 3 **));**

**Example 4**
x **=** CallPublished **(** 'ModuleIntf.DataSetLocate' **,** VarArray **(** vCDIM **,** 'CDIMLINES1;CDIMLINES2' **,**
VarArray **(** vCdimLines1 **,** vCdimLines2 **,** 2 **),** 3 **));**


Chapter 12 – SBSL

**DatasetEdit(DatasetHandle);**

Puts the Dataset into Edit state.

**Example**
**_Locate a record in Sales document (id=1000) and add comments ‘Comments from SBSL script’.
This specific example uses the CallPublished function instead of include ‘ModuleIntf’_**
**var** x **,** fModule **,** dsFinDoc **,** vfindocID **;**

fModule **=**
CallPublished **(** 'ModuleIntf.CreateModule' **,** 'SALDOC,WARNINGS:OFF,NOMESSAGES:1' **);**
dsFinDoc **=** CallPublished **(** 'ModuleIntf.GetDataset' **,** VarArray **(** Module **,** 'FINDOC' **,** 2 **));**
vfindocID **=** 1000 **;**
x **=** CallPublished **(** 'ModuleIntf.LocateModule' **,** VarArray **(** Module **,** vfindocID **,** 2 **));**
x **=** CallPublished **(** 'ModuleIntf.DatasetEdit' **,** DsFinDoc **);**

x **=** CallPublished **(** 'ModuleIntf.SetFieldValue' **,** VarArray **(** DsFinDoc **,** 'COMMENTS' **,** 'Comments
from SBSL script' **,** 3 **));**
x **=** CallPublished **(** 'ModuleIntf.PostModule' **,** Module **);**

**DatasetInsert(DatasetHandle);**

Opens a new, empty record before the current record, and makes the empty record the current one so that field
values for the record can be entered by code.

**Example**
include 'ModuleIntf' **;
var** x **,** fModule **,** fSalDoc **,** fIteLines **;**

fModule **=** CreateModule **(** 'SALDOC,WARNINGS:OFF' **);**
x **=** InsertModule **(** fModule **);**
fSalDoc **=** GetDataset **(** fModule **,** 'SALDOC' **);**
fIteLines **=** GetDataset **(** fModule **,** 'ITELINES' **);**
x **=** DatasetInsert **(** fIteLines **);**

**DatasetAppend(DatasetHandle);**

Opens a new, empty record at the end of the Dataset and makes the empty record the current one so that field
values for the record can be entered by code.

**Example**
**_Insert new substitute item(code 101) in table MTRSUBSTITUTE for the located item with id=1000._**
include 'ModuleIntf' **;
var** x **,** fModule **,** fDsMtrsubstitute **,** vMTRLID **;**

fModule **=** CreateModule **(** 'ITEM,WARNINGS:OFF,NOMESSAGES:1' **);**
vMTRLID **=** 1000 **;**
x **=** LocateModule **(** fModule **,** vMTRLID **);**
fDsMtrsubstitute **=** GetDataset **(** fModule **,** 'MTRSUBSTITUTE' **);**
x **=** DatasetAppend **(** fDsMtrsubstitute **);**

x **=** SetFieldValue **(** fDsMtrsubstitute **,** 'CODE' **,** '101' **);**
x **=** SetFieldValue **(** fDsMtrsubstitute **,** 'NAME' **,** 'SubItem101' **);**
x **=** SetFieldValue **(** fDsMtrsubstitute **,** 'QTY1' **,** 1 **);**

x **=** DatasetPost **(** fDsMtrsubstitute **);**
x **=** PostModule **(** fModule **);**
x **=** DestroyModule **(** fModule **);**


Chapter 12 – SBSL

**DatasetEof(DatasetHandle);**

Returns True if the Dataset is on the last record

**Example**
ds **=** GetSQLDataset **(** 0 **,** 'SELECT FINDOC FROM FINDOC WHERE.....' **, null)
while (** DatasetEof **(** Ds **)=** 0 **)
{
...**
x **=** DatasetNext **(** Ds **);
}**

**DatasetPrior(DatasetHandle);**

Moves to the previous record of the Dataset

**Example**
vMyTable **=** GetDataset **(** XModule **,** 'CCCMYTABLE' **);**
x **=** DatasetPrior **(** vMyTable **);**

**DatasetFirst(DatasetHandle);**

Moves to the first record of the Dataset

**Example**
x **=** DatasetFirst **(** vMyTable **);**

**DatasetLast(DatasetHandle);**

Moves to the last record of the Dataset

**Example**
x **=** DatasetLast **(** vMyTable **);**

**DatasetNext(DatasetHandle);**

Moves to the next record of the Dataset

**Example**
x **=** DatasetNext **(** vMyTable **);**

**DatasetPost(DatasetHandle);**

Posts the current record to the Dataset

**Example**
**_Insert new project with code ' 10 ' and name 'Project from SBSL script'_**
include 'ModuleIntf' **;
var** x **,** fModule **,** vTablePRJC **;**
fModule **=** CreateModule **(** 'PRJC,WARNINGS:OFF' **);** //SoftOne object is PRJC
x **=** InsertModule **(** fModule **);**
vTablePRJC **=** GetDataset **(** fModule **,** 'PRJC' **);** //Table is PRJC
x **=** DatasetEdit **(** vTablePRJC **);**
x **=** SetFieldValue **(** vTablePRJC **,** 'CODE' **,** '10' **);** //Sets code 10 to field PRJC.CODE
x **=** SetFieldValue **(** vTablePRJC **,** 'NAME' **,** 'Project from SBSL script' **);
x = DatasetPost(vTablePRJC);**
x **=** PostModule **(** fModule **);**
x **=** DestroyModule **(** fModule **);**

**DatasetDelete(DatasetHandle);**

Deletes the current record of the Dataset

**Example**
x **=** DatasetDelete **(** vMyTable **);**


Chapter 12 – SBSL

**DatasetState(DatasetHandle);**

Returns the State of the Dataset. The available values are summarized below:

**_0=dsInactive_**

Dataset closed. Data unavailable.

**_1 =dsBrowse_**

Dataset open. Data can be viewed, but not changed. This is the default state of an open Dataset.

**_2=dsEdit_**

Dataset open. The current row can be modified.

**_3=dsInsert_**

Dataset open. A new row is inserted or appended.

**_6=dsFilter_**

Dataset open. Indicates that a filter operation is under way. A restricted set of data can be viewed, and no data can
be changed.

**DatasetSetFilter(DatasetHandle, Filterstring);**

Applies “Filterstring” filter to Dataset

**SetDatasetLinks(ModuleHandle, DatasetHandle, Value);**

When you populate a Dataset that has fields linked to tables, then for every record added, a query runs for each of
these fields in order to link them to the tables. This function provides the ability to send the queries once when all
records are filled.

Value: 0= Disable links, 1= Enable links

**Example**

fModule **=** CreateModule **(** 'INST,WARNINGS:OFF' **);**
x **=** InsertModule **(** fModule **);**
fDsInst **=** GetDataset **(** fModule **,** 'INST' **);**
x **=** SetDatasetLinks **(** fModule **,** fDsInst **,** 0 **);**

**GetFieldType(DatasetHandle, FieldName);**

Returns a number that applies to the type of the field. Values returned are:
**1** =String, **2** =Smallint, **3** =Integer, **4** =Word, **6** =Float, **11** =DateTime, **16** =Memo

**Example**
fField **=** DatasetFieldName **(** fDs **,** fFieldsCounter **);**
fFieldType **=** GetFieldType **(** fDs **,** fField **);**

**GetFieldValue(DatasetHandle, FieldName);**

Returns the field value for the located record of a dataset

**SetFieldValue(DatasetHandle, FieldName, FieldValue);**

Assigns a value in the field for the located record of a dataset


Chapter 12 – SBSL

**SetValueFromFile(DatasetHandle, FieldName, FileName);**

Saves data in a blob (image) field of a dataset.

**Example**
**_Locate an item with id=100 and insert an image from file (C:\myimage.png)_**
include 'ModuleIntf' **;
var** x **,** fModule **,** vIteDocData **,** vMTRLID **;**

fModule **=** CreateModule **(** 'ITEM' **);**
vMTRLID **=** 100 **;**
x **=** LocateModule **(** fModule **,** vMTRLID **);**
vIteDocData **=** GetDataSet **(** Module **,** 'ITEDOCDATA' **);**
x **=** DataSetEdit **(** vIteDocData **);
x = SetValueFromFile(vIteDocData,'SODATA', 'C:\myimage.png');**
x **=** DataSetPost **(** vIteDocData **);**
x **=** PostModule **(** fModule **);**
x **=** DestroyModule **(** fModule **);**

**DatasetRecordCount(DatasetHandle);**

Returns the number of records in the Dataset

**DatasetOpen(DatasetHandle);**

Sets Dataset in Open state

**DatasetClose(DatasetHandle);**

Closes the Dataset

**DatasetRecNo(DatasetHandle);**

Returns the location of arecord in the Dataset

**DatasetSetRecNo(DatasetHandle,RecNo);**

Setsthe location of a record in the Dataset

**DatasetDisableControls(DatasetHandle);**

Disables Windows Controls to theDataset

**DatasetEnableControls(DatasetHandle);**

Enables Windows Controls to the Dataset

**DatasetFieldCount(DatasetHandle);**

Returns the number of fields of a Dataset

**DatasetFieldName(DatasetHandle, FieldIndex);**

Returns the field name of a Dataset based on the index of the field

**GetSQLDataset(SupportHandle, SQLStatement, Params);**

Returns aDatasetbased on the SQL statement.

**Example**
vds **=** GetSQLDataset **(** 0 **,** 'SELECT DISTINCT CODE, NAME FROM CCCMYTABLE ORDER BY CODE,
NAME' **, null);**

**GetBand(ModuleHandle, BandName);**

Return the Module Band


Chapter 12 – SBSL

**SetBandXProperty(BandHandle, FieldName, PropertyType, PropertyValue);**

Sets the column properties of the Band

**Property Types** : **1** =Caption, **2** =Width. Decimals, **4** =Visible, **7** =HasSums, **8** =DebitCredit, **9** =Transfer

**GetBandXProperty(BandHandle, FieldName, PropIndex);**

Returns the properties of a column of the Band

**AddBandField(BandHandle, FieldName);**

Adds a new column in the Band

**DeleteBandField(BandHandle, FieldName);**

Deletes a Band column

**GetField(DatasetHandle, FieldName);**

Returns the Dataset field

**AddFieldToDataset(DatasetHandle, FieldName, Type, Size, Label);**

Adds a field to a Dataset

**SetFieldEditor(ModuleHandle, FieldName, Editor, ClearOld);**

Changes the Editor of a field

**ResolveEditors(ModuleHandle, TableName);**

Follows SetFieldEditor and activates new Editors on the table

**SetProperty(ModuleHandle, ControlType, ControlName, Property, Value);**

Sets the property defined to a Module with parameters 1,2,3 (e.g. 'PANEL','PANELNAME','VISIBLE','TRUE')

**DebugString(text:string) published 'ModuleIntf.DebugString';**

Text message is saved in the EventLog.


Chapter 12 – SBSL

### G.2 PiLib

**AsciiImport(ParamsInfo, FieldsInfo);**

Reads an ascii file with a specific layout and imports it in a table that is already created in the database.

**ParamInfo** = Parameters (Table name, ASCII file path, Decimals separator, first line to insert, Convert chars to 437,
Date format)
**FieldsInfo** = Fields layout

**Example**
include 'PiLib' **;**
vParamsInfo **=** 'TABLENAME=test_table' **+** # 13 **+** # 10 **+**
'ASCIINAME=C:\myDir\myfile.txt' **+** # 13 **+** # 10 **+**
'THOUSANDSEPARATOR=.' **+** # 13 **+** # 10 **+**
'DECIMALSEPARATOR=,' **+** # 13 **+** # 10 **+**
'FIRSTLINE=1' **+** # 13 **+** # 10 **+**
'OEMCONVERT=1' **+** # 13 **+** # 10 **+**
'DATEFORMAT=' **;**
vFieldsInfo **=** 'TRNDATE=1,8' **+** # 13 **+** # 10 **+**
'CODE=010,012' **+** # 13 **+** # 10 **+**
'NAME=023,039' **+** # 13 **+** # 10 **+**
'TPRMS=063,003' **+** # 13 **+** # 10 **+**
'FINCODE=067,009' **+** # 13 **+** # 10 **+**
'WHOUSE=079,001' **+** # 13 **+** # 10 **+**
'TRDCODE=082,005' **+** # 13 **+** # 10 **+**
'QTY=098,012' **+** # 13 **+** # 10 **+**
'TRNVALUE1=137,012' **+** # 13 **+** # 10 **+**
'COMMENTS=149,039' **;**
x **=** AsciiImport **(** vParamsInfo **,** vFieldsInfo **);**

**CreateDir (Directory: string);**

Creates the defined directory.

**Example**
x **=** CallPublished **(** 'PILib.CreateDir' **,** Directory **);**

**DirectoryExists (Directory: string);**

Returns true if the directory exists.

**Example**
x **=** CallPublished **(** 'PILib.DirectoryExists' **,** Directory **);**

**ForceDirectories(Path: string);**

Creates all the folders under a specific path, if they don't exist.

**Example**
x **=** CallPublished **(** 'PILib.ForceDirectories' **,** Path **);**

**RemoveDir(Directory: string);**

Deletes the folder, if it's empty.

**Example**
x **=** CallPublished **(** 'PILib.RemoveDir' **,** Directory **);**


Chapter 12 – SBSL

**FileExists(FileName: string);**

Checks whether the file exists.

**Example**
include 'PiLib' **;
if (** FileExists **(** FileName **)=** 'True' **)
{**
//....
**}**

**DeleteFile(FileName: string);**

Deletes file FileName.

**Example**
vFileDel **=** DeleteFile **(** FileName **);**

**RenameFile(OldName: string, NewName: string);**

Renames the file “OldName” file to “NewName”.

**CreateText(FileName: string);**

Creates the “FileName” file.

**Example**

vFileName **=** '.\folder1 ' **+** 'Myname.log' **;**
vFile 1 **=** CreateText **(** vFileName **);**

**CreateTextCodePage(FileName: string, CodePage: integer);**

Creates file “FileName” file using specific encoding.

**Example**
vFile 2 **=** CreateTextCodePage **(:** ImpTable**.** vFile, 65001 **);** //UTF-8 Unicode

**OpenText(FileName:string);**

Opens “FileName” file for Read or Write.

**Example**
vFile 1 **=** OpenText **(:** ImpTable**.** vFile **);**

**OpenTextCodePage(FileName: string, CodePage: integer);**

Opens “FileName” file for Read or Write using the codepage defined.
Codepage identifiers can be found at the following links:

https://docs.microsoft.com/en-us/windows/win32/intl/code-page-identifiers

https://en.wikipedia.org/wiki/Windows_code_page

**Example**
vFile 2 **=** OpenTextCodePage **(:** ImpTable**.** vFile, 65001 **);** //UTF-8 Unicode

**ReadLine(FileName: string);**

Reads a line characters from the file “FileName”.

**Example
while (** Eof **(** vFile **)=** 0 **)
{**
vLine **=** ReadLine **(** vFile **);
}**


Chapter 12 – SBSL

**WriteLine(FileName: string, Text: string);**

Writes the specified data, followed by the current line terminator, to the “FileName” file.

**Example**
x **=** WriteLine **(** vFile **,** 'Start job' **);**

**EOF(FileName: string);**

Returns true if the file “FileName” is at the end.

**Example
while (** Eof **(** vFile **)=** 0 **)
{**
vLine **=** ReadLine **(** vFile **);
}**

**CloseText(FileName: string);**

Closes file FileName, which was opened using “OpenText” or “OpenTextCodePage” functions.

**Example**
x **=** CloseText **(** vFile **);**

**WriteTextToFile(FileName: string, Text: string);**

Writes the specified data to the file “FileName”, replacing any other text inside the file.

**Example**
x **=** WriteTextToFile **(** vPath **+** 'PL-' **+** VarToStr **(** sDoc**.** FINDOC **)+** '.TXT' **,** vText **);**

**ReadTextFromFile(FileName: string);**

Opens file FileName and reads all its contents.

**Example**
x **=** ReadTextFromFile **(** vFile **);**

**ReadFile(FileName: string);**

Opens file FileName and reads it in Stream.

**Example**
x **=** ReadFile **(** vFile **);**

**AnsiToUTF8(Text: string);**

Converts the text “Text” from ANSI to UTF8.

**Example**
x **=** AnsiToUtf8 **(** vLine **);**

**UTF8ToAnsi (Text: string);**

Converts the text “Text” from UTF8 to ANSI.

**Example**
x **=** Utf8ToAnsi **(** vLine **);**

**GetSupportQueryResults(Support: Handle, Query: string, Params: VarArray);**

Returns the value for the Query of the Handle stated. Returns a value or an Array.


Chapter 12 – SBSL

**GetSupportQueryData(Support: Handle, Query: string, Params: VarArray);**

Returns the result of the Query of the Handle stated in compressed format.
Fields are separated with '|' and entries with '|~'

**FindFirst(Path: string, Attr: integer);**

Searches a folder for the first file that use specific attributes (and name).
Returns an array with the following: [0]=Filename, [1]=Date, [2]=Size, [3]=Attributes
Don't forget to use FindClose after the use of this function in order to deallocate memory.

**File Attributes**
faReadOnly=1, faHidden=2, faSysFile=4, faVolumeID=8, faDirectory=16, faArchive=32, faAnyFile=63

**Example**
vFind **=** FindFirst **(** 'C:\test.*' **,** 63 **);**

**FindNext(FileHandle: FindFirstResult);**

Searches for the next file with the specific name and attributes.
Don't forget to use FileClose after the use of this function in order to deallocate memory.

**Example**
x **=** FindNext **(** vFind **);**

**FindClose (FileHandle: FindFirstResult);**

Frees the memory after using FindFirst or FindNext functions.

**Example**
x **=** FindClose **(** vFind **);**

**GetXStrings(StringListName: string);**

Returns the data of the “Name” string list.

**Example**

See Case Study 4

**TStringsCreate();**

Defines a string list object and points the variable at it.

**TStringsClear(TStringsHandle);**

Clears the data of the string list.

**TStringsGetValue(TStringsHandle, Key: string);**

If there is a name-value pair in the list of strings that has name part “Key”, then the corresponding value is returned.
If there is no such pair, an empty string is returned.

**Example
var** strlist **,** vDocLinksValue **;**
strlist **=** FindXStrings **(** XModule **,** 'RELJOBS' **);**
vDocLinksValue **=** VarToStr **(** TStringsGetValue **(** strlist **,** '@FINDOC.XDOCLINKS' **));** //Returns
the name of the relative job

**TStringsValueOfIndex (TStringsHandle, Index: integer);**

Moves to the specified index of the string list and returns its value.


Chapter 12 – SBSL

**TStringsSetValue(TStringsHandle, Key: string, Value: Variant);**

Checks whether there exists a name-value pair in the list with name “ _Key_ ”. If such a pair is found, it's value part is
overwritten with the specified value. If no such pair is found, a new name-value pair is added with the
specified “Key” and value.

**TStringsGetItem(TStringsHandle, Index: integer);**

Moves to the specified index of the string list and returns the item.

**Example**

See Case Study 4

**TStringsGetItemName(TStringsHandle, Index: integer);**

Moves to the specified index of the string list and returns its key.

**TStringsSetItem(TStringsHandle, Index: integer, Value: Variant);**

Moves to the specified index of the string list and sets the value " _Value_ ".

**TStringsAdd(TStringsHandle, DataStr: string);**

**DataStr Structure** : Key = Value

Adds “DataStr” data to the next record of the string list.

**Example**
mystrlist **=** GetXStrings **(** 'CCCMYLIST' **);**
x **=** TStringsAdd **(** mystrlist **,** '20=New Item In List' **);**

**TStringsCount(TStringsHandle);**

Returns the number of records of the string list.

**Example 1**
mystrlist **=** GetXStrings **(** 'CCCMYLIST' **);**
x **=** TStringsCount **(** mystrlist **);**

**Example 2**

See Case Study 4


Chapter 12 – SBSL

### G.3 SysRequest

**CreateForm('ObjectName[ObjectAttributes]');**

Creates a pointer for a SoftOne object, allowing also to use a specific form. The module instance is created through
the function GetFormModule.

**Syntax** :

vForm = CallPublished **(** 'SysRequest.CreateForm' **,** VarArray **(** ' **S1Object[FORM:MyForm]** ' **,** 5 **,** 2 **));**
vFormModule = CallPublished **(** 'SysRequest.GetFormModule' **,** vForm **);**

**Example**
vForm **=** CallPublished **(** 'SysRequest.CreateForm' **,** VarArray **(** 'SOACTION **[FORM:MyForm]** ' **,** 5 **,** 2 **));**
vFormModule **=** CallPublished **(** 'SysRequest.GetFormModule' **,** vForm **);**
fetch sDoc **{**
x **=** InsertModule **(** vFormModule **);**
DsSOACTION **=** GetDataSet **(** vFormModule **,** 'SOACTION' **);**
DsCCCMyTable **=** GetDataSet **(** vFormModule **,** 'CCCMYTABLE' **);**
x **=** DataSetEdit **(** DsSOACTION **);**
x **=** SetFieldValue **(** DsSOACTION **,** 'SERIES' **,** VarToStr **(:** ImpTable**.** vSeries **));
...**
fetch sDocLines **{**
x **=** DatasetAppend **(** DsCCCMyTable **);**
x **=** SetFieldValue **(** DsCCCMyTable **,** 'CHEQUE' **,** sDocLines**.** CHEQUE **);
...**
x **=** DataSetPost **(** DsCCCMyTable **);
}**
newid **=** PostModule **(** vFormModule **);
if ((** ImportError **=** 0 **)** AND **(** newid **>** 0 **)) {
....
}
}**
x **=** CallPublished **(** 'SysRequest.DestroyObject' **,** vFormModule **);** //Destroys pointer

**DestroyObject(ObjectHandle);**

Frees memory of the defined object.

**Example**
x **=** DestroyObject **(** fObject **);**

**DoSendMail2(TO, CC, BCC, Subject, BodyText, BodyHTMLText, Attachment, FromName);**

Sends email to the given recipient with the parameters defined. It uses the outgoing email settings defined either in
the Email Account of the login user or in SoftOne general settings (Internet tab).

Note that the last parameter (FromName) is not mandatory, so you can omit it, if not necessary.

**Example**
strTO **=** 'myemail@testemail.com' **;**
strCC **=** '' **;**
strBCC **=** '' **;**
strSubject **=** 'Email Subject' **;**
strBodyPlain **=** 'Email plain text – no html' **;**
strBodyHTML **=** 'Dear Sir,<br>...' **;**
strFromName **=** 'Last Name First Name' **;**
strAttachment **=** 'C:\myfile.txt' **;**
x **=** CallPublished **(** 'SysRequest.doSendMail2' **,** VarArray **(** strTO **,** strCC **,** strBCC **,**
strSubject **,** strBodyPlain **,** strBodyHTML **,** strAttachment **,** strFromName **,** 8 **));**


Chapter 12 – SBSL

**DoSendMail3(TO, CC, BCC, Subject, BodyText, BodyHTMLText, Attachment, FromName,**

**EmailAccount);**

Sends email to the given recipient using the email settings defined in the outgoing panel of given Email Account
(Parameter 9).

**Example**
strTO **=** 'myemail@testemail.com' **;**
strCC **=** '' **;**
strBCC **=** '' **;**
strSubject **=** 'Email Subject' **;**
strBodyPlain **=** 'Email plain text – no html' **;**
strBodyHTML **=** 'Dear Sir,<br>...' **;**
strFromName **=** 'Last Name First Name' **;**
strAttachment **=** 'C:\myfile.txt' **;**
vEmailAccount **=** 10 **;** //Defines the email account (Parameters – Users & Rights – Email
Accounts)
x **=** CallPublished **(** 'SysRequest.doSendMail3' **,** VarArray **(** strTO **,** strCC **,** strBCC **,**
strSubject **,** strBodyPlain **,** strBodyHTML **,** strAttachment **,** strFromName **,** vEmailAccount **,**
9 **));**

**Evaluate(Module, InternalFunction: string);**

Executes the internal function of the application.

**Example**
**_Get the id of a customer (Customer Code = 50) using the internal function ID._**
sExpr **=** 'ID(' **+** QuotedStr **(** 'CUSTOMER' **) +** ',' **+** QuotedStr **(** '50' **) +** ')' **;**
id **=** CallPublished **(** 'SysRequest.Evaluate' **,** VarArray **(** ImportModule **(** CUSTOMER'),sExpr,
2));

**ExecuteXScript(Module, Language, ScriptName, Function);**

Runs the Function of the script named “ScriptName”. Use it when you want to create your own libraries and call
functions from them.

**Language:** 1 = JavaScript, 2 = VBScript

**Examples**
**_1.RUN JavaScript code that displays message box (X.WARNING) in the screen._**
x **=** ExecuteXScript **(** XModule **,** 1 **,** 'function RUN() {X.WARNING(' **+** # 39 **+** 'Msg' **+** # 39 **+** ');}' **,** 'RUN' **);**
//OR (Using double quotes)
x **=** ExecuteXScript **(** XModule **,** 1 **,** 'function RUN() { X.WARNING("Msg");}' **,** 'RUN' **);**

**_2. Call and execute a function from the custom SBSL script named “myfunctions”._**
vScript **=** GetQueryResults **(** 'SoftOne' **,** 'SELECT SOIMPORT FROM SOIMPORT WHERE CODE =
' **+** QuotedStr **(** 'myfunctions' **),** Null **);**
x **=** ExecuteXScript **(** vModule **,** 1 **,** vScript **,** 'Convert' **);**

**_3. Include “Advanced JavaScript” code and execute a specific function (myFunc)._**
Form **{
}**

connect Xplorer Softone **{**
connect **();
}**

**var** x **,** vLibScript **;**

**{**
vLibScript **=** 'lib.include("mylib");' **;**
x **=** CallPublished **(** 'SysRequest.ExecuteXScript' **,** VarArray **(** XModule **,** 1 **,** vLibScript **,** 'myFunc' **,**
4 **));
}**


Chapter 12 – SBSL

**ExecuteNetFunction(Dll FileName, Class (with Namespace), FunctionName, Params);**

Runs the .NET DLL Function using the defined Params.

**Class** : Namespace.ClassName

**Attention:** .NET function must be defined as static int.

**Example**
**_JavaScript: Call .NET function (CallFromSoftOne) using browser right-click menu option (specified command)_**
**function** ON_CREATE **() {
var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '20 220101 =1;Run DLL Job' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 20220101 **) {
var** xplorerDir **=** X**.** DIR **(** 'EXE' **);**
X**.** EXEC **(** 'CODE:SysRequest.ExecuteNetFunction' **,** xplorerDir **+** 'S1DevInProcess.dll' **,**
'S1DevInProcess.S1' **,** 'CallFromSoftOne' **,** 'my message;50' **);
}
}**

**_C# function CallFromSoftOne – Login – SELRECS – Object Events – DLL Form as new Tab in Customer object._**
**namespace** S1DevInProcess
**{
public** class S1DevInProcess
**{
public** static XSupport s1Support **;
public** static string strAppName **=** "S1Dev ver." **+** string**.** Format **(** "{0}.{1}" **,**
Assembly**.** GetExecutingAssembly **().** GetName **().** Version**.** Major **,** Assembly**.** GetExecutingAssembly **().** GetName **().** Version**.** Minor **);
}**

**public** class S1
**{
public** static int CallFromSoftOne **(** string data **)
{**
string **[]** args **=** data**.** Split **(** ';' **);**
//string param1 = args[0];
//int param2 = int.Parse(args[1]);
MessageBox**.** Show **(** "Test Msg " **+** args **[** 0 **],** S1DevInProcess**.** strAppName **,** MessageBoxButtons**.** OK **,** MessageBoxIcon**.** Information **);
return** 1 **;
}**

**public** class S1Init **:** TXCode
**{
public override** void Initialize **()
{**
MessageBox**.** Show **(** "DLL Login OK" **,** S1DevInProcess**.** strAppName **,** MessageBoxButtons**.** OK **,** MessageBoxIcon**.** Information **);
}
}**

**[** WorksOn **(** "ITEM" **)]
public** class Items **:** TXCode
**{
public** XTable XItems **;
public override** void Initialize **()
{
base.** Initialize **();**
XModule**.** SetEvent **(** "ON_ITEM_NAME" **,** MyfunctionToGetTheEvent **);**
XItems **= this.** XModule**.** GetTable **(** "ITEM" **);
}
public override** void BeforePost **()
{
base.** BeforePost **();**
MessageBox.Show("Posted from DLL. Current Name is:" + XItems**.** Current **[** "NAME" **]** .ToString());
**}**

**private** void MyfunctionToGetTheEvent **(object** Sender **,** XEventArgs e **)
{**
string str **=** string**.** Format **(** "Name changed to '{0}'" **,** XItems**.** Current **[** "NAME" **]);**
MessageBox**.** Show **(** str **,** S1DevInProcess**.** strAppName **);
}
}**


Chapter 12 – SBSL
**[** WorksOn **(** "SERIES" **)]
public** class Series **:** TXCode
**{
public** XTable XSeries **;
public override** void Initialize **()
{
base.** Initialize **();**
XSeries **= this.** XModule**.** GetTable **(** "SERIES" **);
}
public override** void AfterLocate **()
{
base.** AfterLocate **();**
MessageBox**.** Show **(** String**.** Format **(** "Located Series with SOSOURCE {0}" **,** XSeries**.** Current **[** "SOSOURCE" **]),** "DLL Msg" **);
}
public override** void BeforePost **()
{
base.** BeforePost **();**
MessageBox**.** Show **(** "Posted Series from dll" **,** S1DevInProcess**.** strAppName **);
}
}**

**[** WorksOn **(** "CUSTOMER" **)]
public** class S1Customer **:** TXCode
**{
public** XTable XCustomer **;
public override** void Initialize **()
{**
XCustomer **= this.** XModule**.** GetTable **(** "CUSTOMER" **);**
XModule**.** SetEvent **(** "ON_TRDR_NAME" **,** TRDR_NAME_Changed **);
}**

**public override** void OnFormLoad **(** string formname **)
{
base.** OnFormLoad **(** formname **);
try
{**
FormInCustomer fInCustomer **= new** FormInCustomer **();** //DLL Form
XModule**.** InsertControl **(** fInCustomer **,** "+PAGE(Pg2,TabCaption)" **);** //Adds the DLL Form after the tab "Pg2"
**}
catch (** Exception ex **)
{
throw new** Exception **(** "Could not add the DLL form. Error message:" **+** ex**.** Message **);
}
}**

**public override** void AfterLocate **()
{
base.** AfterLocate **();
}
public override object** ExecCommand **(** int Cmd **)
{
switch (** Cmd **)
{
case -** 2 **:**
MessageBox**.** Show **(** "Copy from Buffer" **,** S1DevInProcess**.** strAppName **);
break;
case** 20190219 **:**
string message **=** "" **;
if (** XModule**.** Params**.** Any **(** x **=>** x **!= null &&** x**.** StartsWith **(** "SELRECS" **)))
{**
message **=** XModule**.** Params**.** First **(** x **=>** x**.** StartsWith **(** "SELRECS" **));** //SelectedRecords parameter (String array)
**}
else
{**
message **=** "No Customers selected!" **;
}**
MessageBox**.** Show **(** message **,** S1DevInProcess**.** strAppName **,** MessageBoxButtons**.** OK **,** MessageBoxIcon**.** Information **);
break;
}
return base.** ExecCommand **(** Cmd **);
}
public override** void BeforePost **()
{
base.** BeforePost **();
if (** XCustomer**.** Current **[** "Name" **].** ToString **() ==** "Test" **)
{
throw new** Exception **(** "Test is not permitted" **);
}
}**

**private** void TRDR_NAME_Changed **(object** Sender **,** XEventArgs e **)
{**
string s **=** string**.** Format **(** "Name changed to '{0}'" **,** XCustomer**.** Current **[** "Name" **]);**
MessageBox**.** Show **(** s **,** S1DevInProcess**.** strAppName **);
}
}
}
}**


Chapter 12 – SBSL

**ExecuteReport(ObjectName, ListName, Filters, Output, Template);**

Runs the report using the specified filters or template (predefined list) and exports it to the given filename or
printer. Parameter “Template” can be omitted.

**ObjectName:** ReportObjectName or Report (for reports created using the tool “Open Designed Report”)

**Filters:** Reports Filters using the same syntax as in FORCEFILTERS

**Output:** Printer Name or Filename

**Examples**

**_1. Run the report “Customer Statement” using the photo ‘Template1’ and specific extra filters.
Export it in txt, pdf or printer._**
// vOutput = 'C:\\'+ VarTostr(sTRDR.NAME)+'.txt';
// vOutput = 'C:\'+ VarTostr(sTRDR.NAME)+'.pdf';
// vOutput = 'HP LaserJet Series';
x **=** executeReport **(** 'CUST_STM' **,** 'B2B' **,**
'QUESTIONS.FCODE=104&QUESTIONS.TCODE=104&QUESTIONS.FROMDATE=01/02/202 2 &QUESTIONS.TODA
TE=01/03/2021' **,** vOutput,'Template1' **);**

**_2. Run the custom Open Designer Report named “Custom Statement” and export it in Excel format_**
x **=** executeReport **(** 'REPORT' **,** 'Custom Statement' **,** 'vFilter1=10 1 &vFilter2=01/0 4 /202 2 ' **,**
'C:\Temp\Statement.xls' **);**

**_3 .Javascript code that prints the custom Open Designer Report named “WS_Customer Statement” and exports
it in pdf format. The code runs for the selected Customer records through right click menu in the Browser._**
**function** ON_CREATE **() {
var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '-=-' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '202106103=1;Execute Open Designed
Fast Report and save to PDF file' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);
}**

**function** EXECCOMMAND **(** cmd **) {
if (** cmd **==** 202106103 **) {**
ExecOpenDesignedFastReportSavePDF **();
}
}**

**function** ExecOpenDesignedFastReportSavePDF **() {
var** vSelRecs **;
var** vFilename **=** "" **;
var** vFilters **=** "" **;**
vSelRecs **=** X**.** GETPARAM **(** 'SELRECS' **);**
vSelRecs **=** vSelRecs**.** replace **(/\?/g,** "," **);
var** ds **=** X**.** GETSQLDATASET **(** "SELECT TRDR, CODE, NAME, EMAIL FROM TRDR WHERE " **+**
vSelRecs **, null);**
//var vCusCodes = X.SQL('SELECT STRING_AGG(CODE,';') FROM TRDR WHERE '+
vSelRecs,null); //SQL Server 2017
**if (** ds**.** RECORDCOUNT **>** 0 **) {**
ds**.** FIRST **;
while (!** ds**.** EOF **) {**
vFilename **=** "C:\\MyTemp\\" **+** ds**.** NAME **+** ".pdf" **;**
vFilters **=** 'vCustomer=' **+** ds**.** TRDR **+** '&vFilter1=' **+**
X**.** EVAL **(** "FormatDateTime('dd/mm/yyyy',X.SYS.FYDATE)" **) +** '&vFilter2=' **+**
X**.** EVAL **(** "FormatDateTime('dd/mm/yyyy',X.SYS.LOGINDATE)" **);**
X**.** EXEC **(** 'CODE:SysRequest.executeReport' **,** 'REPORT' **,** 'WS_Customer
Statement' **,** vFilters **,** vFilename **);**
ds**.** NEXT **;
}
}
}**


Chapter 12 – SBSL

**GetFieldCaption(Field);**

Returns the caption of the defined field.

**Example**
**_Custom javascript function that returns the caption of any field._**
**function** GetCaption **(** strTable **,** strField **) {** //Get Field Caption
**var** ds **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** X**.** MODULE **,** strTable **);
var** field **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** ds **,** strField **);
return** X**.** EXEC **(** 'CODE:SysRequest.GetFieldCaption' **,** field **);
}**
//Example of use
GetCaption **(** "SALDOC" **,** "TRDR" **);**

**GetFormModule(Object);**

Creates an instance of the module for the object that was previously created using the function CreateForm.

**Syntax** :

vForm = CallPublished **(** 'SysRequest.CreateForm' **,** VarArray **(** ' **S1Object[FORM:MyForm]** ' **,** 5 **,** 2 **));**
vFormModule = CallPublished **(** 'SysRequest.GetFormModule' **,** vForm **);**

**GetNewID(Module);**

Returns the id of the record that has already been posted to “Module”.

**Example**
**_Get the ids of the created sales document records._**
Form **{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0
**[** ImpTable **]**
vSeries **=** 2 **;** 15 **;** 1 **;** 1 **;** 0 **;** Sales Series **;** SERIES **(** W **[** SOSOURCE **=** 1351 **]);;;**
vWhere **=** 16 **;** 80000 **;** 0 **;** 1 **;** 0 **;** Browser Selecton **;;;&** SELRECS **;&** SELRECS
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Messages **...;;;;
[** PANELS **]**
PANEL10 **=** 0 **;** Options **;** 0 **;** 100 **,** G10 **,** N
PANEL11 **=** 4 **;** Job Messages **;** 0 **;** 100 **,** G10 **,** N **,** L3
**[** PANEL10 **]**
ImpTable**.** vSeries
**[** PANEL11 **]**
ImpTable**.** vMess
**}**

include 'PILib' **;**
include 'ModuleIntf' **;**
include 'SysRequest' **;
var** x **,** vMess **,** vTot **,** vCurRow **,** vErroRow **,** vDsHead **,** vModule **,** vDsLines **,** vNewID **;**

Connect Xplorer SoftOne **{**
connect **();**

sHeader **=** SELECT DISTINCT FINDOC**.** FINDOC
**,** FINDOC**.** TRNDATE
**,** FINDOC**.** FINCODE
FROM FINDOC
WHERE **(** $REMOVEQUOTES **(:** $ImpTable**.** vWhere **))**
AND FINDOC**.** SOSOURCE **=** 1351
AND FINDOC**.** COMPANY **=:** $X**.** SYS**.** COMPANY
AND FINDOC**.** ISCANCEL **=** 0 **;**

sLines **=** SELECT DISTINCT FINDOC**.** FINDOC
**,** MTRLINES**.** MTRLINES
**,** MTRLINES**.** MTRL


Chapter 12 – SBSL
**,** MTRLINES**.** QTY1
**,(** MTRLINES**.** QTY1 **-** MTRLINES**.** QTY1COV **-** MTRLINES**.** QTY1CANC **)** AS NEWQTY
**,** MTRLINES**.** PRICE
**,** MTRLINES**.** DISC1PRC
**,** MTRLINES**.** LINEVAL
FROM FINDOC
INNER JOIN MTRLINES ON FINDOC**.** FINDOC **=** MTRLINES**.** FINDOC
WHERE **(** $REMOVEQUOTES **(:** $ImpTable**.** vWhere **))**
AND FINDOC**.** SOSOURCE **=** 1351
AND FINDOC**.** COMPANY **=:** $X**.** SYS**.** COMPANY
AND FINDOC**.** ISCANCEL **=** 0
AND FINDOC**.** FULLYTRANSF IN **(** 0 **,** 2 **)**
AND FINDOC**.** FINDOC **=:** $sHeader**.** FINDOC **;
}**

**{**
fetch sHeader **{**
vModule **=** CreateModule **(** 'SALDOC,WARNINGS:OFF,NOMESSAGES:1' **);**
x **=** InsertModule **(** vModule **);**
vDsHead **=** GetDataSet **(** vModule **,** 'FINDOC' **);**
x **=** DataSetEdit **(** vDsHead **);**
x **=** SetFieldValue **(** vDsHead **,** 'SERIES' **,:** ImpTable**.** vSeries **);**
x **=** SetFieldValue **(** vDsHead **,** 'TRNDATE' **,:** X**.** SYS**.** LOGINDATE **);**
x **=** SetFieldValue **(** vDsHead **,** 'TRDR' **,** sHeader**.** TRDR **);**
x **=** DataSetPost **(** vDsHead **);**

vDsLines **=** GetDataSet **(** vModule **,** 'ITELINES' **);**
x **=** DataSetEdit **(** vDsLines **);**
fetch sLines **{**
x **=** DataSetAppend **(** vDsLines **);**
x **=** SetFieldValue **(** vDsLines **,** 'MTRL' **,** sLines**.** MTRL **);**
x **=** SetFieldValue **(** vDsLines **,** 'QTY1' **,** sLines**.** NEWQTY **);**
x **=** SetFieldValue **(** vDsLines **,** 'PRICE' **,** sLines**.** PRICE **);**
x **=** SetFieldValue **(** vDsLines **,** 'DISC1PRC' **,** sLines**.** DISC1PRC **);**
x **=** SetFieldValue **(** vDsLines **,** 'FINDOCS' **,** sLines**.** FINDOC **);**
x **=** SetFieldValue **(** vDsLines **,** 'MTRLINESS' **,** sLines**.** MTRLINES **);**
x **=** DataSetPost **(** vDsLines **);
}**

x **=** PostModule **(** vModule **);
vNewID = GetNewID(vModule);**
x **=** DestroyModule **(** vModule **);
}
}**

**GetTableFieldInfos(TableName);**

Returns text containing information for each field in the table.

**GetTableFieldNames(TableName);**

Returns the field names of table “TableName”.

**GetTableMoreInfo(TableName);**

Returns text with the table information.

**GetXplorerDataDir(Params);**

Returns the installation directory of SoftOne application.

**GetXplorerLogDir(Params);**

Returns the directory of log files.


Chapter 12 – SBSL

**GetXplorerOffLineDir(Params);**

Returns the directory of offline files.

**GetXplorerTempDir(Params);**

Returns the directory of temp files.

**PrintForm(Module, Form, Printer, FileName);**

Prints the form defined by the 'Form' code for the given Module and Printer. In case of printing to a file, then
FileName must be defined.

**Example**
**_Locate the record id=1000 in purchase documents and print it to ASCII file using the form with code=100._**
iFINDOC **=** 1000 **;**
vFile **=** 'C:\\Softone\\‘ + VarToStr(:X.SYS.COMPANY) + '_' + iFINDOC + '**.** TXT'; //
ASCII File Name and Path
vPURModule **=** CallPublished **(** 'ModuleIntf.CreateModule' **,** 'PURDOC,WARNINGS:OFF' **);**
x **=** CallPublished **(** 'ModuleIntf.LocateModule' **,** VarArray **(** vPURModule **,** iFINDOC **,** 2 **));** //Locate
record
x **=** CallPublished **(** 'SysRequest.PrintForm' **,** VarArray **(** vPURModule **,** 100 **,** '928' **,** vFile **,** 4 **));**
//Save to ASCII file

**RefreshPopupMenu**

Refreshes the items of the Context Menu. Combined with PiLib.TStringsSetItem or PiLib.TStringsAdd.

**Example**
**_Form Javascript - Add menu item in Browser Context Menu of any object._**
**function** ON_CREATE **() {
var** vBrowserMenu **=** X**.** EXEC **(** 'CODE:ModuleIntf.FindXStrings' **,** X**.** MODULE **,** 'BRMENU' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201705291=One Record Job');
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201705292=1;Many Records Job' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201705292=1;SubJob1?MySubMenu' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201705292=1;SubJob2?MySubMenu' **);**
X**.** EXEC **(** 'CODE:PiLib.TStringsAdd' **,** vBrowserMenu **,** '201910023=3;Displayed on Lines
Analysis Browser' **);**
X**.** EXEC **(** 'CODE:SysRequest.RefreshPopupMenu' **,** X**.** MODULE **,** 'BRMENU' **,** 1 **);
}**

**RequestEdit(Command: string);**

Executes the command. It works only on client scripts.

**Example**
**_Execute the custom design report named “Myreport” filtered for TRDR = 1000.
Dialog filter field linked to TRDR is “USRREPORTV1L”._**
**var** vTRDR **,** sObj **,** x **;**
vTRDR **=** 1000 **;**
sObj **=** 'REPORT[LIST=MyCustomReport,FORCEFILTERS=USRREPORTV1L=' **+** VarToStr **(** vTRDR **)+** ',AUTOEXEC=1]' **;**
x **=** CallPublished **(** 'SysRequest.RequestEdit' **,** sObj **);**


Chapter 12 – SBSL

**ShowHtmlMessageForm(TStringsHandle);**

Opens a Web form with the text set defined in the “TStringsHandle” string list. Similar to the results screen of SBSL
scripts.

**Example**
fText **=** 'mytext' **;**
fStrings **=** TStringsCreate **;**
x **=** TStringsSetText **(** fStrings **,** fText **);**
x **=** ShowHtmlMessageForm **(** fStrings **);**

**ShowInTheMap(Params1, Params2, Params3);**

Returns in a web form the location defined by the coordinates.

**Params1** : Latitude, **Params2** : Longitude, **Params3** : Web Form to open.

**Example**
vDs **=** CallPublished **(** 'ModuleIntf.GetDataSet' **,** VarArray **(** XModule **,** 'GPNT' **,** 2 **));**
vFld1 **=** CallPublished **(** 'ModuleIntf.GetFieldValue' **,** VarArray **(** vDs **,** 'SOWIDTH' **,** 2 **));**
vFld2 **=** CallPublished **(** 'ModuleIntf.GetFieldValue' **,** VarArray **(** vDs **,** 'SOLENGTH' **,** 2 **));**
vFld3 **=** CallPublished **(** 'ModuleIntf.GetFieldValue' **,** VarArray **(** vDs **,** 'CODE' **,** 2 **));**
Data **=** CallPublished **(** 'SysRequest.ShowInTheMap' **,** VarArray **(** vFld1 **,** vFld2 **,** vFld3 **,** 3 **));**

**ShowWebPage(URL: string);**

Opens the HTML page defined by the URL string.

**Example**
x **=** ShowWebPage **(** 'www.softone.gr' **);**

**XSendWebSMS(PhoneNumber: string, message: string);**

Sends SMS to the defined Phone Number. Uses the WEB SMS Account defined in SoftOne Settings (Xplorer.cfg)

**Example**
x **=** CallPublished **(** 'SysRequest.XSendWebSMS' **,** VarArray **(** '123456789' **,** 'mymessage' **,** 2 **));**


Chapter 12 – SBSL

### H. Case Studies

#### 1. ReUpdate Sales Documents

Reupdate sales documents (based on a specific query) by changing the value of the field PAYMENT.

**form {
}**

connect Xplorer xData **{**
connect **();**
findoc **=select** findoc **,** sosource **,** fincode **,** trndate **,** sumamnt
**from** findoc
where company **=:** $X**.** SYS**.** COMPANY
and fiscprd **=:** $X**.** SYS**.** FISCPRD
and sosource **=** 1351
and fprms **in
(** 7061 **,** 7062 **,** 7063 **,** 7064 **,** 7066 **,** 7067 **,** 7071 **,** 7072 **,** 7073 **,** 7076 **,** 7082 **,** 7127 **,** 7128 **)
--** and trndate > **=** '20 18 0110'
order by 1 desc **;
}**

**var**
x **,** Module **,** DsFinDoc **,** Dslines **,** vFieldVal **,** vFieldVal1 **,** Count **;
{**
Module **=**
CallPublished **(** 'ModuleIntf.CreateModule' **,** 'SALDOC,WARNINGS:OFF,NOMESSAGES:1' **);**
DsFinDoc **=** CallPublished **(** 'ModuleIntf.GetDataset' **,** VarArray **(** Module **,** 'FINDOC' **,** 2 **));**
Count **=** 0 **;**
fetch finDoc **{**
Count **=** Count **+** 1 **;
}**
x **=** SendResponse **(** Count **,** 'RESULTS.TOTREC' **);**

Count **=** 0 **;**
fetch findoc **{**
x **=** CallPublished **(** 'ModuleIntf.LocateModule' **,** VarArray **(** Module **,** findoc**.** findoc **,** 2 **));**
Count **=** Count **+** 1 **;**
x **=** SendResponse **(** Count **,** 'RESULTS.CURREC' **);**
x **=** CallPublished **(** 'ModuleIntf.DatasetEdit' **,** DsFinDoc **);**

x **=** CallPublished **(** 'ModuleIntf.SetFieldValue' **,** VarArray **(** DsFinDoc **,** 'PAYMENT' **,** 1000 **,**
3 **));**

x **=** CallPublished **(** 'ModuleIntf.PostModule' **,** Module **);
}**
x **=** SendResponse **(** Count **,** 'RESULTS.CURREC' **);
}**


Chapter 12 – SBSL

#### 2. Import Customers from Excel..........................................................................................................................................................

Import customers from Excel file into a temp table of the database and then insert the records in the
customers module. The script retrieves data from an excel file that uses columns with specific headers

(Line, Name, VAT, City, Address, Branch code).

Form **{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Transfer messages **...;;;;**
vExcelFile **=** 1 **;** 4000 **;** 1 **;** 1 **;** 0 **;** Excel file **;** $Filename **;;** 'C:\test1.xlsx' **;**
vDBTable **=** 1 **;** 64 **;** 1 **;** 0 **;** 0 **;** TableName **;;;;** CCCEXCEL_CUST
vDrop **=** 2 **;** 15 **;** 1 **;** 0 **;** 0 **;** Drop and Create Table **;** $Y **;;** 1 **;**
vInsRec **=** 2 **;** 15 **;** 1 **;** 0 **;** 0 **;** Insert Records **;** $Y **;;** 1 **;**

**[** PANELS **]**
PANEL10 **=** 0 **;;** 0 **;** 50 **,** G10 **,** N
PANEL13 **=** 4 **;** Transfer messages **...;** 0 **;** 100 **,** G10 **,** N **,** L3

**[** PANEL10 **]**
ImpTable**.** vExcelFile
ImpTable**.** vDBTable
ImpTable**.** vDrop
ImpTable**.** vInsRec

**[** PANEL13 **]**
ImpTable**.** vMess
**}**

Import ImpCUSTOMER **(** sCus **,** sCusBranch **)** into 'CUSTOMER,WARNINGS:OFF,NOMESSAGES:1'
**{**
CUSTOMER sCus **{**
CODE **=** '*' **;**
NAME **=** sCus**.** cNAME **;**
AFM **=** sCus**.** cAFM **;**
CITY **=** sCus**.** cCITY **;**
ADDRESS **=** sCus**.** cADDRESS **;
}**

CUSBRANCH sCusBranch **{**
CODE **=** sCusBranch**.** bCODE **+** '.01' **;**
NAME **=** sCusBranch**.** bNAME **;**
ISCENTER **=** sCusBranch**.** bISCENTER **;**
ADDRESS **=** sCusBranch**.** bADDRESS **;**
CITY **=** sCusBranch**.** bCITY **;
}
}**

Connect Xplorer SoftOne **{**
connect **();**

sCus **=** SELECT
**[** Line **]** AS Line
**,[** Name **]** AS cNAME
**,[** VAT **]** AS cAFM
**,[** City **]** AS cCITY
**,[** Address **]** AS cADDRESS
FROM $REMOVEQUOTES **(:** $ImpTable**.** vDBTable **);**

sCusBranch **=** SELECT


Chapter 12 – SBSL
**[** BranchCode **]** AS bCODE
**,[** Name **]** AS bNAME
**,** 1 AS bISCENTER
**,[** Address **]** AS bADDRESS
**,[** City **]** AS bCITY
FROM $REMOVEQUOTES **(:** $ImpTable**.** vDBTable **)**
WHERE **[** Line **] = :** $sCus**.** Line **;
}
var**
Jstr **,** objExcel **,** vscript **,** x **,** vTot **,** vRow **,** vRowCancel **,** vMess **,** Ds **,** vError **,** str1 **,**
vModule **,** ifin **,** vTask **,** vSalesman **,** newCusCode **,** vMessErrors **,** vMessTask **,** vCurRec **;
{**
vError **=** 0 **;**
vMess **=** '' **;
if (** vError **=** 0 **)
{**
vMess **=** '============== J O B S T A R T ==============' **+** # 13 **+** # 10 **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vTot **,** vRow **,** vRowCancel **,** 'Start job...' **,** vMess **,**
'RESULTS.TOTREC;RESULTS.CURREC;RESULTS.CANREC;RESULTS.LABELTEXT;ImpTable.vMess' **);**
//>>>======= Transfer Excel to SQL Table - Table initialization =======
**if(:** ImpTable**.** vDrop **=** 1 **)
{**
x **=** SafeExecSQL **(** 'SoftOne' **,** 'DROP TABLE ' **+ :** ImpTable**.** vDBTable **,** Null **);**
x **=** CallPublished **(** 'SysRequest.Evaluate' **,** VarArray **(** ImportModule **(** 'ImpCUSTOMER' **),**
'ExcelImport(' **+** # 39 **+:** ImpTable**.** vExcelFile **+** # 39 **+** ',' **+** # 39 **+:** ImpTable**.** vDBTable **+** # 39 **+** ',1,2)' **,**
2 **));
}**
//<<<======= Transfer Excel to SQL Table - Table Initialization =======

//>>>============ Insert CUSTOMER (Customers) ================
vCurRec **=** 0 **;**
vTot **=** 0 **;**
vRowCancel **=** 0 **;**
fetch sCus vTot **=** vTot **+** 1 **;**
x **=** SendResponse **(** vTot **,** 0 **,** 0 **,** 'RESULTS.TOTREC;RESULTS.CURREC;RESULTS.CANREC' **);**
vMess **=** vMess **+** 'A. CUSTOMERS IMPORT... ' **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vMess **,** 'Customer Import...' **,** 'ImpTable.vMess;RESULTS.LABELTEXT'
**);**
fetch sCus **{
if(:** ImpTable**.** vInsRec **=** 1 **)
{**
ImpCUSTOMER **(** sCus **,** sCusBranch **);**
vCurRec **=** vCurRec **+** 1 **;
if (** ImportError **=** 0 **)
{**
newCusCode **=** GETQUERYRESULTS **(** 'SoftOne' **,** 'SELECT CODE FROM TRDR WHERE
TRDR=' **+** VarToStr **(** resultnum **),** NULL **);**
vMess **=** vMess **+** ' ' **+** VartoStr **(** vCurRec **) +** '. Name:
' **+** VartoStr **(** sCus**.** cName **)
+** ' ...OK - New Code:
' **+** VartoStr **(** newCusCode **)+** # 13 **+** # 10 **;**
x **=** SafeExecSQL **(** 'SoftOne' **,** 'UPDATE ' **+ :** ImpTable**.** vDBTable **+** '
SET [Customer code]=' **+** VartoStr **(** newCusCode **)+** ' ,[Branch code]=' **+** QUOTEDSTR **(** '01' **)+** ' WHERE
LINE=' **+** VartoStr **(** vCurRec **),** Null **);
}
else
{**
vRowCancel **=** vRowCancel **+** 1 **;**
vMess **=** vMess **+** ' ' **+** VartoStr **(** vCurRec **) +** '. Name: '
**+** VartoStr **(** sCus**.** cName **)+** ' ...ERROR - ' **+**
ErrorMessage **+** # 13 **+** # 10 **;**
x **=** SafeExecSQL **(** 'SoftOne' **,** 'UPDATE ' **+ :** ImpTable**.** vDBTable **+** '
SET [Customer code]=' **+** QUOTEDSTR **(** 'error' **)+** ',[Branch code]=' **+** QUOTEDSTR **(** 'error' **)+** ' WHERE
LINE=' **+** VartoStr **(** vCurRec **),** Null **);**


Chapter 12 – SBSL
**}**
vSalesman **=** sCus**.** cSalesman **;**
x **=** SendResponse **(** vTot **,** vCurRec **,** vRowCancel **,** vMess **,**
'RESULTS.TOTREC;RESULTS.CURREC;RESULTS.CANREC;ImpTable.vMess' **);
}
}**
vMess **=** vMess **+** '- CUSTOMER IMPORT COMPLETION' **+** # 13 **+** # 10 **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vTot **,** vCurRec **,** vRowCancel **,** vMess **,**
'RESULTS.TOTREC;RESULTS.CURREC;RESULTS.CANREC;ImpTable.vMess' **);**
//<<<============ Import CUSTOMER (Customers) ================

vMess **=** vMess **+** # 13 **+** # 10 **+** '============== J O B E N D ================' **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vCurRec **,** vRowCancel **,** vMess **,** 'End of job...' **,**
'RESULTS.CURREC;RESULTS.CANREC;ImpTable.vMess;RESULTS.LABELTEXT' **);
}
}**


Chapter 12 – SBSL

#### 3. Add Customer Collections (UI)

Batch job that inserts customer collections for specific documents (based on SQL query). The collections
documents are displayed in users screen and wait for the user to save them (command “,T”).

Form **{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Transfer messages **...;;;;**

**[** PANELS **]**
PANEL13 **=** 4 **;** Transfer messages **...;** 0 **;** 100 **,** G10 **,** N **,** L3

**[** PANEL13 **]**
ImpTable**.** vMess
**}**
Import ImpCFNCUSDOC **(** sDoc **)** into 'CFNCUSDOC,WARNINGS:OFF,NOMESSAGES:1,T' **{** // ,T
displays record in screen
FinDoc sDoc **{**
SERIES **=** 3800 **;**
TRNDATE **=** sDoc**.** TRNDATE **;**
TRDR **=** sDoc**.** TRDR **;**
FINDOCS **=** sDoc**.** FINDOC **;**
COMMENTS **=** 'Import from Import Script' **;
}**
CashLines sDoc **{**
SOPAYTYPE **=** 1 **;**
LINEVAL **=** sDoc**.** sumamnt **;
}
}**
connect Xplorer xData **{**
connect **();**
sDoc **= select** findoc **,** trdr **,** sosource **,** fincode **,** trndate **,** sumamnt
**from** findoc
where company **=:** $X**.** SYS**.** COMPANY
and fiscprd **=:** $X**.** SYS**.** FISCPRD
and sosource **=** 1351
and fprms **in
(** 7061 **,** 7062 **,** 7063 **,** 7064 **,** 7066 **,** 7067 **,** 7071 **,** 7072 **,** 7073 **,** 7076 **,** 7082 **,** 7127 **,** 7128 **)**
and trndate **=** '20030110'
order by 1 desc **;
}
var**
x **,** Module **,** DsFinDoc **,** Dslines **,** vFieldVal **,** vFieldVal1 **,** Count **,** vMess **,** vRow **,**
vRowCancel **,** vTot **;
{**
vTot **=** 0 **;**
fetch sDoc vTot **=** vTot **+** 1 **;**
vMess **=** 'Start job.....' **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vTot **,** 0 **,** 0 **,** 'Import collection documents...' **,** vMess **,**
'RESULTS.TOTREC;RESULTS.CURREC;RESULTS.CANREC;RESULTS.LABELTEXT;ImpTable.vMess' **);**
fetch sDoc **{**
ImpCFNCUSDOC **(** sDoc **);
if (** ImportError **=** 0 **)** vRow **=** vRow **+** 1 **;
else** vRowCancel **=** vRowCancel **+** 1 **;**
x **=** SendResponse **(** vRow **,** vRowCancel **,** 'RESULTS.CURREC;RESULTS.CANREC' **);
}**
vMess **=** vMess **+** 'End of transfer...' **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vRow **,** vRowCancel **,** vMess **,** 'End of import of collection
documents...' **,** 'RESULTS.CURREC;RESULTS.CANREC;ImpTable.vMess;RESULTS.LABELTEXT' **);
}**


Chapter 12 – SBSL

#### 4. Get String List Data

Batch job that displays the keys and values of the given string list. Enter a SoftOne string list in filters and
run it to get its values. Use it for any SoftOne string list (SODTYPE, SOSOURCE, TAXDEVTYPE, etc.)

```
Figure CS4.1 – SOSOURCE string list
```
```
Figure CS4.2 – ORIGIN string list
```

Chapter 12 – SBSL

Form
**{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vStringList **=** 1 **;** 25 **;** 0 **;** 1 **;** 0 **;** Enter StringList Name **;**
vImpMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Messages **...;;;;;** 2

**[** PANELS **]**
PANEL11 **=** 0 **;** Filters **;** 0 **;** 40 **,** G11
PANEL12 **=** 4 **;** Messages **...;** 0 **;** 100 **,** H50

**[** PANEL11 **]**
ImpTable**.** vStringList

**[** PANEL12 **]**
ImpTable**.** vImpMess

**}**
include 'PILib' **;**

Var
vMess **,** x **,** tStringList **,** tStringListCount **,** i **,** ListItem **;**

Connect Xplorer SoftOne
**{**
connect **();
}**

**{**
vMess **=** '' **;**
tStringList **=** GetXStrings **(** VarToStr **(:** ImpTable**.** vStringList **));** //Handler

**if (** tStringList **<>** 0 **)
{**
tStringListCount **=** TStringsCount **(** tStringList **);** //Get ListCount
i **=** 0 **;
while(** i **<= (** tStringListCount **-** 1 **))
{**
ListItem **=** TStringsGetItem **(** tStringList **,** i **);** //Get Current Item
(e.g 1=Item1)
**if (** Copy **(** ListItem **,** Pos **(** '=' **,** ListItem **)+** 1 **,** Len **(** ListItem **)) <>** '' **)**
//Check if Item Value is not null
**{**
vMess **=** vMess **+** ListItem **+** # 13 **+** # 10 **;**
x **=** SendResponse **(** vMess **,** 'ImpTable.vImpMess' **);
}**
i **=** i **+** 1 **;
}
}
else
{**
vMess **=** '' **;**
x **=** SendResponse **(** vMess **,** 'ImpTable.vImpMess' **);**
x **=** RAISEEXCEPTION **(** 'String List does not exist !!!!! ' **);
}
}**


Chapter 12 – SBSL

#### 5. Read ASCII file using specific Codepage

Batch job that reads an ASCII file, iterates through file lines and displays the data in a memo text box.

```
Figure CS5.1 – Job Results
```
```
Figure CS5.2 – Ascii File
```

Chapter 12 – SBSL

**form
{
[** TABLES **]**
ImpTable **=;;;;** Master **;** 3 **;** 0

**[** ImpTable **]**
vTxtFile **=** 1 **;** 255 **;** 1 **;** 1 **;** 0 **;** ASCII File **;** $Filename **;;;**
vImpMess **=** 16 **;** 64000 **;** 0 **;** 1 **;** 1 **;** Messages **...;;;;;** 2

**[** PANELS **]**
PANEL11 **=** 0 **;;** 0 **;** 050 **,** 000 **,** 000 **,** 000 **,** N **,** G10
PANEL14 **=** 4 **;** Messages **...;** 0 **;** 100 **,** G10 **,** N **,** L20

**[** PANEL11 **]**
ImpTable**.** vTxtFile

**[** PANEL14 **]**
ImpTable**.** vImpMess
**}**

include 'PiLib' **;**

Connect Xplorer Softone **{**
connect **();**

**}**

**var** x **,** vRow **,** vRowCancel **,** UserResp **,** vMess **,** TxtRead **,** vLine **;
{**
TxtRead=OpenTextCodePage(:ImpTable.vTxtFile,65001); //UTF- 8
//TxtRead = OpenText(:ImpTable.vTxtFile);
vLine **=** '' **;**
vMess **=** '' **;**
UserResp **=** SendResponse **(** vMess **,** 'ImpTable.vImpMess' **);
while (** Eof **(** TxtRead **) =** 0 **)
{**
vLine **=** ReadLine **(** TxtRead **);
if (** Len **(** vLine **) >** 0 **)
{**
vMess **=** vMess **+** vLine **+** Char **(** 13 **);**
UserResp **=** SendResponse **(** vMess **,** 'ImpTable.vImpMess' **);
}
}
}**


## 12. Web Services

#### A. Overview

#### B. Open Enterprise Engine

#### C. Methods / API Calls

#### D. Case Studies


Chapter 12 – Web Services

### A. Overview

SoftOne API provides Web Services that give you the ability to connect and manage data through your website or
external application. Almost all the data and functionality of SoftOne is accessible through web services so the
integration possibilities are endless.

Web services are available through Cloud or On Premise SoftOne installations using the SoftOne Open Enterprise
Engine. This service can be activated through one click and makes data available using Secure TCP/IP connections.

The web services use **HTTP requests** to URLs given by SoftOne and the data are returned in **JSON format**. The
generic format for the API endpoint is:

**https://** <RegisteredName or Soft1SerialNumber> **.oncloud.gr/s1services?**

where <RegisteredName> should be replaced with the name you used to register the SoftOne Open Enterprise
Service. Suppose the registered name is _mycompany_ then the API endpoint would be:

**https://mycompany.oncloud.gr/s1services?**

A simple webservice call example (HTTP-GET request) is: https://demo.oncloud.gr/s1services?ping

**Please make note of the following:**

- The majority of the calls use **HTTP-POST methods**.
- All HTTP-Post methods are accessed via: https://RegisteredName.oncloud.gr/s1services
- All methods (after Login) require a unique client identifier ( **clientID)** which is obtained through the
    **Authenticate** method.
- Compression (Content encoding) used is **gzip**.

Tests on SoftOne web services can be done using the data of the demo database, which is accessed through the url:
https://webdemo.oncloud.gr/s1services

```
DictionaryApplication
```
```
Engine
Core
```
```
demand(Loaded on
)
```
```
demand(Loaded on
)
```
```
APPLICATION SERVER /
FEEDER
```
```
ModulesCustom ModulesCommon ModulesServer
```
```
Customization
```
```
Database
```
```
Web
Handler
(REST,
JSON)
```
```
IIS WEB
SERVER
```
```
Web Services
```
```
Static
Content
```
```
Web
Applications
```
```
Web Services &
UI Engine
```
```
DriversNative TCP/IP
```

Chapter 12 – Web Services

### B. Open Enterprise Engine

SoftOne Open Enterprise Engine is a SoftOne module. This module enables a one-click setup service, that connects
on-premises application server with the cloud infrastructure.

#### B.1 Prerequisites & Setup

Web services are enabled only if you have activated the "Soft1 Open Enterprise Engine" License Module (Figure B1).
Note that you can have one site registration per serial number.

```
Figure B1
```
On-Premises installations require the local execution of the S1 Agent Service. This Service should run on a
workstation that is always online to transfer data from the local SoftOne database to the Internet (using SoftOne
web services). It is advisable to activate S1 Agent on the same workstation where SoftOne application server sits.

Cloud installations on the other hand do not require any further setup for enabling the web services, but only the
activation of the "Soft1 Open Enterprise Engine" License Module.

The service, in both on-premises or cloud installations, is started using the “cloud” button that sits on the main
toolbar of SoftOne (Figure B 2 ). This button is displayed only to users defined as Administrators by the application.

```
Figure B 2
```

Chapter 12 – Web Services

Before activating the S1 Agent Service make sure that the Windows user has administration rights.

Click on “ **Configure S1 Agent** ”, enter a domain name and register the site.

**Note** : The domain name should not be prefixed with numbers and should not contain any capital letters.

The fields below the site name (e-mail address, UserName and password) are used to automatically create a new
web account and menu, that are explained in the next section.

Finally, click on " **Activate** " button to complete the process of activating the S1 Agent Service.

Upon activating the Agent Service, a new connection file “ **WEB.XCO** ” is created inside the SoftOne folder and an e-
mail is also send to the address entered, that informs the user that the service is activated. WEB.XCO file keeps all
the info needed to connect the local SoftOne database to the internet thus enables the web services for this specific
database.

In order to change the pc that serves your domain name you need first to **deactivate** the service from the initial
workstation and then activate it in the new workstation.

Note that S1 Agent Service uses **SoftOne Licence Manager** , which means that it is preferable to use LM as a
service, for logging off without losing the connection.

#### B.2 Custom Web & Mobile Apps........................................................................................................................................................

Custom Web and mobile applications must be defined inside the _Web Services_ entity. Open _Web Services_ module,
create a new record and enter the web service id, code and description (Figure B4).

**Note: Web Service IDs should be greater than 1000** , since SoftOne uses the numbers below 1000 for internal web
and mobile applications.

The id will be later used in all your web service calls ( **appID** ).

```
Figure B4
```

Chapter 12 – Web Services

#### B.3 Web Accounts

Web accounts define the web users who will have access to your web and mobile applications. They are linked to a
SoftOne database and transfer data to it. The procedure of creating a web account may be performed either
automatically or manually.

**_Automated Process_**

Web accounts are auto created using the “ **_Configure S1 Agent_** ” option (as seen in the previous section). This brings
up a window that requires fields: E-mail, Username and Password in order to Activate the service (Figure B 5 ).

After completing this process, notice that the following tasks have been performed automatically:

- A new Web Account is created that uses the above credentials.
- Webservices: Web360, Soft1B2b, QuickView and MyPortal are auto-inserted for this account.
- Classic menus are created that can be used in Web accounts (or related jobs of objects).

```
Figure B 5
```

Chapter 12 – Web Services

**_Manual Process_**

Web & Mobile services configuration is performed through the Menu: Tool –Parameters – Web & Mobile.

Open the **_Web accounts_** entity to define the Web users that will use your applications (web services) (Figure B 6 ).

```
Figure B 6
```
Upon creating a new web account entry, enter the code, the password and the email. Inside the tab “ _Relations_ ”
define the services that the web user will have access, using the button " _New_ " (Figure B 7 ). This button brings up the
form “Relates to...”, where you can state the web service application, the login user, the company and the branch.
Double click a line to modify the data of the related service.

**Note** : **Web accounts must not exceed the number of installation user licenses, because an error will occur
when you try to make a request to a SoftOne webservice.**

```
Figure B 7
```

Chapter 12 – Web Services

### C. Methods / API Calls

All the following methods use a custom **appID** ( **3001** ) that needs to be created in SoftOne Web Accounts.

#### Ping (Get Method)

Pings the SoftOne API. It is the simplest method that you can use to see that the API is functioning.

**Request URL**

https://RegisteredName.oncloud.gr/s1services?ping

**Response Sample**
Ping from Softone WebModule
ISAPI is working **-** Module configured
Running in TCP mode **[** 127.0.0.1 **:** 22099 Connected **]**
Cached **:** 39 Forwarded **:** 28647 Responses **(** 0 **%)**
Cache **:** X **:** \ProgramData\SoftOne\webdata\

#### Refresh(Get Method)

Restarts and refreshes the SoftOne API for the specific URL and returns OK when job is completed.
Usually used when web application parameters are changed in SoftOne and user needs to see the changes
immediately (e.g. change of the user web menu in SoftOne S360 application).

**Request URL**

https://RegisteredName.oncloud.gr/s1services?refresh

**Response**
OK


Chapter 12 – Web Services

#### Login(Post Method)

It is used to Login the web account defined by _RegisteredName_ in request URL. It returns a temporary access token
(clientID) that can be later used in the “ _authenticate_ ” method. It also returns the available set of login permissions
for the User (Company, Branch, etc.).

**Request URL**

https://RegisteredName.oncloud.gr/s1services

**Request Sample
{**
"service" **:** "login" **,**
"username" **:** "MyUser" **,**
"password" **:** "123456" **,**
"appId" **:** "3001"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed. Current method is login.
username string Username (Code) defined in SoftOne Web Accounts
password string Password defined in SoftOne Web Accounts
appId string ID of the Service defined in SoftOne Web Accounts
```
**Response Sample
{**
"success" **: true,**
"clientID" **:** "9J8pJ6La...Ga5mHG" **,**
"objs" **: [ {**
"COMPANY" **:** "1000" **,**
"COMPANYNAME" **:** "Standard Company" **,**
"BRANCH" **:** "1000" **,**
"BRANCHNAME" **:** "Head Offices" **,**
"MODULE" **:** "0" **,**
"MODULENAME" **:** "<Blank>" **,**
"REFID" **:** "500" **,**
"REFIDNAME" **:** "demo" **,**
"USERID" **:** "500" **,**
"FINALDATE" **:** "1899- 12 - 30 00:00:00" **,**
"ROLES" **:** ""
**}],**
"ver" **:** "4.00.514.10630" **,**
"sn" **:** "01234567890123"
**}**

**Response Properties**

```
Property Description
clientID
(string)
```
```
Temporary access token issued by SoftOne that verifies the Service is active and can be later used is
Authentication method
```
```
objs (array)
```
```
Array containing the following keys
COMPANY integer SoftOne Company ID
COMPANYNAME string SoftOne Company Description
BRANCH string SoftOne Branch ID
BRANCHNAME string SoftOne Branch Description
MODULE integer SoftOne Entity (12=Suppliers, 13=Customers, etc.)
```

Chapter 12 – Web Services

```
MODULENAME string SoftOne Entity Description
REFID integer Rereference ID
REFIDNAME string Reference Name
USERID integer SoftOne User ID
FINALDATE datetime User Expiration Date
```
```
ROLES^ string^ User Roles^
ver (string) SoftOne Client version
sn (string) Serial Number of the SoftOne Account.
```
**Error Response Samples**

**_1. Error Code -1: Invalid Credentials._**
**{**
"success" **: false,**
"errorcode" **: -** 1 **,**
"error" **:** "Login fails due to invalid login credentials."
**}**
**_2. Error Code -3: Invalid appID, or Module not activated._**
**{**
"success" **: false,**
"errorcode" **: -** 3 **,**
"error" **:** "Access denied. Selected module not activated."
**}**


Chapter 12 – Web Services

#### Authenticate(Post Method)

Authenticates and gives access to the Web Application using the temporary access token (clientID) obtained
through the login method. Returns the access token that is used in all the subsequent methods.

**Request Sample
{**
"service" **:** "authenticate" **,**
"clientID" **:** "9J8p9J...2KqC0" **,**
"company" **:** "1000" **,**
"branch" **:** "1000" **,**
"module" **:** "0" **,**
"refid" **:** "1"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (Authenticate).
clientID string Temporary access token obtained through the Login method
company integer Company obtained through the Login method
branch integer Branch obtained through the Login method
module integer Module obtained through the Login method
refid integer RefID obtained through the Login method
```
**Response Sample
{**
"success" **: true,**
"clientID" **:** " 9J8pH7...HL5L9GG " **,**
"s1u" **:** 1 **,**
"hyperlinks" **:** 1 **,**
"canexport" **:** 1
**}**

**Response Properties**

```
Property Type Description
success string Validates user data and returns True or False
clientID string Access token issued by SoftOne that is used in all API requests later on
s1u integer SoftOne Internal Use Only
hyperlinks integer SoftOne Internal Use Only
Canexport integer SoftOne Internal Use Only
```
**Error Response Samples**
**_1. Error Code -1: Invalid ClientID._**
**{**
"success" **: false,**
"errorcode" **: -** 1 **,**
"error" **:** "Invalid request. Please login first"
**}**

**_2. Error Code -2: Invalid Credentials, Company, Branch, Module or RefID._**
**{**
"success" **: false,**
"errorcode" **: -** 2 **,**
"error" **:** "Authenticate fails due to invalid credentials."
**}**


Chapter 12 – Web Services

#### ChangePassword (Post Method)

Changes the password of the login User.

**Request Sample
{**
"service" **:** "changepassword" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"old" **:** "oldpassword" **,**
"new" **:** "newpassword"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (ChangePassword)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
old string Old Password
new string New Password
```
**Response Sample**

**{**
"success" **: true
}**


Chapter 12 – Web Services

#### GetObjects (Post Method)

Returns all SoftOne objects (EditMaster) and tables in memory (EditList).

**Request Sample
{**
"service" **:** "getObjects" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetObjects)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
```
**Response Sample**

**{**
"success" **: true,**
"count" **:** 1327 **,**
"objects" **: [{**
"name" **:** "ITEM" **,**
"type" **:** "EditMaster" **,**
"caption" **:** "Stock Items"
**},**
...
**,{**
"name" **:** "$ITEGROUP" **,**
"type" **:** "EditList" **,**
"caption" **:** "Item Groups"
**},**
...
**,{**
"name" **:** "CUSTOMER" **,**
"type" **:** "EditMaster" **,**
"caption" **:** "Customers"
**},**
...
**,{**
"name" **:** "SALDOC" **,**
"type" **:** "EditMaster" **,**
"caption" **:** "Sales Documents"
**},**
...
**,{**
"name" **:** "ZIP" **,**
"type" **:** "EditMaster" **,**
"caption" **:** "Postal codes"
**}
]
}**


Chapter 12 – Web Services

#### GetObjectTables (Post Method)

Returns all tables defined in a SoftOne object (EditMaster).

**Request Sample
{**
"service" **:** "getObjectTables" **,**
"clientID" **:** "9J8pH7...HL5L9GG " **,**
"appId" **:** "3001" **,**
"object" **:** "SALDOC"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetObjectTables)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne EditMaster Object Name
```
**Response Sample
{**
"success" **: true,**
"count" **:** 34 **,**
"tables" **: [{**
"name" **:** "SALDOC" **,**
"dbname" **:** "FINDOC" **,**
"caption" **:** "Transactions (Sales)" **,**
"filltype" **:** "SQL"
**}, {**
"name" **:** "MTRDOC" **,**
"dbname" **:** "MTRDOC" **,**
"caption" **:** "Materials transactions" **,**
"filltype" **:** "SQL"
**},**
...
**{**
"name" **:** "ITELINES" **,**
"dbname" **:** "MTRLINES" **,**
"caption" **:** "Item lines" **,**
"filltype" **:** "SQL"
**},**
...
**{**
"name" **:** "SNLINES" **,**
"dbname" **:** "SNLINES" **,**
"caption" **:** "Serial number per material lines" **,**
"filltype" **:** "SQL"
**}, {**
"name" **:** "EXPANAL" **,**
"dbname" **:** "EXPANAL" **,**
"caption" **:** "Expense analysis" **,**
"filltype" **:** "SQL"
**},**
...
**]
}**


Chapter 12 – Web Services

#### GetTableFields (Post Method)

Returns the table fields and properties of a SoftOne object (EditMaster).

**Request Sample
{**
"service" **:** "getTableFields " **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "SALDOC" **,**
"table" **:** "SALDOC"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetTableFields)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne EditMaster Object Name
table string Table (database name or alias name)
```
**Response Sample**

**{**
"success" **: true,**
"count" **:** 204 **,**
"fields" **: [**
... **{**
"name" **:** "TRNDATE" **,**
"alias" **:** "" **,**
"fullname" **:** "SALDOC.TRNDATE" **,**
"caption" **:** "Date" **,**
"size" **:** "8" **,**
"type" **:** "DateTime" **,**
"edittype" **:** "CalendarDate" **,**
"defaultvalue" **:** "'20150322'" **,**
"decimals" **:** "" **,**
"editor" **:** "" **,**
"readOnly" **: false,**
"visible" **: true,**
"required" **: true,**
"calculated" **: false
},**
... **{**
"name" **:** "TRDR" **,**
"alias" **:** "" **,**
"fullname" **:** "SALDOC.TRDR" **,**
"caption" **:** "Customer" **,**
"size" **:** "4" **,**
"type" **:** "Integer" **,**
"edittype" **:** "Selector" **,**
"defaultvalue" **:** "" **,**
"decimals" **:** "" **,**
"editor" **:** "CUSTOMER" **,**
...
**},** ...
**]
}**


Chapter 12 – Web Services

#### GetDialog (Post Method)

Returns all filter fields from a specific browser or report dialog, together with their format.

**Request Sample
{**
"service" **:** "getDialog" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"list" **:** ""
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetDialog)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne EditMaster Object Name
list string List Name.
```
**Response Sample**

**{**
"success" **: true,**
"title" **:** "Customers" **,**
"model" **: {**
"CUSTOMER" **: {**
"relationship" **:** "OneToOne" **,**
"editable" **: true,**
"fields" **: [{**
"name" **:** "CODE" **,**
"type" **:** "string"
**}, {**
"name" **:** "CODE_TO" **,**
"type" **:** "string"
**},
]
}
},**
"form" **: [{**
"xtype" **:** "s1cont" **,**
"items" **: [{**
"xtype" **:** "s1fields" **,**
"flex" **:** 0.50 **,**
"group" **:** 1 **,**
"items" **: [**
s1Editor **(** "0;CUSTOMER.CODE;Code,from;;;1;0;1;0;0;;;" **)
]
}, {**
...
**]
}
],**
"editable" **: true
}]
}**


Chapter 12 – Web Services

#### GetFormDesign (Post Method)

Returns all fields and design properties from a specific form of an object.

**Request Sample
{**
"service" **:** "getFormDesign" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"form" **:** ""
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetFormDesign)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne EditMaster Object Name
form string Form Name.
```
**Response Sample**

**{**
"success" **: true,**
"model" **: {**
"CUSTOMER" **: {**
"relationship" **:** "OneToOne" **,**
"editable" **: true,**
"fields" **: [{**
"name" **:** "CODE" **,**
"type" **:** "string"
**},**
...
**]
},
...
},**
"form" **: [{**
"xtype" **:** "s1cont" **,**
"items" **: [{**
"xtype" **:** "s1fields" **,**
"flex" **:** 0.25 **,**
"group" **:** 110 **,**
"items" **: [**
s1Editor **(** "0;CUSTOMER.CODE;Code;;;1;0;1;1;0;;;" **)
]
}, ...**
"items" **: [{**
"xtype" **:** "s1cont" **,**
"items" **: [{**
"xtype" **:** "s1fields" **,**
...

s1Editor **(** "0;CUSTOMER.JOBTYPETRD;Profession;;;1;0;1;0;0;;;" **)]
...
}]
}]
}]
}**


Chapter 12 – Web Services

#### GetBrowserInfo(Post Method)

Executes a browser and returns its reference code (reqID) along with the structure of the browser fields, the columns
of the browser, the number of records and the total sums of the numeric fields.

Response field “ **_ZOOMINFO_** _”_ indicates the id of the main table of the object.

**Request Sample
{**
"service" **:** "getBrowserInfo" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "SALDOC" **,**
"list" **:** "" **,**
"filters" **:** "SALDOC.TRNDATE=2015- 03 - 01&SALDOC.TRNDATE_TO=2015- 03 -
31&SALDOC.FINCODE=sis*"
**}**

**Request Parameters**

```
Property Type Description
```
```
service string Defines the name of the method that will be executed (GetBrowserInfo)
```
```
clientID string Unique client identifier obtained from the Authenticate Method
```
```
appId integer ID of the Service defined in SoftOne Web Accounts
```
```
object string SoftOne EditMaster Object Name
```
```
list string List Name
```
```
filters string
```
```
Operation is always “=”, you can not have “<>” and the syntax is the following:
FieldName1=FilterValue1&FieldName2=FilterValue2&...&FieldNameX=FilterValueX
Filter Fields are the same as the ones found in Browser Filters Screen (using CTRL + SHIFT + F12).
Note that the format for filtering datetime fields is “yyyy-dd-dd”. If you set filters in the FROM field
then it will be translated as “=”. If you set filters in both FROM and TO fields then it will be
translated as “>=” (DATEFROM) and “<” (DATETO-1)
```
**Response Properties**

```
Property Type Description
```
```
success string Validates user data and returns True or False
```
```
formDesign string Access token issued by SoftOne that is used in all API requests later on
```
```
reqID String Browser reference code
```
```
totalcount Integer Total number of records
```
```
fields Array Field Names and types
```
```
columns Array Field labels and parameters as defined in SoftOne browser
```
```
sums Array Totals for fields with numeric values
```

Chapter 12 – Web Services

**Response Sample
{**
"success" **: true,**
"formDesign" **:** "SALDOC" **,**
"reqID" **:** "0018374974105073328" **,**
"totalcount" **:** 5 **,**
"fields" **: [{**
"name" **:** "ZOOMINFO" **,**
"type" **:** "string"
**}, {**
"name" **:** "SALDOC.TRNDATE" **,**
"type" **:** "date"
**}, {**
"name" **:** "SALDOC.FINCODE" **,**
"type" **:** "string"
**},**
... **{**
"name" **:** "SALDOC.SUMAMNT" **,**
"type" **:** "float"
**}
],**
"columns" **: [{**
"dataIndex" **:** "SALDOC.TRNDATE" **,**
"header" **:** "Date" **,**
"width" **:** 120 **,**
"sortable" **: true
}, {**
"dataIndex" **:** "SALDOC.FINCODE" **,**
"header" **:** "Document" **,**
"width" **:** 120 **,**
"sortable" **: true
},**
... **{**
"dataIndex" **:** "SALDOC.SUMAMNT" **,**
"header" **:** "Collection Amount" **,**
"width" **:** 168 **,**
"sortable" **: true,**
"align" **:** "right"
**}
],**
"sums" **: [**
"" **,**
"" **,**
"" **,**
"" **,**
"89531.06"
**]
}**


Chapter 12 – Web Services

#### GetBrowserData(Post Method)

Returns data from a browser with a specific reference ID. Records can be limited using limit property.

**Request Sample
{**
"service" **:** "getBrowserData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** 3001 **,**
"reqID" **:** "0018374974105073328" **,**
"start" **:** 0 **,**
"limit" **:** 2
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetBrowserData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
reqID string Referece ID obtained through GetBrowserInfo
start integer Start Record (zero based, 0 is the first record)
limit integer Number of returned records. Note that totalcount property returns the total number of records.
```
**Response Sample
{**
"success" **: true,**
"totalcount" **:** 5 **,**
"rows" **: [
[**
"01351;594" **,**
"2015- 03 - 29 00:00:00" **,**
"SISN000019" **,**
"219" **,**
"Customer 1" **,**
"62115"
**],
[**
"01351;593" **,**
"2015- 03 - 21 00:00:00" **,**
"SISN000018" **,**
"155" **,**
"Customer 2" **,**
"8074.95"
**]
]
}**


Chapter 12 – Web Services

#### GetReportInfo(Post Method)

Executes a SoftOne report and returns its reference code (reqID) along with the number of the pages.

**Request Sample
{**
"service" **:** "getReportInfo" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** 3001 **,**
"object" **:** "CUST_STM" **,**
"list" **:** "" **,**
"filters" **:** "CUSTOMER.CODE=102*"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetReportInfo)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne Report Object Name
list string Report Name
```
```
filters string
```
```
Filters syntax is the following:
FieldName1=FilterValue1&FieldName2=FilterValue2&...&FieldNameX=FilterValueX
```
**Response Sample
{**
"success" **: true,**
"reqID" **:** "0881579405109468171" **,**
"npages" **:** 1
**}**


Chapter 12 – Web Services

#### GetReportData(Post Method)

Returns a page of a report in HTML format. The report is defined by the specific reference ID obtained through
GetReportInfo.

**Request Sample
{**
"service" **:** "getReportData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** 3001 **,**
"reqID" **:** "0881579405109468171" **,**
"pagenum" **:** 1
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetReportData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
reqID string Referece ID obtained through GetReportInfo
pagenum integer Page number that will be returned
```
**Response Sample**

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<html>
<head>
<meta http-equiv= **"content-type"** content= **"text/html; charset=windows-1253"** />
<title> **Softone Report** </title>
<link rel= **"stylesheet"** type= **"text/css"**
href= **"https://s1sites01.blob.core.windows.net/lib/weblib/prints/prints.css"** />
<script type= **"text/javascript"**
src= **"https://s1sites01.blob.core.windows.net/lib/weblib/prints/prints.js"** ></script>
</head>
<body>
<table cellpadding= **"0"** cellspacing= **"0"** class= **"outtertable"** >
<tr class= **"header"** >
<td align= **"center"** width= **"38px"** > **A/A** </td>
<td align= **"center"** width= **"75px"** > **Code** </td>
<td align= **"center"** width= **"262px"** > **Name** </td>
<td align= **"center"** width= **"150px"** > **T.R.No.** </td>
</tr>
**...**
<td width= **"105px"** align= **"right"** > **152,396.80** </td>
<td width= **"105px"** align= **"right"** > **40,416.65** </td>
<td width= **"105px"** align= **"right"** > _&nbsp;_ </td>
</tr>
<tr class= **"footer"** >
<td colspan= **"4"** width= **"376px"** align= **"left"** > **Totals** </td>
<td width= **"105px"** align= **"right"** > **128,522.70** </td>
<td width= **"105px"** align= **"right"** > **95,700.00** </td>
<td width= **"105px"** > _&nbsp;_ </td>
<td width= **"105px"** > _&nbsp;_ </td>
<td width= **"105px"** > _&nbsp;_ </td>
<td width= **"105px"** > _&nbsp;_ </td>
</tr>
</table>
</td></table>
</body>


Chapter 12 – Web Services

#### GetData(Post Method)

Returns the data of a record of a Business Object. The LOCATEINFO parameter defines the fields that will be
returned; leave it null to return all tables and fields.

**Request Sample
{**
"service" **:** "getData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"form" **:** "" **,**
"key" **:** 47 **,**
"locateinfo" **:** "CUSTOMER:CODE,NAME,AFM;CUSTEXTRA:VARCHAR02,DATE01"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (GetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne Object Name
form string Form Name
key integer Primary key of the record
```
```
locateinfo string
```
```
Return fields in the following syntax:
TableName1:FieldName1,FieldName2;TableName2:FieldName1,FieldName2;...
```
**Response Sample
{**
"success" **: true,**
"readOnly" **: false,**
"data" **: {**
"CUSTOMER" **: [{**
"CODE" **:** "107" **,**
"NAME" **:** "SoftOne AE" **,**
"AFM" **:** "999863881"
**}
]
},**
"prtname" **:** "" **,**
"caption" **:** "107 - SoftOne AE" **,**
"calc" **: false,**
"einvoice" **: false
}**


Chapter 12 – Web Services

#### FileName(Get Method)

Returns the file of a SoftOne Business Object record. The full name of the file is returned from the getData method.
Photos saved inside Business records can be retrieved through the Field SODATA of the alias table of XTRDOCDATA
(LNUM=0, RefObjID=ObjectRecordID).
URLs or Dropbox files that are saved in Related Files of a record can be retrieved using the field SOFNAME of the
table XTRDOCDATA (LNUM>0).

**Request URL**
https://webdemo.oncloud.gr/s1services?FileName=[serial number]/EA78807CFF1D36DB.jpg

**Example**
Download the photo saved in an item's record (ID=1634)

**Step 1 – Use getData to get the filename (Alias Table of XTRDOCDATA is ITEDOCDATA)**

**Request Sample
{**
"service" **:** "getData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"OBJECT" **:** "ITEM" **,**
"FORM" **:** "" **,**
"KEY" **:** 1634 **,**
"LOCATEINFO" **:** "ITEDOCDATA:SODATA"
**}**

**Response
{**
"success" **: true,**
"readOnly" **: false,**
"data" **: {**
"ITEDOCDATA" **: [
{**
"SODATA" **:** "12345678901234/EA78807CFF1D36DB.jpg"
**}
]
},**
"prtname" **:** "" **,**
"caption" **:** "10014 - Rescue Life Jackets" **,**
"calc" **: false,**
"einvoice" **: false
}**

**Step 2 – Use FileName get method to display the file**

**Request URL**
https://webdemo.oncloud.gr/s1services?FileName=12345678901234/EA78807CFF1D36DB.jpg


Chapter 12 – Web Services

#### SetData(Post Method)

Inserts or modifies the data of a SoftOne business object (Customers, Items, Sales, etc.).
If the property “ _KEY”_ is empty or missing then it inserts a new record, else it locates the record using the given
number and modifies its data.

In order to add or update data to child (detail) tables you also need to define the field LINENUM. For adding new
records use numbers from 9000001 and up. Notice that if the child table contains records already, and you need to
update or add new, you have to insert the LINENUM field number of the existing ones (without using any other
fields), or else those records will be deleted. Child table records can be updated by entering the LINENUM field and
then the fields that will be updated.

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (SetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
OBJECT string SoftOne Object Name
OBJECTPARAMS JSON array Object parameters. e.g. {“param1”:1, “param2”:”test”}
```
```
key integer Primary key of the record that you need to modify. Leave it blank if you want to insert a new record.
```
```
data array of tables
```
```
Array containing the fields of the tables that will be modified or inserted
```
```
TABLE 1 (array of
table fields)
```
```
FIELD 1
FIELD 2
```
```
...^
```
```
TABLE 2 (array of
table fields)
```
```
FIELD 1
FIELD 2
```
```
...^
```
```
...^^
```
**Response Sample
{**
"success" **: true,**
"id" **:** "47"
**}**


Chapter 12 – Web Services

**Request Example**

Modify Customers Record. Update Customer fields: Name, Address, T.R.No, City, Phone, Remarks.
Insert also data for fields Varchar01 and Int01 of the extra table CusExtra.

Add a new customer branch with Code=111 and modify the branch name of the record with Linenum=2.

Make sure that the customer branch with linenum=1 is not deleted.

**{**
"service" **:** "setData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"objectparams" **:** {"param1":0} **,**
"key" **:** "47" **,**
"data" **: {**
"CUSTOMER" **: [{**
"NAME" **:** "New Name" **,**
"ADDRESS" **:** "New Address" **,**
"AFM" **:** "0123456789" **,**
"CITY" **:** "Athens" **,**
"PHONE01" **:** "0302102102102" **,**
"ZIP" **:** "12345" **,
}
],**
"CUSEXTRA" **: [{**
"VARCHAR01" **:** "Extra 1" **,**
"INT01" **:** 1
**}
],**
"CUSBRANCH" **: [{**
"LINENUM" **:** 1
**}, {**
"LINENUM" **:** 2
"NAME" **:** "UpdatedBranchName"
**}, {**
"LINENUM" **:** 9000001 **,**
"CODE" **:** 111 **,**
"NAME" **:** "NewBranchName"
**}
]
}
}**


Chapter 12 – Web Services

#### Calculate(Post Method)

Returns the calculated data based on the user input, such as: item prices in documents, total amount of documents
(as calculated from SoftOne client), displays the alert messages, updates fields based on other field editors (U

attribute). The data and the fields returned are defined in property “ **_LOCATEINFO_** ”. It doesn’t cause any
modifications to the record, only calculations.

**Request Sample
{**
"service" **:** "calculate" **,**
"clientID" **:** "Wj8T3tvs... ...tlrT8" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"key" **:** "47" **,**
"locateinfo" **:** "CUSTOMER:CODE,NAME,AFM;CUSTEXTRA:VARCHAR02,DATE01"
"data" **: {**
"CUSTOMER" **: [
{**
"CODE" **:** "100" **,**
"NAME" **:** "Soft One Technologies S.A." **,**
"AFM" **:** "999863881"
**}
],**
"CUSEXTRA" **: [
{**
"VARCHAR01" **:** "Extra 1" **,**
"VARCHAR02" **:** "Extra 2"
**}
]
}
}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (SetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne Object Name
key integer Primary key of the record that will be used in calculation.
locateinfo string Tables separated by ; and fields separated by commas.
```
```
data (array of
tables)
```
```
Array containing the tables and their fields that will be used in calculation
```
```
TABLE 1 (array of
table fields)
```
```
FIELD 1
```
```
FIELD 2^
```
```
...^^
```
**Response Sample
{**
"success" **: true,**
"readOnly" **: true,**
"data" **: {**
"CUSTOMER" **: [{**
"CODE" **:** "100" **,**
"NAME" **:** "Soft One Technologies S.A." **,...
}]
}
}**


Chapter 12 – Web Services

#### DelData(Post Method)

Deletes the record of a SoftOne business object that is defined by the property _“_ **_key_** _”_.

**Request Sample
{**
"service" **:** "delData" **,**
"clientID" **:** "Wj8T3tvs... ...tlrT8" **,**
"appId" **:** "3001" **,**
"object" **:** "CUSTOMER" **,**
"form" **:** "" **,**
"key" **:** 47
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (SetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
object string SoftOne Object Name
form string Form Name
key integer Primary key of the record that will be deleted.
```
**Response Sample
{**
"success" **: true
}**


Chapter 12 – Web Services

#### GetSelectorData(Post Method)

Returns the data of selector lists, memory tables and string lists (data control, see C.7 Selector List). The fields
returned are the ones defined in the “selector fields” property of the table inside the database designer.

**Request Sample
{**
"service" **:** "getSelectorData" **,**
"clientID" **:** "Wj8T3tvs... ...tlrT8" **,**
"appId" **:** "3001" **,**
"editor" **:** "1|CUSTOMER||ISPROSP=0 AND ISACTIVE=1|" **,**
"value" **:** "100*"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (SetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
editor string SoftOne Internal use only
```
```
value string Filteras defined is^ the datan the “^ that will be returned. The filter is applied on selector fields” tab inside database designer.the first column of t he selector editor,
```
**Response Sample
{**
"success" **: true,**
"data" **: [
[**
"40" **,**
"1" **,**
"100" **,**
"Demo Client AE" **,**
"999863881" **,**
""
**],
[**
"365" **,**
"1" **,**
"1000" **,**
"100454656" **,**
"" **,**
""
**]
]
}**


Chapter 12 – Web Services

#### SelectorFields(Post Method)

Returns the data of a table for the fields specified by “ **_resultfields_** ” parameter. Filters are added using the properties
_“_ **_keyname_** _”_ and _“_ **_keyvalue_** _”_.

**Request Sample
{**
"service" **:** "selectorFields" **,**
"clientID" **:** "Wj8T3tvs... ...tlrT8" **,**
"appId" **:** "3001" **,**
"tablename" **:** "CUSTOMER" **,**
"keyname" **:** "TRDR" **,**
"keyvalue" **:** 47 **,**
"resultfields" **:** "CODE,NAME,AFM"
**}**

**Request Parameters**

```
Property Type Description
service string Defines the name of the method that will be executed (SetData)
clientID string Unique client identifier obtained from the Authenticate Method
appId integer ID of the Service defined in SoftOne Web Accounts
tablename string SoftOne Table Name
keyname string Field Names that will be used to filter the records
keyvalue integer Values of the fields that will be used to filter the records
resultfields string Fields that will be returned
```
**Response Sample
{**
"success" **: true,**
"totalcount" **:** 1 **,**
"rows" **: [
{**
"CODE" **:** "100" **,**
"NAME" **:** "Soft One Technologies S.A." **,**
"AFM" **:** "999863881"
**}
]
}**


Chapter 12 – Web Services

### D. Case Studies

All the following examples require Login and Authentication. Use the site registered to SoftOne to do all the web
service calls: https://RegisteredName.oncloud.gr/s1services

#### 1. Get Items

Retrieve items as they appear in a SoftOne browser, matching specified filters (Code=20*, Item
Group=106 or 107).

**Step 1 – Create browser in SoftOne**

Inside SoftOne client create a browser in “Items”entity, add the fields you need to retrieve and save it using any
name (e.g. WSItems).

**Step 2 – Get browser reqID**

Use _getBrowserInfo_ (post method) to get the reference code of the browser you created in the previous step.
The object name is _ITEM_ and list is name is the one you used to save your browser (WSItems). Add criteria using the
_filters_ parameter.

**Request Sample
{**
"service" **:** "getBrowserInfo" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "ITEM" **,**
"list" **:** "WSItems" **,**
"filters" **:** "ITEM.CODE=20*&ITEM.MTRGROUP=106,107"
**}**

**Response Sample
{**
"success" **: true,**
"formDesign" **:** "ITEM" **,**
"reqID" **:** "0911051864780364875" **,**
"totalcount" **:** 3 **,**
"fields" **: [{**
...
**},**
...
**]
}**

**Step 3 – Get Items data**

Use _getBrowserData (_ post method), combined with the reqid given from the response of the previous step, to
retrieve customers data. Records can be limited using the _limit_ parameter.

**Request Sample
{**
"service" **:** "getBrowserData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** 3001 **,**
"reqID" **:** "0911051864780364875" **,**
"start" **:** 0 **,**
"limit" **:** 50
**}**


Chapter 12 – Web Services

**Response Sample
{**
"success" **: true,**
"totalcount" **:** 3 **,**
"rows" **: [
[**
"ITEM;1653" **,**
"1" **,**
"20014" **,**
"Maritime Compass" **,**
"Piec" **,**
"444.6" **,**
"461.7"
**],
[**
"ITEM;1655" **,**
"2" **,**
"20016" **,**
"Gyro compass" **,**
"Piec" **,**
"629.2" **,**
"653.4"
**],
[**
"ITEM;1656" **,**
"3" **,**
"20017" **,**
"Altimeter aviation" **,**
"Piec" **,**
"697.84" **,**
"724.68"
**]
]
}**


Chapter 12 – Web Services

#### 2. Add Customer

Insert a new customer in SoftOne.

Use **_setData_** (post method) to add a new customer, giving a null value to the parameter " **_key_** _"_. The object name is
_Customer_. Add data to tables that exist in Customer object by using their name and fields.

**Request Sample**

{
"service": "setData",
"clientID": "9J8...NM44",
"appId": "157",
"object": "CUSTOMER",
"key": "",
"data": {
"CUSTOMER": [{
"CODE": "123456",
"NAME": "New Name",
"ADDRESS": "New Address",
"REMARKS": "My Remarks!"
}
],
"CUSEXTRA": [{
"VARCHAR01": "Extra 1",
"INT01": 1
}
]
}
}

**Response Sample**

{
"success": **true** ,
"id": " 1450 ",
"message": "Posted Customer: New Name\n(From Advanced Javascript)"
}

```
Figure CS2.1 – New customer added from web service
```

Chapter 12 – Web Services

#### 3. Update Items

Update the description of the item with id 1634.

Use setData (post method) to update item's data. Enter the id of the record in the parameter " **_key_** _"_.
Object name is _ITEM_.

**Request Sample**

{
"service": "setData",
"clientID": "9J8...NM44",
"appId": "157",
"object": "ITEM",
"key": "1634",
"data": {
"ITEM": [{
"NAME": "Description updated from web service"
}
]
}
}

**Response Sample**

{
"success": **true** ,
"id": "1634",
"message": "From Advanced JavaScript - Works in All Forms"
}

```
Figure CS3.1 – Item description updated from web service
```

Chapter 12 – Web Services

#### 4. Add Customer Branch

Add a new customer branch inside the customer with id 100. Make sure that branches with LINENUM 1
and 2 are not deleted.

Use setData (post method) to locate a customer record and add a new branch. Notice that the new branch is
added using LINENUM 9000001. Branches with LINENUM 1 and 2 are also defined, in order not to be deleted.

**Request Sample**

{
"service": "setData",
"clientID": "9J8p...M44",
"appId": "157",
"object": "CUSTOMER",
"key": "47",
"data": {
"CUSBRANCH": [{
"LINENUM": 1
}, {
"LINENUM": 2
}, {
"LINENUM": 9000001 ,
"CODE": "003",
"NAME": "New Branch Name"
}
]
}
}

**Response Sample**

{
"success": **true** ,
"id": "47",
"message": "Posted Customer: SoftOne AE\n(From Advanced Javascript)"
}

```
Figure CS4.1 – New Branch added without deleting Branches 001 and 002
```

Chapter 12 – Web Services

#### 5. Get Sales Documents..........................................................................................................................................................................

Retrieve Sales Documents as they appear in a SoftOne browser, matching specified fields

**Step 1 – Create browser in SoftOne**

Inside SoftOne client create a browser in “Sales Documents” entity, add the fields you need to retrieve and save it
using any name (suppose it’s WSSales).

**Step 2 – Get browser reqID**

Use **_getBrowserInfo_** (post method) to get the reference code of the browser you created in the previous step. The
object name is _SALDOC_ and the list name is the one you used to save your browser (WSSales). Add criteria using the
_filters_ parameter.

**Request Sample
{**
"service" **:** "getBrowserInfo" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** "3001" **,**
"object" **:** "SALDOC" **,**
"list" **:** "WSSales"
"filters" **:** ""
**}**

**Step 3 – Get sales documents data**

Use **_getBrowserData_** (post method), combined with the reqid given from the response of the previous step, to
retrieve sales documents. Records can be limited using the _limit_ parameter.

**Request Sample
{**
"service" **:** "getBrowserData" **,**
"clientID" **:** "9J8pH7...HL5L9GG" **,**
"appId" **:** 3001 **,**
"reqID" **:** "0018374974105073328" **,**
"start" **:** 0 **,**
"limit" **:** 50
**}**

**Response Sample
{**
"success" **: true,**
"totalcount" **:** 31 **,**
"rows" **: [
[**
"01351;609" **,**
"1" **,**
"2015- 04 - 05 00:00:00" **,**
"SINV000005" **,**
"Sales Invoice" **,**
"Head Offices" **,**
"121" **,**
"Alexis Chalkidis" **,**
"369"
**],
[**
"01351;596" **,**
"3" **,**
"2015- 04 - 05 00:00:00" **,**
"SISN000021" **,**
...
**],** ...
**]
}**


Chapter 12 – Web Services

#### 6. Add Sales Document

Insert a new Sales Document with 2 item lines.

Use **_setData_** (post method) to add a new sales document, giving a null value to the parameter " **_key_** _"_. The object
name is _SALDOC_. Table name for item lines is ITELINES. Table name for service lines is SRVLINES. For each line
added don't forget to add data to the field LINENUM using numbers greater than 9000000.

**Request Sample
{**
"CLIENTID" **:** "9J8pH7...HL5L9GG " **,**
"APPID" **:** 3001 **,**
"SERVICE" **:** "SetData" **,**
"OBJECT" **:** "SALDOC" **,**
"KEY" **:** "" **,**
"FORM" **:** "" **,**
"DATA" **: {**
"SALDOC" **: [
{**
"SERIES" **:** "7001" **,**
"TRDR" **:** "40" **,**
"PAYMENT" **:** "1003"
**}
],**
"ITELINES" **: [
{**
"LINENUM" **:** 9000002 **,**
"VAT" **:** "1310" **,**
"MTRUNIT4" **:** "101" **,**
"MTRCATEGORY" **:** "204" **,**
"MTRL" **:** 2016 **,**
"QTY1" **:** 2 **,**
"PRICE" **:** 5
**},
{**
"LINENUM" **:** 9000001 **,**
"VAT" **:** "1310" **,**
"MTRUNIT4" **:** "101" **,**
"MTRCATEGORY" **:** "204" **,**
"MTRL" **:** 2015 **,**
"QTY1" **:** 1 **,**
"PRICE" **:** 10
**}
],**
"SRVLINES" **: []
}
}**

**Response Sample
{**
"success" **: true,**
"id" **:** "919"
**}**


Chapter 12 – Web Services

#### 7. Add HTML data

Custom Web Service, created in Advanced JavaScript, that locates a SoftOne Object record (e.g. SOEMAIL)
and adds HTML data to a blob field (e.g SOMAIL.SOBODY).

**function** AddHTMLData **(** obj **) {
var** resp **= {};**
resp**.** success **= false;
if ((** obj**.** clientID **) && (** obj**.** clientID **!=** "" **)) {
try {
var** S1Module **=** X**.** EXEC **(** 'CODE:ModuleIntf.CreateModule' **,** obj**.** ObjectName **);**
X**.** EXEC **(** 'CODE:ModuleIntf.LocateModule' **,** S1Module **,** obj**.** RecordID **);
var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** S1Module **,** obj**.** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** obj**.** FieldName **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 1 **,** obj**.** HTMLCode **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetEdit' **,** vdsTable **);**
X**.** EXEC **(** 'CODE:SOHTMLDOC.SaveDoctoBlob' **,** vBlobPointer **,** vBlobField **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DatasetPost' **,** vdsTable **);**
X**.** EXEC **(** 'CODE:ModuleIntf.PostModule' **,** S1Module **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DestroyModule' **,** S1Module **);**
resp**.** success **= true;
}
catch (** e **) {**
resp**.** error **=** e**.** message **;
}
}
else {**
resp**.** error **=** "Authenticate failed due to invalid credentials!" **; ;
}
return** resp **;
}**

```
Figure CS7.1 – Advanced JavaScript – Custom WebService
```

Chapter 12 – Web Services

**Request URL**

https://RegisteredName.oncloud.gr/s1services/JS/myWS/AddHTMLData

**Request Sample**

{
"clientID": "9J8...M44",
"ObjectName": "SOEMAIL",
"RecordID": 3362 ,
"TableName": "SOMAIL",
"FieldName": "SOBODY",
"HTMLCode": "<p>This is a <span style='color: #0000ff;'>test</span> email from <span style='color:
#ff0000;'><strong>web service call</strong></span>.</p>"
}

**Response Sample**

{
"success": **true**
}

```
Figure CS7.2 – HTML data posted from web service call
```

Chapter 12 – Web Services

#### 8. Get HTML data

Custom Web Service, created in Advanced JavaScript, that locates a SoftOne Object record (e.g. SOEMAIL)
and retrieves HTML data from a blob field (e.g SOMAIL.SOBODY).

**function** GetHTMLData **(** obj **) {
var** resp **= {};**
resp**.** success **= false;**
resp**.** data **=** "" **;
if ((** obj**.** clientID **) && (** obj**.** clientID **!=** "" **)) {
try {
var** S1Module **=** X**.** EXEC **(** 'CODE:ModuleIntf.CreateModule' **,** obj**.** ObjectName **);**
X**.** EXEC **(** 'CODE:ModuleIntf.LocateModule' **,** S1Module **,** obj**.** RecordID **);
var** vdsTable **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetDataSet' **,** S1Module **,** obj**.** TableName **);
var** vBlobField **=** X**.** EXEC **(** 'CODE:ModuleIntf.GetField' **,** vdsTable **,** obj**.** FieldName **);
var** vBlobPointer **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.CreateDoc' **,** 2 **,** vBlobField **);**
resp**.** data **=** X**.** EXEC **(** 'CODE:SOHTMLDOC.GetDocHTMLPart' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:SOHtmlDoc.DestroyDoc' **,** vBlobPointer **);**
X**.** EXEC **(** 'CODE:ModuleIntf.DestroyModule' **,** S1Module **);**
resp**.** success **= true;
}
catch (** e **) {**
resp**.** error **=** e**.** message **;
}
}
else {**
resp**.** error **=** "Authenticate failed due to invalid credentials!" **; ;
}
return** resp **;
}**

```
Figure CS8.1 – Advanced Javascript – Custom WebService
```

Chapter 12 – Web Services

**Request URL**

https://RegisteredName.oncloud.gr/s1services/JS/myWS/GetHTMLData

**Request Sample**

{
"clientID": "9J8...M44",
"ObjectName": "SOEMAIL",
"RecordID": 3363 ,
"TableName": "SOMAIL",
"FieldName": "SOBODY
}

**Response Sample**

{
"success": **true** ,
"data": "<html><head></head><body><p>Hello,</p><p>this is a test email.</p><p><img align=\"baseline
\" alt=\"\" src=\"https://www.softone.gr/wp-content/themes/Softone/images/logo-
mobile.png\" border=\"0\" hspace=\"0\"></p></body></html>"
}

```
Figure CS 8 .2 – HTML data retrieved from GetHTMLData web service
```

Chapter 12 – Web Services

#### 9. Add Related Files

Locate a record and add related documents using the web service method SetData.
Notice that some SoftOne objects, like SALDOC (Sales Documents) link to Related Documents using

Relative Jobs. In these cases, you need to manually create a custom form, add the table XTRDOCDATA

“Related Documents” and make the webservice call for this specific form.
Use LINENUM field as in every detail table added from web service call (e.g. Add Customer Branch).

**Request Sample**

{
"service": "setData",
"clientID": "9J8...M44",
"appId": "157",
"OBJECT": "SALDOC[FORM=Related Files]",
"KEY": "5422",
"data": {
"XTRDOCDATA": [{
"LINENUM": "1"
}, {
"LNUM": "1",
"LINENUM": "9000002",
"NAME": "https://www.softone.gr/wp-content/uploads/2017/10/SCREEN-SFA-2.png",
"SOFNAME": "https://www.softone.gr/wp-content/uploads/2017/10/SCREEN-SFA-2.png"
}
]
}
}

**Response Sample**

{
"success": **true** ,
"id": "5422"
}

```
Figure CS9.1 – Add XTRDOCDATA table in Sales Documents form (Related Files)
```

Chapter 12 – Web Services

```
Figure CS9.2 – Locate statement of XTRDOCDATA table
```
```
Figure CS9.3 – Related File added from web service call (SetData)
```

```
Chapter 13 – BAM
```
## 13. Business Automation Machine

#### A. Overview

#### B. Setup

#### C. Design & Mode

#### D. Variables

#### E. Process Steps

#### F. Runtime

#### G. Audit & Reports


Chapter 13 – BAM

### A. Overview

Business Automation Machine (B.A.M.) is an advanced Workflow tool that combines all the SoftOne customization
tools in order to run jobs over different SoftOne Business objects.

BAM runs in **server-side** , using Cloud Agent and executes all processes **asynchronously**. Processes can be triggered
through user-interaction (entities events) or through SoftOne scheduler. The results of a process are displayed in a
visual viewer using diagrams.

A graphical modelling view is used, which is user-friendly and provides an overview of the different steps and their
properties, both in design mode and in runtime. In design mode, the screen is vertically splitted and displays the
modeling view on the left, while on the right-hand side it shows different actions and commands that change upon
the type of the selected step.

There are numerous jobs that can be executed using BAM, such as send e-mail /sms / internal messages, export
files, insert/update records, run sql commands, print forms, create reminders, run data flows or even make HTTP
requests.

A development environment is offered so as to test Workflows before publication. There is also an option of
deactivating workflows that were used in the past and their records need to be maintained in the system.

Sub-workflows are also available for design, which can be nested in any workflow. They are processed as different

### flows and allow parameters and results to be transferred between parent and child flows.

At runtime, the records of SoftOne objects (including the custom ones) that are affected from a BAM workflow
display the flow of the process through the related job “Business Process”. This job displays the process in the same
graphical modeling view that it was originally designed inside BAM designer.

B.A.M. design is saved in the blob field SODATA of the table CSTINFO (CSTTYPE=19) and can be exported /
imported through different installations as .cst or .auv files using the “Custom Administration” tool.

```
Figure A1
```

Chapter 13 – BAM

### B. Prerequisites & Setup

B.A.M. requires the module Soft1 B.A.M. which also adds Soft1 Open Enterprise Engine (Figure B1). Processed of
B.A.M. are activated as long as you turn on S1 Agent (StandAlone or Azure installations).

```
Figure B1
```
S1 Agent setup is the same as in Web Services. Click on the “Cloud” button on top of SoftOne application and then
select “ _Configure S1 Agent_ ”. On top of the form that opens, enter the domain name of your site, which will be
domainname.oncloud.gr and click on “Register”. Then, fill in the rest of the form and click on “Activate” (Figure B2).

```
Figure B2
```

Chapter 13 – BAM

S1 Agent works as SoftOne server and automatically logins into SoftOne using a user named “WEB”. If no user is
found under that name, then it uses the first Administrator user that it finds (Figure B3).

```
Figure B3
```

Chapter 13 – BAM

### C. Design & Mode

#### C1. Available Tools

Business processes consist of steps that are processed indifferently. Steps “ _Start_ ” and “ _End_ ” are auto inserted and
cannot be deleted. Steps properties allow you to add fields and custom variables (toolbar buttons).

All tools (toolbar buttons, steps, fields, variables ,etc.) are available only in design mode.
Toolbar buttons (Figure C1.1) are explained in the table that follows.

```
Figure C1. 1
```
##### BUTTON DESCRIPTION

```
Add Adds a new step in the process.
```
```
Delete step Deletes the selected step.
```
```
Fields
```
```
Lists the fields of the “Start” entity and is available only if the process is Started from an entity.
Fields can be added (using drag and drop) in steps or variables.
Variables List Lists the created variables of the process that can be added in other variables or in steps.
```
```
Variables Edit Window-grid that allows to insert or edit custom variables
```
```
Comments User-comments about the business process
```
```
Screen layout Maximize / Minimize design layout
```

Chapter 13 – BAM

#### C2. Mode

The different modes of a BAM process are explained in the table below.

```
Figure C2.1
```
##### MODE DESCRIPTION

```
Inactive Business process is not active, but there might be pending processes that need to be
completed. Design is not permitted. Use this mode in order to deactivate a BAM.
```
```
Design
```
```
Business process is not active and not running. Process is available for design. Use this mode
when you are designing a BAM and you have not yet set it to run.
```
```
Publication
```
```
Business process is active and running. Design is not permitted. In order to stop the process
from running you need to change the mode to inactive, where design is not permitted
because there might be pending processes that need to be completed.
```
Note that in order to change the design of a BAM process that is published, it’s recommended to turn it to “ _Inactive_ ”
mode and then design a copy of it. Inactive mode allows pending processes (steps that have not yet completed) to
be executed normally. If you alter the design of a BAM that was previously published and pending processes exist,
then they will not be executed and errors will occur.


Chapter 13 – BAM

#### C3. Process Testing

BAM is offered for **testing** in standalone installations, if you run S1Agent using webfeeder and SoftOne using the
switch /BAM:LOCAL. This switch opens SoftOne and at the same time it activates a local BAM server, which executes
all business processes that are in **Publish** or **Design** mode. This lets you test a business process, while in Design
mode, which means that it will run as if it was published.

Steps for testing BAM processes are:

**1.** Create a shortcut for Softone and add the switch /WEBFEED:LOCAL (Figure C3.1)
**2.** Create a shortcut for Softone and add the switch /BAM:LOCAL (Figure C3.2)
**3.** Create an XCO file named WEB.XCO, add the configuration data of your installation and place it inside the
    SoftOne application folder.
**4.** Run Webfeeder (Step 1). This creates a web server using web.xco file.
**5.** Run SoftOne using the shortcut of Step 2. This creates the BAM server that serves processes locally and opens
    SoftOne for testing design mode business processes.

```
Figure C3.1 Figure C3.2
```

Chapter 13 – BAM

### D. Variables

Variables are defined in design mode and are used to store the results of calculations inside the steps of the
business process. They can also store the results of a step and then used in other steps of the business process. The
available types of variables are **Calculation** , **SQL Command** , **Function** and **Soft1360**.

Variables are calculated **only** when you use them inside the properties of a step (“Results” , “Conditions”, “Locate”,
“Initialize Variables”, etc.). A variable is initialized (calculated for the first time) if it has no assigned value. This occurs
when you use it inside a property of a step (e.g. “Conditions” or “Mapping Fields”), except for the property “Results”
where its value is reassigned. This means that if for example you have a variable that selects data from a table and
you use it more than one times (in different steps), then the sql statement will not be executed every time, if it
already has data, but it will use the data from the previous steps. It’s obvious that “Results” property of a step
produces different data, so each time you use a variable inside that property it will be reassigned with the new data.

If you need to store different record fields of the same object, that appear in more than one steps then you need to
create different values. For example if you need to store the customers of tasks (SOACTION.TRDR) that are inserted
in different steps of your process, then you need to create different variables (vTRDR1 – Calculation –
SOACTION.TRDR and vTRDR2 – Calculation – SOACTION.TRDR) and use them in the result fields of the steps.

Variables are created through the toolbar button “ **_Variables – Create_** ”. This opens a window, where you can define
variables that may be used inside any step of your workflow (Figure D 1 ). A new variable is inserted in the grid when
you use the down arrow of the keyboard.

```
Figure D 1
```

Chapter 13 – BAM

#### D.1 Calculation

It is used for storing values that are processed inside steps and can be later used in any other step of the workflow.

The results that are produced by some types of steps can be stored in calculation variables. A step type “ **_Job_** ” that
inserts or update a record in a specific object can store the posted recordset in a calculation variable. The name of
the variable must be entered in the “ **_Result_** ” textbox. The id of the result recordset is referenced using the
expression **_{{VariableName.id}}_** , while all the result fields are referenced using the expression:

**_{{VariableName.data.TableName[ 0 ].FieldName}}_**.

In the example of Figure D1.1 the step “ **_Task for Lead_** ” inserts a new task (SOTASK) and the result recordset of
SOACTION is stored in the variable “ **_Qtask_** _”_.

```
Figure D1.1
```
It is then used in a “ **_User Action_** ” step, to check if this specific task (Locate **{{QTask.id}}** ) is completed (Condition
SOACTION.ACTSTATES = 600) in order to move on to next steps (Figure D1.2).

```
Figure D1.2
```

Chapter 13 – BAM

The variable “ **_Qtask_** ” is initialized inside “ **_Variables_** ” as in Figure D1.3.

```
Figure D1.3
```
Another use of “Calculation” is for storing field values, that are processed inside conditions or result fields of a step.
In the example of Figure D1.4 the variable “ **_DraftId_** ” stores the value of the field “ **_SODRAFT.SODRAFT_** ”, which is
initialized in the Start of the workflow (Entity SODRAFT) and then used to map fields in another step (Figure D1.5).

```
Figure D1. 4
```
```
Figure D1.5
```

Chapter 13 – BAM

#### D.2 SQL Command

**SQL Command** is used for retrieving data from database using sql statements and the results are available in any
step. The main advantage comparing to the corresponding command in user-defined fields is that you have the
option to **select as many fields and records** as you like and not only one. This is very efficient as it does not send
many queries to the database.

Sql command data are referenced using the expression: **{{VariableName[recordno].Column}}**

In the example of figure D2. 1 , the step “ **_Create sales opportunity_** ” inserts a new project (PRJC) and maps fields
using variables. Field **_PRJC.TRDR_** is mapped with variable **_{{LCustomer[0].trdr}}_** which is the result of the query:
**select** trdr **from** sodraftlnk **where** sodraft **={{** DraftId **}}**

Field PRJC.NAME is mapped with variable {{CustName[0].name}} which is the result of the query (Figure D2.2) :
**SELECT** name **,** code **FROM** TRDR **WHERE** TRDR **={{** LCustomer **[** 0 **].** trdr **}}**

It’s obvious that you can use reference variables inside other variables, if they have been initialized first.

```
Figure D2.1
```
```
Figure D2.2
```

Chapter 13 – BAM

**D. 3 Soft1 360**

This command is used for creating references to SoftOne web and mobile applications. An example of a web
function is DeepLink, that has the following syntax:

**DEEPLINK:ObjectName[attributes],RecordID, FormName**

The example of Figure D3.1 defines a variable that creates a deep link for a specific record of an object.
Variable “ _linkforpjc_ ” is used in a Job step that sends an email. The body of the email, contains a link of the record for
Soft1 360 site (Figure D3.2).

```
Figure D3.1
```
```
Figure D3.2
```

Chapter 13 – BAM

### E. Process Steps

A step is the part of the process that defines the actions that will take place inside the flow. A
new step is created through right click on the left panel, or through the toolbar button “Add”.
Selected (focused) steps are highlighted on the left panel with orange color. All step types can
be used in parallel or sequentially. Sequential (serial) process steps are executed one after
another, while parallel ones are executed simultaneously. Parallel steps are used when for
example you have an approval system and you need to send separate approval tasks to many
approvers and then continue the process based on the actions of one or more of them. The
different types of steps you can use inside a business process are discussed in the following
sections.

#### E.1 Start

A business process can be started (triggered) from **Entity** records that are posted by users,
**Scheduler** or other **parent business processes**. These different ways are discussed below.

**_E.1.1 Entity_**

Records that are inserted or updated using SoftOne objects can start a business process. Start Conditions, that fire
these events, are defined through the “ **_Start Condition_** ” option (Figure E1.1).

On the right-handside select “ **_Entity_** ” from the “ **_Start from_** ” list, choose the desirable event (After Insert, After
Update or After Post) and then enter the object that will start the workflow. Any SoftOne object can be used, even
custom ones for the start entity of the workflow. “After post” event fires either on insert or on update of the record.

The conditions that trigger the start process entity are entered inside the “ **_Start condition_** ” panel. You are allowed
to use any field of the start entity (Toolbar button “ **_Fields_** ”), or created **variables** (e.g. SQL commands) and **X.SYS**
parameters. Variables entered here are initialized and can be later used in other step of the process.

```
Figure E1.1
```

Chapter 13 – BAM

**_E.1.1.1 Before Post Javascript_**

There is an option of writing **Javascript** code that will run in the “ **_Before post_** ” event of the object defined in the
Start Entity of the business process. This can be very helpful when you need to select a value (and save it in a
variable) before the record is posted and then compare it with posted ones in later steps.
It can also be used when you need to alter a value (e.g. SALDOC.APPRV = 0) and trigger the workflow in the after
post event by checking the results that occurred due to the changes of this value along with other conditions.
Javascript code can be written inside the “ **_Advanced_** ” panel (Figure E1.1.1).

```
Figure E1.1.1
```
**_E.1.1.2 Variables Initialize_**

Before post values can be saved into variables, through the “ **_Initialize Variables_** ” memo. Enter here the variables
that you need to store data before the start entity record is posted, so as to use them in any other step.

For example you may need to save the customer’s balance before a Sales Document is saved, so as to compare it
with the after post balance in other steps and create different types of processes.


Chapter 13 – BAM

**_E.1. 2 Scheduler_**

SoftOne scheduler can be set to start a business process. This means that you can schedule a business process to
run at a specific time and day (or recurrently) without the need of user action.

The commands that must be entered inside the scheduler are (Figure E1.2.1):

TYPE **=** BAM
JOBNAME **=** BAMRecordID **(** id of the Business process **)**

Figures E1.2.1 shows an example of a Job Scheduler that is set to be executed every month (1st) and run the BAM
process with code 10.

```
Figure E1.2.1
```

Chapter 13 – BAM

In the BAM process Start step the “Start from” is “Scheduler” (Figure E1.2. 2 ). The next step sends an email to the
specified recipients and the process ends (Figure E1.2.3) and this happens every month (from Scheduler recurrency).

```
Figure E1.2.2
```
```
Figure E1.2.3
```

Chapter 13 – BAM

#### E.2 Decision

This step is used to define different sub processes based on a true/false condition. The
condition may contain Variables, X.SYS parameters or Fields (toolbar button) from the
“Start entity”. The process splits in as many “ **_Yes_** ” and “ **_No_** ” branches as the ones defined
in the “ **_Next steps_** ” panel.

In the example of Figure E2.1 the flow will continue with Step “Service Card A” if the condition
({{vTicket.data.SOACTION[0].CCCITEMTYPE}}=3) is true, otherwise it continue with step “Service Card B”.

```
Figure E2.1
```
The example of Figure E2.2 shows a “Decision” step that splits the process in three different steps. It moves to Step
“ _Task to approve amounts <=1000 euro_ ” if the Condition _{{LINSUPDOC.NETAMNT}}<=1000_ is true, otherwise it
moves to two different steps.

```
Figure E2.2
```

Chapter 13 – BAM

Notice that the condition uses the field LINSUPDOC.NETAMNT, which is a field from the “Start” entity (selected
through the toolbar button Fields).

**The “Start” entity object fields are available for use in the steps of the business process that are above the
first “User Action” step.** This means that if you need a field value of the “Start” entity in a step that is below a “User
Action” step, then you need to create a variable and initialize it in a step above the first “User Action”. This variable
will contain the value of the start entity field and will be available for use in any step of the entire process.

In the following example, _SODRAFT_ is the “Start” entity of the business process. The step “ _Task for Lead qualification_ ”
initializes the variable _{{interest}}_ when used as mapping field of _SOACTION.MTRL_ (Figure E2.3).
Variable _{{interest}}_ is defined to store the data of the start entity field _SODRAFT.UCTBL0_ 2 (Figure E2.4). This way the
variable can be later used in any step of the process, even below “User Action” steps.

```
Figure E2. 3
```
```
Figure E2.4
```

Chapter 13 – BAM

#### E.3 Standby

This type of step waits for other steps to be completed in order to move on to the
next step. The steps are entered inside the “Condition” panel as in Figure E3.1.

The following example shows a “Standby” step (18) that waits for steps 15 (Email to sales manager) and 17 (New
customer approval) to be completed in order to move to step 19 (Invoicing).
Process 15 (Figure E3.2) is a “Job” type step that sends an email, while process 17 (Figure E3.3) is a sub workflow.

```
Figure E3.1
```
```
Figure E3.2 Figure E3.3
```

Chapter 13 – BAM

#### E.4 User Action

This step type is triggered when an entity record is posted by specific users or user groups and
certain conditions are met. Steps that are created after User Actions offer two branches, one that
is continuous and another that is used for escallation.

The id of the record is defined inside the textbox “Locate”. Users or Groups are selected from the panel “Completed
by” panel. Variables can be used for selecting users or groups if you click on the button next to them.

The sub business process of Figure E4.1 shows a user action step that is triggered when User 1 or any user of the
User Group 200, save the Customer withm record id _{{_ **_PARENT_** _.LCustomer[0].trdr}}_ and the value of the field
_{{CUSTOMER.ISPROSP}}=0_. The id _{{PARENT.LCustomer[0].trdr}}_ is initialized in a “Job” step of parent business
process 5 (Figure E4.2), which uses the variable “ _LCustomer_ ” that retrieves data using the sql statement :

**select** trdr **from** sodraftlnk **where** sodraft **={{** DraftId **}}**

```
Figure E4.1
```
```
Figure E4.2
```

Chapter 13 – BAM

**_Escalation_**

Some actions (e.g. Order Approval) are time critical and need to be completed in a specific time period. Such actions
can be managed through escalation functionality, that allows you to set up different process steps when the
deadline is reached. Scaling time can be defined in minutes, hours or days.

In the following example (Figure E4.3) the process waits 1 day for User 262 to complete the Service Folder with id
_{{SRVCARD.id}}_. Step is completed when certain condition is met ( _SRVCARD.FINSTATES = 3 or 4 or 6_ ).

```
Figure E 4 .3
```
When deadline is reached an email is sent to notify a user that the record failed to complete and then sends a
message to another user (Figure E4.4) so as to complete the action.

```
Figure E4.4
```

Chapter 13 – BAM

#### E.5 Job

This type of step is used for creating automated jobs that are executed in server-side. The different
options that are available according to the type of job are discussed below.

**_E.5.1 Send email_**

Sends email to the given recipient using the email settings defined in the following table:

```
PROPERTY DESCRIPTION
```
```
From SoftOne e-mail account (Parameters – Users & Rights – Email Accounts).
Name From Display Name.
```
```
To, CC, BCC Recipient e-mail addresses split by semicolons. They can be hardcoded or selected from Start
Entity Fields or defined in Variables.
```
```
Attachment
```
```
File that will be attached to the e-mail. Variables, that return the filename using the full path,
can be used.
Subject Text that will be added to the subject of the e-mail
```
The example of Figure E5.1.1 sends an e-mail to recipients that are defined in “ _SalesSecEmail_ ” Variable.

```
Figure E5.1.1
```

Chapter 13 – BAM

**_E.5.2 Send SMS_**

Sends sms to the given recipient using the following settings:

```
PROPERTY DESCRIPTION
```
```
From SoftOne SMS account (Parameters – Users & Rights – Email Accounts).
```
```
Number
```
```
Recipients’ phone number. It can be hardcoded or selected from Start Entity Fields or defined
in Variables.
Message SMS Text, with use of data defined in variables.
```
The example of Figure E5.2.1 sends SMS to Number _123456789_ and the message contains data from Variables.

```
Figure E5.2.1
```

Chapter 13 – BAM

**_E.5.3 Run Job / Print_**

This type of process job is used for running SoftOne object jobs or printing reports.

**_E.5.3.1 Run Object Job_**

Select the object job to run, from the corresponding button “Select”, enter the desirable template and the record Id.
The result message can be assigned to a variable and used in a next step (e.g. send email).

The example of Figure E3.5.1.1 runs job “Convert Draft Entry” using the template named “WorkFlow” for the record
{{ _DraftId_ }} that was previously initialized in the Start entity of the business process. The result is saved in the variable
{{ _BatchMsg_ }} (Figure E3.5.1.2).

```
Figure E5.3.1.1
```
```
Figure E5.3.1. 2
```

Chapter 13 – BAM

**_E.5.3.2 Print Report (Browser)_**

Prints the browser of the located object record. Select or enter the object inside “Object” textbox and then the
record Id that will be printed (Locate) and the desirable browser template. Enter the filename (using variables) and
select the File type from the list.

The example of Figure E5. 3 .2.1 prints the browser “Customers Balance” of Customers (CUSTOMER) objectfor the
record {{ _vCustomerid_ }}, which is the id of the Sales Document posted in the “Start” step (SALDOC.TRDR) (Figure
E5. 3 .2.2).

```
Figure E5.3.2.1
```
```
Figure E5.3.2.2
```

Chapter 13 – BAM

**_E.5.4 Insert / Update Record_**

This type of job uses the SetData post method for adding or editing object records.
The available options are the following:

```
PROPERTY DESCRIPTION
```
```
Entity SoftOne Object that will be used for insert or update. Select or enter the object name.
```
```
Locate
```
```
ID of the record. Leave it blank for inserting new records or enter here the id of the object
that will be updated. Variables entered here are initialized.
```
```
Screen Form Object Form. Select a form, when you need to execute extra business logic (through custom
code) that exists in this specific form.
```
```
Map Fields
```
```
Map the target fields using hardcoded values or Fields from “Start Entity” (Toolbar button
Fields) or Variables that were initialized in a previous step. Always keep in mind that “Start
Entity” Fields are available for use in any step above the first “User Action” step.
```
```
Result Fields
```
```
Enter here the fields that will be returned when posting is completed. These fields will be
added in the “Result” recordset under the “Data” node so as to use them in later steps of the
business process..
```
```
Result
```
```
Results are in JSON format and contain the data produced from SetData post method.
Enter here a variable name that will be populated with the id of the record along with the
result message and the result fields defined in the textbox “Result Fields”.
{
"success" : true / false,
"id" : "xxx"
"data" : {
"ResultTable1" : [{
"ResultField1" : "..." ,
"ResultField2" : "..." ,
...
}
]
}
}
The result fields are available for use in other steps, using the expression:
{{ResultVariableName.data.TableName[ 0 ].FieldName}}.
```
The example of Figure E5.4.1 updates a record of LINSUPDOC, setting the value of the field LINSUPDOC.APPRV to 1.
The id that is used to locate the record is LINSUPDOC.FINDOC, which is the id of “Start Entity”. In order to use the
“Start Entity” id in other steps (even the ones below “User Action” we assign it to a variable (startfindoc) and initialize
it here in the Locate statement (Figure E5.4.2).

```
Figure E5.4.1
```

Chapter 13 – BAM

```
Figure E5.4.2
```
The example of Figure E5.4.3 insert a new task (Locate statement is blank) and the results are saved in the variable
_Qtask_. It also adds the field SOACTION.BRANCH to the result variable, which is used in another step (Figure E5.4.4).

```
Figure E5.4.3
```
```
Figure E5.4.4
```

Chapter 13 – BAM

**_E.5.5 SQL command_**

This type of job step is used for executing sql select statements and storing the results in variables for later use in
other steps. It also allows you to execute sql insert, update and delete statements.

It identifies the type of sql statement by the first word used, which means that it (internally) runs GetSQLDataset
when the sql statement begins with “SELECT ...” (Figure E5.5.1), while on the other hand it runs EXECSQL when it
begins with “INSERT” or “UPDATE” or “DELETE” (Figure E5.5.2).

```
Figure E5.5.1
```
```
Figure E5.5.2
```

Chapter 13 – BAM

**_E.5.6 Print form_**

This type of step is used for printing object forms. Select or enter the object inside “Entity” textbox and then the
record Id that will be printed (Locate) and the desirable print-out form template. Job returns the filepath of the
printed file and you can assign it in a variable for use in other steps (Result).

The example of Figure E5.6.1 prints the form 1001 of Sales Documents (SALDOC) for the record {{ _newsaldoc_ }}, which
is the id of the Sales Document posted in the “Start” step (SALDOC.FINDOC). The result filename is assigned to
variable {{ _formfilepath_ }} (Figure E5.6.2).

```
Figure E5.6.1
```
```
Figure E5.6.1
```

Chapter 13 – BAM

**_E.5.7 Send message_**

Sends a SoftOne message to the given users or groups using the following settings:

```
PROPERTY DESCRIPTION
```
```
To Users or Groups
```
```
Select Select users or groups or click on button “{x}” to enter a variable that defines them.
```
```
Message Message text, where you can use Variables.
```
```
Attachments Adds linked records of given entity.
```
Figure E5. 7. 1 shows an example of message sent to user 2 that contains message using data from parent process. It
also adds an attachment that contains the redirecton link of a customer record (Figure E5.7.2).

```
Figure E5.7.1
```
```
Figure E5. 7 .2
```

Chapter 13 – BAM

**_E.5.8 Create reminder_**

Creates a SoftOne reminder using the following settings:

```
PROPERTY DESCRIPTION
```
```
To Users or Groups
```
```
Select Select users or groups or click on button “{x}” to enter a variable that defines them.
```
```
Reminder Time Reminder time in hours, minutes or days.
```
```
Related entry Adds a link to the reminder that contains the record of the “ Locate ” property of the object
defined in “ Entity” property.
```
The example of Figure E5.8.1 creates a reminder that adds a link of the Service folder record {{SRVCARD.id}}, which is
the result of the Service folder added in step 1 - “New Service Folder” (Figure E5.8.2).

```
Figure E5.8.1
```
```
Figure E5.8.2
```

Chapter 13 – BAM

**_E.5.9 HTTP Request_**

This type of Job is used for making HTTP calls using either get or post method. Select the method and enter the
URL. Then add the Headers, if any, and the Body of the call for POST requests. The answer can be saved in a variable
for later use in other steps of the business process.

In the following example (Figure E5.9.1) we establish a login request to SoftOne demo database using a POST
method. The results are saved in {{vResults}} variable (Figure E5.9.2).

```
Figure E5.9.1
```
```
Figure E5.9.2
```

Chapter 13 – BAM

**_E.5.10 Data Flow Rule_**

This type of job step is used for running SoftOne data flow rules that don’t have interface (dialog filters and form
display). It’s very useful when you need to create more than one records in a single step using the data of one
record of an object. This is accomplished because data flow rules allow multiple create of records using grouped
data (e.g. create as many records as the number of the different lines of a single Sales Document).

Design is very easy, as you only need to define the object name inside “Entity” textbox, the record Id that will be
used to run the rule (Locate) and finally the name of the rule that will be executed.

The following example shows a business process that is activated when a meeting with Series 105 is inserted (Figure
E5.10.1). In the next step it waits for users to complete the meeting using a specific condition (Figure E5.10.2) and
then it automatically creates a Sales Document using the data flow rule “ _Create Sales from Meeting_ ” (Figure E5.10. 3 ).
The locate statement of the data flow rule {{SOACTION.SOACTION}} is the id of the meeting of the first step.

```
Figure E5.10.1
```
```
Figure E 5. 10 .2
```

Chapter 13 – BAM

```
Figure E5. 10. 3
```
The Data Flow rule is created as in Figure E5.10. 4. The source entity is Meetings (SOMEETING) and the target the
Sales Documents (SALDOC).

```
Figure E5.10. 4
```

Chapter 13 – BAM

#### E.6 Sub Process

This type of step is used to trigger a sub business process. Apart from the design that it is the
same as any other business process, parameters can be sent from parent to child processes.
Nested business processes are also displayed in different graphical modelling view at runtime.

Figure E6.1 shows an example that triggers the Sub process 200, which uses a value from the parent process
{{PARENT.LCustomer[0].trdr}} to locate the Customer record in a User Action step (Figure E6.2).

```
Figure E6.1
```
```
Figure E6.2
```

Chapter 13 – BAM

### F. Runtime............................................................................................................................................................

At runtime, BAM offers visual view of the active processes per object record. This is available in all SoftOne objects
through the related job “Business Process” (Figure F1). BAM steps are processed asynchronously from server, so
there is no delay when users process records that trigger workflow steps.

```
Figure F1
```
The business process diagram of an object record shows the steps that are completed in green color and the
pending ones in orange (Figure F2). Jobs that are executed while you open the Business process Status diagram can
be refreshed using the “Refresh” button. The grid of the right panel shows detail info about the workflow.

```
Figure F2
```

Chapter 13 – BAM

Variables panel shows analysis of the calculated variables of the selected step (Figure F3). This is very useful for
debugging the business process and checking that the variables created inside the design of the workflow have the
correct values. Steps that fail to process are colored red, and the fail reason is inserted inside “ **Variable** ” panel. The
Step “Picked Document” of Figure F4 failed because in Design mode the locate statement of the job was blank and
the application could not locate the sales document in order to convert it and complete the step.

```
Figure F3
```
```
Figure F4
```

Chapter 13 – BAM

### G. Audit & Reports

#### G.1 Business Process Management

This entity keeps a log file of all business process records that were triggered and are pending or executed. It lists
the steps, their execution time, the user and the insert/end date per business process. It also shows the status of the
step, that is also available in Browser filters (Figure G1.2).

Right Click on a record (Figure G1.1) gives you the following options:

- Drill-down to the **related entry** of the step
- **Retry** the **step execution** if the process of the selected step has failed to run
- View the whole **business process** in the modelling view Window.

```
Figure G1.1
```
```
Figure G1.2
```

Chapter 13 – BAM

#### G.2 Business Process Analysis

This Dashboard shows graphical analysis of business processes execution time per job and users (Figures G2.1 &
G 2 .2).

```
Figure G 2 .1
```
```
Figure G 2 .2
```

Appendix

## Appendix System Parameters & Commands

#### A. SODTYPE – Entity Values

#### B. SOSOURCE – Module Values

#### C. ORIGIN – Transaction Source Values

#### D. CSTTYPE (CSTINFO Table)

#### E. X.SYS – System Parameters

#### F. ACMD Commands – System Tools

#### G. Editor Commands

#### H. Editor Attributes

#### I. Built-in Editors

#### J. Related Job Commands

#### K. Browser Job Commands

#### L. Command Line Switches

#### M. XCO: On-Premise Connection Settings

#### N. PARAMS.CFG: Cloud Connection Settings

#### O. Internal Object Parameters


Appendix

### A. SODTYPE – Entity Values................................................................................................................................

The following table contains all the values that can be found in the internal string list SODTYPE.

```
SODTYPE List
```
```
Code Module Code Module
```
```
10 Internal use only 44 Warranties
```
```
11 Company 51 Inventory
```
```
12 Suppliers 52 Services
```
```
13 Customers 53 Debits/Credits
```
```
14 Cash accounts 54 Fixed assets
```
```
15 Debtors 61 Revenue/Expense accounts
```
```
16 Creditors 70 Item sets
```
```
20 Company employees 71 Bills of materials
```
```
21 Contacts 72 Debits/Credits set
```
```
22 Draft Entry 73 Service sets
```
```
25 Resources 81 Cheques
```
```
28 CRM Questionnaires 82 Costing
```
```
29 HR Questionnaires 83 Gift vouchers
```
```
30 Salespersons 84 Bonus cards
```
```
31 Collectors 89 General ledger
```
```
32 Buyers 90 Cost accounting
```
```
33 Technicians 91 ABCosting
```
```
40 Projects 95 Payroll
```
```
41 Installations 96 Actions
```
```
42 Special contracts 97 Call centers
```
```
43 Geographic points 98 B2B service
```

Appendix

### B. SOSOURCE – Module Values

The following table contains all the values that can be found in the internal string list SOSOURCE.

```
SOSOURCE List
```
**Code Module Code Module**

**1010 ...1019** Custom business documents **1352** Service folders

**1054** Depreciation documents **1353** Special transactions – Customers

**1089** G.L. entries **1361** Revenue documents

**1090** C.A. entries **1381** Cash transactions - Customers

**1096** Alternative packages **1382** Exports costing

**1097** Cash registers **1412** Supplier remittances

**1098** Financial status report (Bulgaria) **1413** Customer remittances

**1099** KEPYO **1414** Cash accounts remittances

**1100** Accountants info documents **1415** Debtor remittances

**1120** Time sheets **1416** Creditor remittances

**11351** Retail **1453** Cash accounts special

**1140** Construction accounting codes **1481** Cash account cash transactions

**1151** Inventory documents **1553** Special from debtors

**1154** Fixed asset documents **1581** Cash transactions from debtors

**1171** Production orders **1653** Special from creditors

**1181** Cheque documents **1681** Cash transactions from creditors

**1212** Supplier reconciliation **1717** Suppliers reconciliation

**1251** Purchase documents **2021** Actions

**1253** Special transactions -Suppliers **2052** Service calls

**1261** Expense documents **2095** Payroll results

**1281** Cash transactions - Suppliers **5151** Inventory composition

**1282** Imports costing **5171** Production order

**1312** Reconcile customer with suppliers **7151** Production documents

**1313** Customers reconciliation **8100** Cheques

**1351** Sales Documents **9500** D.P.S.


Appendix

### C. ORIGIN – Transaction Source Values

The table below contains all the values that can be found in the internal string list ORIGIN. Field ORIGIN, that uses
this string list is under FINDOC table.

```
ORIGIN List
Code Transaction source Code Transaction source
1 Normal 22 Production documents from subcontract
```
```
2 Costing Imports 23 From cash register
```
```
3 Costing Exports 24 Exchange rate gains and losses
(evaluation)
```
```
4 Integrated financial & cost accounts 25
```
```
Exchange rate gains and losses (open-
item)
```
```
5 Automatic pay-off 26 Previous fiscal years revenue
```
```
6 Reversal transactions 27 Inter-co. movement (from production)
```
```
7 Physical stock taking 28 Counter-balance account based costing
```
```
8 From receiving note (Service) 29 Card installment payment document
```
```
9 From folder (Service) 30 Forecast / Reversing document
```
```
10 Initialize fixed assets 31 Fixed assets revaluation
```
```
11 From call (Service) 32 Opportunity interest
```
```
12 Update physical stock taking documents 33 Contract document
```
##### 14

```
Production documents from order-
prod.orders
```
```
34 Production slips from orders
```
##### 15

```
Composition doc. from
sale/purchase/inventory^35 Bonus points from bonus cards^
```
```
16 Revenue/Expenses 36 Export document (Ifaistos)
```
```
17 Credit notes due to turnover 37 Reversing of sales cost (Cyprus)
```
```
18 Production orders from sales order 38 Credit note due to turnover (purchases)
```
```
19 Semi-finished products production doc. 39 VAT Records (Art. 39b)
```
```
20 Production document from work slips 40 Contract Instalment Invoices
```
```
21 From import
```

Appendix

### D. CSTTYPE (CSTINFO Table)

The following table contains all the values that can be found in the internal string list CSTTYPE, that appears in
CSTINFO table records. Records marked with red can be imported / exported through Custom Administration tool.

```
CSTTYPE List
```
```
Code Control
```
```
0 Browsers / Reports
```
```
1 Screen Forms
```
```
2 Templates (Prototypes)
```
```
3 User-Defined Global (General) Fields
```
```
5 Imports (ASCII / Excel)
```
```
6 Alerts (EDA)
```
```
7 Personal User Menu
```
```
8 S1 Scripts
```
```
9 Custom SDK Code Files
```
```
10 Classic Menu
```
```
12 Data Flow Rules
```
```
13 Data Flow Scenarios
```
```
15 Gadgets
```
```
16 Advanced JavaScript
```
```
18 SQL Scripts
```
```
19 Business Processes (BAM)
```
```
20 Retail Designer
```
```
21 S1 Smart Scripts
```
```
92 SelectTop (Max Entries)
```
```
96 Trace (Objects Log File)
```
```
97 Custom Designers
```
```
98 Database Version
```
```
99 User Rights
```
```
98 Database Version
```
```
99 User Rights
```

Appendix

### E. X.SYS – System Parameters

The values in the table below apply to SoftOne tools such as browsers, reports, Java & VB script in custom forms,
SBSL scripts and EDA (alerts). Use them by entering **:X.SYS.CName** , where CName is the name of each command
(e.g. for login company code use the command :X.SYS.COMPANY).

```
System Parameters (:X.SYS.CName)
```
```
Command (CName) Description Type
```
```
ACNSCHEMA Model of the chart of accounts Small Int
```
```
BRANCH Login branch Small Int
```
```
CLIENTDATE Login Client Date and Time Datetime
```
```
CMPCURR Company currency code VarChar(5)
```
```
COMPANY Login company Small Int
```
```
COUNTRY Country Small Int
```
```
DBTYPE 1=ORACLE, 3=MSSQL Small Int
```
```
FISCPRD Login fiscal period Small Int
```
```
FISCPRDPAY Payroll year Small Int
```
```
FOLDER Portfolio Small Int
```
```
FPDATE First date of the login period Date
```
```
FPERIOD First fiscal period of the login fiscal year Small Int
```
```
FYDATE First date of the login fiscal year Date
```
```
GROUPS Login user group code Small Int
```
```
ISADMIN Returns 1 if login user is administrator Small Int
```
```
LANGEXT Login language VarChar(5)
```
```
LOCKFISCPRD Locked fiscal period Small Int
```
```
LOGINDATE Login date Date
```
```
LPDATE Last date of the login period Date
```
```
LPERIOD Last fiscal period of the login fiscal year Small Int
```
```
LYDATE Last fiscal date of the login fiscal year Date
```
```
MAINCOMPANY Parent Company in a Group of Companies schema Small Int
```
```
NFISCPRD Next fiscal year Small Int
```
```
PAYCPDATE Date for the calculation of payroll period Date
```
```
PAYFPDATE First date of the payroll period Date
```
```
PAYLPDATE Last date of the payroll period Date
```
```
PAYPERIOD Payroll period Small Int
```
```
PAYPRDTYPE Payroll period type Small Int
```
```
PERIOD Login fiscal period Small Int
```

Appendix

```
PFISCPRD Previous fiscal period Small Int
```
```
PFYDATE First date of the previous year Date
```
```
PLYDATE Last date of the previous year Date
```
```
RELATEDCMPS Relative Companies in Group of Companies schema VarChar( 1024 )
```
```
SERIALNUM Soft1 Serial number VarChar( 1 5)
```
```
SOCASH Cash Small Int
```
```
SOCASHUSER Cash from user Small Int
```
```
SOCURRENCY Currency Small Int
```
```
SYSDATE System date Date
```
```
USER Login user Small Int
```
```
USERBRANCHES Login user branches VarChar( 1024 )
```
```
USERNAME Login user name VarChar( 30 )
```
```
WHOUSES Login warehouse VarChar(4000)
```
```
WRKSTN Workstation Small Int
```

Appendix

### F. ACMD Commands – System Tools

The table below displays all the available commands that can be executed through the SoftOne menu using the job
type "System Tools".The command syntax is: " **ACMD:xxx** " where xxx is the name of the Job.

```
acCommands Table
```
```
Command Job Name
```
```
acAbout SoftOne About window
```
```
acAgentConfigure SoftOne Agent Configuration
```
```
acAgentUninstall SoftOne Agent Uninstall
```
```
acBackup Backup database
```
```
acBuildHtmlDoc Create accounting report model
```
```
acBuildOfflineFile Create file for local synchronization
```
```
acCalcErrors Calculation errors of local fields
```
```
acChangePWD Change password
```
```
acChat Support call
```
```
acCheckCS Check client / server connection
```
```
acCheckDB Update database window
```
```
acCheckForUpdates Check for updates
```
```
acComputerSoft1Address View computer soft1 address
```
```
acConnections Connections administration
```
```
acCreateDB Create database tables
```
```
acCutCompanyData Export company data
```
```
acDesktop SoftOne Desktop home page
```
```
acEditAccess Define user access rights
```
```
acEditUserMenu Design user menu
```
```
acExpBarClose Hide menu panel
```
```
acExport Export database tables
```
```
acFavorites Favorite jobs
```
```
acFullTextSearch Enable / Disable database full text search
```
```
acHelpContents Help Contents and index
```
```
acHistory Jobs history window
```
```
acImpFromClipBoard Import XXF from Clipboard
```
```
acImpFromFile Import XXF from file
```
```
acImport Import database tables
```
```
acKnowBase Program knowledge base
```
```
acLicUse Activate product license
```
```
acMainMenu2 Display main menu
```

Appendix

```
acMemory SoftOne Messages window
```
```
acmMind Game Master mind
```
```
acModifMenu Display group / user menu
```
```
acMP3Player MP3 Player
```
```
acMySoft1 My installation window
```
```
acNewLicense Newlicense
```
```
acNewSynchOffline Sync offline (client) database (ver. 3.12.508 and newer)
```
```
acProgramNews Program news
```
```
acRelogin Relogin using differentcredentials
```
```
acReminder Reminder window
```
```
acRemoteCommands Scheduled commands
```
```
acRemoteConfig Design remote commands
```
```
acRemoteServer Remote Server
```
```
acReportGen Custom reportsdesigner
```
```
acRestore Restore database
```
```
acS1AddOns SoftOne Add Ons
```
```
acSaaSServerLogin Saas Server Login
```
```
acScheduler Scheduler
```
```
acSDKFiles Custom SDK Files
```
```
acSelectTop Select Top Entries per Object
```
```
acSendCustomerMessage Send e-mail message to customer
```
```
acSettings Settings
```
```
acSetupOffline Off-Line installation parameters
```
```
acSetupPrinters Printer settings
```
```
acSQLMonitor SQL monitor
```
```
acSrvAccess Define Server access rights
```
```
acStandard Display old menu
```
```
acStartupSQL Startup SQL queries
```
```
acStatusBar Show / Hide status bar
```
```
acSyncDB Update database window
```
```
acSynchOffLine Sync offline (client) database
```
```
acSynchOnline Sync online (server) database
```
```
acTetris Game Tetris
```
```
acToggleMnu Remove menu panel
```
```
acUpgradeLicense Renew licence
```
```
acUserMenu User menu
```

Appendix

```
acWebPage SoftOne site
```
```
acWMModules Web & Mobile Licences
```
```
acZReportSignB Z Report of the type B electronic signature device
```

Appendix

### G. Editor Commands

The table below summarizes all the available editor commands and their use.

```
EDITOR COMMANDS
```
```
Command Operation / Usage Data Type
```
```
$DT Displays Date & Time in two different fields Datetime
```
```
$TIME Displays Time in HH:MM format (Saves the current Date) Datetime
```
```
$TIMESEC Displays Time in HH:MM:SS format (Saves the current Date) Datetime
```
```
$PASSWORD Password Mask (Displays text with asterisks) Varchar
```
```
$PASSWORDH Hash Password (Displays text with asterisks) Varchar
```
```
$Y Boolean Field (Displays checkbox control) Small Integer
```
```
$YN Boolean Field in datagrids (Displays “Yes/No” combobox control) Small Integer
```
```
$WEBPAGE Web Page Fields - Link to Internet Browser Varchar
```
```
$EMAIL Email Fields - Link to Email Program Varchar
```
```
$PRINTERS Displays Printers Window Dialog Varchar
```
```
$IMAGE Displays image control (usage in Image fields) Image
```
```
$DATERANGE Date from to Datetime
```
```
$TIMERANGE Time from to Datetime
```
```
$COLOR Displays Softone Color Selection window Varchar
```
##### $ONECOLOR

```
Displays Windows Color Selection window
= 256 ^ 2Red * 256 ^ 1Green * 256 ^ 0Blue
```
```
Varchar
```
```
$FILENAME Displays File Selection Window and returns its path Varchar
```
```
$FOLDERNAME Displays folder selection window and returns its path Varchar
```
```
$MASKEDIT Code Mask Creation Window Varchar
```
```
$RECURRENCE Displays Softone Scheduler Window Varchar
```
```
$MEMOEDIT Corrects word wrap in datagrid lines for memo textbox fields Varchar
```
```
$LIST:OBJECT Lookup^ from preselection^ lists created from^ browsers.^
Tables used are SOLIST and SOLISTLNS.
```
```
Varchar
```
##### $XRUN

```
Runs external program
$XRUN(D[0,C:\Xplorer.exe,"/"+CUSEXTRA.VARCHAR01])
The above example runs SoftOne application using the switch
parameters added in field CUSEXTRA.VARCHAR01.
```
```
Varchar
```

```
Appendix
```
### H. Editor Attributes

```
Inside Editors, that retrieve data from other Tables, Views or Strings (e.g. ITEM), it is possible to enter extra
commands that have various functions, such as entries filtering, fields updating, change links etc.
The following table summarizes all the available commands as well as examples of their syntax.
Note: Line breaks and Quotes are not permitted in editors, instead you can use the sql function char().
```
```
EDITOR ATTRIBUTES
```
```
Command Operation / Usage Syntax Example
```
##### W

```
(Master
Table
Selectors)
```
```
Filters table data using extra where
clause in SQL statement.
Usage in selector fields linked to
master tables.
```
```
SALDOC(W[A.COMPANY=:X.SYS.COMPANY])
Lookup data from sales documents table using as filter the Company Login.
Login system parameters (as Login Company) can be used by entering a colon
: and then the name of the param(:X.SYS.COMPANY).
CUSTOMER(W[A.CODE LIKE CHAR(97)+CHAR(37)])
Customers that code starts with letter 'a' (... AND A.CODE LIKE 'a%')
```
```
W
(Memory
Table
Selectors)
```
```
Filters memory table data using the
operators AND, OR, <>, >, <.
Usage in selector fields linked to
memory tables.
```
```
SERIES(F[COMPANY;SOSOURCE=:X.SYS.COMPANY;1351],W[FPRMS=7000
OR FPRMS=7001])
Display sales series from login company that FPRMS=7000 or FPRMS=7001
```
##### W

**(String Lists)**

```
Filters String List data.
Usage in fields linked to string lists.
```
```
$CCCMYSTR (W[1,2,3])
Lookup data from the string list CCCMYSTR displaying only the values that the
key is 1 or 2 or 3.
```
##### F

```
Filters memory table data.
Usage in fields linked to memory
tables.
```
```
MTRMARK(F[CCCMYFIELD;SODTYPE=1;51])
Lookup from the table MTRMARK filtering data using CCCMYFIELD = 1 and
SODTYPE = 51 fields and values.
```
##### M, R

```
Defines the field that will be
returned.
Usually used in string fields.
```
```
CUSTOMER(W[A.CCCMYFIELD=1],M,R[CODE])
Lookup data from customers (inherited table) using specific filter from CCC
field and return the customer's code.
(Use the Editor of the above example in a varchar field)
```
##### U

```
Updates fields after selection.
Usage in selector fields linked to
tables.
```
```
SERIES(U[FPRMS;BUSUNITS;=FPRMS;BUSUNITS@]
Lookup data from series table and update the FPRMS and BUSUNITS fields
with the values of the fields FPRMS and BUSUNITS of the selected series. The
@ symbol at the end indicates that the fields on the left, will always be
updated, no matter if they already have a value or not. If you do not enter the
@ symbol, then the fields will be updated only if they do not already have a
value.
```
```
H Redirection to Object, using the hyperlink of the field label. CCCTABLE(H[CCCOBJECT]) or CCCTABLE(H[#ObjectID;RecordID]) Lookup data from table CCCTABLE. Redirection to Object CCCOBJECT.^
```
```
E,W[] ExclusionUsage in fields linked to^ Filter in String Lists.string lists.^
```
```
$CCCMYSTR (E,W[5])
Lookup data from the string list CCCMYSTR displaying only the values that the
key is not 5.
```
```
J Join Custom Design Printouts.-^ Link to specific field. Us age in SALDOC(J[A.FINDOC])
```
##### I

```
Defines the field that will be
updated when user clicks the button
“Input” in fields of datagrids with
editors.
```
```
ITEM(I[QTY1])
In sales documents, when user selects from the available items and clicks on
the button “Input” then the data entered will update the QTY1 field.
```
##### L

```
Local Editor that lookups data from
a table, db view or virtual table that
is inside an object.
```
**1. CCCMYVTTABLE(L,F[CCCMYVTTABLEFIELD=:OTHERTABLE.FIELD])
2. #WHOUSE(L) (example in object Company** → **BRANCH.WHOUSES)**


Appendix

##### C

```
Removes the SQL expression “ AND
A.COMPANY=<LoginCompany> ”
from the where clause.
Usage in selector fields linked to
master tables.
```
```
SALDOC(W[A.CCCField in (1,2,3)],C)
Lookup data from sales documents of all the companies, using also an extra
where clause: “AND A.CCCField in (1,2,3)”.
```
##### A

```
Removes the SQL expression
“ AND A.ISACTIVE=1 ”
from the where clause.
Usage in selector fields linked to
master tables.
```
```
CUSTOMER(A)
Lookup data from Customer inherited table (Active and Inactive records)
```
##### Z

```
Applies to Soft1 Designer String
Lists only. Displays both Key and
Value of the string list.
```
```
$SODTYPE(Z)
Displays data in format “Key – Value“
```

Appendix

### I. Built-in Editors

The table below contains the analysis of the application internal editors.

```
Built-in Editors
```
**Command Editor**

**@ACN** ACNT(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;:CSEL.SODTYPE])

**@ACNAL** ACNTAL(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;90])

**@ACNALM** ACNTAL(M,R[CODE],F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;90],H[ACNTAL])

**@ACNCTGR** ACNCATEGORY(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;:CSEL.SODTYPE])

**@ACNGL** ACNTGL(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;89])

**@ACNGLM** ACNTGL(M,R[CODE],F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;89],H[ACNTGL])

**@ACNGRP** ACNGROUP(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;:CSEL.SODTYPE])

**@ACNM** ACNT(M,R[CODE],F[ACNSCHEMA=:X.SYS.ACNSCHEMA],H[ACNTGL])

**@ACNMDL** ACNMODEL(F[ACNSCHEMA=:X.SYS.ACNSCHEMA])

**@ACNMDLAL** ACNMODELAL(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;90])

**@ACNSLG** ACNISOLOG(F[ACNSCHEMA;SODTYPE=:X.SYS.ACNSCHEMA;:CSEL.SODTYPE])

**@ACNT** ACNT(F[ACNSCHEMA=:X.SYS.ACNSCHEMA])

##### @ALLCLSFLDR FINDOC(M,R[FINCODE],W[SOSOURCE IN (1282, 1382) AND EXISTS (SELECT 1 FROM CSTFLDR

##### CS WHERE CS.CSTFLDR=A.FINDOC AND CS.CFOCLOSEOK<>1)])

##### @ARS AREAS(F[SODTYPE=:CSEL.SODTYPE])

##### @CKAD

##### KAD(W[EXISTS (SELECT 1 FROM COMPANYKAD WHERE COMPANY=:X.SYS.COMPANY AND

##### A.KAD=COMPANYKAD.KAD UNION SELECT 1 FROM COMPANY WHERE

##### COMPANY=:X.SYS.COMPANY AND A.KAD=COMPANY.KAD)])

##### @CLSFLDR

##### FINDOC(M,R[FINCODE],W[SOSOURCE=&SOSOURCE AND EXISTS (SELECT 1 FROM CSTFLDR

##### CS WHERE CS.CSTFLDR=A.FINDOC AND CS.CFOCLOSEOK<>1)])

##### @COL

##### PRSNIN(W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.COMPANY=:X.SYS.COMPANY AND PRSEXT.SODTYPE=31 AND PRSEXT.ISACTIVE=1)])

##### @COLM PRSNIN(M,R[CODE],W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=31 AND PRSEXT.COMPANY=:X.SYS.COMPANY AND PRSEXT.ISACTIVE=1)])

##### @COMM COMMENTS(M,R[NAME],F[SOSOURCE=:CSEL.SOSOURCE])

##### @CRCNTRL CRCONTROL(F[SODTYPE=:CSEL.SODTYPE])

##### @DSCPLC VCRDRULE(F[SODTYPE;SOTYPE=:CSEL.SODTYPE;2])

##### @IRSM IRSDATA(M,R[NAME])

##### @JOB JOBTYPE(F[SODTYPE=:CSEL.SODTYPE])

##### @MATEXP EXPN(F[USEBYITEM=1])

##### @MATOMD MTRGROUP(F[SODTYPE=:CSEL.SODTYPE])

##### @PAYT PAYMENT(F[SODTYPE=:CSEL.SODTYPE])

##### @PERIODACN PERIOD(W[COMPANY = :X.SYS.COMPANY AND FISCPRD = :X.SYS.FISCPRD])


Appendix

**@PERIODPAY** PAYPRD(W[COMPANY = :X.SYS.COMPANY AND FISCPRDPAY = :X.SYS.FISCPRDPAY])

##### @PERIODMTR

##### PERIOD(W[COMPANY = :X.SYS.COMPANY AND FISCPRD = :X.SYS.FISCPRD AND

##### PERIOD<1000])

##### @PERIODTRD PERIOD(W[COMPANY = :X.SYS.COMPANY AND FISCPRD = :X.SYS.FISCPRD AND PERIOD>0

##### AND PERIOD<1000])

##### @PUR

##### PRSNIN(W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=32 AND PRSEXT.COMPANY=:X.SYS.COMPANY AND PRSEXT.ISACTIVE=1)])

##### @PURM PRSNIN(M,R[CODE],W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=32 AND PRSEXT.COMPANY=:X.SYS.COMPANY AND PRSEXT.ISACTIVE=1)])

##### @RPCPLC PRCPOLICY(F[SODTYPE;SOTYPE=:CSEL.SODTYPE;1])

##### @SAL PRSNIN(W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=30 AND PRSEXT.ISACTIVE=1)])

##### @SALM

##### PRSNIN(M,R[CODE],W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=30 AND PRSEXT.ISACTIVE=1)])

##### @SXACNTM SXACNT(M,R[CODE],H[SXACNT])

##### @SXACNTSM SXACNT(W[A.MTRTYPE IN (1,3)],M,R[CODE],H[SXACNT])

##### @SXACNTXM SXACNT(W[A.MTRTYPE IN (2,4)],M,R[CODE],H[SXACNT])

##### @TEC PRSNIN(W[ EXISTS (SELECT 1 FROM PRSEXT WHERE A.PRSN=PRSEXT.PRSN AND

##### PRSEXT.SODTYPE=33 AND PRSEXT.COMPANY=:X.SYS.COMPANY AND PRSEXT.ISACTIVE=1)])

##### @TEMPLATESABC TEMPLATESABC(F[SOSOURCE;GLTEMPLATESMD=:SOSOURCE;2])

##### @TEMPLATESGL TEMPLATESGL(F[SOSOURCE;GLTEMPLATESMD=:SOSOURCE;1])

##### @TEMPLATESSX TEMPLATESSX(F[SOSOURCE;GLTEMPLATESMD=:SOSOURCE;3])

##### @TFPRMS TFPRMS(F[SOSOURCE=:CSEL.SOSOURCE])

##### @TRDBRN TRDBRANCH(F[TRDR=:CSEL.TRDR])

##### @TRDBSN TRDBUSINESS(F[SODTYPE=:CSEL.SODTYPE])

##### @TRDCTGR TRDCATEGORY(F[SODTYPE=:CSEL.SODTYPE])

##### @TPGROUP TRDPGROUP(F[SODTYPE=:CSEL.SODTYPE])

##### @TRDRS TRDR(W[SODTYPE IN (12,13,15,16)])

##### @UAT1 UATBL01(F[ACNSCHEMA;SODTYPE=:CSEL.ACNSCHEMA;:CSEL.SODTYPE])

##### @UAT2 UATBL02(F[ACNSCHEMA;SODTYPE=:CSEL.ACNSCHEMA;:CSEL.SODTYPE])

##### @UAT3 UATBL03(F[ACNSCHEMA;SODTYPE=:CSEL.ACNSCHEMA;:CSEL.SODTYPE])

##### @UAT4 UATBL04(F[ACNSCHEMA;SODTYPE=:CSEL.ACNSCHEMA;:CSEL.SODTYPE])

##### @UAT5 UATBL05(F[ACNSCHEMA;SODTYPE=:CSEL.ACNSCHEMA;:CSEL.SODTYPE])

##### @UCT1 UCTBL01(F[SODTYPE=:CSEL.SODTYPE])

##### @UCT2 UCTBL0 2 (F[SODTYPE=:CSEL.SODTYPE])

##### @UCT3 UCTBL0 3 (F[SODTYPE=:CSEL.SODTYPE])

##### @UCT4 UCTBL0 4 (F[SODTYPE=:CSEL.SODTYPE])

##### @UCT5 UCTBL0 5 (F[SODTYPE=:CSEL.SODTYPE])


Appendix

**@UT1** UTBL01(F[SODTYPE=:CSEL.SODTYPE])

**@UT2** UTBL02(F[SODTYPE=:CSEL.SODTYPE])

**@UT3** UTBL03(F[SODTYPE=:CSEL.SODTYPE])

**@UT4** UTBL04(F[SODTYPE=:CSEL.SODTYPE])

**@UT5** UTBL05(F[SODTYPE=:CSEL.SODTYPE])

**@ZIPM** VZIPADDRESS(M,R[CODE])


Appendix

### J. Related Job Commands

The table below contains all the commands that are used to accessrelated jobs per module.

```
Transaction Related Jobs – Table FINDOC
```
```
Related Job Reference Modules SoftOne command
Payment terms Sales – Purchases – Collections – Remittances XCMD:SFPAYTERMS
```
```
Open-item Sales – Purchases – Collections – Remittances XCMD:1031
```
```
Pay-off Sales XCMD:CFNCUSDOC,EKSOFL:1,S
```
```
Pay-off Purchases XCMD:CFNSUPDOC,EKSOFL:1,S
```
```
Costing folder Sales – Purchases – Collections – Remittances XCMD:CSTFINLNS,S;FINDOC.FINDOC
```
```
Recalculation
```
```
Sales – Purchases – Retail – Collections –
Remittances
```
##### XCMD:10006

```
XCMD:100061 (no confirmation
messages)
```
```
Originated from
```
```
Sales – Purchases – Collections – Remittances
```
- Item Docs – Production Docs – Service
Folders

##### XCMD:SFFINFROM

```
Converted into Sales –^ Purchases –^ Collections –^ Remittances –^
Service Folders
```
##### XCMD:SFFINTO

```
Lots proposal
```
```
Sales – Purchases – Item Docs – Collections –
Remittances
```
##### XCMD:10112

```
Agreement on total
```
```
Sales – Purchases – Retail – Collections –
Remittances – Service Folders XCMD:SFFINPRCRULE^
```
```
Select contract Sales – Purchases – Collections – Remittances XCMD:SFCNTR
```
```
Select agreement Sales –^ Purchases –^ Retail^ –^ Collections –^
Remittances
```
##### XCMD:SFPRCPOLICY

```
Match with
revenue/expenses
```
```
Sales – Purchases – Retail Collections –
Remittances – Item Docs
```
##### XCMD:10113

```
Activity Based
Costing Analysis
```
```
Sales – Purchases – Retail – Collections –
Remittances – Item Docs
```
##### XCMD:ABCTRNLINES,S[ABCTABLE=FIN

##### DOC];FINDOC.FINDOC

```
Entry Sales –^ Purchases –^ Retail –Collections –^
Remittances – Item Docs – Production Docs
```
##### XCMD:10110

```
Related files
```
```
Sales – Purchases – Retail – Collections –
Remittances – Item Docs – Production Docs –
Service Folders / Calls
```
##### XCMD:XTRDOCDATA,S

```
Update sales prices Purchases XCMD:10107
```
```
Advance payment /
Order Retail^ XCMD:SFADVANCE^
```
```
Credit card
installments
```
```
Retail XCMD:908
```
```
Production cost
(subcontracted) Special Transactions^ XCMD:CSTPRDLNS,S;FINDOC.FINDOC^
```

Appendix

```
Pay-off Special Transactions XCMD:&EKSOFL
```
```
Settlement Revenues – Expenses XCMD:&CMDOBJ
```
```
Related documents Service Calls (APPMNT) XCMD:SFFINTO
```
```
Conversion history Sales – Purchases – Item Docs XCMD:10114
```
```
Record printouts Sales – Purchases XCMD:1011 5
```
```
Customer / Supplier Related Jobs – Table TRDR
```
**Relative Job Reference Modules SoftOne command**

**Balance per company**

```
Customers – Suppliers –
Debtors – Creditors XCMD:SFCMPREM^
```
**Register of non-natural
persons**

```
Customers XCMD:GsisCmpAfmData
```
```
Item Related Jobs– Table MTRL
```
**Relative Job Reference Modules SoftOne command**

**Balance per company** Items XCMD:SFCMPREM

```
Accounting Related Jobs – Table ACNT
```
**Relative Job Reference Modules SoftOne command**

**Entry model** Accounting Entries XCMD:10009

**Related files** Accounting Entries XCMD:XTRDOCDATA,S

```
Contract Related Jobs– Table SRVC
```
**Relative Job Reference Modules SoftOne command**

**Related document** Contracts XCMD:1001

```
Budget Related Jobs– Table BUDGET
```
**Relative Job Reference Modules SoftOne command**

**Update initial data** Budget – Budget data XCMD:InitBudgetData,s,BUDGET.BUDGET

**Update actual data** Budget – Budget data XCMD:CalcBadgetData;BUDGET.BUDGET

**Delete data** Budget – Budget data XCMD:DELETEBUDGETDATA;BUDGET.BUDGET

**Copy data** Budget XCMD:COPYBUDGETDATA;BUDGET.BUDGET


```
Appendix
```
```
File / Document Related Jobs – Table XDOCS
```
**Relative Job Reference Modules SoftOne command**

**Open file** Documents file XCMD:10003

**Save to file** Documents file XCMD:10004

**Save file to DB** Documents file XCMD:10011

**Delete file from DB** Documents file XCMD:10012

**Upload file to Azure** Documents file XCMD:11011

**Delete file from Azure** Documents file XCMD:11012

**Download from URL** Documents file XCMD:11013

```
CRM Related Jobs – Table SOACTION
```
```
Relative Job Reference Modules SoftOne command
```
```
Next step Actions – Calls – Meetings – Tasks – e-mails XCMD:FOLLOWUPDLG
```
```
Action history Actions – Calls – Meetings – Tasks – e-mails XCMD:ACTHISTDLG
```
```
Repeat action Actions – Calls – Meetings – Tasks – e-mails XCMD:ACTREPEATDLG
```
```
Sales opportunity Actions – Calls – Meetings – Tasks – e-mails XCMD:1002
```
```
Previous step Actions – Calls – Meetings – Tasks – e-mails XCMD:SFPREVSTEP
```
```
Related files Actions – Calls – Meetings – Tasks – e-mails – Draft entries XCMD:XTRDOCDATA,S
```
```
Attachments e-mails XCMD:1001
```
```
Send e-mails XCMD:1000
```
```
Reply e-mails XCMD:1003
```
```
Reply to all e-mails XCMD:1004
```
```
Forward e-mails XCMD:1005
```
```
Templates e-mails XCMD:1006
```
```
Convert draft entry Draft entries XCMD:1001
```
```
Register of non-
natural persons
```
```
Draft entries XCMD:GsisCmpAfmData
```
```
Reports recording Actions – Calls – Meetings – Tasks – e-mails – Draft entries XCMD:10115
```
```
Follow up Actions – Calls – Meetings – Tasks – e-mails – Draft entries XCMD:1200
```
```
Data Actions – Calls – Meetings – Tasks – e-mails – Draft entries XCMD:SFLEAD
```
```
Attachment e-mails XCMD:10006
```
```
Send and Save e-mails XCMD:1007
```

Appendix

### K. Browser Job Commands

The table below contains the commands that can be found in the right click context menu of object browsers.

```
Document Browser Jobs – Table FINDOC
```
```
Relative Job Reference Modules SoftOne command
```
```
Conversion Sales XCMD:CONVERTDLG,SOSOURCE:1351
```
```
Conversion Item Docs XCMD:CONVERTDLG,SOSOURCE:1151
```
```
Conversion Purchases XCMD:CONVERTDLG,SOSOURCE:1251
```
```
Convert document Fixed assets docs XCMD:ASSDOC,N,CNV:1
```
```
Convert lines Sales – Purchases XCMD: CONVERTDLG,SOSOURCE:1351,LN:1
```
```
Remove pending
```
```
Sales – Purchases – Retail – Item
Docs.
```
##### XCMD:REMOVERESTMODE

```
Restore pending
```
```
Sales – Purchases – Retail – Item
Docs. XCMD:UNDOREMOVEREST^
```
```
Remove pending (lines) Sales –^ Purchases –^ Retail –^ Item
Docs.
```
##### XCMD:REMOVERESTMODE,LN:1

```
Restore line pending
```
```
Sales – Purchases – Retail – Item
Docs. XCMD:UNDOREMOVEREST,LN:1^
```
```
Documents processing Sales XCMD:PROCESSDLG,SOSOURCE:1351
```
```
Documents processing Item Docs XCMD:PROCESSDLG,SOSOURCE:1151
```
```
Documents processing Purchases XCMD:PROCESSDLG,SOSOURCE:1251
```
```
Copy document Sales XCMD:SALDOC,N,CNV:3
```
```
Copy document Retail XCMD:RETAILDOC,N,CNV:3
```
```
Copy document Purchases XCMD:PURDOC,N,CNV:3
```
```
Copy document Item Docs XCMD:ITEDOC,N,CNV:3
```
```
Copy document Fixed assets docs XCMD:ASSDOC,N,CNV:3
```
```
Cancel transactions
```
```
Sales – Purchases – Retail - Item
docs – Fixed assets –
Remittances – Collections –
Special transactions
```
##### XCMD:1001

```
Cancel by reversal Sales XCMD:SALDOC,N,CNV:100
```
```
Cancel by reversal Purchases XCMD:PURDOC,N,CNV:100
```
```
Cancel by reversal Item Docs XCMD:ITEDOC,N,CNV:100
```
```
Cancel by reversal
```
```
Collections – Special
Transactions
```
##### XCMD:1003


Appendix

```
Re-issue by cancelling
with reversal
```
```
Sales – Retail XCMD:10016
```
```
Discount amount
(forecast)
```
```
Invoice discounting documents XCMD:Docspmcash
```
```
Discount amount
(disbursement) Invoice discounting documents^ XCMD:Docsmcash^
```
```
Balance disbursement Invoice discounting documents XCMD:Docsrcash
```
```
Discount expenditure Invoice discounting documents XCMD:DocsPayExpences
```
```
Management
expenditure Invoice discounting documents^ XCMD:DocsExpences^
```
```
Create credit notes Credit notes results XCMD:CreditDoc
```
```
Order planning Sales XCMD:IteOrdersServ
```
```
Transfer to purchase
documents
```
```
Sales XCMD:CRTPURORDS
```
```
Transfer to production
documents Sales^ XCMD:CRTPRDDOCS^
```
```
Transfer to production
orders
```
```
Sales XCMD:CRTPRDORDDOCS
```
```
Recalculate Sales XCMD:PRCRECALCDLG
```
```
Discount credit notes
calculation Sales^ XCMD:CULCTMPCREDIT^
```
```
Customers / Projects Browser Jobs – Tables TRDR / PRJC
```
**Relative Job Reference Modules SoftOne command**

**Save actions** Customers –^ Suppliers –^
Debtors – Creditors – Projects

##### XCMD:CRTACTIONDLG

**Send email**

```
Customers – Suppliers –
Debtors – Creditors
```
##### XCMD:SENDEMAILDLG

**Insert file**

```
Customers – Suppliers –
Debtors – Creditors – Projects XCMD:CreateXDoc^
```
```
Contacts Browser Jobs – Table PRSN
```
**Relative Job Reference Modules SoftOne command**

**Save actions** Contacts XCMD:CRTACTIONDLG

**Send email** Contacts XCMD:SENDEMAILDLG

**Export to Outlook** Contacts XCMD:EXPOUTCONTACTS

**Export to Google** Contacts XCMD:EXPGCONTACTS

**Insert file** Contacts XCMD:CreateXDoc


Appendix

**Calendar** Contacts XCMD: 102

```
Item Browser Jobs – Table MTRL
```
**Relative Job Reference Modules SoftOne command**

**Mass price modification** Items XCMD:IteCalcMarkUp

**Transfer among W/h** Items XCMD:IteWhouseRest

**Order planning** Items XCMD:IteOrdersServ

**Insert file** Items – Fixed assets - Services XCMD:CreateXDoc

**Tranfer to “Web items” file** Items XCMD:IteToWeb

**Transfer to “Touch items”
file** Items^ XCMD:IteToRetail^

```
Accounting Browser Jobs – Table ACNT
```
**Relative Job Reference Modules SoftOne command**

**Cancel entry** General ledger entries XCMD:1001

**Cancel by reversal** General ledger entries XCMD:ACCGLHEADER,N,CNV:100

**Cancel entry** Cost accounting entries XCMD:1001

**Cancel by reversal** Cost accounting entries XCMD:ACCALHEADER,N,CNV:100

```
Cheque Browser Jobs – Table CHEQUE
```
**Relative Job Reference Modules SoftOne command**

**Cash transaction** Cheques XCMD:ChqCfnDoc

**Insert file** Cheques XCMD:CreateXDoc

```
Services Browser Jobs – Table SRVC
```
**Relative Job Reference Modules SoftOne command**

**Related documents** Service calls XCMD:100001

**Cancel call** Service calls XCMD:100002

**Cancel transactions** Service folders XCMD:1001

**Revoke pending status** Service folders XCMD:1002

**Spare parts documents** Service folders XCMD:SALDOC,N,FROMSRVCARD:1

**Service documents** Service folders XCMD:SALDOC,N,FROMSRVCARD:2


Appendix

**Service – spare parts
document**

```
Service folders XCMD:SALDOC,N,FROMSRVCARD:0
```
**Shipment to customer** Service folders XCMD:SALDOC,N,SENDSRVCARD:1

```
Installations Browser Jobs – Table INST
```
**Relative Job Reference Modules SoftOne command**

**Insert file** Installations XCMD:CreateXDoc

```
Warranties Browser Jobs – Table Guaranty
```
**Relative Job Reference Modules SoftOne command**

**Save file** Warranties XCMD:CreateXDoc

```
File Documents Browser Jobs – Table XDOC
```
**Relative Job Reference Modules SoftOne command**

**Open document** Documents file XCMD:10003

**Export file** Documents file XCMD:10004

**Send by e-mail** Documents file XCMD:SendDocWithMail

```
CRM Browser Jobs – Table SOACTION
```
**Relative Job Reference Modules SoftOne command**

**Next step**

```
General actions–Calls –
Meetings – Tasks – e-mails –
CRM action statistics
```
##### XCMD:FOLLOWUPDLG,BROWSER:1

**Action history**

```
General actions – Calls –
Meetings – Tasks – e-mails –
CRM action statistics
```
##### XCMD:ACTHISTDLG,BROWSER:1

**Repeat action**

```
General actions – Calls –
Meetings – Tasks – e-mails –
CRM action statistics
```
##### XCMD:ACTREPEATDLG,BROWSER:1

**Save action** CRM action statistics XCMD:1100

**Insert action** Draft entries XCMD:CRTACTIONDLG

**Send email** Draft entries XCMD:SENDEMAILDLG

**Export to Google** Draft entries XCMD:GLCONTACTS


Appendix

### L. Command Line Switches

The table below contains the switches that can be used when executing SoftOne (Xplorer.exe file).

```
Command Line Switches
```
```
Switch Operation / Usage Example
```
```
/server
```
```
Runs SoftOne Application Server.
Defaults ports for SoftOne are:
1) Application Port=22001, 2) WebPort=22002
```
```
X:\...\Xplorer.exe /server
```
```
/server:XXX Runs SoftOne Application Server using^ XXX ip address or
HostName.
```
```
X:\...\Xplorer.exe /server:XXX
```
```
/host:XXX
```
```
Runs SoftOne application as client and connects to
application server XXX (HostName or ip address).
```
```
X:\...\Xplorer.exe /host:XXX
```
```
/port:XXX Changes the TCP/IP port of Application Server to XXX
```
```
X:\...\Xplorer.exe /server
/port:XXX
```
```
/install
```
```
Installs SoftOne Application Server as Windows service.
Defaults ports for SoftOne are:
1) Application Port=22001, 2) WebPort=22002
Always run it as Administrator.
```
```
X:\...\Xplorer.exe /install
```
```
/uninstall Uninstalls SoftOne Application Server from windows
services.
```
```
X:\...\Xplorer.exe /uninstall
```
```
/regserver
```
```
Installs the registry keys for the use of com server. It also
adds SoftOne file associations for the following file
types: .auv, .cst, .imp, .imp2, .impc, .impc2, .xmd, .xpr, .xxf
Always run it as Administrator.
```
```
X:\...\Xplorer.exe /regserver
```
```
/unregserver Uninstalls the registry keys installed from regeserver. X:\...\Xplorer.exe /unregserver
```
```
/xco:filename.XCO
```
```
Auto runs the xco (connection) file. Autologin in Softone
works when there is a section [LOGIN] in the xco file.
```
```
X:\...\Xplorer.exe
/xco:filename.XCO
```
```
/sxco
```
```
Executes the configuration commands using the
connection file " default.xco " that exists in the
application server folder.
Useful when clients do not use different parameters
(offline, autologin, etc) in their connection file (xco) than
the ones that application server uses.
```
```
X:\...\Xplorer.exe /host:XXX /sxco
```
```
/balance:X
```
```
Runs SoftOne Balancer for X number of users. It runs
SoftOne Application Server when X SoftOne users login.
SoftOne Application Server must not be installed as
windows service.
```
```
X:\...\Xplorer.exe /balance:10
```
```
/srvrestart:XXX Restarts application server in XXX time intervals X:\...\Xplorer.exe /srvrestart:10
```
```
/forceoffline:1 Forces offline connection mode X:\...\Xplorer.exe /forceoffline:1
```
```
/np "command" Executes the shell command line followed.
```
```
Insert xxf file on login
X:\...\Xplorer.exe /np
"X:\...\myfile.xxf"
```
```
/lang:language Defines SoftOne application language X:\...\Xplorer.exe /lang:eng
```

Appendix

```
Switch Operation / Usage Example
```
```
/xcmd:MenuJob
```
```
Runs and opens the MenuJob (usually SoftOne Object)
after login. It can be combined with any menu
command, such as FORM, LIST, AUTOEXEC, CUSTOM,
FORCEFILTERS, FORCEVALUES etc. Usually used with
autologin xco.
```
**1.** X:\...\Xplorer.exe
/xcmd:CUSTOMER
**2.** X:\...\Xplorer.exe
/xcmd:SALDOC[AUTOEXEC=2]
**3.** X:\...\Xplorer.exe
/xcmd:ITEM[LIST=MYLIST,FORM
=MYFORM]

```
/hide
```
```
Minimizes SoftOne application in Windows tray.
Usually combined with XCMD command, in order to run
only one object/entity and not the entire application.
```
```
X:\...\Xplorer.exe /hide
```
```
/execute:filename
```
```
Runs "filename", using commands similar to Remote Server or Scheduler commands. Mostly
used in Windows scheduled Tasks.
Note : For Azure Installations, inside the local xco file, always use the plain text password
not the encrypted one.
Examples
```
**1. Auto execute a SoftOne script
a)** Create a file (S1Job.txt) using the following commands:
JOBNAME=MyJob
TYPE=BATCH
OBJECT=FORMIMPORT,SCRIPTNAME:TestScript
XCOFILENAME=MYXCOFILE.XCO
**b)** Create windows shortcut X:\...\Xplorer.exe /execute:X:\...\S1Job.txt
**2. Auto execute a SoftOne report and save it as ASCII file
a)** Create a file (S1Report.txt) using the following commands:
TYPE=Report
OBJECT=CUSTOMER
JOBNAME=CustomersBalance
OUTPUT=928
FILENAME=X:\...\Myreport.txt
XCOFILENAME=MYXCOFILE.XCO
**b)** Create windows shortcut X:\...\Xplorer.exe /execute:X:\...\S1Report.txt

```
/pad Deprecated – SoftOne interface for Windows tablets X:\...\Xplorer.exe /pad
```
```
/noversion
```
```
Does not update client files from Application / Cloud
Server X:\...\Xplorer.exe /noversion^
```
```
/refresh Forces client update from Application / Cloud Server files X:\...\Xplorer.exe /refresh
```
```
/noparams Does not load PARAMS.CFG file X:\...\Xplorer.exe /noparams
```
```
/db:xdbxdrv.bpl Used for connections with Oracle database X:\...\Xplorer.exe /db:xdbxdrv.bpl
```
```
/webreport:0 Closes the WebServer TCP/IP port (22002) X:\...\Xplorer.exe /webreport:0
```
```
/webreport:XXX Changes the WebServer TCP/IP port to XXX X:\...\Xplorer.exe /webreport:XXX
```
```
/webfeed:XXX
```
```
Runs SoftOne as web feeder using the defined ip
address. Default port is 22099.
```
```
X:\...\Xplorer.exe
/webfeed:test.oncloud.gr
```
```
/bam:LOCAL Runs BAM locally, for testing BAM scenarios.^
Local webfeeder needs to be running (/webfeed:LOCAL)
```
```
X:\...\Xplorer.exe /BAM:LOCAL
```

Appendix

```
Switch Operation / Usage Example
```
```
/xextui Runs SoftOne using the New UI X:\...\Xplorer.exe /xextui
```
```
/azconsole Runs Azure Console X:\...\Xplorer.exe /azconsole
```
```
/cloudusrtimeout:X
```
```
Specifies the hours that the client application will be
terminated due to user inactivity. Default is 3 hours.
```
```
X:\...\Xplorer.exe
/cloudusrtimeout:6
```
```
/usewebview2 Uses Microsoft Edge as default SoftOne Web browser X:\...\Xplorer.exe /usewebview2
```

Appendix

### M. XCO: On-Premise Connection Settings

The tables below contain the different sections and arguments that can be used in SoftOne connection file XCO.

```
XCO Parameters
```
```
Section Application
```
```
Command Operation / Usage Example
```
```
MPR=MENU Shows SoftOne Menu MPR=MENU
```
```
SN=SoftOne serial number Current connection's serial number SN=0012345678
```
##### IPADDRESS=XXX

```
Licence Manager IP address (Combined with
command AUTOLM=0)
```
##### IPADDRESS=172.23.3.1

```
AUTOLM=0 or 1
```
```
Autosearch the network for Licence Manager
(0=No, 1=Yes) AUTOLM=0^
```
```
NAME=<Connection Name
(XCO)>
```
```
Connection (XCO) name, that will be displayed in
login "Connection" list. XCO File
(MyConnFile.XCO) might have a different name.
```
```
NAME=MyConnectionName
```
```
NETLIB=SoftOne.Lib.dll
```
```
SoftOne Library for custom .NET inprocess or
outprocess applications.
Note : Libraries S1Interop.dll and S1System.dll are
deprecated.
```
```
NETDLL=<.NET dll
Filename>
```
```
Name of the custom .NET inprocess file NETDLL=MyNETdll.dll
```
```
PATH=<Application path> Application path PATH=C:\Softone
```
```
ADDON=<Delphi dll
Filename>
```
```
Name of the custom Delphi inprocess file ADDON=MYDLL.dll
```
##### FORCEOFFLINE=1

```
Forces offline connection mode.
Usually used from outprocess applications.
```
```
FORCENETDLL=1 Login is not allowed if the inprocess net dll can
not be initialized.
```
```
RDEFAULTS=0 or 1
```
```
Display last login data on Login Dialog (Default=1)
(0=No, 1=Yes)
```
```
LANGUAGE=xxx Login Language (GRE, ENG) LANGUAGE=GRE
```
```
LOCALE=xxxx
```
```
Locale Identifier (LCID) (usually used in WEB.XCO)
Greek=1032, Romanian=1048, Bulgarian=1026
```
##### LOCALE=1032


Appendix

```
XCO Parameters
```
```
Section DBConnect
```
```
Command Operation / Usage Example
```
```
TYPE=MSSQL or ORACLE
```
```
Database type (MSSQL, ORACLE).
```
```
ORACLE connections need the use of
commands:
LIBRARYNAME=dbexpoda.dll
VENDORLIB=dbexpoda.dll
DRIVERFUNC=getSQLDriverORA
ORACLE connections also need
SoftOne to run with the switch
/DB:XDBXDRV.BPL
e.g. C:\Soft1\Xplorer.exe
/DB:XDBXDRV.BPL
```
```
1. MSSQL Connection
[DBCONNECT]
TYPE=MSSQL
SERVER=SQLServerName
DATABASE=DBName
USER=sa
PASSWORD=xxx
```
**2. ORACLE Connection**
[DBCONNECT]
TYPE=ORACLE
DRIVER=XDBXDRV.BPL
SERVER=MyPCName:1021:oraclesrvc
USER=DBName
PASSWORD=xxx
LIBRARYNAME=dbexpoda.dll
VENDORLIB=dbexpoda.dll
DRIVERFUNC=getSQLDriverORA

```
SERVER=<Database Server> Name of the Database Server.
```
**1. MSSQL Connection**
SERVER=SQLServerName
**2. ORACLE Connection**
SERVER=MyPCName:1021:oraclesrvc
" **MyPCName** "=Name of the workstation
" **1021** "=Port that Oracle Service is
available
" **oraclesrvc** "=Name of Oracle Service
**DATABASE=<DB Name>** Database Name DATABASE=DBName

```
USER=<Database UserName>
```
```
For MSSQL connections it stands for
Database User Name.
For ORACLE connections it stands for
Database Name.
```
```
1. MSSQL Connection
USER=sa
```
**2. ORACLE Connection**
USER=DBName
**PASSWORD=<DB Password>** Database User Password PASSWORD=xxx

```
SQLTIMEOUT=<sec>
```
```
Configures the remote query
timeout. Specifies how long (in
seconds) a remote operation can
take before SQL Server times out.
Default value in MSSQL is 600 (10
minutes).
```
##### SQLTIMEOUT=100

```
COMMANDTIMEOUT=<sec>
```
```
Sets the wait time (in seconds)
before terminating the attempt to
execute a command and generating
an error.
```
##### COMMANDTIMEOUT=100

```
DRIVER=XDBXDRV.BPL Used in ORACLE connections
LIBRARYNAME=dbexpoda.dll Used in ORACLE connections
VENDORLIB=dbexpoda.dll Used in ORACLE connections
DRIVERFUNC=getSQLDriverO
RANET
```
```
Used in ORACLE connections
```

Appendix

```
XCO Parameters
```
```
Section [Login]
```
```
Command Operation / Usage Example
```
```
USERNAME=<SoftOne
UserName> Autologin SoftOne User^ Name^ USERNAME=S1UserName^
```
```
PASSWORD=<SoftOne
UserPassword>
```
```
Autologin SoftOne User Password PASSWORD=xxx
```
```
COMPANY=<SoftOne
Company Code>
```
```
Autologin SoftOne Company Code COMPANY=1000
```
```
BRANCH=<SoftOne Branch
Code> Autologin SoftOne Branch Code^ BRANCH=1000^
```
```
HIDEBAR=1 Hides the Toolbar
```
```
HIDEMENU=1 Hides SoftOne User Menu
```
##### HIDEXPLORER=1

```
Minimizes SoftOne application in Windows
tray. Usually combined with command EXEC,
in order to display only one object/entity and
not the entire application.
```
```
EXEC=<SoftOne Command>
```
```
Executes the SoftOne command followed
(usually SoftOne Object). It can be combined
with any menu command, such as FORM,
LIST, AUTOEXEC, CUSTOM, FORCEFILTERS,
FORCEVALUES etc.
```
##### EXEC=SALDOC[AUTOEXEC=2]

```
EXEC=ACMD:acRemoteServer
```
```
XCO Parameters
```
```
SQL SERVER – Windows Authentication
```
```
For Windows Authentication Connections use the following commands inside the xco file.
[DBCONNECT]
TYPE=MSSQL
SERVER=<servername>
DATABASE=<dbname>
CONNECTIONSTRING =Provider=SQLOLEDB.1;Integrated Security=SSPI;Data Source=%s;Initial
Catalog=%s;%s%sAuto Translate=False;Application Name=SOFT1
```

Appendix

```
XCO Example – SQL Connection (Autologin & Open RETAILDOC object)
```
```
XCO Example – Oracle Connection
```

Appendix

### N. PARAMS.cfg: Cloud Connection Settings

The tables below contain the different sections and arguments that can be used in SoftOne connection file
Params.cfg either for cloud or on-premise installations.

```
Params.cfg
```
```
Section [PARAMS]
```
```
Command Operation / Usage Example
```
```
LANG:xxx Defines SoftOne application language LANG:ENG
```
```
SERVER:XXX Runs SoftOne Application Server using^ XXX IP^
address or HostName
```
```
X:\...\Xplorer.exe /server:XXX
```
##### HOST:XXX

```
Runs SoftOne application as client and connects
to application server XXX (HostName or IP
address).
```
```
X:\...\Xplorer.exe /host:XXX
```
##### PORT:XXX

```
Changes the TCP/IP port of the Application Server
to XXX
```
```
X:\...\Xplorer.exe /server
/port:XXX
```
```
SAAS:saas.azure.oncloud.gr
```
```
Connection URL.
Always use it for out-process applications
```
```
NETLIB=SoftOne.Lib.dll
```
```
SoftOne Library for custom .NET in-process or
out-process applications.
Note : Libraries S1Interop.dll and S1System.dll are
deprecated.
```
```
NETDLL=<.NET dll
Filename>
```
```
Name of the custom .NET in-process file
It’s recommended to add it inside the
filename.xco in Custom SDK Files
```
```
NETDLL=MyNETdll.dll
```
```
ADDON=<Delphi dll
Filename>
```
```
Name of the custom Delphi in-process file ADDON=MYDLL.dll
```
```
CLOUDUSRTIMEOUT=(hrs)
```
```
Specifies the hours that the client application will
be terminated due to user inactivity.
Default value is 3 hours.
```
##### CLOUDUSRTIMEOUT=8

```
TCPPING:(ms)
```
```
Defines the interval ping time (ms) that clients
check if application server is alive.
Used only in client/server installations.
Default value is 40000.
```
##### TCPPING=60000

```
TCPNONEWS:(ms)
```
```
Specifies the time (ms) that clients will be
terminated (killed) from application server due to
user inactivity.
Used only in client/server installations and must
always be greater than the value of TCPPING.
This functionality is disabled by default and only
enabled if the parameter is defined inside
PARAMS.cfg. This means that by default, clients
are not terminated due to user inactivity
(on-premise installations).
```
##### TCPNONEWS= 90000


Appendix

```
Params.cfg
```
```
Section [SAAS]
```
```
Command Operation / Usage Example
```
```
SectionName=DisplayName
```
```
SectionName: Name of the section that will be
used to define the login params (see next table).
More than one sections can be defined inside a
Params.cfg file and will be displayed in SoftOne
Login window (like .XCO files).
DisplayName: Name that is displayed inside
SoftOne Connection drop down list (SoftOne
Login window)
```
```
MyInstallation=MyInstallation
```
```
Params.cfg
```
```
Section [InstSectionName] (Example [MyInstallation]) or [SAASSYSTEM] for single connection
```
```
Command Operation / Usage Example
```
```
USERNAME=<SoftOne
UserName>
```
```
SoftOne installation serial number USERNAME=Admin
```
```
PASSWORD=<SoftOne
UserPassword>
```
```
SoftOne installation password PASSWORD=xxx
```
```
DONTSHOWAGAIN=1 Hides the Cloud Login Window
```
```
Params.cfg Example
```

Appendix

### O. Internal Object Parameters

The table below contains internal parameter commands that can be used inside SoftOne objects.

They can be added in “General Settings” tab under SoftOne Objects’ “Configuration” or executed through JavaScript
code. **Examples** : X.SETPARAM(“KEEPHANDPRC”,”1”) or obj.SETPARAM(“WARNINGS”,”OFF”).

```
Internal Object Parameters
```
```
Object / Module Command Operation / Usage
```
```
All NOMESSAGES=1 Disables the display of warning messagesoperational parameters (e.g. Zero Quantity warning)^ that rise from. SoftOne^
```
```
All WARNINGS=OFF Disables the display of warning messages, that rise from “WARNING” fields (as in Customer, Item objects).
```
```
SALDOC NOPROCDEF=1 Disables the execution of credit control scenarios.
```
```
SALDOC NOCHECKLIMITS=1 Disables item quantity checks.
```
```
SALDOC ASKTOCHANGEPOLICY=1 Displays “Change policy” confirmation message.
```
```
SALDOC KEEPHANDPRC=1 Maintains mcases of document anually added recalculation.item price (Field “ ITELINES.PRICE”) in
```
```
SALDOC KEEPHANDSRVPRC=1 Maintains mcases of document anually added recalculation.service price (Field “SRVLINES.PRICE”) in
```
```
SALDOC KEEPHANDDISCPRC1=1 Manually added of recalculation. item discount (DISC1PRC) is not overwritten in case
```
```
SALDOC KEEPHANDDISCPRC2=1 Manually added of recalculation. item discount (DISC2PRC) is not overwritten in case
```
```
SALDOC KEEPHANDDISCPRC3=1 Manually added of recalculation. item discount (DISC3PRC) is not overwritten in case
```
```
SALDOC NOBONUSPOINT=1 Disables bonus points calculation (on document post).
```
```
SALDOC AUTOCOVERUSE=1 Enables “Auto F.BRANCH=”+FINDOC.BRANCH)Coverage mode” using Company Branch (AND
```
```
SALDOC AUTOCOVERUSE= 2
```
```
Enables “Auto Coverage mode” using Customer Branch (AND
F.TRDBRANCH=”+FINDOC.TRDBRANCH). If Customer Branch is null
then it covers the corresponding documents that have null
TRDBRANCH (AND F.TRDBRANCH is null).
```
```
SALDOC AUTOCOVERUSE= 3 Enables “Auto Coverage mode” using Customer branch. Company branch and
```
```
SALDOC AUTOTRANSKEEPEXPN=1 Sales d“keep” the ocuments expense that are created from auto conversion data (EXPN) of the converted document.(Series flag)
```
```
SALDOC, PURDOC NOSERIESREEVAL=1 Disables “SERIES” field.document recalculation when changing the data of
```

